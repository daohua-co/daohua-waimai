import{ai as n,o as r,M as V,R as z,c as R,O as l,S as c,T as $,U as t,u as e,F,aB as Oe,aC as qe,at as Le,d as T,e as te,a as k,Z as K,aD as De,aE as je,ax as _e,as as O,P as I,a2 as j,I as M,V as Y,i as be,a7 as q,Q as Ne,aF as He,a8 as le,h as Me,n as We,aG as Qe,a6 as Ye}from"./vendor-8025917f.js";import{c as we,i as Ke,z as Ge,d as Ue,p as Re,u as Je,e as Xe,s as Ze,f as et,E as tt}from"./vendor.ep-ac3077ed.js";import{u as L,h as G,r as Ae,s as Pe,a as oe,b as lt,c as nt,e as ke,t as ie,x as ee,d as he,i as Ve,f as pe,g as ot,l as at,j as st,L as X,S as de,k as me,m as ae,F as se,n as it}from"./lib-9fc8d086.js";import{t as xe,E as rt}from"./vendor.mce1-b07e8ce6.js";import"./vendor.mce2-3b45e8ff.js";const dt={__name:"Pagination",props:{bindings:Object},setup(x){return(b,a)=>{const i=n("el-pagination");return x.bindings.listData.total>0&&x.bindings.listData.per_page<200?(r(),V(i,{key:0,background:"",class:"mt-4",layout:"prev, pager, next, ->, total",onCurrentChange:a[0]||(a[0]=s=>x.bindings.reload(s)),"current-page":x.bindings.listData.current_page,total:x.bindings.listData.total,"pager-count":9,"page-size":x.bindings.listData.per_page},null,8,["current-page","total","page-size"])):z("",!0)}}},ut={__name:"PopconfirmOperate",props:{title:{type:String,default:"确定要删除吗"},label:{type:String,default:"删除"},type:{type:String,default:"link"},disabled:Boolean},emits:["confirm"],setup(x){return(b,a)=>{const i=n("el-button"),s=n("el-icon"),u=n("el-link"),d=n("el-popconfirm");return x.disabled?(r(),R(F,{key:0},[x.type==="button"?(r(),V(i,{key:0,type:"primary",disabled:""},{default:l(()=>[c($(x.label),1)]),_:1})):x.type==="icon"?(r(),V(s,{key:1,disabled:""},{default:l(()=>[t(e(we))]),_:1})):(r(),V(u,{key:2,type:"primary",disabled:""},{default:l(()=>[c($(x.label),1)]),_:1}))],64)):(r(),V(d,{key:1,"confirm-button-text":"确定","cancel-button-text":"取消",onConfirm:a[0]||(a[0]=f=>b.$emit("confirm")),title:x.title},{reference:l(()=>[x.type==="button"?(r(),V(i,{key:0,type:"primary"},{default:l(()=>[c($(x.label),1)]),_:1})):x.type==="icon"?(r(),V(s,{key:1},{default:l(()=>[t(e(we))]),_:1})):(r(),V(u,{key:2,type:"primary"},{default:l(()=>[c($(x.label),1)]),_:1}))]),_:1},8,["title"]))}}};/*! Element Plus v2.3.8 */var pt={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"}}};const mt=(x,b)=>{const a=Oe({history:qe(),routes:b}),i=Le(x);return i.use(a),i.use(Ke,{locale:pt}),i.component("Pagination",dt),i.component("PopconfirmOperate",ut),window.app=i,i},ct="modulepreload",_t=function(x){return"/admincp/"+x},$e={},Q=function(b,a,i){if(!a||a.length===0)return b();const s=document.getElementsByTagName("link");return Promise.all(a.map(u=>{if(u=_t(u),u in $e)return;$e[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(!!i)for(let m=s.length-1;m>=0;m--){const _=s[m];if(_.href===u&&(!d||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${f}`))return;const o=document.createElement("link");if(o.rel=d?"stylesheet":ct,d||(o.as="script",o.crossOrigin=""),o.href=u,document.head.appendChild(o),d)return new Promise((m,_)=>{o.addEventListener("load",m),o.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})})).then(()=>b()).catch(u=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u})},ve=(x,b)=>{const a=x.__vccOpts||x;for(const[i,s]of b)a[i]=s;return a},ft={};function gt(x,b){const a=n("el-result");return r(),V(a,{icon:"error",title:"403 | 无权限","sub-title":"你无权访问该页面"})}const bt=ve(ft,[["render",gt]]),ht={},vt={class:"py-32"};function yt(x,b){const a=n("el-result");return r(),R("div",vt,[t(a,{icon:"info",title:"404 | 页面未找到","sub-title":""})])}const wt=ve(ht,[["render",yt]]),kt={__name:"Demo",props:{modelValue:{type:Array,default:()=>[]}},setup(x){const b=x,a=T([]);return te(()=>b.modelValue,function(){console.log("changed...",arguments),a.value=b.modelValue.map(i=>({url:i}))},{deep:!0,immediate:!0}),(i,s)=>(r(),R("span",null,$(a.value),1))}},Vt={__name:"Dashboard",setup(x){const b=["xxxaaa","xxxxxxbbb"];return(a,i)=>(r(),V(kt,{modelValue:b,"onUpdate:modelValue":i[0]||(i[0]=s=>b=s)}))}},xt="data:image/png;base64,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",$t={},Ct={class:"copyright mt-4"},Et=k("a",{href:"https://bendi.team",target:"_blank"},"Bendi.team",-1);function Dt(x,b){return r(),R("div",Ct,[c(" © "+$(new Date().getFullYear())+" ",1),Et])}const Se=ve($t,[["render",Dt]]),Ut={class:"auth-wrapper"},Rt=k("div",{class:"top"},[k("a",{href:"https://bendi.team/"},[k("img",{height:"34",src:xt})]),k("h1",null,"系统管理登录")],-1),At=k("i",{class:"iconfont icon-user-fill"},null,-1),Pt=k("i",{class:"iconfont icon-password"},null,-1),St={__name:"Login",setup(x){const b=K({account:"",password:""}),a=K({account:[{required:!0,message:"请输入账号",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{min:6,max:20,message:"密码长度为 6~20 位",trigger:["blur","change"]}]}),i=De(),s=je().query.forward||"/",u=T();_e(()=>{u.value.focus(),L.id&&i.replace(s)});const d=T(!1),f=g=>{g.validate().then(()=>{d.value=!0,G.post("/admin/auth/login",b).then(o=>{if(!o.success){Ae(o);return}Pe(o.userInfo),oe("登录成功"),i.replace(s)}).finally(()=>{d.value=!1})})};return(g,o)=>{const m=n("el-input"),_=n("el-form-item"),h=n("el-button"),w=n("el-form"),p=O("loading");return r(),R("div",Ut,[Rt,t(w,{size:"large","label-position":"top",class:"auth-form",rules:a,ref:"formRef",model:b,onSubmit:o[2]||(o[2]=j(v=>f(g.$refs.formRef),["prevent"]))},{default:l(()=>[t(_,{prop:"account"},{default:l(()=>[t(m,{ref_key:"accountRef",ref:u,modelValue:b.account,"onUpdate:modelValue":o[0]||(o[0]=v=>b.account=v),placeholder:"请输入用户名/手机号/邮箱"},{prepend:l(()=>[At]),_:1},8,["modelValue"])]),_:1}),t(_,{prop:"password"},{default:l(()=>[t(m,{modelValue:b.password,"onUpdate:modelValue":o[1]||(o[1]=v=>b.password=v),type:"password",autocomplete:"off",placeholder:"请输入密码"},{prepend:l(()=>[Pt]),_:1},8,["modelValue"])]),_:1}),t(_,null,{default:l(()=>[I((r(),V(h,{type:"primary",class:"submit","native-type":"submit"},{default:l(()=>[c(" 登录 ")]),_:1})),[[p,d.value]])]),_:1})]),_:1},8,["rules","model"]),t(Se)])}}},Bt=[{path:"/",component:Vt,meta:{title:"概况"}},{path:"/notfound",component:wt,meta:{title:"404 | 页面未找到"}},{path:"/forbidden",component:bt,meta:{title:"403 | 无权限"}},{path:"/login",component:St,meta:{title:"登录"}},{path:"/contents",component:()=>Q(()=>Promise.resolve().then(()=>yl),void 0),meta:{parent:"",title:"内容管理",auth:"content.viewAll"}},{path:"/contents/create",component:()=>Q(()=>Promise.resolve().then(()=>Ee),void 0),meta:{parent:"/contents",title:"新建内容",auth:"content.create"}},{path:"/contents/:id/edit",props:!0,component:()=>Q(()=>Promise.resolve().then(()=>Ee),void 0),meta:{parent:"/contents",title:"编辑内容",auth:"content.category.update"}},{path:"/contents/categories",component:()=>Q(()=>Promise.resolve().then(()=>Hl),void 0),meta:{parent:"/contents",title:"分类管理",auth:"content.category.viewAll"}},{path:"/contents/tags",component:()=>Q(()=>Promise.resolve().then(()=>en),void 0),meta:{parent:"/contents",title:"标签管理",auth:"content.tag.viewAll"}},{path:"/admin-users",component:()=>Q(()=>Promise.resolve().then(()=>gn),void 0),meta:{title:"人员管理",auth:"admin-user.viewAll"}},{path:"/admin-users/departments",component:()=>Q(()=>Promise.resolve().then(()=>$n),void 0),meta:{parent:"/admin-users",title:"部门管理",auth:"admin-user.department.viewAll"}},{path:"/admin-users/roles",component:()=>Q(()=>Promise.resolve().then(()=>Ln),void 0),meta:{parent:"/admin-users",title:"角色管理",auth:"admin-user.role.viewAll"}},{path:"/admin-users/recycles",component:()=>Q(()=>Promise.resolve().then(()=>Kn),void 0),meta:{parent:"/admin-users",title:"回收站",auth:"admin-user.recycle.viewAll"}},{path:"/settings/:group",props:!0,component:()=>Q(()=>Promise.resolve().then(()=>Zn),void 0),meta:{title:"设置",auth:"system.setting.update"}}],It="/admincp/assets/logo-ea9a3a15.svg",Ft={type:"submit"},zt={__name:"ChangePasswordDialog",setup(x,{expose:b}){const a=K({show:!1,submitting:!1,showValidateError:!0}),i=K({old_password:"",password:"",password_confirmation:""}),s=T(),u={old_password:{required:!0,min:6,message:"请输入 6 位以上的旧密码",trigger:["blur","change"]},password:{required:!0,min:6,message:"请输入 6 位以上的密码",trigger:["blur","change"]},password_confirmation:{required:!0,validator:(g,o,m)=>!o||o!==i.password?m(new Error("两次输入密码不一致")):m(),trigger:["blur","change"]}},d=()=>{a.showValidateError=!1,lt.empty(i),setTimeout(()=>{s.value.clearValidate(),a.showValidateError=!0},200)},f=()=>{s.value.validate().then(()=>{G.patch("/admin/account/chpw",i).then(g=>{oe("修改密码成功"),a.show=!1,d()})})};return b({show:()=>{a.show=!0}}),(g,o)=>{const m=n("el-input"),_=n("el-form-item"),h=n("el-form"),w=n("el-button"),p=n("el-dialog"),v=O("loading");return r(),V(p,{modelValue:a.show,"onUpdate:modelValue":o[3]||(o[3]=y=>a.show=y),title:"修改密码",width:"480",draggable:"","align-center":""},{footer:l(()=>[t(w,{onClick:d},{default:l(()=>[c("重置")]),_:1}),I((r(),V(w,{type:"primary",onClick:f},{default:l(()=>[c("确定")]),_:1})),[[v,a.submitting]])]),default:l(()=>[t(h,{class:M(a.showValidateError?"":"hide-validate-error"),ref_key:"formRef",ref:s,rules:u,model:i,"label-width":"100px",onSubmit:j(f,["prevent"])},{default:l(()=>[I(k("input",Ft,null,512),[[Y,!1]]),t(_,{label:"旧密码",prop:"old_password"},{default:l(()=>[t(m,{type:"password",modelValue:i.old_password,"onUpdate:modelValue":o[0]||(o[0]=y=>i.old_password=y),placeholder:"请输入6位以上的密码","show-password":""},null,8,["modelValue"])]),_:1}),t(_,{label:"新密码",prop:"password"},{default:l(()=>[t(m,{type:"password",modelValue:i.password,"onUpdate:modelValue":o[1]||(o[1]=y=>i.password=y),placeholder:"请输入6位以上的密码","show-password":""},null,8,["modelValue"])]),_:1}),t(_,{label:"确认密码",prop:"password_confirmation"},{default:l(()=>[t(m,{type:"password",modelValue:i.password_confirmation,"onUpdate:modelValue":o[2]||(o[2]=y=>i.password_confirmation=y),placeholder:"请输入6位以上的密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["class","model","onSubmit"])]),_:1},8,["modelValue"])}}},Be=(x,b,a)=>["image/png","image/jpeg","image/gif","image/webp"].includes(x)?b/1024/1024>parseFloat(a+"")?(ke(`图片大小不能超过 ${a}M`),!1):!0:(ke("不支持该文件格式"),!1),Ie=(x="shared")=>nt(`/admin/images?type=${x}`);async function Fe(x){if(!x.message)return ie("上传异常");const b=JSON.parse(x.message);if(b.code===419&&b.token_cookie_sent){ie("已为你更新已过期的安全码，请重新上传。");return}ie(b.message)}const Tt={class:"loading"},Ot={key:0,class:"image-wp"},qt={__name:"UploadImage",props:{modelValue:{type:String},type:{type:String,default:"shared"},sizeLimit:{type:Number,default:5},disabled:{type:Boolean,default:!1},enablePreview:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(x,{emit:b}){const a=x,i={_xsrf_token:ee()},s=be({get:()=>a.modelValue,set:h=>b("update:modelValue",h)}),u=T(!1),d=T(!1),f=(h,w)=>{s.value=h.data.url,d.value=!1},g=()=>{s.value=""},o=h=>Be(h.type,h.size,a.sizeLimit)?(d.value=!0,!0):!1,m=h=>{if(h.message.includes("Unauthenticated")){he(),i._xsrf_token=ee();return}Fe(h).then(()=>{d.value=!1,i._xsrf_token=ee()})},_=()=>{u.value=!1};return(h,w)=>{const p=n("el-image"),v=n("el-icon"),y=n("el-upload"),P=n("el-image-viewer"),U=O("loading");return r(),R(F,null,[t(y,{class:M(`image-uploader rounded ${x.disabled?" image-uploader-disabled":""}`),accept:"image/png, image/jpeg, image/gif, image/webp",action:e(Ie)(x.type),"with-credentials":!0,data:i,multiple:!1,"show-file-list":!1,"on-success":f,"on-error":m,"before-upload":o,name:"img",disabled:x.disabled},{default:l(()=>[I(k("div",Tt,null,512),[[U,d.value]]),s.value?(r(),R("div",Ot,[t(p,{src:s.value,fit:"cover",class:"image"},null,8,["src"]),x.enablePreview?(r(),V(v,{key:0,title:"预览",class:"image-preview-button image-action rounded",onClick:w[0]||(w[0]=j(A=>u.value=!0,["prevent","stop"]))},{default:l(()=>[t(e(Ge))]),_:1})):z("",!0),t(v,{title:"删除",class:"image-remove-button image-action rounded",onClick:j(g,["prevent","stop"])},{default:l(()=>[t(e(Ue))]),_:1},8,["onClick"])])):(r(),V(v,{key:1,class:"image-uploader-icon"},{default:l(()=>[t(e(Re))]),_:1}))]),_:1},8,["class","action","disabled"]),x.enablePreview&&s.value&&u.value?(r(),V(P,{key:0,"url-list":[s.value],"z-index":9999,"hide-on-click-modal":!0,"close-on-press-escape":!0,teleported:!0,onClose:_},null,8,["url-list"])):z("",!0)],64)}}};const Lt={type:"submit"},jt={class:"avatar-wp"},Nt={__name:"ChangeProfileDialog",setup(x,{expose:b}){const a=K({show:!1,submitting:!1,loading:!1}),i=K({}),s=T(),u={realname:{required:!0,min:2,message:"真实姓名名不能少于2个字符",trigger:["blur","change"]},mobile:{pattern:/^1[3-9]\d{9}$/,message:"手机号码格式不正确",trigger:["blur","change"]},email:{pattern:/^[\w\-.]+@[\w-]+(\.[\w-]+)+$/i,message:"邮箱格式不正确",trigger:["blur","change"]}},d=()=>{s.value.validate().then(()=>{G.patch("/admin/account/ch_profile",i).then(f=>{oe("修改成功"),a.show=!1,Pe(i)})})};return b({show:()=>{Object.assign(i,{avatar:L.avatar,realname:L.realname,email:L.email,mobile:L.mobile}),a.show=!0}}),(f,g)=>{const o=n("el-skeleton"),m=n("el-form-item"),_=n("el-input"),h=n("el-form"),w=n("el-button"),p=n("el-dialog"),v=O("loading");return r(),V(p,{modelValue:a.show,"onUpdate:modelValue":g[4]||(g[4]=y=>a.show=y),title:"修改资料",width:"560",draggable:"","align-center":""},{footer:l(()=>[I((r(),V(w,{type:"primary",onClick:d},{default:l(()=>[c("确定")]),_:1})),[[v,a.submitting]])]),default:l(()=>[t(o,{rows:10,loading:a.loading,animated:""},null,8,["loading"]),a.loading?z("",!0):(r(),V(h,{key:0,ref_key:"formRef",ref:s,rules:u,model:i,"label-width":"100px",onSubmit:j(d,["prevent"])},{default:l(()=>[I(k("input",Lt,null,512),[[Y,!1]]),t(m,{label:"头像",prop:"avatar"},{default:l(()=>[k("div",jt,[t(qt,{type:"avatar",modelValue:i.avatar,"onUpdate:modelValue":g[0]||(g[0]=y=>i.avatar=y)},null,8,["modelValue"])])]),_:1}),t(m,{label:"用户名",prop:"name"},{default:l(()=>[c($(e(L).name),1)]),_:1}),t(m,{label:"姓名",prop:"realname"},{default:l(()=>[t(_,{modelValue:i.realname,"onUpdate:modelValue":g[1]||(g[1]=y=>i.realname=y)},null,8,["modelValue"])]),_:1}),t(m,{label:"手机号",prop:"mobile"},{default:l(()=>[t(_,{modelValue:i.mobile,"onUpdate:modelValue":g[2]||(g[2]=y=>i.mobile=y),placeholder:"请输入大陆手机号"},null,8,["modelValue"])]),_:1}),t(m,{label:"邮箱",prop:"email"},{default:l(()=>[t(_,{modelValue:i.email,"onUpdate:modelValue":g[3]||(g[3]=y=>i.email=y)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","onSubmit"]))]),_:1},8,["modelValue"])}}},Ce=[{title:"首页",path:"/",icon:"dashboard",desc:"后台首页",children:[{title:"控制台",path:"/"}]},{title:"内容",path:"/contents",icon:"news",desc:"内容管理",module:"contents",children:[{title:"文章",path:"/contents"},{title:"分类",path:"/contents/categories"},{title:"标签",path:"/contents/tags"}]},{title:"商品",path:"/goods",icon:"goods",desc:"商品管理",module:"goods",children:[{title:"商品",path:"/goods"},{title:"分类",path:"/goods/categories"},{title:"标签",path:"/goods/tags"}]},{title:"Todo",path:"/todo",icon:"stats",desc:"数据管理",module:"stats",children:[{title:"Todo1",path:"/todo"},{title:"Todo2",path:"/todo"}]},{title:"人员",path:"/admin-users",icon:"user",desc:"人员管理",module:"admin-users",children:[{title:"人员管理",path:"/admin-users"},{parent:"/admin-users",title:"角色管理",path:"/admin-users/roles"},{parent:"/admin-users",title:"部门管理",path:"/admin-users/departments"},{parent:"/admin-users",title:"回收站",path:"/admin-users/recycles"}]},{title:"设置",path:"/settings/system",icon:"setting",desc:"系统设置",module:"settings",children:[{title:"系统设置",path:"/settings/system"},{title:"联系信息",path:"/settings/contact"},{title:"短信设置",path:"/settings/sms"}]}],Ht={class:"app-top-ops"},Mt={class:"user-action"},Wt={class:"avatar"},Qt={key:1},Yt=k("span",null,"修改资料",-1),Kt=k("span",null,"修改密码",-1),Gt=k("span",null,"退出登录",-1),Jt={title:"易始管理后台"},Xt=k("img",{class:"logo",src:It,alt:"易始管理后台"},null,-1),Zt={class:"menu"},el={class:"menu-2"},tl=k("div",{class:"menu menu-2-holder"},[k("dl",{class:"menu-2 !border-none !block !left-0 !z-[8]"},[k("dt",null,"其它"),k("dd",{class:"active"},[k("a",{class:"router-link-active router-link-exact-active block"},[k("span",null,"其它")])])])],-1),ll={key:1},nl={__name:"App",setup(x){const b=T(),a=T([0,0]),i=T([]),s=De();s.beforeEach((f,g,o)=>{if(f.matched.length===0){s.replace("/notfound");return}if(f.path==="/login"){if(Ve()){const m=f.query.forward||"/";s.replace(m);return}o();return}if(!Ve()){he();return}if(f.meta.auth&&!pe(f.meta.auth)){s.replace("/forbidden");return}o()}),s.afterEach((f,g,o)=>{f.matched.length!==0&&(a.value=ot(f.path,Ce),u(f))});const u=f=>{const g=[];f.meta.parent&&g.push({path:f.meta.parent,title:s.resolve(f.meta.parent).meta.title}),g.push({title:f.meta.title??"未知页面"}),i.value=g},d=(f="")=>{at.show({text:"退出中..."}),G.post("/admin/auth/logout",{}).then(g=>{oe("退出成功"),window.location.reload()})};return(f,g)=>{const o=n("el-image"),m=n("el-icon"),_=n("el-dropdown-item"),h=n("el-dropdown-menu"),w=n("el-dropdown"),p=n("router-link"),v=n("el-aside"),y=n("el-breadcrumb-item"),P=n("el-breadcrumb"),U=n("el-header"),A=n("router-view"),C=n("el-main"),E=n("el-container");return r(),R(F,null,[t(E,{class:"h-full"},{default:l(()=>[k("div",Ht,[t(w,null,{dropdown:l(()=>[t(h,null,{default:l(()=>[t(_,{onClick:g[0]||(g[0]=B=>f.$refs.chProfileRef.show())},{default:l(()=>[t(m,null,{default:l(()=>[t(e(Je))]),_:1}),Yt]),_:1}),t(_,{onClick:g[1]||(g[1]=B=>f.$refs.chpwRef.show())},{default:l(()=>[t(m,null,{default:l(()=>[t(e(Xe))]),_:1}),Kt]),_:1}),t(_,{onClick:g[2]||(g[2]=B=>d())},{default:l(()=>[t(m,null,{default:l(()=>[t(e(Ze))]),_:1}),Gt]),_:1})]),_:1})]),default:l(()=>[k("div",Mt,[k("span",Wt,[e(L).avatar?(r(),V(o,{key:0,class:"img",fit:"cover",src:e(L).avatar},null,8,["src"])):(r(),R("span",Qt,$(e(L).showName[0]||""),1))]),c(" "+$(e(L).showName)+" ",1),t(m,{class:"align-middle"},{default:l(()=>[t(e(et))]),_:1})])]),_:1})]),t(v,{class:"app-side"},{default:l(()=>[k("h1",Jt,[t(p,{to:"/"},{default:l(()=>[Xt]),_:1})]),k("ul",Zt,[(r(!0),R(F,null,q(e(Ce),(B,N)=>(r(),R("li",{class:M(N===a.value[0]?"active":""),key:B.path},[t(p,{to:B.path},{default:l(()=>[k("i",{class:M("iconfont icon-"+B.icon+(N===a.value[0]?"-fill":""))},null,2),k("span",null,$(B.title),1)]),_:2},1032,["to"]),k("dl",el,[k("dt",null,$(B.desc?B.desc:B.title),1),(r(!0),R(F,null,q(B.children,(H,D)=>(r(),R("dd",{class:M(N===a.value[0]&&D===a.value[1]?"active":""),key:H.path},[t(p,{to:H.path},{default:l(()=>[k("span",null,$(H.title),1)]),_:2},1032,["to"])],2))),128))])],2))),128))]),tl]),_:1}),t(E,{class:"main-wrapper h-full"},{default:l(()=>[t(U,{class:"app-header"},{default:l(()=>[t(P,{class:"breadcrumb"},{default:l(()=>[(r(!0),R(F,null,q(i.value,B=>(r(),V(y,{key:B.title},{default:l(()=>[B.path?(r(),V(p,{key:0,to:B.path},{default:l(()=>[c($(B.title),1)]),_:2},1032,["to"])):(r(),R("span",ll,$(B.title),1))]),_:2},1024))),128))]),_:1})]),_:1}),t(C,{class:"app-main"},{default:l(()=>[t(A,null,{default:l(({Component:B})=>[(r(),V(He,null,[(r(),V(Ne(B)))],1024))]),_:1}),t(Se)]),_:1})]),_:1})]),_:1}),t(zt,{ref_key:"chpwRef",ref:b},null,512),t(Nt,{ref:"chProfileRef"},null,512)],64)}}};st("admin/auth/profile").then(()=>{mt(nl,Bt).mount("#app")});const Z=new X("admin/admin-users/departments"),ne=new X("admin/admin-users/roles"),re=new X("admin/admin-users"),ue=new X("admin/admin-users/recycles"),ye=new X("admin/admin-users/permissions"),ce=new X("admin/contents"),J=new X("admin/contents/categories"),ge=new X("admin/contents/tags");const ol={key:0},al=k("span",{class:"tips"},"从小到大显示",-1),sl=["innerHTML"],il={__name:"ShowDrawer",setup(x,{expose:b}){const a=new de(ce.api),{item:i,is:s,show:u}=a;return b({show:u}),(d,f)=>{const g=n("el-skeleton"),o=n("el-descriptions-item"),m=n("el-tag"),_=n("el-image"),h=n("el-descriptions"),w=n("el-button"),p=n("el-drawer"),v=n("el-form");return r(),V(v,{ref:"formRef",model:e(i),"label-width":"100px",class:"show-wp"},{default:l(()=>[t(p,{modelValue:e(s).show,"onUpdate:modelValue":f[1]||(f[1]=y=>e(s).show=y),title:"商品详情",size:"720"},{footer:l(()=>[t(w,{type:"primary",onClick:f[0]||(f[0]=()=>e(me)(`/contents/${e(i).id}/edit`))},{default:l(()=>[c("编辑")]),_:1})]),default:l(()=>[t(g,{rows:10,loading:e(s).loading},null,8,["loading"]),e(s).loading?z("",!0):(r(),R("div",ol,[k("div",null,[t(h,{title:"基本信息",column:1,"label-align":"right","label-size":"small",border:""},{default:l(()=>[t(o,{label:"商品标题"},{default:l(()=>[c($(e(i).title),1)]),_:1}),t(o,{label:"创建者"},{default:l(()=>{var y;return[c($((y=e(i).creator)==null?void 0:y.show_name),1)]}),_:1}),t(o,{label:"作者"},{default:l(()=>[c($(e(i).author),1)]),_:1}),t(o,{label:"编辑"},{default:l(()=>[c($(e(i).editor),1)]),_:1}),t(o,{label:"来源"},{default:l(()=>[c($(e(i).source),1)]),_:1}),t(o,{label:"显示排序"},{default:l(()=>[c($(e(i).asc_num)+" ",1),al]),_:1}),t(o,{label:"状态"},{default:l(()=>[t(m,{size:"small",effect:"plain",type:e(i).status==="published"?"success":"warning",round:""},{default:l(()=>[c($(e(i).status==="published"?"发布":"草稿"),1)]),_:1},8,["type"])]),_:1}),t(o,{label:"分类"},{default:l(()=>[(r(!0),R(F,null,q(e(i).categories,y=>(r(),V(m,{class:"mr-2",key:y.id},{default:l(()=>[c($(y.title),1)]),_:2},1024))),128))]),_:1}),t(o,{label:"标签"},{default:l(()=>[(r(!0),R(F,null,q(e(i).tags,y=>(r(),V(m,{class:"mr-2",key:y.id},{default:l(()=>[c($(y.title),1)]),_:2},1024))),128))]),_:1}),t(o,{label:"相册"},{default:l(()=>[(r(!0),R(F,null,q(e(i).album,(y,P)=>(r(),V(_,{class:"w-24 h-24 mr-2",fit:"cover","preview-src-list":e(i).album,src:y,key:y,"initial-index":P,"hide-on-click-modal":!0},null,8,["preview-src-list","src","initial-index"]))),128))]),_:1}),t(o,{label:"创建时间"},{default:l(()=>[c($(e(i).created_at),1)]),_:1}),t(o,{label:"更新时间"},{default:l(()=>[c($(e(i).updated_at),1)]),_:1}),t(o,{label:"删除时间"},{default:l(()=>[c($(e(i).deleted_at??"-"),1)]),_:1})]),_:1})]),t(h,{class:"mt-6",column:1,title:"文章内容","label-align":"right","label-size":"small",border:""},{default:l(()=>[t(o,{label:"简介"},{default:l(()=>[c($(e(i).brief??"-"),1)]),_:1}),t(o,{label:"详情"},{default:l(()=>[k("div",{class:"detail-preview",innerHTML:e(i).detail},null,8,sl)]),_:1})]),_:1})]))]),_:1},8,["modelValue"])]),_:1},8,["model"])}}},rl={class:"op-bar flex mb-4"},dl={class:"ops flex-auto"},ul={class:"filters flex-none"},pl=k("span",{class:"iconfont icon-search"},null,-1),ml={class:"box"},cl=["src"],_l={key:1},fl={key:1},gl={key:0,class:"text-success"},bl={key:1,class:"text-mutted"},hl={class:"btm-ops mt-3"},vl={__name:"Index",setup(x){const b=ae("content",["view","create","update","delete","batDelete"]),{listData:a,batOperate:i,search:s,selectChange:u,destroy:d,load:f}=ce;return f({"with-category":1},{categories:J.listData.items}),te(()=>a.query.cat_id,()=>s()),(g,o)=>{const m=n("PopconfirmOperate"),_=n("el-button"),h=n("el-tree-select"),w=n("el-input"),p=n("el-table-column"),v=n("el-tag"),y=n("el-link"),P=n("el-table"),U=n("Pagination"),A=O("loading");return r(),R(F,null,[k("div",rl,[k("div",dl,[t(m,{type:"button",label:"批量删除",onConfirm:o[0]||(o[0]=C=>e(i)()),disabled:!e(b).batDelete||e(a).batOperateIds.length===0},null,8,["disabled"]),t(_,{type:"primary",onClick:o[1]||(o[1]=C=>e(me)("/contents/create")),disabled:!e(b).create},{default:l(()=>[c("+ 新建")]),_:1},8,["disabled"])]),k("div",ul,[t(h,{class:"w-50",placeholder:"选择分类",modelValue:e(a).query.cat_id,"onUpdate:modelValue":o[2]||(o[2]=C=>e(a).query.cat_id=C),data:e(J).listData.items,props:{label:"title",value:"id",multiple:!0},"render-after-expand":!1,"default-expand-all":"","collapse-tags":"","collapse-tags-tooltip":"",clearable:"",filterable:"",checkStrictly:""},null,8,["modelValue","data"]),t(w,{clearable:"",onClear:o[3]||(o[3]=C=>e(s)()),modelValue:e(a).query.keyword,"onUpdate:modelValue":o[4]||(o[4]=C=>e(a).query.keyword=C),onKeyup:o[5]||(o[5]=le(C=>e(s)(),["enter"])),class:"keyword mx-1.5",placeholder:"搜索标题"},{prefix:l(()=>[pl]),_:1},8,["modelValue"]),t(_,{type:"primary",onClick:o[6]||(o[6]=C=>e(s)())},{default:l(()=>[c("搜索")]),_:1})])]),k("div",ml,[I((r(),V(P,{data:e(a).items,onSelectionChange:o[7]||(o[7]=C=>e(u)(C))},{default:l(()=>[t(p,{type:"selection",width:"45",align:"center",fixed:""}),t(p,{prop:"id",label:"ID",width:"50","class-name":"cell-px-0",fixed:""}),t(p,{prop:"title",label:"标题"},{default:l(({row:C})=>[C.album[0]?(r(),R("img",{key:0,src:C.album[0].thumb,width:"42",align:"left",class:"mr-2"},null,8,cl)):z("",!0),c(" "+$(C.title),1)]),_:1}),t(p,{label:"分类",width:""},{default:l(({row:C})=>[C.categories.length>0?(r(!0),R(F,{key:0},q(C.categories,E=>(r(),V(v,{class:"mr-1.5",size:"small",key:E.id},{default:l(()=>[c($(E.title),1)]),_:2},1024))),128)):(r(),R("span",_l,"-"))]),_:1}),t(p,{label:"标签",width:""},{default:l(({row:C})=>[C.tags.length>0?(r(!0),R(F,{key:0},q(C.tags,E=>(r(),V(v,{class:"mr-1.5",size:"small",key:E.id},{default:l(()=>[c($(E.title),1)]),_:2},1024))),128)):(r(),R("span",fl,"-"))]),_:1}),t(p,{prop:"status",label:"状态",width:"45","class-name":"cell-px-0",align:"center"},{default:l(({row:C})=>[C.status=="published"?(r(),R("span",gl,"发布")):(r(),R("span",bl,"草稿"))]),_:1}),t(p,{prop:"asc_num",label:"显示排序",width:"60","class-name":"cell-px-0",align:"center"}),t(p,{prop:"created_at",label:"创建时间",width:"168",align:"center"},{default:l(({row:C})=>[c($(C.created_at),1)]),_:1}),t(p,{label:"操作",width:"136","class-name":"list-item-ops",align:"center",fixed:"right"},{default:l(({row:C})=>[t(y,{type:"primary",onClick:E=>g.$refs.showRef.show(C.id),disabled:!e(b).view},{default:l(()=>[c("详情")]),_:2},1032,["onClick","disabled"]),t(y,{type:"primary",onClick:E=>e(me)(`/contents/${C.id}/edit`),disabled:!e(b).update},{default:l(()=>[c("编辑")]),_:2},1032,["onClick","disabled"]),t(m,{title:"您确定要删除该文章吗？",onConfirm:E=>e(d)(C.id),disabled:!e(b).delete},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[A,e(a).isLoading]])]),k("div",hl,[t(m,{type:"button",label:"批量删除",onConfirm:o[8]||(o[8]=C=>e(i)()),disabled:!e(b).batDelete||e(a).batOperateIds.length===0},null,8,["disabled"])]),t(U,{bindings:e(ce)},null,8,["bindings"]),t(il,{ref:"showRef"},null,512)],64)}}},yl=Object.freeze(Object.defineProperty({__proto__:null,default:vl},Symbol.toStringTag,{value:"Module"})),wl={__name:"Editor",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},height:{type:Number,default:500},disabled:{type:Boolean,default:!1},plugins:{type:[String,Array],default:"code image media link preview table quickbars template pagebreak lists advlist"},toolbar:{type:[String,Array],default:["blocks fontfamily fontsize forecolor backcolor bold italic underline strikethrough link","alignleft aligncenter alignright alignjustify outdent indent numlist bullist","table image media preview code selectall"].join(" ")},templates:{type:Array,default:()=>[]},options:{type:Object,default:()=>{}},fonts:{type:String,default:["微软雅黑=Microsoft YaHei,Helvetica Neue,PingFang SC","苹方=PingFang SC,Microsoft YaHei","黑体=SimHei;宋体=simsun,serif;仿宋=FangSong;楷体=楷体;隶书=隶书;幼圆=幼圆","Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde","Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier","Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol","Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times","Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings"].join(";")}},emits:["update:modelValue"],setup(x,{emit:b}){const a=x,i=be({get:()=>a.modelValue,set:f=>b("update:modelValue",f)}),s="/web/",u={language_url:s+"vendor/tinymce/langs/zh-Hans.js",language:"zh-Hans",skin_url:s+"vendor/tinymce/skins/ui/oxide",content_css:s+"vendor/tinymce/skins/content/default/content.css",menubar:!1,statusbar:!0,plugins:a.plugins,toolbar:a.toolbar,toolbar_mode:"sliding",font_family_formats:a.fonts,font_size_formats:"12px 14px 16px 18px 22px 24px 36px 72px",height:a.height,placeholder:a.placeholder,branding:!1,resize:!0,elementpath:!0,content_style:"",templates:a.templates,quickbars_selection_toolbar:"forecolor backcolor bold italic underline strikethrough link",quickbars_image_toolbar:"alignleft aligncenter alignright",quickbars_insert_toolbar:!1,image_caption:!0,image_advtab:!0,convert_urls:!1,images_upload_handler:f=>{const g=new FormData;return g.append("img",f.blob(),f.filename()),G.post("admin/images",g).then(o=>o.data.url)},setup:f=>{f.on("init",function(){})},...a.options};Me(()=>{xe.init({})});const d=f=>{b("onClick",f,xe)};return(f,g)=>(r(),V(e(rt),{modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=o=>i.value=o),init:u,disabled:x.disabled,placeholder:x.placeholder,onOnClick:d},null,8,["modelValue","disabled","placeholder"]))}},kl={class:"hot-tags w-full"},Vl={__name:"Tags",props:["modelValue","hotTags"],emits:["update:modelValue"],setup(x,{emit:b}){const a=x,i=be({get:()=>a.modelValue,set:_=>b("update:modelValue",_)}),s=T(""),u=T(),d=T(!1),f=()=>{d.value=!0,We(()=>{u.value.input.focus()})},g=()=>{s.value&&i.value.push({title:s.value.trim()}),d.value=!1,s.value=""},o=_=>{i.value.splice(_,1)},m=_=>{const h=a.hotTags[_];for(const w of i.value)if(w.title===h.title){ie("该标签已添加，不能重复添加");return}i.value.push({id:h.id,title:h.title})};return(_,h)=>{const w=n("el-tag"),p=n("el-input"),v=n("el-button"),y=n("el-link");return r(),R(F,null,[(r(!0),R(F,null,q(i.value,(P,U)=>(r(),V(w,{key:P.title,class:"mx-1",onClose:A=>o(U),closable:"",effect:"plain"},{default:l(()=>[c($(P.title),1)]),_:2},1032,["onClose"]))),128)),d.value?(r(),V(p,{key:0,ref_key:"tagInputRef",ref:u,modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=P=>s.value=P),class:"ml-1 w-24",size:"small",onKeyup:le(j(g,["stop"]),["enter"]),onKeydown:h[1]||(h[1]=le(P=>P.preventDefault(),["enter"])),onBlur:h[2]||(h[2]=P=>d.value=!1),plain:""},null,8,["modelValue","onKeyup"])):(r(),V(v,{key:1,class:"w-24 ml-1",size:"small",onClick:f,plain:""},{default:l(()=>[c(" + 添加标签 ")]),_:1})),k("div",kl,[c(" 热门标签： "),(r(!0),R(F,null,q(x.hotTags,(P,U)=>(r(),V(y,{key:P.id,class:"mr-4",onClick:A=>m(U),type:"primary",title:"点击选择"},{default:l(()=>[c($(P.title),1)]),_:2},1032,["onClick"]))),128))])],64)}}},xl={class:"album"},$l={class:"el-upload-list el-upload-list--picture-card flex"},Cl={class:"el-upload-list__item",tabindex:"0",style:{}},El={class:"el-upload-list__item-actions"},Dl={class:"el-upload-list__item-delete"},Ul={class:"tips"},Rl={__name:"UploadAlbum",props:{modelValue:{type:Array,default:()=>[]},sizeLimit:{type:Number,default:2},numLimit:{type:Number,default:10}},emits:["update:modelValue"],setup(x,{emit:b}){const a=x,i={_xsrf_token:ee()};let s=!1;const u=T([]);te(u,()=>{const h=[];u.value.forEach(w=>{w.status==="success"&&h.push(w.org??w.url)}),s=!0,b("update:modelValue",h)},{deep:!0}),te(()=>a.modelValue,()=>{if(s){s=!1;return}u.value=a.modelValue.map(h=>({url:h}))},{deep:!0,immediate:!0});const d=T(!1),f=(h,w)=>{u.value.splice(w,1)},g=(h,w,p)=>{w.org=h.data.org},o=h=>Be(h.type,h.size,a.sizeLimit),m=h=>{if(h.message.includes("Unauthenticated")){he(),i._xsrf_token=ee();return}Fe(h).then(()=>{i._xsrf_token=ee()})},_=()=>{ie(`图片数量不能超过 ${a.numLimit} 个`)};return(h,w)=>{const p=n("el-progress"),v=n("el-image"),y=n("el-icon"),P=n("el-popconfirm"),U=n("el-upload");return r(),R("div",xl,[k("ul",$l,[t(e(Qe),{modelValue:u.value,"onUpdate:modelValue":w[0]||(w[0]=A=>u.value=A),group:"people",onStart:w[1]||(w[1]=A=>d.value=!0),onEnd:w[2]||(w[2]=A=>d.value=!1),"item-key":"id"},{item:l(({element:A,index:C})=>[k("li",Cl,[I(t(p,{type:"circle",percentage:A.percentage,width:90},null,8,["percentage"]),[[Y,A.status!=="success"]]),t(v,{fit:"cover",src:A.url,"preview-src-list":u.value.map(E=>E.url),"initial-index":C,"hide-on-click-modal":!0},null,8,["src","preview-src-list","initial-index"]),k("div",El,[t(P,{title:"您确定要移除该图片吗？",onConfirm:E=>f(A,C)},{reference:l(()=>[k("span",Dl,[t(y,null,{default:l(()=>[t(e(Ue))]),_:1})])]),_:2},1032,["onConfirm"])])])]),_:1},8,["modelValue"]),t(U,{"file-list":u.value,"onUpdate:fileList":w[3]||(w[3]=A=>u.value=A),headers:{Accept:"application/json"},action:e(Ie)("album"),"list-type":"picture-card","on-success":g,"on-error":m,"on-exceed":_,"with-credentials":!0,data:i,multiple:!0,"show-file-list":!1,"before-upload":o,limit:x.numLimit,accept:"image/png, image/jpeg, image/gif, image/webp",name:"img",class:"mr-3"},{default:l(()=>[t(y,null,{default:l(()=>[t(e(Re))]),_:1})]),_:1},8,["file-list","action","limit"])]),k("div",Ul,"可上传"+$(x.numLimit)+"张以内，格式为 png、jpg、jpeg、gif、webp 的图片。可拖动图片调整顺序。",1)])}}},Al={class:"box p-6 mb-14"},Pl=k("span",{class:"tips"},"从小到大显示",-1),Sl={class:"form-footer-fixed"},Bl={__name:"Form",props:["id"],setup(x){const b=x,a=T(),i={title:{required:!0,message:"请输入标题",trigger:["blur","change"]}},s=new se(ce,a,{id:0,cat_ids:[],title:"",asc_num:50,brief:"",status:"published",detail:"<p><br></p>",album:[],tags:[],editor:L.showName,author:"",source:""}),{item:u,is:d,reset:f,save:g}=s,o=T([]);return _e(()=>{G.get("/admin/contents/tags/hot").then(m=>{o.value=m.items})}),J.checkLoaded(),s.initFormPage(b),(m,_)=>{const h=n("el-skeleton"),w=n("el-input"),p=n("el-form-item"),v=n("el-tree-select"),y=n("el-input-number"),P=n("el-switch"),U=n("el-button"),A=n("el-form"),C=O("loading");return r(),R("div",Al,[t(h,{rows:20,loading:e(d).loading,animated:""},null,8,["loading"]),e(d).loading?z("",!0):(r(),V(A,{key:0,ref_key:"formRef",ref:a,model:e(u),rules:i,"label-width":"100px",onSubmit:j(e(g),["prevent"]),class:M(e(d).showValidateError?"":"hide-validate-error"),"scroll-to-error":!0},{default:l(()=>[t(p,{label:"标题",prop:"title"},{default:l(()=>[t(w,{modelValue:e(u).title,"onUpdate:modelValue":_[0]||(_[0]=E=>e(u).title=E),placeholder:"",class:"w-full",clearable:""},null,8,["modelValue"])]),_:1}),t(p,{label:"作者",prop:"author"},{default:l(()=>[t(w,{modelValue:e(u).author,"onUpdate:modelValue":_[1]||(_[1]=E=>e(u).author=E),placeholder:"",class:"w-80",clearable:""},null,8,["modelValue"])]),_:1}),t(p,{label:"来源",prop:"source"},{default:l(()=>[t(w,{modelValue:e(u).source,"onUpdate:modelValue":_[2]||(_[2]=E=>e(u).source=E),placeholder:"",class:"w-80",clearable:""},null,8,["modelValue"])]),_:1}),t(p,{label:"编辑",prop:"editor"},{default:l(()=>[t(w,{modelValue:e(u).editor,"onUpdate:modelValue":_[3]||(_[3]=E=>e(u).editor=E),placeholder:"",class:"w-80",clearable:""},null,8,["modelValue"])]),_:1}),t(p,{label:"分类",prop:"cat_ids"},{default:l(()=>[t(v,{class:"w-80 mr-3",placeholder:"请选择",modelValue:e(u).cat_ids,"onUpdate:modelValue":_[4]||(_[4]=E=>e(u).cat_ids=E),data:e(J).listData.items,props:{label:"title",value:"id"},"render-after-expand":!0,"default-expand-all":"",multiple:"",clearable:""},null,8,["modelValue","data"])]),_:1}),t(p,{label:"标签",prop:"tag_ids"},{default:l(()=>[t(Vl,{modelValue:e(u).tags,"onUpdate:modelValue":_[5]||(_[5]=E=>e(u).tags=E),"hot-tags":o.value},null,8,["modelValue","hot-tags"])]),_:1}),t(p,{label:"相册",prop:"asc_num"},{default:l(()=>[t(Rl,{modelValue:e(u).album,"onUpdate:modelValue":_[6]||(_[6]=E=>e(u).album=E),"size-limit":5,"num-limit":10},null,8,["modelValue"])]),_:1}),t(p,{label:"显示排序",prop:"asc_num"},{default:l(()=>[t(y,{modelValue:e(u).asc_num,"onUpdate:modelValue":_[7]||(_[7]=E=>e(u).asc_num=E),modelModifiers:{number:!0},min:0,max:9999,"controls-position":"right",class:""},null,8,["modelValue"]),Pl]),_:1}),t(p,{label:"状态",prop:"status"},{default:l(()=>[t(P,{width:"48",modelValue:e(u).status,"onUpdate:modelValue":_[8]||(_[8]=E=>e(u).status=E),"active-value":"published","active-text":"发布","inactive-value":"draft","inactive-text":"草稿","inline-prompt":""},null,8,["modelValue"])]),_:1}),t(p,{label:"简介",prop:"brief"},{default:l(()=>[t(w,{type:"textarea",placeholder:"",class:"w-full",modelValue:e(u).brief,"onUpdate:modelValue":_[9]||(_[9]=E=>e(u).brief=E),autosize:{minRows:2},clearable:""},null,8,["modelValue"])]),_:1}),t(p,{label:"详细介绍",prop:"detail",class:"editor-wp mb-2"},{default:l(()=>[t(wl,{modelValue:e(u).detail,"onUpdate:modelValue":_[10]||(_[10]=E=>e(u).detail=E)},null,8,["modelValue"])]),_:1}),k("div",Sl,[I((r(),V(U,{type:"primary","native-type":"submit"},{default:l(()=>[c("确定")]),_:1})),[[C,e(d).submitting]]),t(U,{onClick:_[11]||(_[11]=E=>e(f)())},{default:l(()=>[c("重置")]),_:1})])]),_:1},8,["model","onSubmit","class"]))])}}},Ee=Object.freeze(Object.defineProperty({__proto__:null,default:Bl},Symbol.toStringTag,{value:"Module"})),Il={type:"hidden"},Fl=k("div",{class:"tips"},"从小到大显示",-1),zl=k("span",{class:"tips"},"在用户端导航菜单中是否显示",-1),Tl={__name:"FormDialog",setup(x,{expose:b}){const a=T([]),i=T(),s={title:{required:!0,message:"请输入文章分类名",trigger:["blur","change"]},asc_num:{type:"number",min:0,max:100,message:"序号不能大于100",trigger:["blur","change"]}},u=new se(J,i,{id:0,title:"",asc_num:50,brief:"",is_show:!0,parent_id:null}),{item:d,is:f,onHide:g,reset:o,create:m,edit:_}=u,h=()=>{u.save().then(w=>{a.value=w.options})};return b({create(){m(),a.value=J.listData.items},edit(w){_(w,{"with-parent-options":1}).then(p=>{a.value=p.options})}}),window.parentOptions=a,(w,p)=>{const v=n("el-skeleton"),y=n("el-tree-select"),P=n("el-form-item"),U=n("el-input"),A=n("el-slider"),C=n("el-switch"),E=n("el-form"),B=n("el-button"),N=n("el-dialog"),H=O("loading");return r(),V(N,{modelValue:e(f).show,"onUpdate:modelValue":p[7]||(p[7]=D=>e(f).show=D),title:`${e(f).edit?"编辑":"新建"}文章分类`,onClose:e(g),width:"560",draggable:"","align-center":""},{footer:l(()=>[t(B,{onClick:p[5]||(p[5]=D=>e(o)())},{default:l(()=>[c("重置")]),_:1}),I((r(),V(B,{type:"primary",onClick:p[6]||(p[6]=D=>h())},{default:l(()=>[c("确定")]),_:1})),[[H,e(f).submitting]])]),default:l(()=>[t(v,{rows:5,loading:e(f).loading,animated:""},null,8,["loading"]),e(f).loading?z("",!0):(r(),V(E,{key:0,ref_key:"formRef",ref:i,model:e(d),rules:s,"label-width":"100px",onSubmit:j(h,["prevent"]),class:M(e(f).showValidateError?"":"hide-validate-error")},{default:l(()=>[I(k("input",Il,null,512),[[Y,!1]]),t(P,{label:"上级分类",prop:"parent_id"},{default:l(()=>[t(y,{modelValue:e(d).parent_id,"onUpdate:modelValue":p[0]||(p[0]=D=>e(d).parent_id=D),class:"w-full",placeholder:"请选择",data:a.value,props:{label:"title",value:"id"},"render-after-expand":!0,"check-strictly":"","default-expand-all":"",clearable:""},null,8,["modelValue","data"])]),_:1}),t(P,{label:"分类标题",prop:"title"},{default:l(()=>[t(U,{modelValue:e(d).title,"onUpdate:modelValue":p[1]||(p[1]=D=>e(d).title=D),placeholder:""},null,8,["modelValue"])]),_:1}),t(P,{label:"简介",prop:"brief"},{default:l(()=>[t(U,{modelValue:e(d).brief,"onUpdate:modelValue":p[2]||(p[2]=D=>e(d).brief=D),row:2,type:"textarea",placeholder:"",class:""},null,8,["modelValue"])]),_:1}),t(P,{label:"显示排序",prop:"asc_num"},{default:l(()=>[t(A,{modelValue:e(d).asc_num,"onUpdate:modelValue":p[3]||(p[3]=D=>e(d).asc_num=D),"show-input":""},null,8,["modelValue"]),Fl]),_:1}),t(P,{label:"显示状态",prop:"is_show"},{default:l(()=>[t(C,{width:"60",modelValue:e(d).is_show,"onUpdate:modelValue":p[4]||(p[4]=D=>e(d).is_show=D),"active-text":"显示","inactive-text":"隐藏","inline-prompt":""},null,8,["modelValue"]),zl]),_:1})]),_:1},8,["model","onSubmit","class"]))]),_:1},8,["modelValue","title","onClose"])}}},Ol={__name:"ShowDrawer",setup(x,{expose:b}){const a=new de(J.api),{is:i,item:s,show:u,toEdit:d}=a;return b({show:f=>u(f,{"with-parent":1})}),(f,g)=>{const o=n("el-skeleton"),m=n("el-descriptions-item"),_=n("el-tag"),h=n("el-descriptions"),w=n("el-button"),p=n("el-drawer");return r(),V(p,{modelValue:e(i).show,"onUpdate:modelValue":g[1]||(g[1]=v=>e(i).show=v),title:"分类详情",size:"560"},{footer:l(()=>[t(w,{type:"primary",onClick:g[0]||(g[0]=()=>e(d)(f.$parent.$refs.formRef,e(s).id))},{default:l(()=>[c("编辑")]),_:1})]),default:l(()=>[t(o,{rows:8,loading:e(i).loading,animated:""},null,8,["loading"]),e(i).loading?z("",!0):(r(),V(h,{key:0,column:1,"label-align":"right","label-size":"small",border:""},{default:l(()=>[t(m,{label:"ID"},{default:l(()=>{var v;return[c($((v=e(s))==null?void 0:v.id),1)]}),_:1}),t(m,{label:"上级分类"},{default:l(()=>[c($(e(s).parent?e(s).parent.title:"-"),1)]),_:1}),t(m,{label:"分类标题"},{default:l(()=>[c($(e(s).title),1)]),_:1}),t(m,{label:"分类简介"},{default:l(()=>[c($(e(s).brief??"-"),1)]),_:1}),t(m,{label:"显示排序"},{default:l(()=>[c($(e(s).asc_num),1)]),_:1}),t(m,{label:"文章数量"},{default:l(()=>[c($(e(s).content_count),1)]),_:1}),t(m,{label:"显示状态"},{default:l(()=>[t(_,{size:"small",effect:"plain",type:e(s).is_show?"success":"danger",round:""},{default:l(()=>[c($(e(s).is_show?"显示":"隐藏"),1)]),_:1},8,["type"])]),_:1}),t(m,{label:"创建时间"},{default:l(()=>[c($(e(s).created_at),1)]),_:1}),t(m,{label:"更新时间"},{default:l(()=>[c($(e(s).updated_at),1)]),_:1})]),_:1}))]),_:1},8,["modelValue"])}}},ql={class:"op-bar flex mb-4"},Ll={class:"ops flex-auto"},jl={class:"box"},Nl={__name:"Index",setup(x){const b=ae("content.category",["view","create","update","delete"]),{listData:a,load:i,destroy:s}=J;return i(),(u,d)=>{const f=n("el-button"),g=n("el-table-column"),o=n("el-tag"),m=n("el-link"),_=n("PopconfirmOperate"),h=n("el-table"),w=O("loading");return r(),R(F,null,[k("div",ql,[k("div",Ll,[t(f,{type:"primary",onClick:d[0]||(d[0]=p=>u.$refs.formRef.create()),disabled:!e(b).create},{default:l(()=>[c("+ 新建")]),_:1},8,["disabled"])])]),k("div",jl,[I((r(),V(h,{data:e(a).items,"row-key":"id","default-expand-all":""},{default:l(()=>[t(g,{prop:"title",label:"标题","class-name":"title"}),t(g,{prop:"brief",label:"简介"}),t(g,{prop:"content_count",label:"文章数",width:"70",align:"center","class-name":"cell-px-0",sortable:""}),t(g,{prop:"asc_num",label:"显示排序",width:"88",align:"center","class-name":"cell-px-0",sortable:""}),t(g,{label:"显示状态",prop:"is_show",width:"88",align:"center","class-name":"cell-px-0",sortable:""},{default:l(({row:p})=>[t(o,{size:"small",effect:"plain",type:p.is_show?"success":"danger",round:""},{default:l(()=>[c($(p.is_show?"显示":"隐藏"),1)]),_:2},1032,["type"])]),_:1}),t(g,{prop:"id",label:"ID",width:"70",align:"center",sortable:""}),t(g,{prop:"created_at",label:"创建时间",width:"150",align:"center","class-name":"cell-px-0"},{default:l(({row:p})=>[c($(p.created_at),1)]),_:1}),t(g,{label:"操作",width:"136","class-name":"list-item-ops",align:"center",fixed:"right"},{default:l(({row:p})=>[t(m,{type:"primary",onClick:v=>u.$refs.showRef.show(p.id),disabled:!e(b).view},{default:l(()=>[c("查看")]),_:2},1032,["onClick","disabled"]),t(m,{type:"primary",onClick:v=>u.$refs.formRef.edit(p.id),disabled:!e(b).update},{default:l(()=>[c("编辑")]),_:2},1032,["onClick","disabled"]),t(_,{title:"您确定要删除该分类吗？",onConfirm:v=>e(s)(p.id),disabled:!e(b).delete},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[w,e(a).isLoading]])]),t(Tl,{ref:"formRef"},null,512),t(Ol,{ref:"showRef"},null,512)],64)}}},Hl=Object.freeze(Object.defineProperty({__proto__:null,default:Nl},Symbol.toStringTag,{value:"Module"})),Ml={type:"submit"},Wl={__name:"FormDialog",setup(x,{expose:b}){const a=T(),i={title:{required:!0,message:"请输入标签名",trigger:["blur","change"]}};class s extends se{save(){return super.save().then(p=>{this.is.edit&&(oe("编辑成功"),tt.close(),this.is.show=!1)})}}const u=new s(ge,a),{is:d,item:f,create:g,edit:o,reset:m,save:_,onHide:h}=u;return b({create:g,edit:o}),(w,p)=>{const v=n("el-skeleton"),y=n("el-input"),P=n("el-form-item"),U=n("el-form"),A=n("el-button"),C=n("el-dialog"),E=O("loading");return r(),V(C,{modelValue:e(d).show,"onUpdate:modelValue":p[4]||(p[4]=B=>e(d).show=B),title:(e(d).edit?"编辑":"新建")+"标签","align-center":"",draggable:"",width:"420px",onClosed:p[5]||(p[5]=B=>e(h)())},{footer:l(()=>[t(A,{onClick:p[2]||(p[2]=B=>e(m)())},{default:l(()=>[c("重置")]),_:1}),I((r(),V(A,{type:"primary",onClick:p[3]||(p[3]=B=>e(_)())},{default:l(()=>[c("确定")]),_:1})),[[E,e(d).submitting]])]),default:l(()=>[t(v,{loading:e(d).loading,rows:1,animated:""},null,8,["loading"]),e(d).loading?z("",!0):(r(),V(U,{key:0,ref_key:"formRef",ref:a,model:e(f),rules:i,"label-width":"100px",onSubmit:p[1]||(p[1]=j(B=>e(_)(),["prevent"])),class:M(e(d).showValidateError?"":"hide-validate-error")},{default:l(()=>[I(k("input",Ml,null,512),[[Y,!1]]),t(P,{label:"标签",prop:"title"},{default:l(()=>[t(y,{modelValue:e(f).title,"onUpdate:modelValue":p[0]||(p[0]=B=>e(f).title=B),clearable:"",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","class"]))]),_:1},8,["modelValue","title"])}}},Ql={class:"op-bar flex mb-4"},Yl={class:"ops flex-auto"},Kl={class:"filters flex-none"},Gl=k("span",{class:"iconfont icon-search"},null,-1),Jl={class:"box"},Xl={class:"btm-ops mt-3"},Zl={__name:"Index",setup(x){const b=ae("content.tag",["create","update","delete","batDelete"]),{listData:a,search:i,load:s,destroy:u,batOperate:d,selectChange:f}=ge;return s(),(g,o)=>{const m=n("PopconfirmOperate"),_=n("el-button"),h=n("el-input"),w=n("el-table-column"),p=n("el-link"),v=n("el-table"),y=n("Pagination"),P=O("loading");return r(),R(F,null,[k("div",Ql,[k("div",Yl,[t(m,{type:"button",label:"批量删除",onConfirm:o[0]||(o[0]=U=>e(d)()),disabled:!e(b).batDelete||e(a).batOperateIds.length===0},null,8,["disabled"]),t(_,{type:"primary",onClick:o[1]||(o[1]=U=>g.$refs.formRef.create()),disabled:!e(b).create},{default:l(()=>[c("+ 新建")]),_:1},8,["disabled"])]),k("div",Kl,[t(h,{clearable:"",onClear:o[2]||(o[2]=U=>e(i)()),modelValue:e(a).query.keyword,"onUpdate:modelValue":o[3]||(o[3]=U=>e(a).query.keyword=U),onKeyup:o[4]||(o[4]=le(U=>e(i)(),["enter"])),class:"keyword mx-1.5",placeholder:"搜索标签名"},{prefix:l(()=>[Gl]),_:1},8,["modelValue"]),t(_,{type:"primary",onClick:o[5]||(o[5]=U=>e(i)())},{default:l(()=>[c("搜索")]),_:1})])]),k("div",Jl,[I((r(),V(v,{data:e(a).items,onSelectionChange:o[6]||(o[6]=U=>e(f)(U))},{default:l(()=>[t(w,{type:"selection",width:"45",align:"center",fixed:""}),t(w,{prop:"id",label:"ID",width:"60",fixed:""}),t(w,{prop:"title",label:"标签"}),t(w,{prop:"content_count",label:"文章数",width:"72",align:"center"}),t(w,{prop:"created_at",label:"创建时间",width:"168",align:"center"},{default:l(({row:U})=>[c($(U.created_at),1)]),_:1}),t(w,{label:"操作",width:"120","class-name":"list-item-ops",align:"center",fixed:"right"},{default:l(U=>[t(p,{type:"primary",onClick:A=>g.$refs.formRef.edit(U.row.id),disabled:!e(b).update},{default:l(()=>[c("编辑")]),_:2},1032,["onClick","disabled"]),t(m,{title:"您确定要删除该标签吗？",onConfirm:A=>e(u)(U.row.id),disabled:!e(b).delete},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[P,e(a).isLoading]])]),k("div",Xl,[t(m,{type:"button",label:"批量删除",onConfirm:o[7]||(o[7]=U=>e(d)()),disabled:!e(b).batDelete||e(a).batOperateIds.length===0},null,8,["disabled"])]),t(y,{bindings:e(ge)},null,8,["bindings"]),t(Wl,{ref:"formRef"},null,512)],64)}}},en=Object.freeze(Object.defineProperty({__proto__:null,default:Zl},Symbol.toStringTag,{value:"Module"})),tn={key:1},ze={__name:"ShowDrawer",setup(x,{expose:b}){const a=new de(re.api),{is:i,item:s}=a,u=pe("admin-user.update")&&(!s.is_super||L.is_super);return b({show:d=>a.show(d,{"with-department":!0})}),(d,f)=>{const g=n("el-skeleton"),o=n("el-descriptions-item"),m=n("el-tag"),_=n("el-descriptions"),h=n("el-button"),w=n("el-drawer");return r(),V(w,{modelValue:e(i).show,"onUpdate:modelValue":f[1]||(f[1]=p=>e(i).show=p),title:"人员详情",size:"560"},{footer:l(()=>[t(h,{type:"primary",onClick:f[0]||(f[0]=()=>e(a).toEdit(d.$parent.$refs.formRef,e(s).id)),disabled:!e(u)},{default:l(()=>[c("编辑")]),_:1},8,["disabled"])]),default:l(()=>[t(g,{rows:10,loading:e(i).loading,animated:""},null,8,["loading"]),e(i).loading?z("",!0):(r(),V(_,{key:0,column:1,"label-align":"right","label-size":"small",border:""},{default:l(()=>[t(o,{label:"ID"},{default:l(()=>[c($(e(s).id),1)]),_:1}),t(o,{label:"部门"},{default:l(()=>[e(s).department?(r(),V(m,{key:0,class:"mr-3",size:"small",plain:""},{default:l(()=>[c($(e(s).department.title),1)]),_:1})):(r(),R("span",tn,"-"))]),_:1}),t(o,{label:"角色"},{default:l(()=>[e(s).is_super?(r(),V(m,{key:0,class:"mr-3",size:"small",type:"danger",round:""},{default:l(()=>[c("超级管理员")]),_:1})):z("",!0),(r(!0),R(F,null,q(e(s).roles,p=>(r(),V(m,{class:"mr-3",size:"small",round:"",key:p.id},{default:l(()=>[c($(p.title),1)]),_:2},1024))),128))]),_:1}),t(o,{label:"用户名"},{default:l(()=>[c($(e(s).name??"-"),1)]),_:1}),t(o,{label:"姓名"},{default:l(()=>[c($(e(s).realname??"-"),1)]),_:1}),t(o,{label:"手机号"},{default:l(()=>[c($(e(s).mobile??"-"),1)]),_:1}),t(o,{label:"邮箱"},{default:l(()=>[c($(e(s).email??"-"),1)]),_:1}),t(o,{label:"状态"},{default:l(()=>[e(s).deleted_at?(r(),V(m,{key:0,size:"small",type:"danger",effect:"plain",round:""},{default:l(()=>[c("已删除")]),_:1})):(r(),V(m,{key:1,size:"small",effect:"plain",type:e(s).enabled?"success":"danger",round:""},{default:l(()=>[c($(e(s).enabled?"启用":"停用"),1)]),_:1},8,["type"]))]),_:1}),t(o,{label:"创建时间"},{default:l(()=>[c($(e(s).created_at),1)]),_:1}),t(o,{label:"更新时间"},{default:l(()=>[c($(e(s).updated_at),1)]),_:1}),e(s).deleted_at?(r(),V(o,{key:0,label:"删除时间"},{default:l(()=>[c($(e(s).deleted_at),1)]),_:1})):z("",!0)]),_:1}))]),_:1},8,["modelValue"])}}},ln={type:"submit"},nn=k("span",{class:"tips"},"停用账号后不能再登录",-1),Te={__name:"FormDialog",setup(x,{expose:b}){const a=T();class i extends se{create(){return w(!1),super.create()}edit(v){return w(!0),super.edit(v)}}const s=new i(re,a,{enabled:!0,department_id:null,role_ids:[]}),{is:u,item:d,save:f,reset:g,onHide:o,create:m,edit:_}=s,h=K({name:[{required:!0,min:2,message:"用户名不能少于2个字符",trigger:["blur","change"]},{pattern:/^[a-z][0-9a-z]+$/i,message:"仅支持以字母开头，小写字母或数字",trigger:["blur","change"]}],realname:[{required:!0,min:2,message:"真实姓名名不能少于2个字符",trigger:["blur","change"]}],mobile:[{pattern:/^1[3-9]\d{9}$/,message:"手机号码格式不正确",trigger:["blur","change"]}],email:[{pattern:/^[\w\-.]+@[\w-]+(\.[\w-]+)+$/i,message:"邮箱格式不正确",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{min:6,message:"密码不能少于6个字符",trigger:["blur","change"]}],password_confirmation:[{required:!0,message:"请输入确认密码",trigger:["blur","change"]},{validator:(p,v,y)=>v&&v!==d.password?y(new Error("两次输入密码不一致")):y(),trigger:["blur","change"]}]}),w=p=>{h.password[0].required=!p,h.password_confirmation[0].required=!p};return b({create:m,edit:_}),(p,v)=>{const y=n("el-skeleton"),P=n("el-tree-select"),U=n("el-form-item"),A=n("el-option"),C=n("el-select"),E=n("el-input"),B=n("el-tag"),N=n("el-switch"),H=n("el-form"),D=n("el-button"),W=n("el-dialog"),fe=O("loading");return r(),V(W,{modelValue:e(u).show,"onUpdate:modelValue":v[10]||(v[10]=S=>e(u).show=S),title:`${e(u).edit?"编辑":"新建"}人员`,onClosed:e(o),width:"640",draggable:"","align-center":""},{footer:l(()=>[t(D,{onClick:e(g)},{default:l(()=>[c("重置")]),_:1},8,["onClick"]),I((r(),V(D,{type:"primary",onClick:v[9]||(v[9]=S=>e(f)())},{default:l(()=>[c("确定")]),_:1})),[[fe,e(u).submitting]])]),default:l(()=>[t(y,{rows:10,loading:e(u).loading,animated:""},null,8,["loading"]),e(u).loading?z("",!0):(r(),V(H,{key:0,ref_key:"formRef",ref:a,model:e(d),rules:h,"label-width":"80px","validate-on-rule-change":!1,onSubmit:j(e(f),["prevent"]),class:"grid grid-cols-2 gap-x-4 gap-y-1"},{default:l(()=>[I(k("input",ln,null,512),[[Y,!1]]),t(U,{label:"部门",prop:"department_id",class:"col-start-1"},{default:l(()=>[t(P,{modelValue:e(d).department_id,"onUpdate:modelValue":v[0]||(v[0]=S=>e(d).department_id=S),modelModifiers:{number:!0},class:"w-80",placeholder:"请选择",data:e(Z).listData.items,props:{label:"title",value:"id"},"render-after-expand":!1,"default-expand-all":"",clearable:""},null,8,["modelValue","data"])]),_:1}),t(U,{label:"角色",prop:"role_ids"},{default:l(()=>[t(C,{modelValue:e(d).role_ids,"onUpdate:modelValue":v[1]||(v[1]=S=>e(d).role_ids=S),placeholder:"请选择",class:"w-80",multiple:""},{default:l(()=>[(r(!0),R(F,null,q(e(ne).listData.items,S=>(r(),V(A,{key:S.id,label:S.title,value:S.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(U,{label:"用户名",prop:"name"},{default:l(()=>[t(E,{modelValue:e(d).name,"onUpdate:modelValue":v[2]||(v[2]=S=>e(d).name=S),placeholder:"以字母开头，小写字母或数字"},null,8,["modelValue"])]),_:1}),t(U,{label:"姓名",prop:"realname"},{default:l(()=>[t(E,{modelValue:e(d).realname,"onUpdate:modelValue":v[3]||(v[3]=S=>e(d).realname=S)},null,8,["modelValue"])]),_:1}),t(U,{label:"密码",prop:"password"},{default:l(()=>[t(E,{type:"password",modelValue:e(d).password,"onUpdate:modelValue":v[4]||(v[4]=S=>e(d).password=S),placeholder:`请输入6位以上的密码${e(u).edit?"，如果不修改请留空":""}`,"show-password":""},null,8,["modelValue","placeholder"])]),_:1}),t(U,{label:"确认密码",prop:"password_confirmation"},{default:l(()=>[t(E,{type:"password",modelValue:e(d).password_confirmation,"onUpdate:modelValue":v[5]||(v[5]=S=>e(d).password_confirmation=S),placeholder:`${e(u).edit?"如果不修改请留空":""}`,"show-password":""},null,8,["modelValue","placeholder"])]),_:1}),t(U,{label:"手机号",prop:"mobile"},{default:l(()=>[t(E,{modelValue:e(d).mobile,"onUpdate:modelValue":v[6]||(v[6]=S=>e(d).mobile=S),placeholder:"请输入大陆手机号"},null,8,["modelValue"])]),_:1}),t(U,{label:"邮箱",prop:"email"},{default:l(()=>[t(E,{modelValue:e(d).email,"onUpdate:modelValue":v[7]||(v[7]=S=>e(d).email=S)},null,8,["modelValue"])]),_:1}),e(d).deleted_at?(r(),V(U,{key:0,label:"账号状态",prop:""},{default:l(()=>[t(B,{size:"small",type:"danger",effect:"plain",round:""},{default:l(()=>[c("已删除")]),_:1})]),_:1})):(r(),V(U,{key:1,label:"账号状态",prop:"enabled"},{default:l(()=>[t(N,{width:"60",modelValue:e(d).enabled,"onUpdate:modelValue":v[8]||(v[8]=S=>e(d).enabled=S),"active-text":"启用","inactive-text":"停用","inline-prompt":""},null,8,["modelValue"]),nn]),_:1}))]),_:1},8,["model","rules","onSubmit"]))]),_:1},8,["modelValue","title","onClosed"])}}};const on=k("span",{class:"pl-3"},"全部部门",-1),an=k("span",{class:"pl-3"},"全部角色",-1),sn={class:"pl-3"},rn={class:"op-bar flex mb-4"},dn={class:"ops flex-auto"},un={class:"filters flex-none"},pn=k("span",{class:"iconfont icon-search"},null,-1),mn={class:"box user-list"},cn={key:2},_n={class:"btm-ops mt-3"},fn={__name:"Index",setup(x){const b=ae("admin-user",["view","create","update","delete","batDelete"]),{listData:a,destroy:i,selectChange:s,load:u,search:d,batOperate:f}=re,g=T(["1","2"]);return te([()=>a.query.role_id,()=>a.query.department_id],()=>d()),u({"with-roles":1,"with-departments":1},{roles:ne.listData.items,departments:Z.listData.items}),(o,m)=>{const _=n("el-link"),h=n("el-tree"),w=n("el-collapse-item"),p=n("el-collapse"),v=n("el-aside"),y=n("PopconfirmOperate"),P=n("el-button"),U=n("el-input"),A=n("el-table-column"),C=n("el-tag"),E=n("el-table"),B=n("Pagination"),N=n("el-container"),H=O("loading");return r(),R(F,null,[t(N,null,{default:l(()=>[t(v,{class:"w-60"},{default:l(()=>[t(p,{class:"side-filter w-60",modelValue:g.value,"onUpdate:modelValue":m[3]||(m[3]=D=>g.value=D)},{default:l(()=>[t(w,{title:"部门",name:"1"},{default:l(()=>[t(_,{onClick:m[0]||(m[0]=D=>e(a).query.department_id=""),class:M(e(a).query.department_id?"":"active")},{default:l(()=>[on]),_:1},8,["class"]),t(h,{data:e(Z).listData.items,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:{label:"title",class:D=>D.id===e(a).query.department_id?"active":""},indent:14,onNodeClick:m[1]||(m[1]=D=>{e(a).query.department_id=D.id})},null,8,["data","props"])]),_:1}),t(w,{title:"角色",name:"2"},{default:l(()=>[t(_,{onClick:m[2]||(m[2]=D=>e(a).query.role_id=""),class:M(e(a).query.role_id?"":"active")},{default:l(()=>[an]),_:1},8,["class"]),(r(!0),R(F,null,q(e(ne).listData.items,D=>(r(),V(_,{key:D.id,class:M(e(a).query.role_id===D.id?"active":""),onClick:W=>e(a).query.role_id=D.id},{default:l(()=>[k("span",sn,$(D.title),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(N,{class:"is-vertical"},{default:l(()=>[k("div",rn,[k("div",dn,[t(y,{type:"button",label:"批量删除",onConfirm:m[4]||(m[4]=D=>e(f)()),disabled:!e(b).batDelete||e(a).batOperateIds.length===0},null,8,["disabled"]),t(P,{type:"primary",onClick:m[5]||(m[5]=D=>o.$refs.formRef.create()),disabled:!e(b).create},{default:l(()=>[c("+ 新建")]),_:1},8,["disabled"])]),k("div",un,[t(U,{clearable:"",onClear:m[6]||(m[6]=D=>e(d)()),modelValue:e(a).query.keyword,"onUpdate:modelValue":m[7]||(m[7]=D=>e(a).query.keyword=D),onKeyup:m[8]||(m[8]=le(D=>e(d)(),["enter"])),class:"keyword mx-1.5",placeholder:"账号/姓名/手机号/邮箱"},{prefix:l(()=>[pn]),_:1},8,["modelValue"]),t(P,{type:"primary",onClick:m[9]||(m[9]=D=>e(d)())},{default:l(()=>[c("搜索")]),_:1})])]),k("div",mn,[I((r(),V(E,{style:{width:"100%"},data:e(a).items,onSelectionChange:m[10]||(m[10]=D=>e(s)(D)),stripe:""},{default:l(()=>[t(A,{type:"selection",width:"45",align:"center",fixed:""}),t(A,{prop:"id",label:"ID",width:"45","class-name":"cell-px-0"}),t(A,{prop:"name",label:"账号",width:"100","class-name":"item-name cell-px-0"}),t(A,{prop:"realname",label:"姓名",width:"120"}),t(A,{prop:"department",label:"部门"},{default:l(({row:D})=>[D.department?(r(),V(C,{key:0},{default:l(()=>[c($(D.department.title),1)]),_:2},1024)):z("",!0)]),_:1}),t(A,{label:"角色",width:""},{default:l(({row:D})=>[D.is_super?(r(),V(C,{key:0,class:"mr-3",size:"small",type:"danger",round:""},{default:l(()=>[c("超级管理员")]),_:1})):z("",!0),D.roles&&D.roles.length>0?(r(!0),R(F,{key:1},q(D.roles,W=>(r(),V(C,{class:"mr-1.5",size:"small",round:"",key:W.id},{default:l(()=>[c($(W.title),1)]),_:2},1024))),128)):D.is_super?z("",!0):(r(),R("span",cn,"-"))]),_:1}),t(A,{label:"状态",prop:"enabled",width:"70",align:"center","class-name":"cell-px-0",sortable:""},{default:l(({row:D})=>[t(C,{size:"small",type:D.enabled?"success":"danger",round:""},{default:l(()=>[c($(D.enabled?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),t(A,{prop:"created_at",label:"创建时间",width:"150",align:"center","class-name":"cell-px-0"},{default:l(({row:D})=>[c($(D.created_at),1)]),_:1}),t(A,{label:"操作",width:"136","class-name":"list-item-ops",align:"center",fixed:"right"},{default:l(({row:D})=>[t(_,{type:"primary",onClick:W=>o.$refs.showRef.show(D.id),disabled:!e(b).view},{default:l(()=>[c("查看")]),_:2},1032,["onClick","disabled"]),t(_,{type:"primary",onClick:W=>o.$refs.formRef.edit(D.id),disabled:!e(b).update||D.is_super&&!e(L).is_super},{default:l(()=>[c("编辑")]),_:2},1032,["onClick","disabled"]),t(y,{title:"您确定要删除该人员吗？",onConfirm:W=>e(i)(D.id),disabled:!e(b).delete||D.is_super},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[H,e(a).isLoading]])]),k("div",_n,[t(y,{type:"button",label:"批量删除",onConfirm:m[11]||(m[11]=D=>e(f)()),disabled:!e(b).batDelete||e(a).batOperateIds.length===0},null,8,["disabled"])]),t(B,{bindings:e(re)},null,8,["bindings"])]),_:1})]),_:1}),t(ze,{ref:"showRef"},null,512),t(Te,{ref:"formRef"},null,512)],64)}}},gn=Object.freeze(Object.defineProperty({__proto__:null,default:fn},Symbol.toStringTag,{value:"Module"})),bn={type:"submit"},hn=k("div",{class:"tips"},"从小到大显示",-1),vn={__name:"FormDialog",setup(x,{expose:b}){const a=T([]),i=T(),s={title:{required:!0,message:"请输入部门名称",trigger:["blur","change"]},asc_num:{required:!0,type:"number",min:0,max:100,message:"序号不能大于100",trigger:["blur","change"]}},u=new se(Z,i,{id:0,title:"",asc_num:50,intro:""}),{is:d,item:f,onHide:g}=u,o=()=>{u.save().then(m=>{a.value=m.options})};return b({create(){u.create(),a.value=Z.listData.items},edit(m){u.edit(m,{"with-parent-options":1}).then(_=>{a.value=_.options})}}),(m,_)=>{const h=n("el-skeleton"),w=n("el-tree-select"),p=n("el-form-item"),v=n("el-input"),y=n("el-slider"),P=n("el-form"),U=n("el-button"),A=n("el-dialog"),C=O("loading");return r(),V(A,{modelValue:e(d).show,"onUpdate:modelValue":_[7]||(_[7]=E=>e(d).show=E),title:`${e(d).edit?"编辑":"新建"}商品部门`,onClose:_[8]||(_[8]=E=>e(g)()),width:"560",draggable:"","align-center":""},{footer:l(()=>[t(U,{onClick:_[5]||(_[5]=E=>e(u).reset())},{default:l(()=>[c("重置")]),_:1}),I((r(),V(U,{type:"primary",onClick:_[6]||(_[6]=E=>o())},{default:l(()=>[c("确定")]),_:1})),[[C,e(d).submitting]])]),default:l(()=>[t(h,{rows:5,loading:e(d).loading,animated:""},null,8,["loading"]),e(d).loading?z("",!0):(r(),V(P,{key:0,ref_key:"formRef",ref:i,model:e(f),rules:s,"label-width":"100px",onSubmit:_[4]||(_[4]=j(E=>o(),["prevent"])),"show-message":e(d).showValidateError},{default:l(()=>[I(k("input",bn,null,512),[[Y,!1]]),t(p,{label:"上级部门",prop:"parent_id"},{default:l(()=>[t(w,{modelValue:e(f).parent_id,"onUpdate:modelValue":_[0]||(_[0]=E=>e(f).parent_id=E),class:"w-full",placeholder:"请选择",data:a.value,props:{label:"title",value:"id"},"render-after-expand":!0,"check-strictly":"","default-expand-all":"",clearable:""},null,8,["modelValue","data"])]),_:1}),t(p,{label:"部门名称",prop:"title"},{default:l(()=>[t(v,{modelValue:e(f).title,"onUpdate:modelValue":_[1]||(_[1]=E=>e(f).title=E),placeholder:""},null,8,["modelValue"])]),_:1}),t(p,{label:"部门简介",prop:"intro"},{default:l(()=>[t(v,{modelValue:e(f).intro,"onUpdate:modelValue":_[2]||(_[2]=E=>e(f).intro=E),row:2,type:"textarea",placeholder:"",class:""},null,8,["modelValue"])]),_:1}),t(p,{label:"显示排序",prop:"asc_num"},{default:l(()=>[t(y,{modelValue:e(f).asc_num,"onUpdate:modelValue":_[3]||(_[3]=E=>e(f).asc_num=E),"show-input":""},null,8,["modelValue"]),hn]),_:1})]),_:1},8,["model","show-message"]))]),_:1},8,["modelValue","title"])}}},yn={__name:"ShowDrawer",setup(x,{expose:b}){const a=new de(Z.api),{is:i,item:s,show:u}=a;return b({show:d=>u(d,{"with-parent":1})}),(d,f)=>{const g=n("el-skeleton"),o=n("el-descriptions-item"),m=n("el-descriptions"),_=n("el-button"),h=n("el-drawer");return r(),V(h,{modelValue:e(i).show,"onUpdate:modelValue":f[1]||(f[1]=w=>e(i).show=w),title:"部门详情",size:"560"},{footer:l(()=>[t(_,{type:"primary",onClick:f[0]||(f[0]=()=>{d.$parent.$refs.formRef.edit(e(s).id),e(i).show=!1})},{default:l(()=>[c("编辑 ")]),_:1})]),default:l(()=>[t(g,{rows:10,loading:e(i).loading},null,8,["loading"]),e(i).loading?z("",!0):(r(),V(m,{key:0,column:1,"label-align":"right","label-size":"small",border:""},{default:l(()=>[t(o,{label:"ID"},{default:l(()=>[c($(e(s).id),1)]),_:1}),t(o,{label:"上级部门"},{default:l(()=>[c($(e(s).parent?e(s).parent.title:"-"),1)]),_:1}),t(o,{label:"部门名称"},{default:l(()=>[c($(e(s).title),1)]),_:1}),t(o,{label:"部门简介"},{default:l(()=>[c($(e(s).intro??"-"),1)]),_:1}),t(o,{label:"显示排序"},{default:l(()=>[c($(e(s).asc_num),1)]),_:1}),t(o,{label:"人员数量"},{default:l(()=>[c($(e(s).user_count),1)]),_:1}),t(o,{label:"创建时间"},{default:l(()=>[c($(e(s).created_at),1)]),_:1}),t(o,{label:"更新时间"},{default:l(()=>[c($(e(s).updated_at),1)]),_:1})]),_:1}))]),_:1},8,["modelValue"])}}},wn={class:"op-bar flex mb-4"},kn={class:"ops flex-auto"},Vn={class:"box"},xn={__name:"Index",setup(x){const b=ae("admin-user.department",["view","create","update","delete"]),{listData:a,load:i,destroy:s}=Z;return i(),(u,d)=>{const f=n("el-button"),g=n("el-table-column"),o=n("el-link"),m=n("PopconfirmOperate"),_=n("el-table"),h=O("loading");return r(),R(F,null,[k("div",wn,[k("div",kn,[t(f,{type:"primary",onClick:d[0]||(d[0]=w=>u.$refs.formRef.create()),disabled:!e(b).create},{default:l(()=>[c("+ 新建")]),_:1},8,["disabled"])])]),k("div",Vn,[I((r(),V(_,{data:e(a).items,"row-key":"id","default-expand-all":"",stripe:""},{default:l(()=>[t(g,{prop:"title",label:"部门名称","class-name":"title"}),t(g,{prop:"intro",label:"部门简介"}),t(g,{prop:"user_count",label:"人员数","class-name":"cell-px-0",width:"70",align:"center",sortable:""}),t(g,{prop:"asc_num",label:"显示排序","class-name":"cell-px-0",width:"88",align:"center",sortable:""}),t(g,{prop:"id",label:"ID",width:"80",align:"center","class-name":"cell-px-0",sortable:""}),t(g,{label:"操作",width:"136","class-name":"list-item-ops",align:"center",fixed:"right"},{default:l(({row:w})=>[t(o,{type:"primary",onClick:p=>u.$refs.showRef.show(w.id),disabled:!e(b).view},{default:l(()=>[c("查看")]),_:2},1032,["onClick","disabled"]),t(o,{type:"primary",onClick:p=>u.$refs.formRef.edit(w.id),disabled:!e(b).update},{default:l(()=>[c("编辑")]),_:2},1032,["onClick","disabled"]),t(m,{title:"您确定要删除该部门吗？",onConfirm:p=>e(s)(w.id),disabled:!e(b).delete},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[h,e(a).isLoading]])]),t(vn,{ref:"formRef"},null,512),t(yn,{ref:"showRef"},null,512)],64)}}},$n=Object.freeze(Object.defineProperty({__proto__:null,default:xn},Symbol.toStringTag,{value:"Module"})),Cn={type:"submit"},En=k("div",{class:"tips"},"从小到大显示",-1),Dn={class:"permissions-box w-full"},Un={class:""},Rn={class:"permission-tree w-full"},An={__name:"FormDialog",setup(x,{expose:b}){const a=T(),i=T(),s={title:{required:!0,message:"请输入角色名称",trigger:["blur","change"]}};class u extends se{onHide(){super.onHide(),a.value.setCheckedKeys([],!1)}save(){this.item.isAllPermission&&(this.item.permissions=["*"]),super.save().then(y=>{this.is.edit||a.value.setCheckedKeys([],!1)})}reset(){var y;super.reset(),this.item.isAllPermission=(y=this.item.permissions)==null?void 0:y.includes("*"),a.value.setCheckedKeys(this.item.permissions||[],!1)}edit(y){super.edit(y).then(P=>{var U;this.item.isAllPermission=(U=this.item.permissions)==null?void 0:U.includes("*"),a.value.setCheckedKeys(this.item.permissions||[],!1)})}}const d=()=>{o.permissions=a.value.getCheckedKeys()},f=new u(ne,i,{title:"",intro:"",asc_num:50,enabled:!0,permissions:[],isAllPermission:!1}),{is:g,item:o,create:m,edit:_,reset:h,save:w,onHide:p}=f;return b({create:m,edit:_}),(v,y)=>{const P=n("el-skeleton"),U=n("el-input"),A=n("el-form-item"),C=n("el-slider"),E=n("el-switch"),B=n("el-checkbox"),N=n("el-tree"),H=n("el-form"),D=n("el-button"),W=n("el-dialog"),fe=O("loading");return r(),V(W,{modelValue:e(g).show,"onUpdate:modelValue":y[6]||(y[6]=S=>e(g).show=S),title:e(g).edit?"编辑角色":"新建角色",onClosed:e(p),width:"560",draggable:"","align-center":""},{footer:l(()=>[t(D,{onClick:e(h)},{default:l(()=>[c("重置")]),_:1},8,["onClick"]),I((r(),V(D,{type:"primary",onClick:e(w)},{default:l(()=>[c("确定")]),_:1},8,["onClick"])),[[fe,e(g).submitting]])]),default:l(()=>[t(P,{rows:10,loading:e(g).loading,animated:""},null,8,["loading"]),e(g).loading?z("",!0):(r(),V(H,{key:0,ref_key:"formRef",ref:i,rules:s,model:e(o),"label-width":"100px",onSubmit:j(e(w),["prevent"])},{default:l(()=>[I(k("input",Cn,null,512),[[Y,!1]]),t(A,{label:"角色名称",prop:"title"},{default:l(()=>[t(U,{modelValue:e(o).title,"onUpdate:modelValue":y[0]||(y[0]=S=>e(o).title=S),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(A,{label:"角色简介"},{default:l(()=>[t(U,{modelValue:e(o).intro,"onUpdate:modelValue":y[1]||(y[1]=S=>e(o).intro=S),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(A,{label:"显示排序",prop:"asc_num"},{default:l(()=>[t(C,{modelValue:e(o).asc_num,"onUpdate:modelValue":y[2]||(y[2]=S=>e(o).asc_num=S),"show-input":""},null,8,["modelValue"]),En]),_:1}),t(A,{label:"状态",prop:"enabled"},{default:l(()=>[t(E,{width:"60",modelValue:e(o).enabled,"onUpdate:modelValue":y[3]||(y[3]=S=>e(o).enabled=S),"active-text":"启用","inactive-text":"停用","inline-prompt":""},null,8,["modelValue"])]),_:1}),t(A,{label:"访问授权"},{default:l(()=>[k("div",Dn,[k("div",Un,[t(B,{modelValue:e(o).isAllPermission,"onUpdate:modelValue":y[4]||(y[4]=S=>e(o).isAllPermission=S)},{default:l(()=>[c("全部权限")]),_:1},8,["modelValue"])]),I(k("div",Rn,[t(N,{ref_key:"permissionsTreeRef",ref:a,data:e(ye).listData.items,onCheckChange:y[5]||(y[5]=S=>d()),"show-checkbox":"","default-expand-all":"","default-checked-keys":e(o).permissions,"node-key":"name","highlight-current":"",props:{label:"title"}},null,8,["data","default-checked-keys"])],512),[[Y,!e(o).isAllPermission]])])]),_:1})]),_:1},8,["model","onSubmit"]))]),_:1},8,["modelValue","title","onClosed"])}}};const Pn={key:0,class:""},Sn={key:1,class:"show-permissions w-full"},Bn={key:0},In={class:""},Fn={__name:"ShowDrawer",setup(x,{expose:b}){const a=T(),i=new de(ne.api),{item:s,is:u,show:d}=i;return b({show:f=>{d(f).then(()=>{a.value&&a.value.setCheckedKeys(s.permissions,!1)})}}),(f,g)=>{const o=n("el-skeleton"),m=n("el-descriptions-item"),_=n("el-tag"),h=n("el-tree"),w=n("el-descriptions"),p=n("el-button"),v=n("el-drawer"),y=n("el-form");return r(),V(y,{ref:"formRef",model:e(s),"label-width":"100px",class:"show-wp"},{default:l(()=>[t(v,{modelValue:e(u).show,"onUpdate:modelValue":g[1]||(g[1]=P=>e(u).show=P),title:"角色详情",size:"560"},{footer:l(()=>[t(p,{type:"primary",onClick:g[0]||(g[0]=()=>{f.$parent.$refs.formRef.edit(e(s).id),e(u).show=!1})},{default:l(()=>[c("编辑")]),_:1})]),default:l(()=>[t(o,{rows:10,loading:e(u).loading},null,8,["loading"]),e(u).loading?z("",!0):(r(),V(w,{key:0,column:1,"label-align":"right","label-size":"small",border:""},{default:l(()=>[t(m,{label:"角色名称"},{default:l(()=>[c($(e(s).title),1)]),_:1}),t(m,{label:"角色简介"},{default:l(()=>[c($(e(s).intro?e(s).intro:"-"),1)]),_:1}),t(m,{label:"显示排序"},{default:l(()=>[c($(e(s).asc_num),1)]),_:1}),t(m,{label:"显示状态"},{default:l(()=>[t(_,{size:"small",effect:"plain",type:e(s).enabled?"success":"danger",round:""},{default:l(()=>[c($(e(s).enabled?"启用":"停用"),1)]),_:1},8,["type"])]),_:1}),t(m,{label:"访问授权"},{default:l(()=>[e(s).permissions&&e(s).permissions.length===0?(r(),R("span",Pn,"未设置")):(r(),R("div",Sn,[e(s).permissions&&e(s).permissions[0]==="*"?(r(),R("div",Bn,"全部权限")):z("",!0),I(k("div",In,[t(h,{ref_key:"permissionsTreeRef",ref:a,data:e(ye).listData.items,"node-key":"name",props:{label:"title",class:(P,U)=>U.indeterminate?"is-indeterminate":""},"default-expand-all":"","default-checked-keys":e(s).permissions},null,8,["data","props","default-checked-keys"])],512),[[Y,!e(s).permissions||e(s).permissions[0]!="*"]])]))]),_:1})]),_:1}))]),_:1},8,["modelValue"])]),_:1},8,["model"])}}},zn={key:0,class:"op-bar flex mb-4"},Tn={class:"ops"},On={class:"box"},qn={__name:"Index",setup(x){const b=ae("admin-user.role",["view","create","update","delete"]),{listData:a,load:i,destroy:s}=ne;return i({"with-permissions":1},{permissions:ye.listData.items}),(u,d)=>{const f=n("el-button"),g=n("el-table-column"),o=n("el-tag"),m=n("el-link"),_=n("PopconfirmOperate"),h=n("el-table"),w=O("loading");return r(),R(F,null,[e(b).create?(r(),R("div",zn,[k("div",Tn,[t(f,{type:"primary",onClick:d[0]||(d[0]=p=>u.$refs.formRef.create()),disabled:!e(b).create},{default:l(()=>[c("+ 新建")]),_:1},8,["disabled"])])])):z("",!0),k("div",On,[I((r(),V(h,{data:e(a).items,stripe:""},{default:l(()=>[t(g,{prop:"id",label:"ID",width:"80"}),t(g,{prop:"title",label:"标题",width:"150"}),t(g,{prop:"intro",label:"简介",width:""}),t(g,{prop:"user_count",label:"人员数","class-name":"cell-px-0",width:"70",align:"center",sortable:""}),t(g,{prop:"asc_num",label:"显示排序",width:"80",align:"center"}),t(g,{label:"状态",prop:"enabled",width:"70",align:"center","class-name":"cell-px-0",sortable:""},{default:l(({row:p})=>[t(o,{size:"small",effect:"plain",type:p.enabled?"success":"danger",round:""},{default:l(()=>[c($(p.enabled?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),t(g,{label:"操作",width:"138","class-name":"list-item-ops",align:"center"},{default:l(p=>[t(m,{type:"primary",onClick:v=>u.$refs.showRef.show(p.row.id),disabled:!e(b).view},{default:l(()=>[c("查看")]),_:2},1032,["onClick","disabled"]),t(m,{type:"primary",onClick:v=>u.$refs.formRef.edit(p.row.id),disabled:!e(b).update},{default:l(()=>[c("编辑")]),_:2},1032,["onClick","disabled"]),t(_,{title:"您确定要删除该角色吗？",onConfirm:v=>e(s)(p.row.id),disabled:!e(b).delete},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[w,e(a).isLoading]])]),t(An,{ref:"formRef"},null,512),t(Fn,{ref:"showRef"},null,512)],64)}}},Ln=Object.freeze(Object.defineProperty({__proto__:null,default:qn},Symbol.toStringTag,{value:"Module"})),jn={class:"op-bar flex mb-4"},Nn=k("div",{class:"ops flex-auto"},null,-1),Hn={class:"filters flex-none"},Mn=k("span",{class:"iconfont icon-search"},null,-1),Wn={class:"box user-list"},Qn={key:2},Yn={__name:"Recycle",setup(x){const b=pe("admin-user.view"),a=pe("admin-user.recycle.restore"),{listData:i,selectChange:s,load:u,search:d}=ue,f=g=>{ue.api.patch(g).then(o=>{if(!o.success){Ae(o);return}oe("恢复成功"),ue.search(),re.reload()})};return _e(()=>{u({recycle:1})}),(g,o)=>{const m=n("el-input"),_=n("el-button"),h=n("el-table-column"),w=n("el-tag"),p=n("el-link"),v=n("PopconfirmOperate"),y=n("el-table"),P=n("Pagination"),U=n("el-container"),A=O("loading");return r(),R(F,null,[t(U,{class:"is-vertical"},{default:l(()=>[k("div",jn,[Nn,k("div",Hn,[t(m,{clearable:"",onClear:o[0]||(o[0]=C=>e(d)()),modelValue:e(i).query.keyword,"onUpdate:modelValue":o[1]||(o[1]=C=>e(i).query.keyword=C),onKeyup:o[2]||(o[2]=le(C=>e(d)(),["enter"])),class:"keyword mx-1.5",placeholder:"账号/姓名/手机号/邮箱"},{prefix:l(()=>[Mn]),_:1},8,["modelValue"]),t(_,{type:"primary",onClick:o[3]||(o[3]=C=>e(d)())},{default:l(()=>[c("搜索")]),_:1})])]),k("div",Wn,[I((r(),V(y,{style:{width:"100%"},data:e(i).items,onSelectionChange:o[4]||(o[4]=C=>e(s)(C)),stripe:""},{default:l(()=>[t(h,{type:"selection",width:"45",align:"center",fixed:""}),t(h,{prop:"id",label:"ID",width:"45","class-name":"cell-px-0"}),t(h,{prop:"name",label:"账号",width:"100","class-name":"item-name cell-px-0"}),t(h,{prop:"realname",label:"姓名",width:"120"}),t(h,{prop:"department",label:"部门"},{default:l(({row:C})=>[C.department?(r(),V(w,{key:0},{default:l(()=>[c($(C.department.title),1)]),_:2},1024)):z("",!0)]),_:1}),t(h,{label:"角色",width:""},{default:l(({row:C})=>[C.is_super?(r(),V(w,{key:0,class:"mr-3",size:"small",type:"danger",round:""},{default:l(()=>[c("超级管理员")]),_:1})):z("",!0),C.roles&&C.roles.length>0?(r(!0),R(F,{key:1},q(C.roles,E=>(r(),V(w,{class:"mr-1.5",size:"small",round:"",key:E.id},{default:l(()=>[c($(E.title),1)]),_:2},1024))),128)):C.is_super?z("",!0):(r(),R("span",Qn,"-"))]),_:1}),t(h,{label:"状态",prop:"enabled",width:"70",align:"center","class-name":"cell-px-0",sortable:""},{default:l(({row:C})=>[t(w,{size:"small",type:C.enabled?"success":"danger",round:""},{default:l(()=>[c($(C.enabled?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),t(h,{prop:"created_at",label:"创建时间",width:"150",align:"center","class-name":"cell-px-0"},{default:l(({row:C})=>[c($(C.created_at),1)]),_:1}),t(h,{label:"操作",width:"136","class-name":"list-item-ops",align:"center",fixed:"right"},{default:l(({row:C})=>[t(p,{type:"primary",onClick:E=>g.$refs.showRef.show(C.id),disabled:!e(b)},{default:l(()=>[c("查看")]),_:2},1032,["onClick","disabled"]),t(v,{title:"您确定要恢复该账号吗？",label:"恢复",onConfirm:E=>f(C.id),disabled:!e(a)},null,8,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"])),[[A,e(i).isLoading]])]),t(P,{bindings:e(ue)},null,8,["bindings"])]),_:1}),t(ze,{ref:"showRef"},null,512),t(Te,{ref:"formRef"},null,512)],64)}}},Kn=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"})),Gn={class:"box p-6 mb-14"},Jn={class:"form-title"},Xn={__name:"IndexSetting",props:["group"],setup(x){const b=x,a=K({title:"",items:[],loading:!1,submitting:!1}),i={system:"系统设置",sms:"短信设置",contact:"联系信息设置"},s=()=>{a.submitting=!0;const d={};for(const f of a.items)d[f.key]=f.value;G.post("admin/settings",{settings:d}).then(f=>{it.success("操作成功")}).finally(()=>{a.submitting=!1})},u=()=>{if(!i[b.group])return me("/notfound");a.title=i[b.group],a.items=[],a.loading=!0,G.get(`admin/settings?group=${b.group}`).then(d=>{a.items=d.items}).finally(()=>{a.loading=!1})};return te(()=>b.group,()=>{u()}),_e(()=>{u()}),Ye(()=>{a.items=[]}),(d,f)=>{const g=n("el-skeleton"),o=n("el-input"),m=n("el-switch"),_=n("el-form-item"),h=n("el-button"),w=n("el-form"),p=O("loading");return r(),R("div",Gn,[t(g,{rows:8,loading:a.loading,animated:""},null,8,["loading"]),a.loading?z("",!0):(r(),V(w,{key:0,ref:"formRef",model:a.items,"label-width":"100px",onSubmit:j(s,["prevent"])},{default:l(()=>[k("h2",Jn,$(a.title),1),(r(!0),R(F,null,q(a.items,v=>(r(),V(_,{key:v.id,label:v.title,prop:v.key},{default:l(()=>[v.input_type==="textarea"?(r(),V(o,{key:0,modelValue:v.value,"onUpdate:modelValue":y=>v.value=y,placeholder:v.tips,type:"textarea",rows:3},null,8,["modelValue","onUpdate:modelValue","placeholder"])):v.input_type==="switch"?(r(),V(m,{key:1,modelValue:v.value,"onUpdate:modelValue":y=>v.value=y,"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue"])):(r(),V(o,{key:2,modelValue:v.value,"onUpdate:modelValue":y=>v.value=y,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label","prop"]))),128)),t(_,null,{default:l(()=>[I((r(),V(h,{type:"primary","native-type":"submit"},{default:l(()=>[c("保存")]),_:1})),[[p,a.submitting]])]),_:1})]),_:1},8,["model","onSubmit"]))])}}},Zn=Object.freeze(Object.defineProperty({__proto__:null,default:Xn},Symbol.toStringTag,{value:"Module"}));
