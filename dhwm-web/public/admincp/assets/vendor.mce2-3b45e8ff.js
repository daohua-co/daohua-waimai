(function(){const $o=Object.getPrototypeOf,eo=(e,t,n)=>{var o;return n(e,t.prototype)?!0:((o=e.constructor)===null||o===void 0?void 0:o.name)===t.name},bo=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&eo(e,String,(n,o)=>o.isPrototypeOf(n))?"string":t},cn=e=>t=>bo(t)===e,_n=e=>t=>typeof t===e,Hn=e=>t=>e===t,Sn=(e,t)=>rt(e)&&eo(e,t,(n,o)=>$o(n)===o),Ee=cn("string"),rt=cn("object"),Nt=e=>Sn(e,Object),ut=cn("array"),ln=Hn(null),nn=_n("boolean"),pt=Hn(void 0),Ge=e=>e==null,Ye=e=>!Ge(e),qe=_n("function"),ht=_n("number"),ie=(e,t)=>{if(ut(e)){for(let n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1},Q=()=>{},kt=e=>()=>e(),to=(e,t)=>(...n)=>e(t.apply(null,n)),Kn=(e,t)=>n=>e(t(n)),O=e=>()=>e,Xe=e=>e,Gt=(e,t)=>e===t;function Et(e,...t){return(...n)=>{const o=t.concat(n);return e.apply(null,o)}}const Vn=e=>t=>!e(t),Jo=e=>()=>{throw new Error(e)},Yn=e=>e(),ne=O(!1),ge=O(!0);class g{constructor(t,n){this.tag=t,this.value=n}static some(t){return new g(!0,t)}static none(){return g.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?g.some(t(this.value)):g.none()}bind(t){return this.tag?t(this.value):g.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:g.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return Ye(t)?g.some(t):g.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}g.singletonNone=new g(!1);const St=Array.prototype.slice,qt=Array.prototype.indexOf,rn=Array.prototype.push,Xn=(e,t)=>qt.call(e,t),Jn=(e,t)=>{const n=Xn(e,t);return n===-1?g.none():g.some(n)},Tt=(e,t)=>Xn(e,t)>-1,Rn=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];if(t(s,n))return!0}return!1},gn=(e,t)=>{const n=[];for(let o=0;o<e;o++)n.push(t(o));return n},Lo=(e,t)=>{const n=[];for(let o=0;o<e.length;o+=t){const s=St.call(e,o,o+t);n.push(s)}return n},ae=(e,t)=>{const n=e.length,o=new Array(n);for(let s=0;s<n;s++){const r=e[s];o[s]=t(r,s)}return o},be=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];t(s,n)}},kn=(e,t)=>{for(let n=e.length-1;n>=0;n--){const o=e[n];t(o,n)}},he=(e,t)=>{const n=[],o=[];for(let s=0,r=e.length;s<r;s++){const a=e[s];(t(a,s)?n:o).push(a)}return{pass:n,fail:o}},Y=(e,t)=>{const n=[];for(let o=0,s=e.length;o<s;o++){const r=e[o];t(r,o)&&n.push(r)}return n},Ae=(e,t,n)=>(kn(e,(o,s)=>{n=t(n,o,s)}),n),me=(e,t,n)=>(be(e,(o,s)=>{n=t(n,o,s)}),n),zt=(e,t,n)=>{for(let o=0,s=e.length;o<s;o++){const r=e[o];if(t(r,o))return g.some(r);if(n(r,o))break}return g.none()},lt=(e,t)=>zt(e,t,ne),en=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];if(t(s,n))return g.some(n)}return g.none()},xt=e=>{const t=[];for(let n=0,o=e.length;n<o;++n){if(!ut(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);rn.apply(t,e[n])}return t},At=(e,t)=>xt(ae(e,t)),yo=(e,t)=>{for(let n=0,o=e.length;n<o;++n){const s=e[n];if(t(s,n)!==!0)return!1}return!0},Zo=e=>{const t=St.call(e,0);return t.reverse(),t},Qo=(e,t)=>Y(e,n=>!Tt(t,n)),cr=(e,t)=>{const n={};for(let o=0,s=e.length;o<s;o++){const r=e[o];n[String(r)]=t(r,o)}return n},X=e=>[e],K=(e,t)=>{const n=St.call(e,0);return n.sort(t),n},we=(e,t)=>t>=0&&t<e.length?g.some(e[t]):g.none(),He=e=>we(e,0),Pt=e=>we(e,e.length-1),Rt=qe(Array.from)?Array.from:e=>St.call(e),on=(e,t)=>{for(let n=0;n<e.length;n++){const o=t(e[n],n);if(o.isSome())return o}return g.none()},Lt=Object.keys,bs=Object.hasOwnProperty,un=(e,t)=>{const n=Lt(e);for(let o=0,s=n.length;o<s;o++){const r=n[o],a=e[r];t(a,r)}},Ut=(e,t)=>Ht(e,(n,o)=>({k:o,v:t(n,o)})),Ht=(e,t)=>{const n={};return un(e,(o,s)=>{const r=t(o,s);n[r.k]=r.v}),n},We=e=>(t,n)=>{e[n]=t},ft=(e,t,n,o)=>{un(e,(s,r)=>{(t(s,r)?n:o)(s,r)})},uo=(e,t)=>{const n={},o={};return ft(e,t,We(n),We(o)),{t:n,f:o}},co=(e,t)=>{const n={};return ft(e,t,We(n),Q),n},Ln=(e,t)=>{const n=[];return un(e,(o,s)=>{n.push(t(o,s))}),n},pn=(e,t)=>{const n=Lt(e);for(let o=0,s=n.length;o<s;o++){const r=n[o],a=e[r];if(t(a,r,e))return g.some(a)}return g.none()},_s=e=>Ln(e,Xe),Se=(e,t)=>wt(e,t)?g.from(e[t]):g.none(),wt=(e,t)=>bs.call(e,t),io=(e,t)=>wt(e,t)&&e[t]!==void 0&&e[t]!==null,Io=(e,t,n=Gt)=>e.exists(o=>n(o,t)),Os=(e,t,n=Gt)=>qs(e,t,n).getOr(e.isNone()&&t.isNone()),es=e=>{const t=[],n=o=>{t.push(o)};for(let o=0;o<e.length;o++)e[o].each(n);return t},ca=e=>{const t=[];for(let n=0;n<e.length;n++){const o=e[n];if(o.isSome())t.push(o.getOrDie());else return g.none()}return g.some(t)},qs=(e,t,n)=>e.isSome()&&t.isSome()?g.some(n(e.getOrDie(),t.getOrDie())):g.none(),ls=(e,t,n,o)=>e.isSome()&&t.isSome()&&n.isSome()?g.some(o(e.getOrDie(),t.getOrDie(),n.getOrDie())):g.none(),ir=(e,t)=>e!=null?g.some(t(e)):g.none(),ts=(e,t)=>e?g.some(t):g.none(),lr=(e,t)=>e+t,ur=(e,t)=>e.substring(t),ks=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,Es=(e,t)=>Ks(e,t)?ur(e,t.length):e,So=(e,t)=>xo(e,t)?e:lr(e,t),no=(e,t,n=0,o)=>{const s=e.indexOf(t,n);return s!==-1?pt(o)?!0:s+t.length<=o:!1},Ks=(e,t)=>ks(e,t,0),xo=(e,t)=>ks(e,t,e.length-t.length),$n=(e=>t=>t.replace(e,""))(/^\s+|\s+$/g),_r=e=>e.length>0,M=e=>!_r(e),E=e=>e.style!==void 0&&qe(e.style.getPropertyValue),U=(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const s="HTML does not have a single root node";throw console.error(s,e),new Error(s)}return Pe(o.childNodes[0])},W=(e,t)=>{const o=(t||document).createElement(e);return Pe(o)},ke=(e,t)=>{const o=(t||document).createTextNode(e);return Pe(o)},Pe=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},te={fromHtml:U,fromTag:W,fromText:ke,fromDom:Pe,fromPoint:(e,t,n)=>g.from(e.dom.elementFromPoint(t,n)).map(Pe)},It=typeof window<"u"?window:Function("return this;")(),bt=(e,t)=>{let n=t??It;for(let o=0;o<e.length&&n!==void 0&&n!==null;++o)n=n[e[o]];return n},Cn=(e,t)=>{const n=e.split(".");return bt(n,t)},zn=(e,t)=>Cn(e,t),wo=(e,t)=>{const n=zn(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},Kr=Object.getPrototypeOf,Or=e=>wo("HTMLElement",e),mo=e=>{const t=Cn("ownerDocument.defaultView",e);return rt(e)&&(Or(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(Kr(e).constructor.name))},kr=9,hn=11,fn=1,As=3,Bo=e=>e.dom.nodeName.toLowerCase(),Er=e=>e.dom.nodeType,dr=e=>t=>Er(t)===e,ia=e=>Co(e)&&mo(e.dom),Co=dr(fn),Xs=dr(As),Ds=dr(kr),kc=dr(hn),Ar=e=>t=>Co(t)&&Bo(t)===e,Uo=(e,t)=>{const n=e.dom;if(n.nodeType!==fn)return!1;{const o=n;if(o.matches!==void 0)return o.matches(t);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(t);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(t);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},la=e=>e.nodeType!==fn&&e.nodeType!==kr&&e.nodeType!==hn||e.childElementCount===0,Ec=(e,t)=>{const n=t===void 0?document:t.dom;return la(n)?[]:ae(n.querySelectorAll(e),te.fromDom)},ua=(e,t)=>{const n=t===void 0?document:t.dom;return la(n)?g.none():g.from(n.querySelector(e)).map(te.fromDom)},an=(e,t)=>e.dom===t.dom,Ms=(e,t)=>{const n=e.dom,o=t.dom;return n===o?!1:n.contains(o)},ns=e=>te.fromDom(e.dom.ownerDocument),$s=e=>Ds(e)?e:ns(e),da=e=>te.fromDom($s(e).dom.documentElement),us=e=>te.fromDom($s(e).dom.defaultView),Wo=e=>g.from(e.dom.parentNode).map(te.fromDom),Is=e=>g.from(e.dom.parentElement).map(te.fromDom),ni=(e,t)=>{const n=qe(t)?t:ne;let o=e.dom;const s=[];for(;o.parentNode!==null&&o.parentNode!==void 0;){const r=o.parentNode,a=te.fromDom(r);if(s.push(a),n(a)===!0)break;o=r}return s},Fa=e=>g.from(e.dom.offsetParent).map(te.fromDom),ma=e=>g.from(e.dom.nextSibling).map(te.fromDom),jo=e=>ae(e.dom.childNodes,te.fromDom),Bs=(e,t)=>{const n=e.dom.childNodes;return g.from(n[t]).map(te.fromDom)},tc=e=>Bs(e,0),Fs=(e,t)=>({element:e,offset:t}),Pa=(e,t)=>{const n=jo(e);return n.length>0&&t<n.length?Fs(n[t],0):Fs(e,t)},Ra=e=>kc(e)&&Ye(e.dom.host),w=qe(Element.prototype.attachShadow)&&qe(Node.prototype.getRootNode),$=O(w),P=w?e=>te.fromDom(e.dom.getRootNode()):$s,j=e=>Ra(e)?e:te.fromDom($s(e).dom.body),ue=e=>Ie(e).isSome(),Ie=e=>{const t=P(e);return Ra(t)?g.some(t):g.none()},Jt=e=>te.fromDom(e.dom.host),Zn=e=>{if($()&&Ye(e.target)){const t=te.fromDom(e.target);if(Co(t)&&Kt(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return He(n)}}return g.from(e.target)},Kt=e=>Ye(e.dom.shadowRoot),Zt=e=>{const t=Xs(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return Ie(te.fromDom(t)).fold(()=>n.body.contains(t),Kn(Zt,Jt))},sn=()=>mr(te.fromDom(document)),mr=e=>{const t=e.dom.body;if(t==null)throw new Error("Body is not available yet");return te.fromDom(t)},La=(e,t,n)=>{if(Ee(n)||nn(n)||ht(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},Qe=(e,t,n)=>{La(e.dom,t,n)},Ac=(e,t)=>{const n=e.dom;un(t,(o,s)=>{La(n,s,o)})},To=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},Go=(e,t)=>g.from(To(e,t)),v=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},C=(e,t)=>{e.dom.removeAttribute(t)},A=e=>me(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),H=(e,t,n)=>{if(!Ee(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);E(e)&&e.style.setProperty(t,n)},ve=(e,t)=>{E(e)&&e.style.removeProperty(t)},pe=(e,t,n)=>{const o=e.dom;H(o,t,n)},dn=(e,t)=>{const n=e.dom;un(t,(o,s)=>{H(n,s,o)})},_o=(e,t)=>{const n=e.dom;un(t,(o,s)=>{o.fold(()=>{ve(n,s)},r=>{H(n,s,r)})})},Un=(e,t)=>{const n=e.dom,s=window.getComputedStyle(n).getPropertyValue(t);return s===""&&!Zt(e)?Dr(n,t):s},Dr=(e,t)=>E(e)?e.style.getPropertyValue(t):"",xn=(e,t)=>{const n=e.dom,o=Dr(n,t);return g.from(o).filter(s=>s.length>0)},ga=e=>{const t={},n=e.dom;if(E(n))for(let o=0;o<n.style.length;o++){const s=n.style.item(o);t[s]=n.style[s]}return t},nc=(e,t,n)=>{const o=te.fromTag(e);return pe(o,t,n),xn(o,t).isSome()},Qt=(e,t)=>{const n=e.dom;ve(n,t),Io(Go(e,"style").map($n),"")&&C(e,"style")},pa=e=>e.dom.offsetWidth,Dc=(e,t)=>{const n=(c,l)=>{if(!ht(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const d=c.dom;E(d)&&(d.style[e]=l+"px")},o=c=>{const l=t(c);if(l<=0||l===null){const d=Un(c,e);return parseFloat(d)||0}return l},s=o,r=(c,l)=>me(l,(d,p)=>{const h=Un(c,p),b=h===void 0?0:parseInt(h,10);return isNaN(b)?d:d+b},0);return{set:n,get:o,getOuter:s,aggregate:r,max:(c,l,d)=>{const p=r(c,d);return l>p?l-p:0}}},Ps=Dc("height",e=>{const t=e.dom;return Zt(e)?t.getBoundingClientRect().height:t.offsetHeight}),In=e=>Ps.get(e),Yr=e=>Ps.getOuter(e),km=(e,t)=>{const n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],o=Ps.max(e,t,n);pe(e,"max-height",o+"px")},ed=(e,t)=>({left:e,top:t,translate:(o,s)=>ed(e+o,t+s)}),Bn=ed,Em=e=>{const t=e.getBoundingClientRect();return Bn(t.left,t.top)},Js=(e,t)=>e!==void 0?e:t!==void 0?t:0,Rs=e=>{const t=e.dom.ownerDocument,n=t.body,o=t.defaultView,s=t.documentElement;if(n===e.dom)return Bn(n.offsetLeft,n.offsetTop);const r=Js(o==null?void 0:o.pageYOffset,s.scrollTop),a=Js(o==null?void 0:o.pageXOffset,s.scrollLeft),c=Js(s.clientTop,n.clientTop),l=Js(s.clientLeft,n.clientLeft);return oc(e).translate(a-l,r-c)},oc=e=>{const t=e.dom,o=t.ownerDocument.body;return o===t?Bn(o.offsetLeft,o.offsetTop):Zt(e)?Em(t):Bn(0,0)},ha=Dc("width",e=>e.dom.offsetWidth),Jl=(e,t)=>ha.set(e,t),Oo=e=>ha.get(e),Mr=e=>ha.getOuter(e),oi=(e,t)=>{const n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],o=ha.max(e,t,n);pe(e,"max-width",o+"px")},$r=e=>{let t=!1,n;return(...o)=>(t||(t=!0,n=e.apply(null,o)),n)},td=(e,t,n,o)=>{const s=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!s,a=e.isiOS()||e.isAndroid(),c=a||o("(pointer:coarse)"),l=s||!r&&a&&o("(min-device-width:768px)"),d=r||a&&!l,p=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,h=!d&&!l&&!p;return{isiPad:O(s),isiPhone:O(r),isTablet:O(l),isPhone:O(d),isTouch:O(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:O(p),isDesktop:O(h)}},Mc=(e,t)=>{for(let n=0;n<e.length;n++){const o=e[n];if(o.test(t))return o}},$c=(e,t)=>{const n=Mc(e,t);if(!n)return{major:0,minor:0};const o=s=>Number(t.replace(n,"$"+s));return qi(o(1),o(2))},Ic=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?Bc():$c(e,n)},Bc=()=>qi(0,0),qi=(e,t)=>({major:e,minor:t}),sc={nu:qi,detect:Ic,unknown:Bc},Zl=(e,t)=>on(t.brands,n=>{const o=n.brand.toLowerCase();return lt(e,s=>{var r;return o===((r=s.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(s=>({current:s.name,version:sc.nu(parseInt(n.version,10),0)}))}),rc=(e,t)=>{const n=String(t).toLowerCase();return lt(e,o=>o.search(n))},nd=(e,t)=>rc(e,t).map(n=>{const o=sc.detect(n.versionRegexes,t);return{current:n.name,version:o}}),si=(e,t)=>rc(e,t).map(n=>{const o=sc.detect(n.versionRegexes,t);return{current:n.name,version:o}}),No=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Xr=e=>t=>no(t,e),Ql=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>no(e,"edge/")&&no(e,"chrome")&&no(e,"safari")&&no(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,No],search:e=>no(e,"chrome")&&!no(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>no(e,"msie")||no(e,"trident")},{name:"Opera",versionRegexes:[No,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Xr("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Xr("firefox")},{name:"Safari",versionRegexes:[No,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(no(e,"safari")||no(e,"mobile/"))&&no(e,"applewebkit")}],ri=[{name:"Windows",search:Xr("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>no(e,"iphone")||no(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Xr("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Xr("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Xr("linux"),versionRegexes:[]},{name:"Solaris",search:Xr("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Xr("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Xr("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ai={browsers:O(Ql),oses:O(ri)},ci="Edge",ii="Chromium",fa="IE",li="Opera",eu="Firefox",ba="Safari",ui=()=>tu({current:void 0,version:sc.unknown()}),tu=e=>{const t=e.current,n=e.version,o=s=>()=>t===s;return{current:t,version:n,isEdge:o(ci),isChromium:o(ii),isIE:o(fa),isOpera:o(li),isFirefox:o(eu),isSafari:o(ba)}},ac={unknown:ui,nu:tu,edge:O(ci),chromium:O(ii),ie:O(fa),opera:O(li),firefox:O(eu),safari:O(ba)},Ki="Windows",Yi="iOS",di="Android",mi="Linux",gi="macOS",Xi="Solaris",Ji="FreeBSD",pi="ChromeOS",od=()=>nu({current:void 0,version:sc.unknown()}),nu=e=>{const t=e.current,n=e.version,o=s=>()=>t===s;return{current:t,version:n,isWindows:o(Ki),isiOS:o(Yi),isAndroid:o(di),isMacOS:o(gi),isLinux:o(mi),isSolaris:o(Xi),isFreeBSD:o(Ji),isChromeOS:o(pi)}},ou={unknown:od,nu,windows:O(Ki),ios:O(Yi),android:O(di),linux:O(mi),macos:O(gi),solaris:O(Xi),freebsd:O(Ji),chromeos:O(pi)},sd={detect:(e,t,n)=>{const o=ai.browsers(),s=ai.oses(),r=t.bind(l=>Zl(o,l)).orThunk(()=>nd(o,e)).fold(ac.unknown,ac.nu),a=si(s,e).fold(ou.unknown,ou.nu),c=td(a,r,e,n);return{browser:r,os:a,deviceType:c}}},rd=e=>window.matchMedia(e).matches;let Zi=$r(()=>sd.detect(navigator.userAgent,g.from(navigator.userAgentData),rd));const Ir=()=>Zi(),ad=(e,t,n,o,s,r,a)=>({target:e,x:t,y:n,stop:o,prevent:s,kill:r,raw:a}),va=e=>{const t=te.fromDom(Zn(e).getOr(e.target)),n=()=>e.stopPropagation(),o=()=>e.preventDefault(),s=to(o,n);return ad(t,e.clientX,e.clientY,n,o,s,e)},cd=(e,t)=>n=>{e(n)&&t(va(n))},Qi=(e,t,n,o,s)=>{const r=cd(n,o);return e.dom.addEventListener(t,r,s),{unbind:Et(tl,e,t,r,s)}},id=(e,t,n,o)=>Qi(e,t,n,o,!1),el=(e,t,n,o)=>Qi(e,t,n,o,!0),tl=(e,t,n,o)=>{e.dom.removeEventListener(t,n,o)},hi=(e,t)=>{Wo(e).each(o=>{o.dom.insertBefore(t.dom,e.dom)})},su=(e,t)=>{ma(e).fold(()=>{Wo(e).each(s=>{Zs(s,t)})},o=>{hi(o,t)})},ld=(e,t)=>{tc(e).fold(()=>{Zs(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},Zs=(e,t)=>{e.dom.appendChild(t.dom)},ud=(e,t,n)=>{Bs(e,n).fold(()=>{Zs(e,t)},o=>{hi(o,t)})},ru=(e,t)=>{be(t,n=>{Zs(e,n)})},nl=e=>{e.dom.textContent="",be(jo(e),t=>{gr(t)})},gr=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Ls=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return Bn(n,o)},au=(e,t,n)=>{const s=(n!==void 0?n.dom:document).defaultView;s&&s.scrollTo(e,t)},dd=e=>{const t=e===void 0?window:e;return Ir().browser.isFirefox()?g.none():g.from(t.visualViewport)},ol=(e,t,n,o)=>({x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}),sl=e=>{const t=e===void 0?window:e,n=t.document,o=Ls(te.fromDom(n));return dd(t).fold(()=>{const s=t.document.documentElement,r=s.clientWidth,a=s.clientHeight;return ol(o.left,o.top,r,a)},s=>ol(Math.max(s.pageLeft,o.left),Math.max(s.pageTop,o.top),s.width,s.height))},rl=()=>te.fromDom(document),cu=(e,t)=>e.view(t).fold(O([]),o=>{const s=e.owner(o),r=cu(e,s);return[o].concat(r)}),md=(e,t)=>{const n=t.owner(e),o=cu(t,n);return g.some(o)};var al=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?g.none():g.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(te.fromDom)},owner:e=>ns(e)});const Fc=e=>{const t=rl(),n=Ls(t);return md(e,al).fold(Et(Rs,e),s=>{const r=oc(e),a=Ae(s,(c,l)=>{const d=oc(l);return{left:c.left+d.left,top:c.top+d.top}},{left:0,top:0});return Bn(a.left+r.left+n.left,a.top+r.top+n.top)})},pd=(e,t,n)=>({point:e,width:t,height:n}),cl=(e,t,n,o)=>({x:e,y:t,width:n,height:o}),m=(e,t,n,o)=>({x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}),f=e=>{const t=Rs(e),n=Mr(e),o=Yr(e);return m(t.left,t.top,n,o)},x=e=>{const t=Fc(e),n=Mr(e),o=Yr(e);return m(t.left,t.top,n,o)},D=(e,t)=>{const n=Math.max(e.x,t.x),o=Math.max(e.y,t.y),s=Math.min(e.right,t.right),r=Math.min(e.bottom,t.bottom),a=s-n,c=r-o;return m(n,o,a,c)},F=(e,t)=>me(t,(n,o)=>D(n,o),e),oe=()=>sl(window);var Je=tinymce.util.Tools.resolve("tinymce.ThemeManager");const ct=e=>{const t=r=>r(e),n=O(e),o=()=>s,s={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:ge,isError:ne,map:r=>Me.value(r(e)),mapError:o,bind:t,exists:t,forall:t,getOr:n,or:o,getOrThunk:n,orThunk:o,getOrDie:n,each:r=>{r(e)},toOptional:()=>g.some(e)};return s},_t=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(o,s)=>o(e),isValue:ne,isError:ge,map:t,mapError:o=>Me.error(o(e)),bind:t,exists:ne,forall:ge,getOr:Xe,or:Xe,getOrThunk:Yn,orThunk:Yn,getOrDie:Jo(String(e)),each:Q,toOptional:g.none};return n},Me={value:ct,error:_t,fromOption:(e,t)=>e.fold(()=>_t(t),ct)};var Fn;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(Fn||(Fn={}));const vs=(e,t,n)=>e.stype===Fn.Error?t(e.serror):n(e.svalue),Xp=e=>{const t=[],n=[];return be(e,o=>{vs(o,s=>n.push(s),s=>t.push(s))}),{values:t,errors:n}},Jp=(e,t)=>e.stype===Fn.Error?{stype:Fn.Error,serror:t(e.serror)}:e,Mm=(e,t)=>e.stype===Fn.Value?{stype:Fn.Value,svalue:t(e.svalue)}:e,Zp=(e,t)=>e.stype===Fn.Value?t(e.svalue):e,hd=(e,t)=>e.stype===Fn.Error?t(e.serror):e,iu=e=>({stype:Fn.Value,svalue:e}),$m=e=>({stype:Fn.Error,serror:e}),oo={fromResult:e=>e.fold($m,iu),toResult:e=>vs(e,Me.error,Me.value),svalue:iu,partition:Xp,serror:$m,bind:Zp,bindError:hd,map:Mm,mapError:Jp,fold:vs},fd=(e,t,n,o)=>({tag:"field",key:e,newKey:t,presence:n,prop:o}),Qp=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),bd=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},vd=(e,t)=>t,eh=(e,t)=>Nt(e)&&Nt(t)?Wn(e,t):t,Bm=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let o=0;o<t.length;o++){const s=t[o];for(const r in s)wt(s,r)&&(n[r]=e(n[r],s[r]))}return n},Wn=Bm(eh),lu=Bm(vd),Ns=()=>({tag:"required",process:{}}),ya=e=>({tag:"defaultedThunk",process:e}),Na=e=>ya(O(e)),Pc=()=>({tag:"option",process:{}}),Rc=e=>({tag:"mergeWithThunk",process:e}),uu=e=>Rc(O(e)),Fm=(e,t)=>e.length>0?oo.svalue(Wn(t,lu.apply(void 0,e))):oo.svalue(t),yd=e=>to(oo.serror,xt)(e),Sd={consolidateObj:(e,t)=>{const n=oo.partition(e);return n.errors.length>0?yd(n.errors):Fm(n.values,t)},consolidateArr:e=>{const t=oo.partition(e);return t.errors.length>0?yd(t.errors):oo.svalue(t.values)}},il=e=>rt(e)&&Lt(e).length>100?" removed due to size":JSON.stringify(e,null,2),zy=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:O("... (only showing first ten failures)")}]):e;return ae(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},Lc=(e,t)=>oo.serror([{path:e,getErrorInfo:t}]),th=(e,t,n)=>Lc(e,()=>'Could not find valid *required* value for "'+t+'" in '+il(n)),nh=(e,t)=>Lc(e,()=>'Choice schema did not contain choice key: "'+t+'"'),oh=(e,t,n)=>Lc(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+il(t)),sh=(e,t)=>Lc(e,()=>"There are unsupported fields: ["+t.join(", ")+"] specified"),rh=(e,t)=>Lc(e,O(t)),fi=e=>{const t=(o,s)=>oo.bindError(e(s),r=>rh(o,r)),n=O("val");return{extract:t,toString:n}},xd=fi(oo.svalue),ah=(e,t,n,o)=>Se(t,n).fold(()=>th(e,n,t),o),Pm=(e,t,n,o)=>{const s=Se(e,t).getOrThunk(()=>n(e));return o(s)},ch=(e,t,n)=>n(Se(e,t)),Rm=(e,t,n,o)=>{const s=Se(e,t).map(r=>r===!0?n(e):r);return o(s)},ih=(e,t,n,o,s)=>{const r=c=>s.extract(t.concat([o]),c),a=c=>c.fold(()=>oo.svalue(g.none()),l=>{const d=s.extract(t.concat([o]),l);return oo.map(d,g.some)});switch(e.tag){case"required":return ah(t,n,o,r);case"defaultedThunk":return Pm(n,o,e.process,r);case"option":return ch(n,o,a);case"defaultedOptionThunk":return Rm(n,o,e.process,a);case"mergeWithThunk":return Pm(n,o,O({}),c=>{const l=Wn(e.process(n),c);return r(l)})}},Lm=(e,t,n)=>{const o={},s=[];for(const r of n)bd(r,(a,c,l,d)=>{const p=ih(l,e,t,a,d);oo.fold(p,h=>{s.push(...h)},h=>{o[c]=h})},(a,c)=>{o[a]=c(t)});return s.length>0?oo.serror(s):oo.svalue(o)},Nm=e=>({extract:(o,s)=>e().extract(o,s),toString:()=>e().toString()}),lh=e=>Lt(co(e,Ye)),pr=e=>{const t=Re(e),n=Ae(e,(s,r)=>bd(r,a=>Wn(s,{[a]:!0}),O(s)),{});return{extract:(s,r)=>{const a=nn(r)?[]:lh(r),c=Y(a,l=>!io(n,l));return c.length===0?t.extract(s,r):sh(s,c)},toString:t.toString}},Re=e=>({extract:(o,s)=>Lm(o,s,e),toString:()=>`obj{
`+ae(e,s=>bd(s,(r,a,c,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),Nc=e=>({extract:(o,s)=>{const r=ae(s,(a,c)=>e.extract(o.concat(["["+c+"]"]),a));return Sd.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),Hm=(e,t)=>{const n=t!==void 0?t:Xe;return{extract:(r,a)=>{const c=[];for(const l of e){const d=l.extract(r,a);if(d.stype===Fn.Value)return{stype:Fn.Value,svalue:n(d.svalue)};c.push(d)}return Sd.consolidateArr(c)},toString:()=>"oneOf("+ae(e,r=>r.toString()).join(", ")+")"}},uh=(e,t)=>{const n=(r,a)=>Nc(fi(e)).extract(r,a);return{extract:(r,a)=>{const c=Lt(a),l=n(r,c);return oo.bind(l,d=>{const p=ae(d,h=>fd(h,h,Ns(),t));return Re(p).extract(r,a)})},toString:()=>"setOf("+t.toString()+")"}},du=(e,t)=>{const n=$r(t);return{extract:(r,a)=>n().extract(r,a),toString:()=>n().toString()}},ll=to(Nc,Re),Br=O(xd),ul=(e,t)=>fi(n=>{const o=typeof n;return e(n)?oo.svalue(n):oo.serror(`Expected type: ${t} but got: ${o}`)}),bi=ul(ht,"number"),Fo=ul(Ee,"string"),dl=ul(nn,"boolean"),wd=ul(qe,"function"),Vm=e=>{if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>Vm(e[t]));default:return!1}},dh=fi(e=>Vm(e)?oo.svalue(e):oo.serror("Expected value to be acceptable for sending via postMessage")),mh=(e,t,n,o)=>Se(n,o).fold(()=>oh(e,n,o),r=>r.extract(e.concat(["branch: "+o]),t)),Hc=(e,t)=>({extract:(s,r)=>Se(r,e).fold(()=>nh(s,e),c=>mh(s,r,t,c)),toString:()=>"chooseOn("+e+"). Possible values: "+Lt(t)}),gh=()=>Nc(xd),ml=e=>fi(t=>e(t).fold(oo.serror,oo.svalue)),zm=(e,t)=>uh(n=>oo.fromResult(e(n)),t),ph=(e,t,n)=>{const o=t.extract([e],n);return oo.mapError(o,s=>({input:n,errors:s}))},jn=(e,t,n)=>oo.toResult(ph(e,t,n)),Jr=e=>e.fold(t=>{throw new Error(vi(t))},Xe),ys=(e,t,n)=>Jr(jn(e,t,n)),vi=e=>`Errors: 
`+zy(e.errors).join(`
`)+`

Input object: `+il(e.input),Hs=(e,t)=>Hc(e,Ut(t,Re)),Um=(e,t)=>du(e,t),Po=fd,ds=Qp,Cd=e=>ml(t=>Tt(e,t)?Me.value(t):Me.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),J=e=>Po(e,e,Ns(),Br()),Qs=(e,t)=>Po(e,e,Ns(),t),hh=e=>Qs(e,bi),go=e=>Qs(e,Fo),Ha=(e,t)=>Po(e,e,Ns(),Cd(t)),fh=e=>Qs(e,dl),hr=e=>Qs(e,wd),bh=(e,t)=>Po(e,e,Pc(),fi(n=>oo.serror("The field: "+e+" is forbidden. "+t))),cc=(e,t)=>Po(e,e,Ns(),Re(t)),Td=(e,t)=>Po(e,e,Ns(),ll(t)),er=(e,t)=>Po(e,e,Ns(),Nc(t)),Wt=e=>Po(e,e,Pc(),Br()),Sa=(e,t)=>Po(e,e,Pc(),t),gl=e=>Sa(e,bi),ms=e=>Sa(e,Fo),Wm=(e,t)=>Sa(e,Cd(t)),Vc=e=>Sa(e,wd),jm=(e,t)=>Sa(e,Nc(t)),tr=(e,t)=>Sa(e,Re(t)),Gm=(e,t)=>Sa(e,pr(t)),N=(e,t)=>Po(e,e,Na(t),Br()),fr=(e,t,n)=>Po(e,e,Na(t),n),mu=(e,t)=>fr(e,t,bi),Fr=(e,t)=>fr(e,t,Fo),br=(e,t,n)=>fr(e,t,Cd(n)),Ho=(e,t)=>fr(e,t,dl),ko=(e,t)=>fr(e,t,wd),vh=(e,t)=>fr(e,t,dh),Va=(e,t,n)=>fr(e,t,Nc(n)),_d=(e,t,n)=>fr(e,t,Re(n)),Le=e=>{let t=e;return{get:()=>t,set:s=>{t=s}}},i={generate:e=>{if(!ut(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return be(e,(o,s)=>{const r=Lt(o);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],c=o[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!ut(c))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const d=l.length;if(d!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+d);return{fold:(...h)=>{if(h.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+h.length);return h[s].apply(null,l)},match:h=>{const b=Lt(h);if(t.length!==b.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+b.join(","));if(!yo(t,_=>Tt(b,_)))throw new Error("Not all branches were specified when using match. Specified: "+b.join(", ")+`
Required: `+t.join(", "));return h[a].apply(null,l)},log:h=>{console.log(h,{constructors:t,constructor:a,params:l})}}}}),n}};i.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const u=e=>{const t=[],n=[];return be(e,o=>{o.fold(s=>{t.push(s)},s=>{n.push(s)})}),{errors:t,values:n}},y=(e,t)=>{const n={};return un(e,(o,s)=>{Tt(t,s)||(n[s]=o)}),n},T=(e,t)=>({[e]:t}),I=e=>{const t={};return be(e,n=>{t[n.key]=n.value}),t},G=(e,t)=>y(e,t),se=(e,t)=>T(e,t),xe=e=>I(e),tt=(e,t)=>e.length===0?Me.value(t):Me.value(Wn(t,lu.apply(void 0,e))),ot=e=>Me.error(xt(e)),Gn=(e,t)=>{const n=u(e);return n.errors.length>0?ot(n.errors):tt(n.values,t)},bn=e=>qe(e)?e:ne,En=(e,t,n)=>{let o=e.dom;const s=bn(n);for(;o.parentNode;){o=o.parentNode;const r=te.fromDom(o),a=t(r);if(a.isSome())return a;if(s(r))break}return g.none()},gs=(e,t,n)=>{const o=t(e),s=bn(n);return o.orThunk(()=>s(e)?g.none():En(e,t,s))},Zr=(e,t)=>an(e.element,t.event.target),ic={can:ge,abort:ne,run:Q},Pr=e=>{if(!io(e,"can")&&!io(e,"abort")&&!io(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return{...ic,...e}},Od=(e,t)=>(...n)=>me(e,(o,s)=>o&&t(s).apply(void 0,n),!0),gu=(e,t)=>(...n)=>me(e,(o,s)=>o||t(s).apply(void 0,n),!1),pl=e=>qe(e)?{can:ge,abort:ne,run:e}:e,hl=e=>{const t=Od(e,s=>s.can),n=gu(e,s=>s.abort);return{can:t,abort:n,run:(...s)=>{be(e,r=>{r.run.apply(void 0,s)})}}},Eo=O,Rr=Eo("touchstart"),lc=Eo("touchmove"),zc=Eo("touchend"),qm=Eo("touchcancel"),mt=Eo("mousedown"),An=Eo("mousemove"),os=Eo("mouseout"),Vs=Eo("mouseup"),za=Eo("mouseover"),uc=Eo("focusin"),fl=Eo("focusout"),nr=Eo("keydown"),uD=Eo("keyup"),bl=Eo("input"),pu=Eo("change"),vl=Eo("click"),dD=Eo("transitioncancel"),kd=Eo("transitionend"),mD=Eo("transitionstart"),gD=Eo("selectstart"),po=e=>O("alloy."+e),pD={tap:po("tap")},yi=po("focus"),yh=po("blur.post"),Sh=po("paste.post"),yl=po("receive"),Lr=po("execute"),Ed=po("focus.item"),Ad=pD.tap,hD=po("longpress"),Km=po("sandbox.close"),xh=po("typeahead.cancel"),Ym=po("system.init"),fD=po("system.touchmove"),bD=po("system.touchend"),wh=po("system.scroll"),Xm=po("system.resize"),dc=po("system.attached"),hu=po("system.detached"),Sl=po("system.dismissRequested"),Wy=po("system.repositionRequested"),jy=po("focusmanager.shifted"),Ch=po("slotcontainer.visibility"),Gy=po("system.external.element.scroll"),qy=po("change.tab"),Ky=po("dismiss.tab"),Yy=po("highlight"),Th=po("dehighlight"),jt=(e,t)=>{Oh(e,e.element,t,{})},Be=(e,t,n)=>{Oh(e,e.element,t,n)},xl=e=>{jt(e,Lr())},_h=(e,t,n)=>{Oh(e,t,n,{})},Oh=(e,t,n,o)=>{const s={target:t,...o};e.getSystem().triggerEvent(n,t,s)},vD=(e,t,n,o)=>{const s={...o,target:t};e.getSystem().triggerEvent(n,t,s)},Xy=(e,t,n,o)=>{e.getSystem().triggerEvent(n,t,o.event)},On=e=>xe(e),Jy=(e,t)=>({key:e,value:Pr({abort:t})}),yD=(e,t)=>({key:e,value:Pr({can:t})}),Zy=e=>({key:e,value:Pr({run:(t,n)=>{n.event.prevent()}})}),Z=(e,t)=>({key:e,value:Pr({run:t})}),kh=(e,t,n)=>({key:e,value:Pr({run:(o,s)=>{t.apply(void 0,[o,s].concat(n))}})}),SD=e=>t=>Z(e,t),Jm=e=>t=>({key:e,value:Pr({run:(n,o)=>{Zr(n,o)&&t(n,o)}})}),xD=(e,t)=>Z(e,(n,o)=>{n.getSystem().getByUid(t).each(s=>{Xy(s,s.element,e,o)})}),fu=(e,t,n)=>{const o=t.partUids[n];return xD(e,o)},Eh=(e,t)=>Z(e,(n,o)=>{const s=o.event,r=n.getSystem().getByDom(s.target).getOrThunk(()=>gs(s.target,c=>n.getSystem().getByDom(c).toOptional(),ne).getOr(n));t(n,r,o)}),wl=e=>Z(e,(t,n)=>{n.cut()}),wD=e=>Z(e,(t,n)=>{n.stop()}),bu=(e,t)=>Jm(e)(t),Pn=Jm(dc()),mc=Jm(hu()),CD=Jm(Ym()),Uc=SD(Lr()),TD=(e,t)=>{const o=(t||document).createElement("div");return o.innerHTML=e,jo(te.fromDom(o))},Ah=e=>e.dom.innerHTML,vu=(e,t)=>{const o=ns(e).dom,s=te.fromDom(o.createDocumentFragment()),r=TD(t,o);ru(s,r),nl(e),Zs(e,s)},_D=e=>{const t=te.fromTag("div"),n=te.fromDom(e.dom.cloneNode(!0));return Zs(t,n),Ah(t)},OD=(e,t)=>te.fromDom(e.dom.cloneNode(t)),kD=e=>OD(e,!1),ED=e=>{if(Ra(e))return"#shadow-root";{const t=kD(e);return _D(t)}},Si=e=>ED(e),AD=(e,t,n)=>an(t,e.element)&&!an(t,n),DD=On([yD(yi(),(e,t)=>{const n=t.event,o=n.originator,s=n.target;return AD(e,o,s)?(console.warn(yi()+` did not get interpreted by the desired target. 
Originator: `+Si(o)+`
Target: `+Si(s)+`
Check the `+yi()+" event handlers"),!1):!0})]);var MD=Object.freeze({__proto__:null,events:DD});let Qy=0;const Te=e=>{const n=new Date().getTime(),o=Math.floor(Math.random()*1e9);return Qy++,e+"_"+o+Qy+String(n)},$D=O("alloy-id-"),ID=O("data-alloy-id"),BD=$D(),eS=ID(),FD=(e,t)=>{const n=Te(BD+e);return Dh(t,n),n},Dh=(e,t)=>{Object.defineProperty(e.dom,eS,{value:t,writable:!0})},Dd=e=>{const t=Co(e)?e.dom[eS]:null;return g.from(t)},yu=e=>Te(e),PD=Xe,Zm=e=>{const t=s=>`The component must be in a context to execute: ${s}`+(e?`
`+Si(e().element)+" is not in context.":""),n=s=>()=>{throw new Error(t(s))},o=s=>()=>{console.warn(t(s))};return{debugInfo:O("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:n("build"),buildOrPatch:n("buildOrPatch"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),isConnected:ne}},RD=Zm(),LD=(e,t,n)=>{const o=n.toString(),s=o.indexOf(")")+1,r=o.indexOf("("),a=o.substring(r+1,s-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:Mh(a.slice(0,1).concat(a.slice(3)))}),e},Mh=e=>ae(e,t=>xo(t,"/*")?t.substring(0,t.length-2):t),$h=(e,t)=>{const n=e.toString(),o=n.indexOf(")")+1,s=n.indexOf("("),r=n.substring(s+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:Mh(r)}),e},ND=(e,t)=>{const n=t.toString(),o=n.indexOf(")")+1,s=n.indexOf("("),r=n.substring(s+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:Mh(r.slice(1))}),e},Qm=Te("alloy-premade"),tS=e=>(Object.defineProperty(e.element.dom,Qm,{value:e.uid,writable:!0}),se(Qm,e)),HD=e=>wt(e.dom,Qm),nS=e=>Se(e,Qm),eg=e=>ND((t,...n)=>e(t.getApis(),t,...n),e),Ua={init:()=>Nr({readState:O("No State required")})},Nr=e=>e,VD=(e,t)=>{const n=ae(t,s=>tr(s.name(),[J("config"),N("state",Ua)])),o=jn("component.behaviours",Re(n),e.behaviours).fold(s=>{throw new Error(vi(s)+`
Complete spec:
`+JSON.stringify(e,null,2))},Xe);return{list:t,data:Ut(o,s=>{const r=s.map(a=>({config:a.config,state:a.state.init(a.config)}));return O(r)})}},zD=e=>e.list,UD=e=>e.data,oS=(e,t)=>{const n={};return un(e,(o,s)=>{un(o,(r,a)=>{const c=Se(n,a).getOr([]);n[a]=c.concat([t(s,r)])})}),n},xa=e=>({classes:pt(e.classes)?[]:e.classes,attributes:pt(e.attributes)?{}:e.attributes,styles:pt(e.styles)?{}:e.styles}),WD=(e,t)=>({...e,attributes:{...e.attributes,...t.attributes},styles:{...e.styles,...t.styles},classes:e.classes.concat(t.classes)}),jD=(e,t,n,o)=>{const s={...t};be(n,p=>{s[p.name()]=p.exhibit(e,o)});const r=oS(s,(p,h)=>({name:p,modification:h})),a=p=>Ae(p,(h,b)=>({...b.modification,...h}),{}),c=Ae(r.classes,(p,h)=>h.modification.concat(p),[]),l=a(r.attributes),d=a(r.styles);return xa({classes:c,attributes:l,styles:d})},GD=(e,t,n,o)=>{try{const s=K(n,(r,a)=>{const c=r[t],l=a[t],d=o.indexOf(c),p=o.indexOf(l);if(d===-1)throw new Error("The ordering for "+e+" does not have an entry for "+c+`.
Order specified: `+JSON.stringify(o,null,2));if(p===-1)throw new Error("The ordering for "+e+" does not have an entry for "+l+`.
Order specified: `+JSON.stringify(o,null,2));return d<p?-1:p<d?1:0});return Me.value(s)}catch(s){return Me.error([s])}},qD=(e,t)=>({handler:e,purpose:t}),KD=(e,t)=>({cHandler:e,purpose:t}),YD=(e,t)=>KD(Et.apply(void 0,[e.handler].concat(t)),e.purpose),Ih=e=>e.cHandler,XD=(e,t)=>({name:e,handler:t}),JD=(e,t)=>{const n={};return be(e,o=>{n[o.name()]=o.handlers(t)}),n},ZD=(e,t,n)=>{const o={...n,...JD(t,e)};return oS(o,XD)},QD=(e,t,n,o)=>{const s=ZD(e,n,o);return oM(s,t)},eM=e=>{const t=pl(e);return(n,o,...s)=>{const r=[n,o].concat(s);t.abort.apply(void 0,r)?o.stop():t.can.apply(void 0,r)&&t.run.apply(void 0,r)}},tM=(e,t)=>Me.error(["The event ("+e+`) has more than one behaviour that listens to it.
When this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).
The behaviours that can trigger it are: `+JSON.stringify(ae(t,n=>n.name),null,2)]),nM=(e,t,n)=>{const o=t[n];return o?GD("Event: "+n,"name",e,o).map(s=>{const r=ae(s,a=>a.handler);return hl(r)}):tM(n,e)},oM=(e,t)=>{const n=Ln(e,(o,s)=>(o.length===1?Me.value(o[0].handler):nM(o,t,s)).map(a=>{const c=eM(a),l=o.length>1?Y(t[s],d=>Rn(o,p=>p.name===d)).join(" > "):o[0].name;return se(s,qD(c,l))}));return Gn(n,{})},Cl="alloy.base.behaviour",sM=Re([Po("dom","dom",Ns(),Re([J("tag"),N("styles",{}),N("classes",[]),N("attributes",{}),Wt("value"),Wt("innerHtml")])),J("components"),J("uid"),N("events",{}),N("apis",{}),Po("eventOrder","eventOrder",uu({[Lr()]:["disabling",Cl,"toggling","typeaheadevents"],[yi()]:[Cl,"focusing","keying"],[Ym()]:[Cl,"disabling","toggling","representing"],[bl()]:[Cl,"representing","streaming","invalidating"],[hu()]:[Cl,"representing","item-events","tooltipping"],[mt()]:["focusing",Cl,"item-type-events"],[Rr()]:["focusing",Cl,"item-type-events"],[za()]:["item-type-events","tooltipping"],[yl()]:["receiving","reflecting","tooltipping"]}),Br()),Wt("domModification")]),rM=e=>jn("custom.definition",sM,e),aM=e=>({...e.dom,uid:e.uid,domChildren:ae(e.components,t=>t.element)}),cM=e=>e.domModification.fold(()=>xa({}),xa),iM=e=>e.events,Bh=(e,t)=>{const n=To(e,t);return n===void 0||n===""?[]:n.split(" ")},lM=(e,t,n)=>{const s=Bh(e,t).concat([n]);return Qe(e,t,s.join(" ")),!0},uM=(e,t,n)=>{const o=Y(Bh(e,t),s=>s!==n);return o.length>0?Qe(e,t,o.join(" ")):C(e,t),!1},Md=e=>e.dom.classList!==void 0,sS=e=>Bh(e,"class"),dM=(e,t)=>lM(e,"class",t),mM=(e,t)=>uM(e,"class",t),vo=(e,t)=>{Md(e)?e.dom.classList.add(t):dM(e,t)},gM=e=>{(Md(e)?e.dom.classList:sS(e)).length===0&&C(e,"class")},so=(e,t)=>{Md(e)?e.dom.classList.remove(t):mM(e,t),gM(e)},or=(e,t)=>Md(e)&&e.dom.classList.contains(t),gc=(e,t)=>{be(t,n=>{vo(e,n)})},Hr=(e,t)=>{be(t,n=>{so(e,n)})},rS=(e,t)=>yo(t,n=>or(e,n)),pM=e=>{const t=e.dom.classList,n=new Array(t.length);for(let o=0;o<t.length;o++){const s=t.item(o);s!==null&&(n[o]=s)}return n},hM=e=>Md(e)?pM(e):sS(e),pc=e=>e.dom.value,xi=(e,t)=>{if(t===void 0)throw new Error("Value.set was undefined");e.dom.value=t},fM=(e,t,n)=>Bs(e,t).map(s=>{if(n.exists(a=>!an(a,s))){const a=n.map(Bo).getOr("span"),c=te.fromTag(a);return hi(s,c),c}else return s}),aS=(e,t,n)=>{n.fold(()=>Zs(e,t),o=>{an(o,t)||(hi(o,t),gr(o))})},cS=(e,t,n)=>{const o=ae(t,n),s=jo(e);return be(s.slice(o.length),gr),o},iS=(e,t,n,o)=>{const s=Bs(e,t),r=o(n,s),a=fM(e,t,s);return aS(e,r.element,a),r},bM=(e,t,n)=>cS(e,t,(o,s)=>iS(e,s,o,n)),vM=(e,t)=>cS(e,t,(n,o)=>{const s=Bs(e,o);return aS(e,n,s),n}),lS=(e,t)=>{const n=Lt(e),o=Lt(t),s=Qo(o,n),r=uo(e,(a,c)=>!wt(t,c)||a!==t[c]).t;return{toRemove:s,toSet:r}},yM=(e,t)=>{const{class:n,style:o,...s}=A(t),{toSet:r,toRemove:a}=lS(e.attributes,s),c=()=>{be(a,q=>C(t,q)),Ac(t,r)},l=ga(t),{toSet:d,toRemove:p}=lS(e.styles,l),h=()=>{be(p,q=>Qt(t,q)),dn(t,d)},b=hM(t),S=Qo(b,e.classes),_=Qo(e.classes,b),k=()=>{gc(t,_),Hr(t,S)},L=q=>{vu(t,q)},R=()=>{const q=e.domChildren;vM(t,q)},B=()=>{const q=t,V=e.value.getOrUndefined();V!==pc(q)&&xi(q,V??"")};return c(),k(),h(),e.innerHtml.fold(R,L),B(),t},SM=e=>{const t=te.fromTag(e.tag);Ac(t,e.attributes),gc(t,e.classes),dn(t,e.styles),e.innerHtml.each(o=>vu(t,o));const n=e.domChildren;return ru(t,n),e.value.each(o=>{xi(t,o)}),t},xM=(e,t)=>{try{const n=yM(e,t);return g.some(n)}catch{return g.none()}},wM=e=>e.innerHtml.isSome()&&e.domChildren.length>0,CM=(e,t)=>{const n=s=>Bo(s)===e.tag&&!wM(e)&&!HD(s),o=t.filter(n).bind(s=>xM(e,s)).getOrThunk(()=>SM(e));return Dh(o,e.uid),o},TM=e=>{const t=Se(e,"behaviours").getOr({});return At(Lt(t),n=>{const o=t[n];return Ye(o)?[o.me]:[]})},_M=(e,t)=>VD(e,t),OM=e=>{const t=TM(e);return _M(e,t)},kM=(e,t,n)=>{const o=aM(e),s=cM(e),r={"alloy.base.modification":s},a=t.length>0?jD(n,r,t,o):s;return WD(o,a)},EM=(e,t,n)=>{const o={"alloy.base.behaviour":iM(e)};return QD(n,e.eventOrder,t,o).getOrDie()},AM=(e,t)=>{const n=()=>q,o=Le(RD),s=Jr(rM(e)),r=OM(e),a=zD(r),c=UD(r),l=kM(s,a,c),d=CM(l,t),p=EM(s,a,c),h=Le(s.components),b=V=>{o.set(V)},S=()=>{o.set(Zm(n))},_=()=>{const V=jo(d),re=At(V,ee=>o.get().getByDom(ee).fold(()=>[],X));h.set(re)},k=V=>{const re=c;return(qe(re[V.name()])?re[V.name()]:()=>{throw new Error("Could not find "+V.name()+" in "+JSON.stringify(e,null,2))})()},L=V=>qe(c[V.name()]),R=()=>s.apis,B=V=>c[V]().map(re=>re.state.readState()).getOr("not enabled"),q={uid:e.uid,getSystem:o.get,config:k,hasConfigured:L,spec:e,readState:B,getApis:R,connect:b,disconnect:S,element:d,syncComponents:_,components:h.get,events:p};return q},DM=(e,t)=>{const n=Se(e,"components").getOr([]);return t.fold(()=>ae(n,ps),o=>ae(n,(s,r)=>Fh(s,Bs(o,r))))},MM=(e,t)=>{const{events:n,...o}=PD(e),s=DM(o,t),r={...o,events:{...MD,...n},components:s};return Me.value(AM(r,t))},ho=e=>{const t=te.fromText(e);return uS({element:t})},uS=e=>{const t=ys("external.component",pr([J("element"),Wt("uid")]),e),n=Le(Zm()),o=c=>{n.set(c)},s=()=>{n.set(Zm(()=>a))},r=t.uid.getOrThunk(()=>yu("external"));Dh(t.element,r);const a={uid:r,getSystem:n.get,config:g.none,hasConfigured:ne,connect:o,disconnect:s,getApis:()=>({}),element:t.element,spec:e,readState:O("No state"),syncComponents:Q,components:O([]),events:{}};return tS(a)},$M=yu,IM=e=>wt(e,"uid"),Fh=(e,t)=>nS(e).getOrThunk(()=>{const n=IM(e)?e:{uid:$M(""),...e};return MM(n,t).getOrDie()}),ps=e=>Fh(e,g.none()),Qr=tS;var dS=(e,t,n,o,s)=>e(n,o)?g.some(n):qe(s)&&s(n)?g.none():t(n,o,s);const mS=(e,t,n)=>{let o=e.dom;const s=qe(n)?n:ne;for(;o.parentNode;){o=o.parentNode;const r=te.fromDom(o);if(t(r))return g.some(r);if(s(r))break}return g.none()},gS=(e,t,n)=>dS((s,r)=>r(s),mS,e,t,n),BM=(e,t)=>{const n=s=>t(te.fromDom(s));return lt(e.dom.childNodes,n).map(te.fromDom)},FM=(e,t)=>{const n=o=>{for(let s=0;s<o.childNodes.length;s++){const r=te.fromDom(o.childNodes[s]);if(t(r))return g.some(r);const a=n(o.childNodes[s]);if(a.isSome())return a}return g.none()};return n(e.dom)},pS=(e,t,n)=>gS(e,t,n).isSome(),wi=(e,t,n)=>mS(e,o=>Uo(o,t),n),Ph=(e,t)=>BM(e,n=>Uo(n,t)),fo=(e,t)=>ua(t,e),Wa=(e,t,n)=>dS((s,r)=>Uo(s,r),wi,e,t,n),$d="aria-controls",PM=e=>gS(e,n=>{if(!Co(n))return!1;const o=To(n,"id");return o!==void 0&&o.indexOf($d)>-1}).bind(n=>{const o=To(n,"id"),s=P(n);return fo(s,`[${$d}="${o}"]`)}),hS=()=>{const e=Te($d);return{id:e,link:o=>{Qe(o,$d,e)},unlink:o=>{C(o,$d)}}},RM=(e,t)=>PM(t).exists(n=>Tl(e,n)),Tl=(e,t)=>pS(t,n=>an(n,e.element),ne)||RM(e,t),fS="unknown";var Su;(function(e){e[e.STOP=0]="STOP",e[e.NORMAL=1]="NORMAL",e[e.LOGGING=2]="LOGGING"})(Su||(Su={}));const Rh=Le({}),LM=(e,t)=>{const n=[],o=new Date().getTime();return{logEventCut:(s,r,a)=>{n.push({outcome:"cut",target:r,purpose:a})},logEventStopped:(s,r,a)=>{n.push({outcome:"stopped",target:r,purpose:a})},logNoParent:(s,r,a)=>{n.push({outcome:"no-parent",target:r,purpose:a})},logEventNoHandlers:(s,r)=>{n.push({outcome:"no-handlers-left",target:r})},logEventResponse:(s,r,a)=>{n.push({outcome:"response",purpose:a,target:r})},write:()=>{const s=new Date().getTime();Tt(["mousemove","mouseover","mouseout",Ym()],e)||console.log(e,{event:e,time:s-o,target:t.dom,sequence:ae(n,r=>Tt(["cut","stopped","response"],r.outcome)?"{"+r.purpose+"} "+r.outcome+" at ("+Si(r.target)+")":r.outcome)})}}},NM=(e,t,n)=>{switch(Se(Rh.get(),e).orThunk(()=>{const s=Lt(Rh.get());return on(s,r=>e.indexOf(r)>-1?g.some(Rh.get()[r]):g.none())}).getOr(Su.NORMAL)){case Su.NORMAL:return n(UM());case Su.LOGGING:{const s=LM(e,t),r=n(s);return s.write(),r}case Su.STOP:return!0}},HM=["alloy/data/Fields","alloy/debugging/Debugging"],VM=()=>{const e=new Error;if(e.stack!==void 0){const t=e.stack.split(`
`);return lt(t,n=>n.indexOf("alloy")>0&&!Rn(HM,o=>n.indexOf(o)>-1)).getOr(fS)}else return fS},zM={logEventCut:Q,logEventStopped:Q,logNoParent:Q,logEventNoHandlers:Q,logEventResponse:Q,write:Q},Lh=(e,t,n)=>NM(e,t,n),UM=O(zM),bS=O([J("menu"),J("selectedMenu")]),Nh=O([J("item"),J("selectedItem")]);O(Re(Nh().concat(bS())));const WM=O(Re(Nh())),jM=cc("initSize",[J("numColumns"),J("numRows")]),GM=()=>Qs("markers",WM()),tg=()=>cc("markers",[J("backgroundMenu")].concat(bS()).concat(Nh())),_l=e=>cc("markers",ae(e,J)),ng=(e,t,n)=>(VM(),Po(t,t,n,ml(o=>Me.value((...s)=>o.apply(void 0,s))))),Dt=e=>ng("onHandler",e,Na(Q)),vr=e=>ng("onKeyboardHandler",e,Na(g.none)),Ol=e=>ng("onHandler",e,Ns()),Hh=e=>ng("onKeyboardHandler",e,Ns()),Dn=(e,t)=>ds(e,O(t)),vS=e=>ds(e,Xe),yS=O(jM),ss=(e,t,n,o,s,r,a,c=!1)=>({x:e,y:t,bubble:n,direction:o,placement:s,restriction:r,label:`${a}-${s}`,alwaysFit:c}),Ci=i.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),qM=(e,t,n,o,s,r,a,c,l)=>e.fold(t,n,o,s,r,a,c,l),KM=(e,t,n,o)=>e.fold(t,t,o,o,t,o,n,n),YM=(e,t,n,o)=>e.fold(t,o,t,o,n,n,t,o),og=Ci.southeast,Vh=Ci.southwest,zh=Ci.northeast,Uh=Ci.northwest,SS=Ci.south,xS=Ci.north,wS=Ci.east,CS=Ci.west,xu=(e,t,n,o)=>{const s=e+t;return s>o?n:s<n?o:s},Vr=(e,t,n)=>Math.min(Math.max(e,t),n),XM=(e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},rs=(e,t)=>cr(["left","right","top","bottom"],n=>Se(t,n).map(o=>XM(e,o))),JM=(e,t,n)=>{const o=(l,d)=>t[l].map(p=>{const h=l==="top"||l==="bottom",b=h?n.top:n.left,_=(l==="left"||l==="top"?Math.max:Math.min)(p,d)+b;return h?Vr(_,e.y,e.bottom):Vr(_,e.x,e.right)}).getOr(d),s=o("left",e.x),r=o("top",e.y),a=o("right",e.right),c=o("bottom",e.bottom);return m(s,r,a-s,c-r)},Ti="layout",TS=e=>e.x,_S=(e,t)=>e.x+e.width/2-t.width/2,OS=(e,t)=>e.x+e.width-t.width,Wh=(e,t)=>e.y-t.height,jh=e=>e.y+e.height,kS=(e,t)=>e.y+e.height/2-t.height/2,ZM=e=>e.x+e.width,QM=(e,t)=>e.x-t.width,as=(e,t,n)=>ss(TS(e),jh(e),n.southeast(),og(),"southeast",rs(e,{left:1,top:3}),Ti),cs=(e,t,n)=>ss(OS(e,t),jh(e),n.southwest(),Vh(),"southwest",rs(e,{right:0,top:3}),Ti),sr=(e,t,n)=>ss(TS(e),Wh(e,t),n.northeast(),zh(),"northeast",rs(e,{left:1,bottom:2}),Ti),rr=(e,t,n)=>ss(OS(e,t),Wh(e,t),n.northwest(),Uh(),"northwest",rs(e,{right:0,bottom:2}),Ti),Ss=(e,t,n)=>ss(_S(e,t),Wh(e,t),n.north(),xS(),"north",rs(e,{bottom:2}),Ti),Vo=(e,t,n)=>ss(_S(e,t),jh(e),n.south(),SS(),"south",rs(e,{top:3}),Ti),Gh=(e,t,n)=>ss(ZM(e),kS(e,t),n.east(),wS(),"east",rs(e,{left:0}),Ti),qh=(e,t,n)=>ss(QM(e,t),kS(e,t),n.west(),CS(),"west",rs(e,{right:1}),Ti),ES=()=>[as,cs,sr,rr,Vo,Ss,Gh,qh],AS=()=>[cs,as,rr,sr,Vo,Ss,Gh,qh],DS=()=>[sr,rr,as,cs,Ss,Vo],MS=()=>[rr,sr,cs,as,Ss,Vo],Kh=()=>[as,cs,sr,rr,Vo,Ss],Yh=()=>[cs,as,rr,sr,Vo,Ss],e0=(e,t)=>t.universal?e:Y(e,n=>Tt(t.channels,n));var t0=Object.freeze({__proto__:null,events:e=>On([Z(yl(),(t,n)=>{const o=e.channels,s=Lt(o),r=n,a=e0(s,r);be(a,c=>{const l=o[c],d=l.schema,p=ys("channel["+c+`] data
Receiver: `+Si(t.element),d,r.data);l.onReceive(t,p)})})])}),n0=[Qs("channels",zm(Me.value,pr([Ol("onReceive"),N("schema",Br())])))];const o0=(e,t,n)=>Uc(o=>{n(o,e,t)}),Xh=(e,t,n)=>CD((o,s)=>{n(o,e,t)}),s0=(e,t,n,o,s,r)=>{const a=pr(e),c=tr(t,[Gm("config",e)]);return $S(a,c,t,n,o,s,r)},r0=(e,t,n,o,s,r)=>{const a=e,c=tr(t,[Sa("config",e)]);return $S(a,c,t,n,o,s,r)},a0=(e,t,n)=>LD((s,...r)=>{const a=[s].concat(r);return s.config({name:O(e)}).fold(()=>{throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+n)},c=>{const l=Array.prototype.slice.call(a,1);return t.apply(void 0,[s,c.config,c.state].concat(l))})},n,t),c0=e=>({key:e,value:void 0}),$S=(e,t,n,o,s,r,a)=>{const c=h=>io(h,n)?h[n]():g.none(),l=Ut(s,(h,b)=>a0(n,h,b)),p={...Ut(r,(h,b)=>$h(h,b)),...l,revoke:Et(c0,n),config:h=>{const b=ys(n+"-config",e,h);return{key:n,value:{config:b,me:p,configAsRaw:$r(()=>ys(n+"-config",e,h)),initialConfig:h,state:a}}},schema:O(t),exhibit:(h,b)=>qs(c(h),Se(o,"exhibit"),(S,_)=>_(b,S.config,S.state)).getOrThunk(()=>xa({})),name:O(n),handlers:h=>c(h).map(b=>Se(o,"events").getOr(()=>({}))(b.config,b.state)).getOr({})};return p},ce=e=>xe(e),i0=pr([J("fields"),J("name"),N("active",{}),N("apis",{}),N("state",Ua),N("extra",{})]),qo=e=>{const t=ys("Creating behaviour: "+e.name,i0,e);return s0(t.fields,t.name,t.active,t.apis,t.extra,t.state)},l0=pr([J("branchKey"),J("branches"),J("name"),N("active",{}),N("apis",{}),N("state",Ua),N("extra",{})]),IS=e=>{const t=ys("Creating behaviour: "+e.name,l0,e);return r0(Hs(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},u0=O(void 0),zr=qo({fields:n0,name:"receiving",active:t0});var d0=Object.freeze({__proto__:null,exhibit:(e,t)=>xa({classes:[],styles:t.useFixed()?{}:{position:"relative"}})});const wa=e=>e.dom.focus(),Jh=e=>e.dom.blur(),Id=e=>{const t=P(e).dom;return e.dom===t.activeElement},hc=(e=rl())=>g.from(e.dom.activeElement).map(te.fromDom),ja=e=>hc(P(e)).filter(t=>e.dom.contains(t.dom)),Zh=(e,t)=>{const n=P(t),o=hc(n).bind(r=>{const a=c=>an(r,c);return a(t)?g.some(t):FM(t,a)}),s=e(t);return o.each(r=>{hc(n).filter(a=>an(a,r)).fold(()=>{wa(r)},Q)}),s},Ca=(e,t,n,o,s)=>{const r=a=>a+"px";return{position:e,left:t.map(r),top:n.map(r),right:o.map(r),bottom:s.map(r)}},m0=e=>({...e,position:g.some(e.position)}),BS=(e,t)=>{_o(e,m0(t))},Qh=i.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),FS=(e,t,n,o,s,r)=>{const a=t.rect,c=a.x-n,l=a.y-o,d=a.width,p=a.height,h=s-(c+d),b=r-(l+p),S=g.some(c),_=g.some(l),k=g.some(h),L=g.some(b),R=g.none();return qM(t.direction,()=>Ca(e,S,_,R,R),()=>Ca(e,R,_,k,R),()=>Ca(e,S,R,R,L),()=>Ca(e,R,R,k,L),()=>Ca(e,S,_,R,R),()=>Ca(e,S,R,R,L),()=>Ca(e,S,_,R,R),()=>Ca(e,R,_,k,R))},PS=(e,t)=>e.fold(()=>{const n=t.rect;return Ca("absolute",g.some(n.x),g.some(n.y),g.none(),g.none())},(n,o,s,r)=>FS("absolute",t,n,o,s,r),(n,o,s,r)=>FS("fixed",t,n,o,s,r)),ef=(e,t)=>{const n=Et(Fc,t),o=e.fold(n,n,()=>{const a=Ls();return Fc(t).translate(-a.left,-a.top)}),s=Mr(t),r=Yr(t);return m(o.left,o.top,s,r)},g0=(e,t)=>t.fold(()=>e.fold(oe,oe,m),n=>e.fold(O(n),O(n),()=>{const o=RS(e,n.x,n.y);return m(o.left,o.top,n.width,n.height)})),RS=(e,t,n)=>{const o=Bn(t,n),s=()=>{const r=Ls();return o.translate(-r.left,-r.top)};return e.fold(O(o),O(o),s)},p0=(e,t,n,o)=>e.fold(t,n,o);Qh.none;const h0=Qh.relative,f0=Qh.fixed,b0=(e,t)=>({anchorBox:e,origin:t}),v0=(e,t)=>b0(e,t),tf="data-alloy-placement",y0=(e,t)=>{Qe(e,tf,t)},LS=e=>Go(e,tf),S0=e=>C(e,tf),sg=i.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),x0=(e,t)=>{const{x:n,y:o,right:s,bottom:r}=t,{x:a,y:c,right:l,bottom:d,width:p,height:h}=e,b=a>=n&&a<=s,S=c>=o&&c<=r,_=b&&S,k=l<=s&&l>=n,L=d<=r&&d>=o,R=k&&L,B=Math.min(p,a>=n?s-a:l-n),q=Math.min(h,c>=o?r-c:d-o);return{originInBounds:_,sizeInBounds:R,visibleW:B,visibleH:q}},w0=(e,t)=>{const{x:n,y:o,right:s,bottom:r}=t,{x:a,y:c,width:l,height:d}=e,p=Math.max(n,s-l),h=Math.max(o,r-d),b=Vr(a,n,p),S=Vr(c,o,h),_=Math.min(b+l,s)-b,k=Math.min(S+d,r)-S;return m(b,S,_,k)},C0=(e,t,n)=>{const o=O(t.bottom-n.y),s=O(n.bottom-t.y),r=KM(e,s,s,o),a=O(t.right-n.x),c=O(n.right-t.x);return{maxWidth:YM(e,c,c,a),maxHeight:r}},T0=(e,t,n,o)=>{const s=e.bubble,r=s.offset,a=JM(o,e.restriction,r),c=e.x+r.left,l=e.y+r.top,d=m(c,l,t,n),{originInBounds:p,sizeInBounds:h,visibleW:b,visibleH:S}=x0(d,a),_=p&&h,k=_?d:w0(d,a),L=k.width>0&&k.height>0,{maxWidth:R,maxHeight:B}=C0(e.direction,k,o),q={rect:k,maxHeight:B,maxWidth:R,direction:e.direction,placement:e.placement,classes:{on:s.classesOn,off:s.classesOff},layout:e.label,testY:l};return _||e.alwaysFit?sg.fit(q):sg.nofit(q,b,S,L)},_0=(e,t,n,o,s,r)=>{const a=o.width,c=o.height,l=(p,h,b,S,_)=>{const k=p(n,o,s,e,r),L=T0(k,a,c,r);return L.fold(O(L),(R,B,q,V)=>(_===V?q>S||B>b:!_&&V)?L:sg.nofit(h,b,S,_))};return me(t,(p,h)=>{const b=Et(l,h);return p.fold(O(p),b)},sg.nofit({rect:n,maxHeight:o.height,maxWidth:o.width,direction:og(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:n.y},-1,-1,!1)).fold(Xe,Xe)},nf=e=>{const t=Le(g.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(g.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:c=>{n(),t.set(g.some(c))}}},O0=()=>nf(e=>e.destroy()),wu=()=>nf(e=>e.unbind()),Mn=()=>{const e=nf(Q);return{...e,on:n=>e.get().each(n)}},NS=ge,zs=(e,t,n)=>id(e,t,NS,n),of=(e,t,n)=>el(e,t,NS,n),HS=va,VS=["top","bottom","right","left"],rg="data-alloy-transition-timer",k0=(e,t)=>rS(e,t.classes),E0=(e,t,n)=>n.exists(o=>{const s=e.mode;return s==="all"?!0:o[s]!==t[s]}),A0=(e,t)=>{const n=o=>parseFloat(o).toFixed(3);return pn(t,(o,s)=>{const r=e[s].map(n),a=o.map(n);return!Os(r,a)}).isSome()},D0=e=>{const t=r=>{const c=Un(e,r).split(/\s*,\s*/);return Y(c,_r)},n=r=>{if(Ee(r)&&/^[\d.]+/.test(r)){const a=parseFloat(r);return xo(r,"ms")?a:a*1e3}else return 0},o=t("transition-delay"),s=t("transition-duration");return me(s,(r,a,c)=>{const l=n(o[c])+n(a);return Math.max(r,l)},0)},M0=(e,t)=>{const n=wu(),o=wu();let s;const r=d=>{var p;const h=(p=d.raw.pseudoElement)!==null&&p!==void 0?p:"";return an(d.target,e)&&M(h)&&Tt(VS,d.raw.propertyName)},a=d=>{if(Ge(d)||r(d)){n.clear(),o.clear();const p=d==null?void 0:d.raw.type;(Ge(p)||p===kd())&&(clearTimeout(s),C(e,rg),Hr(e,t.classes))}},c=zs(e,mD(),d=>{r(d)&&(c.unbind(),n.set(zs(e,kd(),a)),o.set(zs(e,dD(),a)))}),l=D0(e);requestAnimationFrame(()=>{s=setTimeout(a,l+17),Qe(e,rg,s)})},$0=(e,t)=>{gc(e,t.classes),Go(e,rg).each(n=>{clearTimeout(parseInt(n,10)),C(e,rg)}),M0(e,t)},I0=(e,t,n,o,s,r)=>{const a=E0(o,s,r);if(a||k0(e,o)){pe(e,"position",n.position);const c=ef(t,e),l=PS(t,{...s,rect:c}),d=cr(VS,p=>l[p]);A0(n,d)&&(_o(e,d),a&&$0(e,o),pa(e))}else Hr(e,o.classes)},B0=e=>({width:Mr(e),height:Yr(e)}),F0=(e,t,n,o)=>{Qt(t,"max-height"),Qt(t,"max-width");const s=B0(t);return _0(t,o.preference,e,s,n,o.bounds)},P0=(e,t)=>{const n=t.classes;Hr(e,n.off),gc(e,n.on)},R0=(e,t,n)=>{const o=n.maxHeightFunction;o(e,t.maxHeight)},L0=(e,t,n)=>{const o=n.maxWidthFunction;o(e,t.maxWidth)},N0=(e,t,n)=>{const o=PS(n.origin,t);n.transition.each(s=>{I0(e,n.origin,o,s,t,n.lastPlacement)}),BS(e,o)},H0=(e,t)=>{y0(e,t.placement)},zS=(e,t)=>{km(e,Math.floor(t))},V0=O((e,t)=>{zS(e,t),dn(e,{"overflow-x":"hidden","overflow-y":"auto"})}),Cu=O((e,t)=>{zS(e,t)}),US=(e,t,n)=>e[t]===void 0?n:e[t],z0=(e,t,n,o,s,r,a,c)=>{const l=US(a,"maxHeightFunction",V0()),d=US(a,"maxWidthFunction",Q),p=e.anchorBox,h=e.origin,b={bounds:g0(h,r),origin:h,preference:o,maxHeightFunction:l,maxWidthFunction:d,lastPlacement:s,transition:c};return U0(p,t,n,b)},U0=(e,t,n,o)=>{const s=F0(e,t,n,o);return N0(t,s,o),H0(t,s),P0(t,s),R0(t,s,o),L0(t,s,o),{layout:s.layout,placement:s.placement}},W0=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Wc=(e,t,n,o=1)=>{const s=e*o,r=t*o,a=l=>Se(n,l).getOr([]),c=(l,d,p)=>{const h=Qo(W0,p);return{offset:Bn(l,d),classesOn:At(p,a),classesOff:At(h,a)}};return{southeast:()=>c(-e,t,["top","alignLeft"]),southwest:()=>c(e,t,["top","alignRight"]),south:()=>c(-e/2,t,["top","alignCentre"]),northeast:()=>c(-e,-t,["bottom","alignLeft"]),northwest:()=>c(e,-t,["bottom","alignRight"]),north:()=>c(-e/2,-t,["bottom","alignCentre"]),east:()=>c(e,-t/2,["valignCentre","left"]),west:()=>c(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>c(s,r,["top","alignLeft","inset"]),insetNorthwest:()=>c(-s,r,["top","alignRight","inset"]),insetNorth:()=>c(-s/2,r,["top","alignCentre","inset"]),insetSoutheast:()=>c(s,-r,["bottom","alignLeft","inset"]),insetSouthwest:()=>c(-s,-r,["bottom","alignRight","inset"]),insetSouth:()=>c(-s/2,-r,["bottom","alignCentre","inset"]),insetEast:()=>c(-s,-r/2,["valignCentre","right","inset"]),insetWest:()=>c(s,-r/2,["valignCentre","left","inset"])}},ag=()=>Wc(0,0,{}),cg=Xe,sf=(e,t)=>n=>j0(n)==="rtl"?t:e,j0=e=>Un(e,"direction")==="rtl"?"rtl":"ltr";var jc;(function(e){e.TopToBottom="toptobottom",e.BottomToTop="bottomtotop"})(jc||(jc={}));const rf="data-alloy-vertical-dir",G0=e=>pS(e,t=>Co(t)&&To(t,"data-alloy-vertical-dir")===jc.BottomToTop),_i=()=>tr("layouts",[J("onLtr"),J("onRtl"),Wt("onBottomLtr"),Wt("onBottomRtl")]),ig=(e,t,n,o,s,r,a)=>{const c=a.map(G0).getOr(!1),l=t.layouts.map(S=>S.onLtr(e)),d=t.layouts.map(S=>S.onRtl(e)),p=c?t.layouts.bind(S=>S.onBottomLtr.map(_=>_(e))).or(l).getOr(s):l.getOr(n),h=c?t.layouts.bind(S=>S.onBottomRtl.map(_=>_(e))).or(d).getOr(r):d.getOr(o);return sf(p,h)(e)},q0=(e,t,n)=>{const o=t.hotspot,s=ef(n,o.element),r=ig(e.element,t,Kh(),Yh(),DS(),MS(),g.some(t.hotspot.element));return g.some(cg({anchorBox:s,bubble:t.bubble.getOr(ag()),overrides:t.overrides,layouts:r}))};var K0=[J("hotspot"),Wt("bubble"),N("overrides",{}),_i(),Dn("placement",q0)];const Y0=(e,t,n)=>{const o=RS(n,t.x,t.y),s=m(o.left,o.top,t.width,t.height),r=ig(e.element,t,ES(),AS(),ES(),AS(),g.none());return g.some(cg({anchorBox:s,bubble:t.bubble,overrides:t.overrides,layouts:r}))};var X0=[J("x"),J("y"),N("height",0),N("width",0),N("bubble",ag()),N("overrides",{}),_i(),Dn("placement",Y0)];const WS=i.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),J0=e=>e.fold(Xe,(t,n,o)=>t.translate(-n,-o)),Z0=e=>e.fold(Xe,Xe),jS=e=>me(e,(t,n)=>t.translate(n.left,n.top),Bn(0,0)),Q0=e=>{const t=ae(e,J0);return jS(t)},GS=e=>{const t=ae(e,Z0);return jS(t)},e$=WS.screen,t$=WS.absolute,n$=(e,t,n)=>{const o=us(n.root).dom,s=r=>{const a=ns(r),c=ns(e.element);return an(a,c)};return g.from(o.frameElement).map(te.fromDom).filter(s).map(Rs)},qS=(e,t,n)=>{const o=ns(e.element),s=Ls(o),r=n$(e,t,n).getOr(s);return t$(r,s.left,s.top)},af=(e,t,n,o)=>{const s=e$(Bn(e,t));return g.some(pd(s,n,o))},KS=(e,t,n,o,s)=>e.map(r=>{const a=[t,r.point],c=p0(o,()=>GS(a),()=>GS(a),()=>Q0(a)),l=cl(c.left,c.top,r.width,r.height),d=n.showAbove?DS():Kh(),p=n.showAbove?MS():Yh(),h=ig(s,n,d,p,d,p,g.none());return cg({anchorBox:l,bubble:n.bubble.getOr(ag()),overrides:n.overrides,layouts:h})}),o$=(e,t,n)=>{const o=qS(e,n,t);return t.node.filter(Zt).bind(s=>{const r=s.dom.getBoundingClientRect(),a=af(r.left,r.top,r.width,r.height),c=t.node.getOr(e.element);return KS(a,o,t,n,c)})};var s$=[J("node"),J("root"),Wt("bubble"),_i(),N("overrides",{}),N("showAbove",!1),Dn("placement",o$)];const r$="\uFEFF",a$="",cf={create:(e,t,n,o)=>({start:e,soffset:t,finish:n,foffset:o})},lf=i.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),c$=(e,t,n,o)=>e.fold(t,n,o),i$=e=>e.fold(Xe,Xe,Xe),l$=lf.before,u$=lf.on,d$=lf.after,m$={before:l$,on:u$,after:d$,cata:c$,getStart:i$},lg=i.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),g$=e=>lg.exact(e.start,e.soffset,e.finish,e.foffset),p$=e=>e.match({domRange:t=>te.fromDom(t.startContainer),relative:(t,n)=>m$.getStart(t),exact:(t,n,o,s)=>t}),h$=lg.domRange,f$=lg.relative,b$=lg.exact,v$=e=>{const t=p$(e);return us(t)},y$=cf.create,Bd={domRange:h$,relative:f$,exact:b$,exactFromRange:g$,getWin:v$,range:y$},S$=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,o)=>{e.setStart(n.dom,o)},n=>{e.setStartAfter(n.dom)})},x$=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,o)=>{e.setEnd(n.dom,o)},n=>{e.setEndAfter(n.dom)})},YS=(e,t,n)=>{const o=e.document.createRange();return S$(o,t),x$(o,n),o},XS=(e,t,n,o,s)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(o.dom,s),r},JS=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),w$=e=>{const t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?g.some(n).map(JS):g.none()},C$=e=>{const t=e.getBoundingClientRect();return t.width>0||t.height>0?g.some(t).map(JS):g.none()},Fd=i.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ZS=(e,t,n)=>t(te.fromDom(n.startContainer),n.startOffset,te.fromDom(n.endContainer),n.endOffset),T$=(e,t)=>t.match({domRange:n=>({ltr:O(n),rtl:g.none}),relative:(n,o)=>({ltr:$r(()=>YS(e,n,o)),rtl:$r(()=>g.some(YS(e,o,n)))}),exact:(n,o,s,r)=>({ltr:$r(()=>XS(e,n,o,s,r)),rtl:$r(()=>g.some(XS(e,s,r,n,o)))})}),_$=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(s=>s.collapsed===!1).map(s=>Fd.rtl(te.fromDom(s.endContainer),s.endOffset,te.fromDom(s.startContainer),s.startOffset)).getOrThunk(()=>ZS(e,Fd.ltr,n)):ZS(e,Fd.ltr,n)},O$=(e,t)=>{const n=T$(e,t);return _$(e,n)},QS=(e,t)=>O$(e,t).match({ltr:(o,s,r,a)=>{const c=e.document.createRange();return c.setStart(o.dom,s),c.setEnd(r.dom,a),c},rtl:(o,s,r,a)=>{const c=e.document.createRange();return c.setStart(r.dom,a),c.setEnd(o.dom,s),c}});Fd.ltr,Fd.rtl;const ex=(e,t,n)=>Y(ni(e,n),t),Us=(e,t)=>Ec(t,e),k$=(e,t,n,o)=>{const r=ns(e).dom.createRange();return r.setStart(e.dom,t),r.setEnd(n.dom,o),r},E$=(e,t,n,o)=>{const s=k$(e,t,n,o),r=an(e,n)&&t===o;return s.collapsed&&!r},A$=e=>g.from(e.getSelection()),tx=e=>{if(e.rangeCount>0){const t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return g.some(cf.create(te.fromDom(t.startContainer),t.startOffset,te.fromDom(n.endContainer),n.endOffset))}else return g.none()},D$=e=>{if(e.anchorNode===null||e.focusNode===null)return tx(e);{const t=te.fromDom(e.anchorNode),n=te.fromDom(e.focusNode);return E$(t,e.anchorOffset,n,e.focusOffset)?g.some(cf.create(t,e.anchorOffset,n,e.focusOffset)):tx(e)}},M$=e=>A$(e).filter(t=>t.rangeCount>0).bind(D$),nx=(e,t)=>{const n=QS(e,t);return w$(n)},$$=(e,t)=>{const n=QS(e,t);return C$(n)},I$=((e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return o(r).getOr("")},o=r=>e(r)?g.from(r.dom.nodeValue):g.none();return{get:n,getOption:o,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}})(Xs,"text"),B$=e=>I$.get(e),ug=(e,t)=>({element:e,offset:t}),F$=(e,t)=>{const n=jo(e);if(n.length===0)return ug(e,t);if(t<n.length)return ug(n[t],0);{const o=n[n.length-1],s=Xs(o)?B$(o).length:jo(o).length;return ug(o,s)}},ox=(e,t)=>Xs(e)?ug(e,t):F$(e,t),uf=e=>e.foffset!==void 0,sx=(e,t)=>t.getSelection.getOrThunk(()=>()=>M$(e))().map(o=>{if(uf(o)){const s=ox(o.start,o.soffset),r=ox(o.finish,o.foffset);return Bd.range(s.element,s.offset,r.element,r.offset)}else return o}),P$=(e,t,n)=>{const o=us(t.root).dom,s=qS(e,n,t),r=sx(o,t).bind(l=>{if(uf(l))return $$(o,Bd.exactFromRange(l)).orThunk(()=>{const p=te.fromText(r$);hi(l.start,p);const h=nx(o,Bd.exact(p,0,p,1));return gr(p),h}).bind(p=>af(p.left,p.top,p.width,p.height));{const d=Ut(l,h=>h.dom.getBoundingClientRect()),p={left:Math.min(d.firstCell.left,d.lastCell.left),right:Math.max(d.firstCell.right,d.lastCell.right),top:Math.min(d.firstCell.top,d.lastCell.top),bottom:Math.max(d.firstCell.bottom,d.lastCell.bottom)};return af(p.left,p.top,p.right-p.left,p.bottom-p.top)}}),c=sx(o,t).bind(l=>uf(l)?Co(l.start)?g.some(l.start):Is(l.start):g.some(l.firstCell)).getOr(e.element);return KS(r,s,t,n,c)};var R$=[Wt("getSelection"),J("root"),Wt("bubble"),_i(),N("overrides",{}),N("showAbove",!1),Dn("placement",P$)];const dg="link-layout",rx=e=>e.x+e.width,ax=(e,t)=>e.x-t.width,cx=(e,t)=>e.y-t.height+e.height,ix=e=>e.y,lx=(e,t,n)=>ss(rx(e),ix(e),n.southeast(),og(),"southeast",rs(e,{left:0,top:2}),dg),ux=(e,t,n)=>ss(ax(e,t),ix(e),n.southwest(),Vh(),"southwest",rs(e,{right:1,top:2}),dg),dx=(e,t,n)=>ss(rx(e),cx(e,t),n.northeast(),zh(),"northeast",rs(e,{left:0,bottom:3}),dg),mx=(e,t,n)=>ss(ax(e,t),cx(e,t),n.northwest(),Uh(),"northwest",rs(e,{right:1,bottom:3}),dg),gx=()=>[lx,ux,dx,mx],px=()=>[ux,lx,mx,dx],L$=(e,t,n)=>{const o=ef(n,t.item.element),s=ig(e.element,t,gx(),px(),gx(),px(),g.none());return g.some(cg({anchorBox:o,bubble:ag(),overrides:t.overrides,layouts:s}))};var N$=[J("item"),_i(),N("overrides",{}),Dn("placement",L$)],H$=Hs("type",{selection:R$,node:s$,hotspot:K0,submenu:N$,makeshift:X0});const V$=[er("classes",Fo),br("mode","all",["all","layout","placement"])],z$=[N("useFixed",ne),Wt("getBounds")],U$=[Qs("anchor",H$),tr("transition",V$)],W$=()=>{const e=document.documentElement;return f0(0,0,e.clientWidth,e.clientHeight)},j$=e=>{const t=Rs(e.element),n=e.element.dom.getBoundingClientRect();return h0(t.left,t.top,n.width,n.height)},G$=(e,t,n,o,s,r)=>{const a=v0(t.anchorBox,e);return z0(a,o.element,t.bubble,t.layouts,s,n,t.overrides,r)},q$=(e,t,n,o,s)=>{const r=g.none();hx(e,t,n,o,s,r)},hx=(e,t,n,o,s,r)=>{const a=ys("placement.info",Re(U$),s),c=a.anchor,l=o.element,d=n.get(o.uid);Zh(()=>{pe(l,"position","fixed");const p=xn(l,"visibility");pe(l,"visibility","hidden");const h=t.useFixed()?W$():j$(e);c.placement(e,c,h).each(b=>{const S=r.orThunk(()=>t.getBounds.map(Yn)),_=G$(h,b,S,o,d,a.transition);n.set(o.uid,_)}),p.fold(()=>{Qt(l,"visibility")},b=>{pe(l,"visibility",b)}),xn(l,"left").isNone()&&xn(l,"top").isNone()&&xn(l,"right").isNone()&&xn(l,"bottom").isNone()&&Io(xn(l,"position"),"fixed")&&Qt(l,"position")},l)};var K$=Object.freeze({__proto__:null,position:q$,positionWithinBounds:hx,getMode:(e,t,n)=>t.useFixed()?"fixed":"absolute",reset:(e,t,n,o)=>{const s=o.element;be(["position","left","right","top","bottom"],r=>Qt(s,r)),S0(s),n.clear(o.uid)}}),Y$=Object.freeze({__proto__:null,init:()=>{let e={};return Nr({readState:()=>e,clear:s=>{Ye(s)?delete e[s]:e={}},set:(s,r)=>{e[s]=r},get:s=>Se(e,s)})}});const xs=qo({fields:z$,name:"positioning",active:d0,apis:K$,state:Y$}),df=e=>e.getSystem().isConnected(),Pd=e=>{jt(e,hu());const t=e.components();be(t,Pd)},Rd=e=>{const t=e.components();be(t,Rd),jt(e,dc())},fx=(e,t)=>{e.getSystem().addToWorld(t),Zt(e.element)&&Rd(t)},mf=e=>{Pd(e),e.getSystem().removeFromWorld(e)},bx=(e,t)=>{Zs(e.element,t.element)},X$=e=>{be(e.components(),t=>gr(t.element)),nl(e.element),e.syncComponents()},J$=(e,t,n)=>{const o=e.components();X$(e);const s=n(t),r=Qo(o,s);be(r,a=>{Pd(a),e.getSystem().removeFromWorld(a)}),be(s,a=>{df(a)?bx(e,a):(e.getSystem().addToWorld(a),bx(e,a),Zt(e.element)&&Rd(a))}),e.syncComponents()},Z$=(e,t,n)=>{const o=e.components(),s=At(t,c=>nS(c).toArray());be(o,c=>{Tt(s,c)||mf(c)});const r=n(t),a=Qo(o,r);be(a,c=>{df(c)&&mf(c)}),be(r,c=>{df(c)||fx(e,c)}),e.syncComponents()},kl=(e,t)=>{vx(e,t,Zs)},vx=(e,t,n)=>{e.getSystem().addToWorld(t),n(e.element,t.element),Zt(e.element)&&Rd(t),e.syncComponents()},yx=e=>{Pd(e),gr(e.element),e.getSystem().removeFromWorld(e)},Gc=e=>{const t=Wo(e.element).bind(n=>e.getSystem().getByDom(n).toOptional());yx(e),t.each(n=>{n.syncComponents()})},Sx=e=>{const t=e.components();be(t,yx),nl(e.element),e.syncComponents()},gf=(e,t)=>{xx(e,t,Zs)},mg=(e,t)=>{xx(e,t,su)},xx=(e,t,n)=>{n(e,t.element);const o=jo(t.element);be(o,s=>{t.getByDom(s).each(Rd)})},Q$=e=>{const t=jo(e.element);be(t,n=>{e.getByDom(n).each(Pd)}),gr(e.element)},wx=(e,t,n,o)=>{n.get().each(a=>{Sx(e)});const s=t.getAttachPoint(e);kl(s,e);const r=e.getSystem().build(o);return kl(e,r),n.set(r),r},Cx=(e,t,n,o)=>{const s=wx(e,t,n,o);return t.onOpen(e,s),s},eI=(e,t,n,o)=>n.get().map(()=>wx(e,t,n,o)),tI=(e,t,n,o,s)=>{Ox(e,t),Cx(e,t,n,o),s(),kx(e,t)},Tx=(e,t,n)=>{n.get().each(o=>{Sx(e),Gc(e),t.onClose(e,o),n.clear()})},_x=(e,t,n)=>n.isOpen(),nI=(e,t,n,o)=>_x(e,t,n)&&n.get().exists(s=>t.isPartOf(e,s,o)),oI=(e,t,n)=>n.get(),sI=(e,t,n,o)=>{xn(e.element,t).fold(()=>{C(e.element,n)},s=>{Qe(e.element,n,s)}),pe(e.element,t,o)},rI=(e,t,n)=>{Go(e.element,n).fold(()=>Qt(e.element,t),o=>pe(e.element,t,o))},Ox=(e,t,n)=>{const o=t.getAttachPoint(e);pe(e.element,"position",xs.getMode(o)),sI(e,"visibility",t.cloakVisibilityAttr,"hidden")},aI=e=>Rn(["top","left","right","bottom"],t=>xn(e,t).isSome()),kx=(e,t,n)=>{aI(e.element)||Qt(e.element,"position"),rI(e,"visibility",t.cloakVisibilityAttr)};var cI=Object.freeze({__proto__:null,cloak:Ox,decloak:kx,open:Cx,openWhileCloaked:tI,close:Tx,isOpen:_x,isPartOf:nI,getState:oI,setContent:eI}),iI=Object.freeze({__proto__:null,events:(e,t)=>On([Z(Km(),(n,o)=>{Tx(n,e,t)})])}),lI=[Dt("onOpen"),Dt("onClose"),J("isPartOf"),J("getAttachPoint"),N("cloakVisibilityAttr","data-precloak-visibility")],uI=Object.freeze({__proto__:null,init:()=>{const e=Mn(),t=O("not-implemented");return Nr({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})}});const Mt=qo({fields:lI,name:"sandboxing",active:iI,apis:cI,state:uI}),Oi=O("dismiss.popups"),Tu=O("reposition.popups"),pf=O("mouse.released"),dI=pr([N("isExtraPart",ne),tr("fireEventInstead",[N("event",Sl())])]),hf=e=>{const t=ys("Dismissal",dI,e);return{[Oi()]:{schema:pr([J("target")]),onReceive:(n,o)=>{Mt.isOpen(n)&&(Mt.isPartOf(n,o.target)||t.isExtraPart(n,o.target)||t.fireEventInstead.fold(()=>Mt.close(n),r=>jt(n,r.event)))}}}},mI=pr([tr("fireEventInstead",[N("event",Wy())]),hr("doReposition")]),ff=e=>{const t=ys("Reposition",mI,e);return{[Tu()]:{onReceive:n=>{Mt.isOpen(n)&&t.fireEventInstead.fold(()=>t.doReposition(n),o=>jt(n,o.event))}}}},bf=(e,t,n)=>{t.store.manager.onLoad(e,t,n)},Ex=(e,t,n)=>{t.store.manager.onUnload(e,t,n)};var gI=Object.freeze({__proto__:null,onLoad:bf,onUnload:Ex,setValue:(e,t,n,o)=>{t.store.manager.setValue(e,t,n,o)},getValue:(e,t,n)=>t.store.manager.getValue(e,t,n),getState:(e,t,n)=>n}),pI=Object.freeze({__proto__:null,events:(e,t)=>{const n=e.resetOnDom?[Pn((o,s)=>{bf(o,e,t)}),mc((o,s)=>{Ex(o,e,t)})]:[Xh(e,t,bf)];return On(n)}});const Ax=()=>{const e=Le(null),t=()=>({mode:"memory",value:e.get()}),n=()=>e.get()===null,o=()=>{e.set(null)};return Nr({set:e.set,get:e.get,isNotSet:n,clear:o,readState:t})},hI=()=>Nr({readState:Q}),Dx=()=>{const e=Le({}),t=Le({});return Nr({readState:()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),lookup:a=>Se(e.get(),a).orThunk(()=>Se(t.get(),a)),update:a=>{const c=e.get(),l=t.get(),d={},p={};be(a,h=>{d[h.value]=h,Se(h,"meta").each(b=>{Se(b,"text").each(S=>{p[S]=h})})}),e.set({...c,...d}),t.set({...l,...p})},clear:()=>{e.set({}),t.set({})}})};var fI=Object.freeze({__proto__:null,memory:Ax,dataset:Dx,manual:hI,init:e=>e.store.manager.state(e)});const Mx=(e,t,n,o)=>{const s=t.store;n.update([o]),s.setValue(e,o),t.onSetValue(e,o)},bI=(e,t,n)=>{const o=t.store,s=o.getDataKey(e);return n.lookup(s).getOrThunk(()=>o.getFallbackEntry(s))},vI=(e,t,n)=>{t.store.initialValue.each(s=>{Mx(e,t,n,s)})},yI=(e,t,n)=>{n.clear()};var SI=[Wt("initialValue"),J("getFallbackEntry"),J("getDataKey"),J("setValue"),Dn("manager",{setValue:Mx,getValue:bI,onLoad:vI,onUnload:yI,state:Dx})];const xI=(e,t,n)=>t.store.getValue(e),wI=(e,t,n,o)=>{t.store.setValue(e,o),t.onSetValue(e,o)},CI=(e,t,n)=>{t.store.initialValue.each(o=>{t.store.setValue(e,o)})};var TI=[J("getValue"),N("setValue",Q),Wt("initialValue"),Dn("manager",{setValue:wI,getValue:xI,onLoad:CI,onUnload:Q,state:Ua.init})];const _I=(e,t,n,o)=>{n.set(o),t.onSetValue(e,o)},OI=(e,t,n)=>n.get(),kI=(e,t,n)=>{t.store.initialValue.each(o=>{n.isNotSet()&&n.set(o)})},EI=(e,t,n)=>{n.clear()};var AI=[Wt("initialValue"),Dn("manager",{setValue:_I,getValue:OI,onLoad:kI,onUnload:EI,state:Ax})],DI=[fr("store",{mode:"memory"},Hs("mode",{memory:AI,manual:TI,dataset:SI})),Dt("onSetValue"),N("resetOnDom",!1)];const ye=qo({fields:DI,name:"representing",active:pI,apis:gI,extra:{setValueFrom:(e,t)=>{const n=ye.getValue(t);ye.setValue(e,n)}},state:fI}),zo=(e,t)=>_d(e,{},ae(t,n=>bh(n.name(),"Cannot configure "+n.name()+" for "+e)).concat([ds("dump",Xe)])),gg=e=>e.dump,Ko=(e,t)=>({...ce(t),...e.dump}),Ta={field:zo,augment:Ko,get:gg},$x="placeholder",pg=i.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),vf=e=>wt(e,"uiType"),MI=(e,t,n,o)=>e.exists(s=>s!==n.owner)?pg.single(!0,O(n)):Se(o,n.name).fold(()=>{throw new Error("Unknown placeholder component: "+n.name+`
Known: [`+Lt(o)+`]
Namespace: `+e.getOr("none")+`
Spec: `+JSON.stringify(n,null,2))},s=>s.replace()),$I=(e,t,n,o)=>vf(n)&&n.uiType===$x?MI(e,t,n,o):pg.single(!1,O(n)),Ix=(e,t,n,o)=>$I(e,t,n,o).fold((r,a)=>{const c=vf(n)?a(t,n.config,n.validated):a(t),l=Se(c,"components").getOr([]),d=At(l,p=>Ix(e,t,p,o));return[{...c,components:d}]},(r,a)=>{if(vf(n)){const c=a(t,n.config,n.validated);return n.validated.preprocess.getOr(Xe)(c)}else return a(t)}),II=(e,t,n,o)=>At(n,s=>Ix(e,t,s,o)),BI=(e,t)=>{let n=!1;const o=()=>n,s=()=>{if(n)throw new Error("Trying to use the same placeholder more than once: "+e);return n=!0,t},r=()=>t.fold((a,c)=>a,(a,c)=>a);return{name:O(e),required:r,used:o,replace:s}},FI=(e,t,n,o)=>{const s=Ut(o,(a,c)=>BI(c,a)),r=II(e,t,n,s);return un(s,a=>{if(a.used()===!1&&a.required())throw new Error("Placeholder: "+a.name()+` was not found in components list
Namespace: `+e.getOr("none")+`
Components: `+JSON.stringify(t.components,null,2))}),r},Bx=pg.single,PI=pg.multiple,Fx=O($x),hg=i.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),fg=N("factory",{sketch:Xe}),yf=N("schema",[]),bg=J("name"),Sf=Po("pname","pname",ya(e=>"<alloy."+Te(e.name)+">"),Br()),RI=ds("schema",()=>[Wt("preprocess")]),vg=N("defaults",O({})),yg=N("overrides",O({})),LI=Re([fg,yf,bg,Sf,vg,yg]),NI=Re([fg,yf,bg,vg,yg]),HI=Re([fg,yf,bg,Sf,vg,yg]),VI=Re([fg,RI,bg,J("unit"),Sf,vg,yg]),Px=e=>e.fold(g.some,g.none,g.some,g.some),Rx=e=>{const t=n=>n.name;return e.fold(t,t,t,t)},zI=e=>e.fold(Xe,Xe,Xe,Xe),Sg=(e,t)=>n=>{const o=ys("Converting part type",t,n);return e(o)},hs=Sg(hg.required,LI),_a=Sg(hg.external,NI),ea=Sg(hg.optional,HI),xg=Sg(hg.group,VI),xf=O("entirety");var UI=Object.freeze({__proto__:null,required:hs,external:_a,optional:ea,group:xg,asNamedPart:Px,name:Rx,asCommon:zI,original:xf});const wf=(e,t,n,o)=>Wn(t.defaults(e,n,o),n,{uid:e.partUids[t.name]},t.overrides(e,n,o)),WI=(e,t,n)=>{const o={},s={};return be(n,r=>{r.fold(a=>{o[a.pname]=Bx(!0,(c,l,d)=>a.factory.sketch(wf(c,a,l,d)))},a=>{const c=t.parts[a.name];s[a.name]=O(a.factory.sketch(wf(t,a,c[xf()]),c))},a=>{o[a.pname]=Bx(!1,(c,l,d)=>a.factory.sketch(wf(c,a,l,d)))},a=>{o[a.pname]=PI(!0,(c,l,d)=>{const p=c[a.name];return ae(p,h=>a.factory.sketch(Wn(a.defaults(c,h,d),h,a.overrides(c,h))))})})}),{internals:O(o),externals:O(s)}},Cf=(e,t)=>{const n={};return be(t,o=>{Px(o).each(s=>{const r=jI(e,s.pname);n[s.name]=a=>{const c=ys("Part: "+s.name+" in "+e,Re(s.schema),a);return{...r,config:a,validated:c}}})}),n},jI=(e,t)=>({uiType:Fx(),owner:e,name:t}),Tf=(e,t,n)=>({uiType:Fx(),owner:e,name:t,config:n,validated:{}}),Lx=e=>At(e,t=>t.fold(g.none,g.some,g.none,g.none).map(n=>cc(n.name,n.schema.concat([vS(xf())]))).toArray()),Nx=e=>ae(e,Rx),_f=(e,t,n)=>WI(e,t,n),Of=(e,t,n)=>FI(g.some(e),t,t.components,n),vn=(e,t,n)=>{const o=t.partUids[n];return e.getSystem().getByUid(o).toOptional()},ki=(e,t,n)=>vn(e,t,n).getOrDie("Could not find part: "+n),Hx=(e,t,n)=>{const o={},s=t.partUids,r=e.getSystem();return be(n,a=>{o[a]=O(r.getByUid(s[a]))}),o},Vx=(e,t)=>{const n=e.getSystem();return Ut(t.partUids,(o,s)=>O(n.getByUid(o)))},zx=e=>Lt(e.partUids),kf=(e,t,n)=>{const o={},s=t.partUids,r=e.getSystem();return be(n,a=>{o[a]=O(r.getByUid(s[a]).getOrDie())}),o},Ux=(e,t)=>{const n=Nx(t);return xe(ae(n,o=>({key:o,value:e+"-"+o})))},Ef=e=>Po("partUids","partUids",Rc(t=>Ux(t.uid,e)),Br());var GI=Object.freeze({__proto__:null,generate:Cf,generateOne:Tf,schemas:Lx,names:Nx,substitutes:_f,components:Of,defaultUids:Ux,defaultUidsSchema:Ef,getAllParts:Vx,getAllPartNames:zx,getPart:vn,getPartOrDie:ki,getParts:Hx,getPartsOrDie:kf});const qI=(e,t)=>(e.length>0?[cc("parts",e)]:[]).concat([J("uid"),N("dom",{}),N("components",[]),vS("originalSpec"),N("debug.sketcher",{})]).concat(t),Wx=(e,t,n,o,s)=>{const r=qI(o,s);return ys(e+" [SpecSchema]",pr(r.concat(t)),n)},KI=(e,t,n,o)=>{const s=jx(o),r=Wx(e,t,s,[],[]);return n(r,s)},Af=(e,t,n,o,s)=>{const r=jx(s),a=Lx(n),c=Ef(n),l=Wx(e,t,r,a,[c]),d=_f(e,l,n),p=Of(e,l,d.internals());return o(l,p,r,d.externals())},YI=e=>wt(e,"uid"),jx=e=>YI(e)?e:{...e,uid:yu("uid")},XI=e=>e.uid!==void 0,JI=pr([J("name"),J("factory"),J("configFields"),N("apis",{}),N("extraApis",{})]),ZI=pr([J("name"),J("factory"),J("configFields"),J("partFields"),N("apis",{}),N("extraApis",{})]),Ur=e=>{const t=ys("Sketcher for "+e.name,JI,e),n=r=>KI(t.name,t.configFields,t.factory,r),o=Ut(t.apis,eg),s=Ut(t.extraApis,(r,a)=>$h(r,a));return{name:t.name,configFields:t.configFields,sketch:n,...o,...s}},ws=e=>{const t=ys("Sketcher for "+e.name,ZI,e),n=a=>Af(t.name,t.configFields,t.partFields,t.factory,a),o=Cf(t.name,t.partFields),s=Ut(t.apis,eg),r=Ut(t.extraApis,(a,c)=>$h(a,c));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:n,parts:o,...s,...r}},_u=e=>Ar("input")(e)&&To(e,"type")!=="radio"||Ar("textarea")(e);var QI=Object.freeze({__proto__:null,getCurrent:(e,t,n)=>t.find(e)});const e1=[J("find")],Ot=qo({fields:e1,name:"composing",apis:QI}),t1=["input","button","textarea","select"],Gx=(e,t,n)=>{(t.disabled()?Mf:$f)(e,t)},Df=(e,t)=>t.useNative===!0&&Tt(t1,Bo(e.element)),n1=e=>v(e.element,"disabled"),o1=e=>{Qe(e.element,"disabled","disabled")},s1=e=>{C(e.element,"disabled")},r1=e=>To(e.element,"aria-disabled")==="true",a1=e=>{Qe(e.element,"aria-disabled","true")},c1=e=>{Qe(e.element,"aria-disabled","false")},Mf=(e,t,n)=>{t.disableClass.each(s=>{vo(e.element,s)}),(Df(e,t)?o1:a1)(e),t.onDisabled(e)},$f=(e,t,n)=>{t.disableClass.each(s=>{so(e.element,s)}),(Df(e,t)?s1:c1)(e),t.onEnabled(e)},qx=(e,t)=>Df(e,t)?n1(e):r1(e);var i1=Object.freeze({__proto__:null,enable:$f,disable:Mf,isDisabled:qx,onLoad:Gx,set:(e,t,n,o)=>{(o?Mf:$f)(e,t)}}),l1=Object.freeze({__proto__:null,exhibit:(e,t)=>xa({classes:t.disabled()?t.disableClass.toArray():[]}),events:(e,t)=>On([Jy(Lr(),(n,o)=>qx(n,e)),Xh(e,t,Gx)])}),u1=[ko("disabled",ne),N("useNative",!0),Wt("disableClass"),Dt("onDisabled"),Dt("onEnabled")];const Ne=qo({fields:u1,name:"disabling",active:l1,apis:i1}),Kx=(e,t,n,o)=>{const s=Us(e.element,"."+t.highlightClass);be(s,r=>{Rn(o,c=>an(c.element,r))||(so(r,t.highlightClass),e.getSystem().getByDom(r).each(c=>{t.onDehighlight(e,c),jt(c,Th())}))})},d1=(e,t,n)=>Kx(e,t,n,[]),m1=(e,t,n,o)=>{If(e,t,n,o)&&(so(o.element,t.highlightClass),t.onDehighlight(e,o),jt(o,Th()))},Ld=(e,t,n,o)=>{Kx(e,t,n,[o]),If(e,t,n,o)||(vo(o.element,t.highlightClass),t.onHighlight(e,o),jt(o,Yy()))},g1=(e,t,n)=>{Yx(e,t).each(o=>{Ld(e,t,n,o)})},p1=(e,t,n)=>{Xx(e,t).each(o=>{Ld(e,t,n,o)})},h1=(e,t,n,o)=>{v1(e,t,n,o).fold(s=>{throw s},s=>{Ld(e,t,n,s)})},f1=(e,t,n,o)=>{const s=Zx(e,t);lt(s,o).each(a=>{Ld(e,t,n,a)})},If=(e,t,n,o)=>or(o.element,t.highlightClass),b1=(e,t,n)=>fo(e.element,"."+t.highlightClass).bind(o=>e.getSystem().getByDom(o).toOptional()),v1=(e,t,n,o)=>{const s=Us(e.element,"."+t.itemClass);return g.from(s[o]).fold(()=>Me.error(new Error("No element found with index "+o)),e.getSystem().getByDom)},Yx=(e,t,n)=>fo(e.element,"."+t.itemClass).bind(o=>e.getSystem().getByDom(o).toOptional()),Xx=(e,t,n)=>{const o=Us(e.element,"."+t.itemClass);return(o.length>0?g.some(o[o.length-1]):g.none()).bind(r=>e.getSystem().getByDom(r).toOptional())},Jx=(e,t,n,o)=>{const s=Us(e.element,"."+t.itemClass);return en(s,a=>or(a,t.highlightClass)).bind(a=>{const c=xu(a,o,0,s.length-1);return e.getSystem().getByDom(s[c]).toOptional()})},y1=(e,t,n)=>Jx(e,t,n,-1),S1=(e,t,n)=>Jx(e,t,n,1),Zx=(e,t,n)=>{const o=Us(e.element,"."+t.itemClass);return es(ae(o,s=>e.getSystem().getByDom(s).toOptional()))};var x1=Object.freeze({__proto__:null,dehighlightAll:d1,dehighlight:m1,highlight:Ld,highlightFirst:g1,highlightLast:p1,highlightAt:h1,highlightBy:f1,isHighlighted:If,getHighlighted:b1,getFirst:Yx,getLast:Xx,getPrevious:y1,getNext:S1,getCandidates:Zx}),w1=[J("highlightClass"),J("itemClass"),Dt("onHighlight"),Dt("onDehighlight")];const Vt=qo({fields:w1,name:"highlighting",apis:x1}),C1=[8],Ei=[9],fc=[13],wg=[27],yr=[32],Cg=[37],Nd=[38],Tg=[39],Ou=[40],T1=(e,t,n)=>{const o=Zo(e.slice(0,t)),s=Zo(e.slice(t+1));return lt(o.concat(s),n)},_1=(e,t,n)=>{const o=Zo(e.slice(0,t));return lt(o,n)},O1=(e,t,n)=>{const o=e.slice(0,t),s=e.slice(t+1);return lt(s.concat(o),n)},k1=(e,t,n)=>{const o=e.slice(t+1);return lt(o,n)},$t=e=>t=>{const n=t.raw;return Tt(e,n.which)},Ga=e=>t=>yo(e,n=>n(t)),ku=e=>e.raw.shiftKey===!0,E1=e=>e.raw.ctrlKey===!0,Hd=Vn(ku),Ft=(e,t)=>({matches:e,classification:t}),A1=(e,t)=>lt(e,o=>o.matches(t)).map(o=>o.classification),Qx=(e,t,n)=>{t.exists(s=>n.exists(r=>an(r,s)))||Be(e,jy(),{prevFocus:t,newFocus:n})},Bf=()=>{const e=n=>ja(n.element);return{get:e,set:(n,o)=>{const s=e(n);n.getSystem().triggerFocus(o,n.element);const r=e(n);Qx(n,s,r)}}},D1=()=>{const e=n=>Vt.getHighlighted(n).map(o=>o.element);return{get:e,set:(n,o)=>{const s=e(n);n.getSystem().getByDom(o).fold(Q,a=>{Vt.highlight(n,a)});const r=e(n);Qx(n,s,r)}}};var Eu;(function(e){e.OnFocusMode="onFocus",e.OnEnterOrSpaceMode="onEnterOrSpace",e.OnApiMode="onApi"})(Eu||(Eu={}));const El=(e,t,n,o,s)=>{const r=()=>e.concat([N("focusManager",Bf()),fr("focusInside","onFocus",ml(d=>Tt(["onFocus","onEnterOrSpace","onApi"],d)?Me.value(d):Me.error("Invalid value for focusInside"))),Dn("handler",l),Dn("state",t),Dn("sendFocusIn",s)]),a=(d,p,h,b,S)=>{const _=h(d,p,b,S);return A1(_,p.event).bind(k=>k(d,p,b,S))},l={schema:r,processKey:a,toEvents:(d,p)=>{const h=d.focusInside!==Eu.OnFocusMode?g.none():s(d).map(_=>Z(yi(),(k,L)=>{_(k,d,p),L.stop()})),b=(_,k)=>{const L=$t(yr.concat(fc))(k.event);d.focusInside===Eu.OnEnterOrSpaceMode&&L&&Zr(_,k)&&s(d).each(R=>{R(_,d,p),k.stop()})},S=[Z(nr(),(_,k)=>{a(_,k,n,d,p).fold(()=>{b(_,k)},L=>{k.stop()})}),Z(uD(),(_,k)=>{a(_,k,o,d,p).each(L=>{k.stop()})})];return On(h.toArray().concat(S))}};return l},ew=e=>{const t=[Wt("onEscape"),Wt("onEnter"),N("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),N("firstTabstop",0),N("useTabstopAt",ge),Wt("visibilitySelector")].concat([e]),n=(k,L)=>{const R=k.visibilitySelector.bind(B=>Wa(L,B)).getOr(L);return In(R)>0},o=(k,L)=>{const R=Us(k.element,L.selector),B=Y(R,q=>n(L,q));return g.from(B[L.firstTabstop])},s=(k,L)=>L.focusManager.get(k).bind(R=>Wa(R,L.selector)),r=(k,L)=>n(k,L)&&k.useTabstopAt(L),a=(k,L,R)=>{o(k,L).each(B=>{L.focusManager.set(k,B)})},c=(k,L,R,B,q)=>q(L,R,V=>r(B,V)).fold(()=>B.cyclic?g.some(!0):g.none(),V=>(B.focusManager.set(k,V),g.some(!0))),l=(k,L,R,B)=>{const q=Us(k.element,R.selector);return s(k,R).bind(V=>en(q,Et(an,V)).bind(ee=>c(k,q,ee,R,B)))},d=(k,L,R)=>{const B=R.cyclic?T1:_1;return l(k,L,R,B)},p=(k,L,R)=>{const B=R.cyclic?O1:k1;return l(k,L,R,B)},h=(k,L,R)=>R.onEnter.bind(B=>B(k,L)),b=(k,L,R)=>R.onEscape.bind(B=>B(k,L)),S=O([Ft(Ga([ku,$t(Ei)]),d),Ft($t(Ei),p),Ft(Ga([Hd,$t(fc)]),h)]),_=O([Ft($t(wg),b)]);return El(t,Ua.init,S,_,()=>g.some(a))};var M1=ew(ds("cyclic",ne)),$1=ew(ds("cyclic",ge));const I1=(e,t,n)=>(_h(e,n,Lr()),g.some(!0)),Vd=(e,t,n)=>_u(n)&&$t(yr)(t.event)?g.none():I1(e,t,n),Au=(e,t)=>g.some(!0),B1=[N("execute",Vd),N("useSpace",!1),N("useEnter",!0),N("useControlEnter",!1),N("useDown",!1)],tw=(e,t,n)=>n.execute(e,t,e.element),F1=(e,t,n,o)=>{const s=n.useSpace&&!_u(e.element)?yr:[],r=n.useEnter?fc:[],a=n.useDown?Ou:[],c=s.concat(r).concat(a);return[Ft($t(c),tw)].concat(n.useControlEnter?[Ft(Ga([E1,$t(fc)]),tw)]:[])},P1=(e,t,n,o)=>n.useSpace&&!_u(e.element)?[Ft($t(yr),Au)]:[];var R1=El(B1,Ua.init,F1,P1,()=>g.none());const nw=()=>{const e=Mn();return Nr({readState:()=>e.get().map(s=>({numRows:String(s.numRows),numColumns:String(s.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(s,r)=>{e.set({numRows:s,numColumns:r})},getNumRows:()=>e.get().map(s=>s.numRows),getNumColumns:()=>e.get().map(s=>s.numColumns)})};var L1=Object.freeze({__proto__:null,flatgrid:nw,init:e=>e.state(e)});const ow=e=>(t,n,o,s)=>{const r=e(t.element);return sw(r,t,n,o,s)},Ff=(e,t)=>{const n=sf(e,t);return ow(n)},Pf=(e,t)=>{const n=sf(t,e);return ow(n)},Rf=e=>(t,n,o,s)=>sw(e,t,n,o,s),sw=(e,t,n,o,s)=>o.focusManager.get(t).bind(a=>e(t.element,a,o,s)).map(a=>(o.focusManager.set(t,a),!0)),rw=Rf,aw=Rf,_g=Rf,N1=e=>e.offsetWidth<=0&&e.offsetHeight<=0,cw=e=>!N1(e.dom),H1=(e,t)=>en(e,t).map(n=>({index:n,candidates:e})),iw=(e,t,n)=>{const o=a=>an(a,t),s=Us(e,n),r=Y(s,cw);return H1(r,o)},lw=(e,t)=>en(e,n=>an(t,n)),uw=(e,t,n,o)=>{const s=Math.floor(t/n),r=t%n;return o(s,r).bind(a=>{const c=a.row*n+a.column;return c>=0&&c<e.length?g.some(e[c]):g.none()})},dw=(e,t,n,o,s)=>uw(e,t,o,(r,a)=>{const l=r===n-1?e.length-r*o:o,d=xu(a,s,0,l-1);return g.some({row:r,column:d})}),mw=(e,t,n,o,s)=>uw(e,t,o,(r,a)=>{const c=xu(r,s,0,n-1),d=c===n-1?e.length-c*o:o,p=Vr(a,0,d-1);return g.some({row:c,column:p})}),V1=(e,t,n,o)=>dw(e,t,n,o,1),z1=(e,t,n,o)=>dw(e,t,n,o,-1),U1=(e,t,n,o)=>mw(e,t,n,o,-1),W1=(e,t,n,o)=>mw(e,t,n,o,1),j1=[J("selector"),N("execute",Vd),vr("onEscape"),N("captureTab",!1),yS()],G1=(e,t,n)=>{fo(e.element,t.selector).each(o=>{t.focusManager.set(e,o)})},q1=(e,t)=>t.focusManager.get(e).bind(n=>Wa(n,t.selector)),K1=(e,t,n,o)=>q1(e,n).bind(s=>n.execute(e,t,s)),Og=e=>(t,n,o,s)=>iw(t,n,o.selector).bind(r=>e(r.candidates,r.index,s.getNumRows().getOr(o.initSize.numRows),s.getNumColumns().getOr(o.initSize.numColumns))),gw=(e,t,n)=>n.captureTab?g.some(!0):g.none(),Y1=(e,t,n)=>n.onEscape(e,t),pw=Og(z1),hw=Og(V1),X1=Og(U1),J1=Og(W1),Z1=O([Ft($t(Cg),Ff(pw,hw)),Ft($t(Tg),Pf(pw,hw)),Ft($t(Nd),rw(X1)),Ft($t(Ou),aw(J1)),Ft(Ga([ku,$t(Ei)]),gw),Ft(Ga([Hd,$t(Ei)]),gw),Ft($t(yr.concat(fc)),K1)]),Q1=O([Ft($t(wg),Y1),Ft($t(yr),Au)]);var eB=El(j1,nw,Z1,Q1,()=>g.some(G1));const fw=(e,t,n,o,s)=>{const r=c=>Bo(c)==="button"&&To(c,"disabled")==="disabled",a=(c,l,d)=>s(c,l,o,0,d.length-1,d[l],p=>r(d[p])?a(c,p,d):g.from(d[p]));return iw(e,n,t).bind(c=>{const l=c.index,d=c.candidates;return a(l,l,d)})},bw=(e,t,n,o)=>fw(e,t,n,o,(s,r,a,c,l,d,p)=>{const h=Vr(r+a,c,l);return h===s?g.from(d):p(h)}),kg=(e,t,n,o)=>fw(e,t,n,o,(s,r,a,c,l,d,p)=>{const h=xu(r,a,c,l);return h===s?g.none():p(h)}),tB=[J("selector"),N("getInitial",g.none),N("execute",Vd),vr("onEscape"),N("executeOnMove",!1),N("allowVertical",!0),N("allowHorizontal",!0),N("cycles",!0)],nB=(e,t)=>t.focusManager.get(e).bind(n=>Wa(n,t.selector)),Lf=(e,t,n)=>nB(e,n).bind(o=>n.execute(e,t,o)),oB=(e,t,n)=>{t.getInitial(e).orThunk(()=>fo(e.element,t.selector)).each(o=>{t.focusManager.set(e,o)})},vw=(e,t,n)=>(n.cycles?kg:bw)(e,n.selector,t,-1),yw=(e,t,n)=>(n.cycles?kg:bw)(e,n.selector,t,1),Sw=e=>(t,n,o,s)=>e(t,n,o,s).bind(()=>o.executeOnMove?Lf(t,n,o):g.some(!0)),sB=(e,t,n)=>n.onEscape(e,t),rB=(e,t,n,o)=>{const s=[...n.allowHorizontal?Cg:[]].concat(n.allowVertical?Nd:[]),r=[...n.allowHorizontal?Tg:[]].concat(n.allowVertical?Ou:[]);return[Ft($t(s),Sw(Ff(vw,yw))),Ft($t(r),Sw(Pf(vw,yw))),Ft($t(fc),Lf),Ft($t(yr),Lf)]},aB=O([Ft($t(yr),Au),Ft($t(wg),sB)]);var cB=El(tB,Ua.init,rB,aB,()=>g.some(oB));const Eg=(e,t,n)=>g.from(e[t]).bind(o=>g.from(o[n]).map(s=>({rowIndex:t,columnIndex:n,cell:s}))),xw=(e,t,n,o)=>{const r=e[t].length,a=xu(n,o,0,r-1);return Eg(e,t,a)},ww=(e,t,n,o)=>{const s=xu(n,o,0,e.length-1),r=e[s].length,a=Vr(t,0,r-1);return Eg(e,s,a)},Cw=(e,t,n,o)=>{const r=e[t].length,a=Vr(n+o,0,r-1);return Eg(e,t,a)},Tw=(e,t,n,o)=>{const s=Vr(n+o,0,e.length-1),r=e[s].length,a=Vr(t,0,r-1);return Eg(e,s,a)},iB=(e,t,n)=>xw(e,t,n,1),lB=(e,t,n)=>xw(e,t,n,-1),uB=(e,t,n)=>ww(e,n,t,-1),dB=(e,t,n)=>ww(e,n,t,1),mB=(e,t,n)=>Cw(e,t,n,-1),gB=(e,t,n)=>Cw(e,t,n,1),pB=(e,t,n)=>Tw(e,n,t,-1),hB=(e,t,n)=>Tw(e,n,t,1),fB=[cc("selectors",[J("row"),J("cell")]),N("cycles",!0),N("previousSelector",g.none),N("execute",Vd)],bB=(e,t,n)=>{t.previousSelector(e).orThunk(()=>{const s=t.selectors;return fo(e.element,s.cell)}).each(s=>{t.focusManager.set(e,s)})},vB=(e,t,n)=>ja(e.element).bind(o=>n.execute(e,t,o)),yB=(e,t)=>ae(e,n=>Us(n,t.selectors.cell)),Ag=(e,t)=>(n,o,s)=>{const r=s.cycles?e:t;return Wa(o,s.selectors.row).bind(a=>{const c=Us(a,s.selectors.cell);return lw(c,o).bind(l=>{const d=Us(n,s.selectors.row);return lw(d,a).bind(p=>{const h=yB(d,s);return r(h,p,l).map(b=>b.cell)})})})},_w=Ag(lB,mB),Ow=Ag(iB,gB),SB=Ag(uB,pB),xB=Ag(dB,hB),wB=O([Ft($t(Cg),Ff(_w,Ow)),Ft($t(Tg),Pf(_w,Ow)),Ft($t(Nd),rw(SB)),Ft($t(Ou),aw(xB)),Ft($t(yr.concat(fc)),vB)]),CB=O([Ft($t(yr),Au)]);var TB=El(fB,Ua.init,wB,CB,()=>g.some(bB));const _B=[J("selector"),N("execute",Vd),N("moveOnTab",!1)],kw=(e,t,n)=>n.focusManager.get(e).bind(o=>n.execute(e,t,o)),OB=(e,t,n)=>{fo(e.element,t.selector).each(o=>{t.focusManager.set(e,o)})},Ew=(e,t,n)=>kg(e,n.selector,t,-1),Aw=(e,t,n)=>kg(e,n.selector,t,1),kB=(e,t,n,o)=>n.moveOnTab?_g(Ew)(e,t,n,o):g.none(),EB=(e,t,n,o)=>n.moveOnTab?_g(Aw)(e,t,n,o):g.none(),AB=O([Ft($t(Nd),_g(Ew)),Ft($t(Ou),_g(Aw)),Ft(Ga([ku,$t(Ei)]),kB),Ft(Ga([Hd,$t(Ei)]),EB),Ft($t(fc),kw),Ft($t(yr),kw)]),DB=O([Ft($t(yr),Au)]);var MB=El(_B,Ua.init,AB,DB,()=>g.some(OB));const $B=[vr("onSpace"),vr("onEnter"),vr("onShiftEnter"),vr("onLeft"),vr("onRight"),vr("onTab"),vr("onShiftTab"),vr("onUp"),vr("onDown"),vr("onEscape"),N("stopSpaceKeyup",!1),Wt("focusIn")],IB=(e,t,n)=>[Ft($t(yr),n.onSpace),Ft(Ga([Hd,$t(fc)]),n.onEnter),Ft(Ga([ku,$t(fc)]),n.onShiftEnter),Ft(Ga([ku,$t(Ei)]),n.onShiftTab),Ft(Ga([Hd,$t(Ei)]),n.onTab),Ft($t(Nd),n.onUp),Ft($t(Ou),n.onDown),Ft($t(Cg),n.onLeft),Ft($t(Tg),n.onRight),Ft($t(yr),n.onSpace)],BB=(e,t,n)=>[...n.stopSpaceKeyup?[Ft($t(yr),Au)]:[],Ft($t(wg),n.onEscape)];var FB=El($B,Ua.init,IB,BB,e=>e.focusIn);const PB=M1.schema(),RB=$1.schema(),LB=cB.schema(),NB=eB.schema(),HB=TB.schema(),VB=R1.schema(),zB=MB.schema(),UB=FB.schema();var WB=Object.freeze({__proto__:null,acyclic:PB,cyclic:RB,flow:LB,flatgrid:NB,matrix:HB,execution:VB,menu:zB,special:UB});const jB=e=>io(e,"setGridSize"),$e=IS({branchKey:"mode",branches:WB,name:"keying",active:{events:(e,t)=>e.handler.toEvents(e,t)},apis:{focusIn:(e,t,n)=>{t.sendFocusIn(t).fold(()=>{e.getSystem().triggerFocus(e.element,e.element)},o=>{o(e,t,n)})},setGridSize:(e,t,n,o,s)=>{jB(n)?n.setGridSize(o,s):console.error("Layout does not support setGridSize")}},state:L1}),Dw=(e,t)=>{Zh(()=>{J$(e,t,()=>ae(t,e.getSystem().build))},e.element)},Mw=(e,t)=>{Zh(()=>{Z$(e,t,()=>bM(e.element,t,e.getSystem().buildOrPatch))},e.element)},GB=(e,t,n,o)=>{mf(t);const s=iS(e.element,n,o,e.getSystem().buildOrPatch);fx(e,s),e.syncComponents()},Nf=(e,t,n)=>{const o=e.getSystem().build(n);vx(e,o,t)},qB=(e,t,n,o)=>{Gc(t),Nf(e,(s,r)=>ud(s,r,n),o)},KB=(e,t,n,o)=>(t.reuseDom?Mw:Dw)(e,o),YB=(e,t,n,o)=>{Nf(e,Zs,o)},XB=(e,t,n,o)=>{Nf(e,ld,o)},JB=(e,t,n,o)=>{const s=Dg(e);lt(s,a=>an(o.element,a.element)).each(Gc)},Dg=(e,t)=>e.components(),$w=(e,t,n,o,s)=>{const r=Dg(e);return g.from(r[o]).map(a=>(s.fold(()=>Gc(a),c=>{(t.reuseDom?GB:qB)(e,a,o,c)}),a))};var ZB=Object.freeze({__proto__:null,append:YB,prepend:XB,remove:JB,replaceAt:$w,replaceBy:(e,t,n,o,s)=>{const r=Dg(e);return en(r,o).bind(a=>$w(e,t,n,a,s))},set:KB,contents:Dg});const Ze=qo({fields:[Ho("reuseDom",!0)],name:"replacing",apis:ZB}),QB=(e,t)=>{const n=On(t);return qo({fields:[J("enabled")],name:e,active:{events:O(n)}})},st=(e,t)=>{const n=QB(e,t);return{key:e,value:{config:{},me:n,configAsRaw:O({}),initialConfig:{},state:Ua}}},Iw=(e,t)=>{t.ignore||(wa(e.element),t.onFocus(e))};var eF=Object.freeze({__proto__:null,focus:Iw,blur:(e,t)=>{t.ignore||Jh(e.element)},isFocused:e=>Id(e.element)}),tF=Object.freeze({__proto__:null,exhibit:(e,t)=>{const n=t.ignore?{}:{attributes:{tabindex:"-1"}};return xa(n)},events:e=>On([Z(yi(),(t,n)=>{Iw(t,e),n.stop()})].concat(e.stopMousedown?[Z(mt(),(t,n)=>{n.event.prevent()})]:[]))}),nF=[Dt("onFocus"),N("stopMousedown",!1),N("ignore",!1)];const Ve=qo({fields:nF,name:"focusing",active:tF,apis:eF}),oF=e=>({init:()=>{const n=Le(e);return{get:()=>n.get(),set:c=>n.set(c),clear:()=>n.set(e),readState:()=>n.get()}}}),sF=(e,t,n)=>{const o=t.aria;o.update(e,o,n.get())},rF=(e,t,n)=>{t.toggleClass.each(o=>{n.get()?vo(e.element,o):so(e.element,o)})},zd=(e,t,n,o)=>{const s=n.get();n.set(o),rF(e,t,n),sF(e,t,n),s!==o&&t.onToggled(e,o)},Bw=(e,t,n)=>{zd(e,t,n,!n.get())},aF=(e,t,n)=>{zd(e,t,n,!0)},cF=(e,t,n)=>{zd(e,t,n,!1)},iF=(e,t,n)=>n.get(),Fw=(e,t,n)=>{zd(e,t,n,t.selected)};var lF=Object.freeze({__proto__:null,onLoad:Fw,toggle:Bw,isOn:iF,on:aF,off:cF,set:zd}),uF=Object.freeze({__proto__:null,exhibit:()=>xa({}),events:(e,t)=>{const n=o0(e,t,Bw),o=Xh(e,t,Fw);return On(xt([e.toggleOnExecute?[n]:[],[o]]))}});const dF=(e,t,n)=>{Qe(e.element,"aria-pressed",n),t.syncWithExpanded&&Pw(e,t,n)},mF=(e,t,n)=>{Qe(e.element,"aria-selected",n)},gF=(e,t,n)=>{Qe(e.element,"aria-checked",n)},Pw=(e,t,n)=>{Qe(e.element,"aria-expanded",n)};var pF=[N("selected",!1),Wt("toggleClass"),N("toggleOnExecute",!0),Dt("onToggled"),fr("aria",{mode:"none"},Hs("mode",{pressed:[N("syncWithExpanded",!1),Dn("update",dF)],checked:[Dn("update",gF)],expanded:[Dn("update",Pw)],selected:[Dn("update",mF)],none:[Dn("update",Q)]}))];const it=qo({fields:pF,name:"toggling",active:uF,apis:lF,state:oF(!1)}),Rw=()=>{const e=(t,n)=>{n.stop(),xl(t)};return[Z(vl(),e),Z(Ad(),e),wl(Rr()),wl(mt())]},Mg=e=>{const t=n=>Uc((o,s)=>{n(o),s.stop()});return On(xt([e.map(t).toArray(),Rw()]))},Lw="alloy.item-hover",Nw="alloy.item-focus",Hw="alloy.item-toggled",Vw=e=>{(ja(e.element).isNone()||Ve.isFocused(e))&&(Ve.isFocused(e)||Ve.focus(e),Be(e,Lw,{item:e}))},zw=e=>{Be(e,Nw,{item:e})},hF=(e,t)=>{Be(e,Hw,{item:e,state:t})},Uw=O(Lw),fF=O(Nw),bF=O(Hw),vF=e=>e.toggling.map(t=>t.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),yF=e=>({aria:{mode:"checked"},...co(e,(t,n)=>n!=="exclusive"),onToggled:(t,n)=>{qe(e.onToggled)&&e.onToggled(t,n),hF(t,n)}}),SF=e=>({dom:e.dom,domModification:{...e.domModification,attributes:{role:vF(e),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:Ta.augment(e.itemBehaviours,[e.toggling.fold(it.revoke,t=>it.config(yF(t))),Ve.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:t=>{zw(t)}}),$e.config({mode:"execution"}),ye.config({store:{mode:"memory",initialValue:e.data}}),st("item-type-events",[...Rw(),Z(za(),Vw),Z(Ed(),Ve.focus)])]),components:e.components,eventOrder:e.eventOrder}),xF=[J("data"),J("components"),J("dom"),N("hasSubmenu",!1),Wt("toggling"),Ta.field("itemBehaviours",[it,Ve,$e,ye]),N("ignoreFocus",!1),N("domModification",{}),Dn("builder",SF),N("eventOrder",{})],wF=e=>({dom:e.dom,components:e.components,events:On([wD(Ed())])}),CF=[J("dom"),J("components"),Dn("builder",wF)],Hf=O("item-widget"),Vf=O([hs({name:"widget",overrides:e=>({behaviours:ce([ye.config({store:{mode:"manual",getValue:t=>e.data,setValue:Q}})])})})]),TF=e=>{const t=_f(Hf(),e,Vf()),n=Of(Hf(),e,t.internals()),o=r=>vn(r,e,"widget").map(a=>($e.focusIn(a),a)),s=(r,a)=>_u(a.event.target)?g.none():(()=>(e.autofocus&&a.setSource(r.element),g.none()))();return{dom:e.dom,components:n,domModification:e.domModification,events:On([Uc((r,a)=>{o(r).each(c=>{a.stop()})}),Z(za(),Vw),Z(Ed(),(r,a)=>{e.autofocus?o(r):Ve.focus(r)})]),behaviours:Ta.augment(e.widgetBehaviours,[ye.config({store:{mode:"memory",initialValue:e.data}}),Ve.config({ignore:e.ignoreFocus,onFocus:r=>{zw(r)}}),$e.config({mode:"special",focusIn:e.autofocus?r=>{o(r)}:u0(),onLeft:s,onRight:s,onEscape:(r,a)=>!Ve.isFocused(r)&&!e.autofocus?(Ve.focus(r),g.some(!0)):(e.autofocus&&a.setSource(r.element),g.none())})])}},_F=[J("uid"),J("data"),J("components"),J("dom"),N("autofocus",!1),N("ignoreFocus",!1),Ta.field("widgetBehaviours",[ye,Ve,$e]),N("domModification",{}),Ef(Vf()),Dn("builder",TF)],OF=Hs("type",{widget:_F,item:xF,separator:CF}),kF=(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}),EF=(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager}),AF=(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}),DF=O([xg({factory:{sketch:e=>{const t=ys("menu.spec item",OF,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>wt(t,"uid")?t:{...t,uid:yu("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),MF=O([J("value"),J("items"),J("dom"),J("components"),N("eventOrder",{}),zo("menuBehaviours",[Vt,ye,Ot,$e]),fr("movement",{mode:"menu",moveOnTab:!0},Hs("mode",{grid:[yS(),Dn("config",kF)],matrix:[Dn("config",EF),J("rowSelector"),N("previousSelector",g.none)],menu:[N("moveOnTab",!0),Dn("config",AF)]})),GM(),N("fakeFocus",!1),N("focusManager",Bf()),Dt("onHighlight"),Dt("onDehighlight")]),Ww=O("alloy.menu-focus"),$F=(e,t)=>{const n=Us(e.element,'[role="menuitemradio"][aria-checked="true"]');be(n,o=>{an(o,t.element)||e.getSystem().getByDom(o).each(s=>{it.off(s)})})},IF=(e,t,n,o)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Ko(e.menuBehaviours,[Vt.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),ye.config({store:{mode:"memory",initialValue:e.value}}),Ot.config({find:g.some}),$e.config(e.movement.config(e,e.movement))]),events:On([Z(fF(),(s,r)=>{const a=r.event;s.getSystem().getByDom(a.target).each(c=>{Vt.highlight(s,c),r.stop(),Be(s,Ww(),{menu:s,item:c})})}),Z(Uw(),(s,r)=>{const a=r.event.item;Vt.highlight(s,a)}),Z(bF(),(s,r)=>{const{item:a,state:c}=r.event;c&&To(a.element,"role")==="menuitemradio"&&$F(s,a)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}),Al=ws({name:"Menu",configFields:MF(),partFields:DF(),factory:IF}),BF=e=>Ht(e,(t,n)=>({k:t,v:n})),jw=(e,t,n,o)=>Se(n,o).bind(s=>Se(e,s).bind(r=>{const a=jw(e,t,n,r);return g.some([r].concat(a))})).getOr([]),FF=(e,t)=>{const n={};un(e,(a,c)=>{be(a,l=>{n[l]=c})});const o=t,s=BF(t),r=Ut(s,(a,c)=>[c].concat(jw(n,o,s,c)));return Ut(n,a=>Se(r,a).getOr([a]))},PF=()=>{const e=Le({}),t=Le({}),n=Le({}),o=Mn(),s=Le({}),r=()=>{e.set({}),t.set({}),n.set({}),o.clear()},a=()=>o.get().isNone(),c=(re,ee)=>{t.set({...t.get(),[re]:{type:"prepared",menu:ee}})},l=(re,ee,le,fe)=>{o.set(re),e.set(le),t.set(ee),s.set(fe);const dt=FF(fe,le);n.set(dt)},d=re=>pn(e.get(),(ee,le)=>ee===re),p=(re,ee,le)=>k(re).bind(fe=>d(re).bind(dt=>ee(dt).map(_e=>({triggeredMenu:fe,triggeringItem:_e,triggeringPath:le})))),h=(re,ee)=>{const le=Y(R(re).toArray(),fe=>k(fe).isSome());return Se(n.get(),re).bind(fe=>{const dt=Zo(le.concat(fe)),_e=At(dt,(Ke,Ue)=>p(Ke,ee,dt.slice(0,Ue+1)).fold(()=>Io(o.get(),Ke)?[]:[g.none()],Ct=>[g.some(Ct)]));return ca(_e)})},b=re=>Se(e.get(),re).map(ee=>{const le=Se(n.get(),re).getOr([]);return[ee].concat(le)}),S=re=>Se(n.get(),re).bind(ee=>ee.length>1?g.some(ee.slice(1)):g.none()),_=re=>Se(n.get(),re),k=re=>L(re).bind(Gw),L=re=>Se(t.get(),re),R=re=>Se(e.get(),re);return{setMenuBuilt:c,setContents:l,expand:b,refresh:_,collapse:S,lookupMenu:L,lookupItem:R,otherMenus:re=>{const ee=s.get();return Qo(Lt(ee),re)},getPrimary:()=>o.get().bind(k),getMenus:()=>t.get(),clear:r,isClear:a,getTriggeringPath:h}},Gw=e=>e.type==="prepared"?g.some(e.menu):g.none(),qw={init:PF,extractPreparedMenu:Gw},Kw=Te("tiered-menu-item-highlight"),Yw=Te("tiered-menu-item-dehighlight");var Ws;(function(e){e[e.HighlightMenuAndItem=0]="HighlightMenuAndItem",e[e.HighlightJustMenu=1]="HighlightJustMenu",e[e.HighlightNone=2]="HighlightNone"})(Ws||(Ws={}));const RF=(e,t)=>{const n=Mn(),o=(de,Ce,ze)=>Ut(ze,(gt,Fe)=>{const je=()=>Al.sketch({...gt,value:Fe,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:(tn,Bt)=>{Be(tn,Kw,{menuComp:tn,itemComp:Bt})},onDehighlight:(tn,Bt)=>{Be(tn,Yw,{menuComp:tn,itemComp:Bt})},focusManager:e.fakeFocus?D1():Bf()});return Fe===Ce?{type:"prepared",menu:de.getSystem().build(je())}:{type:"notbuilt",nbMenu:je}}),s=qw.init(),r=de=>{const Ce=o(de,e.data.primary,e.data.menus),ze=l();return s.setContents(e.data.primary,Ce,e.data.expansions,ze),s.getPrimary()},a=de=>ye.getValue(de).value,c=(de,Ce,ze)=>on(Ce,gt=>{if(!gt.getSystem().isConnected())return g.none();const Fe=Vt.getCandidates(gt);return lt(Fe,je=>a(je)===ze)}),l=de=>Ut(e.data.menus,(Ce,ze)=>At(Ce.items,gt=>gt.type==="separator"?[]:[gt.data.value])),d=Vt.highlight,p=(de,Ce)=>{d(de,Ce),Vt.getHighlighted(Ce).orThunk(()=>Vt.getFirst(Ce)).each(ze=>{e.fakeFocus?Vt.highlight(Ce,ze):_h(de,ze.element,Ed())})},h=(de,Ce)=>es(ae(Ce,ze=>de.lookupMenu(ze).bind(gt=>gt.type==="prepared"?g.some(gt.menu):g.none()))),b=(de,Ce,ze)=>{const gt=h(Ce,Ce.otherMenus(ze));be(gt,Fe=>{Hr(Fe.element,[e.markers.backgroundMenu]),e.stayInDom||Ze.remove(de,Fe)})},S=de=>n.get().getOrThunk(()=>{const Ce={},ze=Us(de.element,`.${e.markers.item}`),gt=Y(ze,Fe=>To(Fe,"aria-haspopup")==="true");return be(gt,Fe=>{de.getSystem().getByDom(Fe).each(je=>{const tn=a(je);Ce[tn]=je})}),n.set(Ce),Ce}),_=(de,Ce)=>{const ze=S(de);un(ze,(gt,Fe)=>{const je=Tt(Ce,Fe);Qe(gt.element,"aria-expanded",je)})},k=(de,Ce,ze)=>g.from(ze[0]).bind(gt=>Ce.lookupMenu(gt).bind(Fe=>{if(Fe.type==="notbuilt")return g.none();{const je=Fe.menu,tn=h(Ce,ze.slice(1));return be(tn,Bt=>{vo(Bt.element,e.markers.backgroundMenu)}),Zt(je.element)||Ze.append(de,Qr(je)),Hr(je.element,[e.markers.backgroundMenu]),p(de,je),b(de,Ce,ze),g.some(je)}}));let L;(function(de){de[de.HighlightSubmenu=0]="HighlightSubmenu",de[de.HighlightParent=1]="HighlightParent"})(L||(L={}));const R=(de,Ce,ze)=>{if(ze.type==="notbuilt"){const gt=de.getSystem().build(ze.nbMenu());return s.setMenuBuilt(Ce,gt),gt}else return ze.menu},B=(de,Ce,ze=L.HighlightSubmenu)=>{if(Ce.hasConfigured(Ne)&&Ne.isDisabled(Ce))return g.some(Ce);{const gt=a(Ce);return s.expand(gt).bind(Fe=>(_(de,Fe),g.from(Fe[0]).bind(je=>s.lookupMenu(je).bind(tn=>{const Bt=R(de,je,tn);return Zt(Bt.element)||Ze.append(de,Qr(Bt)),e.onOpenSubmenu(de,Ce,Bt,Zo(Fe)),ze===L.HighlightSubmenu?(Vt.highlightFirst(Bt),k(de,s,Fe)):(Vt.dehighlightAll(Bt),g.some(Ce))}))))}},q=(de,Ce)=>{const ze=a(Ce);return s.collapse(ze).bind(gt=>(_(de,gt),k(de,s,gt).map(Fe=>(e.onCollapseMenu(de,Ce,Fe),Fe))))},V=(de,Ce)=>{const ze=a(Ce);return s.refresh(ze).bind(gt=>(_(de,gt),k(de,s,gt)))},re=(de,Ce)=>_u(Ce.element)?g.none():B(de,Ce,L.HighlightSubmenu),ee=(de,Ce)=>_u(Ce.element)?g.none():q(de,Ce),le=(de,Ce)=>q(de,Ce).orThunk(()=>e.onEscape(de,Ce).map(()=>de)),fe=de=>(Ce,ze)=>Wa(ze.getSource(),`.${e.markers.item}`).bind(gt=>Ce.getSystem().getByDom(gt).toOptional().bind(Fe=>de(Ce,Fe).map(ge))),dt=On([Z(Ww(),(de,Ce)=>{const ze=Ce.event.item;s.lookupItem(a(ze)).each(()=>{const gt=Ce.event.menu;Vt.highlight(de,gt);const Fe=a(Ce.event.item);s.refresh(Fe).each(je=>b(de,s,je))})}),Uc((de,Ce)=>{const ze=Ce.event.target;de.getSystem().getByDom(ze).each(gt=>{a(gt).indexOf("collapse-item")===0&&q(de,gt),B(de,gt,L.HighlightSubmenu).fold(()=>{e.onExecute(de,gt)},Q)})}),Pn((de,Ce)=>{r(de).each(ze=>{Ze.append(de,Qr(ze)),e.onOpenMenu(de,ze),e.highlightOnOpen===Ws.HighlightMenuAndItem?p(de,ze):e.highlightOnOpen===Ws.HighlightJustMenu&&d(de,ze)})}),Z(Kw,(de,Ce)=>{e.onHighlightItem(de,Ce.event.menuComp,Ce.event.itemComp)}),Z(Yw,(de,Ce)=>{e.onDehighlightItem(de,Ce.event.menuComp,Ce.event.itemComp)}),...e.navigateOnHover?[Z(Uw(),(de,Ce)=>{const ze=Ce.event.item;V(de,ze),B(de,ze,L.HighlightParent),e.onHover(de,ze)})]:[]]),_e=de=>Vt.getHighlighted(de).bind(Vt.getHighlighted),Ke=de=>{_e(de).each(Ce=>{q(de,Ce)})},Ue=de=>{s.getPrimary().each(Ce=>{p(de,Ce)})},Ct=de=>g.from(de.components()[0]).filter(Ce=>To(Ce.element,"role")==="menu"),yt={collapseMenu:Ke,highlightPrimary:Ue,repositionMenus:de=>{s.getPrimary().bind(ze=>_e(de).bind(gt=>{const Fe=a(gt),je=_s(s.getMenus()),tn=es(ae(je,qw.extractPreparedMenu));return s.getTriggeringPath(Fe,Bt=>c(de,tn,Bt))}).map(gt=>({primary:ze,triggeringPath:gt}))).fold(()=>{Ct(de).each(ze=>{e.onRepositionMenu(de,ze,[])})},({primary:ze,triggeringPath:gt})=>{e.onRepositionMenu(de,ze,gt)})}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Ko(e.tmenuBehaviours,[$e.config({mode:"special",onRight:fe(re),onLeft:fe(ee),onEscape:fe(le),focusIn:(de,Ce)=>{s.getPrimary().each(ze=>{_h(de,ze.element,Ed())})}}),Vt.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),Ot.config({find:de=>Vt.getHighlighted(de)}),Ze.config({})]),eventOrder:e.eventOrder,apis:yt,events:dt}},LF=O("collapse-item"),NF=(e,t,n)=>({primary:e,menus:t,expansions:n}),HF=(e,t)=>({primary:e,menus:se(e,t),expansions:{}}),VF=e=>({value:Te(LF()),meta:{text:e}}),Dl=Ur({name:"TieredMenu",configFields:[Hh("onExecute"),Hh("onEscape"),Ol("onOpenMenu"),Ol("onOpenSubmenu"),Dt("onRepositionMenu"),Dt("onCollapseMenu"),N("highlightOnOpen",Ws.HighlightMenuAndItem),cc("data",[J("primary"),J("menus"),J("expansions")]),N("fakeFocus",!1),Dt("onHighlightItem"),Dt("onDehighlightItem"),Dt("onHover"),tg(),J("dom"),N("navigateOnHover",!0),N("stayInDom",!1),zo("tmenuBehaviours",[$e,Vt,Ot,Ze]),N("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:RF,extraApis:{tieredData:NF,singleData:HF,collapseItem:VF}}),zF=(e,t,n,o,s)=>{const r=()=>e.lazySink(t),a=o.type==="horizontal"?{layouts:{onLtr:()=>Kh(),onRtl:()=>Yh()}}:{},c=d=>d.length===2,l=d=>c(d)?a:{};return Dl.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightOnOpen:o.menu.highlightOnOpen,fakeFocus:o.menu.fakeFocus,onEscape:()=>(Mt.close(t),e.onEscape.map(d=>d(t)),g.some(!0)),onExecute:()=>g.some(!0),onOpenMenu:(d,p)=>{xs.positionWithinBounds(r().getOrDie(),p,n,s())},onOpenSubmenu:(d,p,h,b)=>{const S=r().getOrDie();xs.position(S,h,{anchor:{type:"submenu",item:p,...l(b)}})},onRepositionMenu:(d,p,h)=>{const b=r().getOrDie();xs.positionWithinBounds(b,p,n,s()),be(h,S=>{const _=l(S.triggeringPath);xs.position(b,S.triggeredMenu,{anchor:{type:"submenu",item:S.triggeringItem,..._}})})}})},UF=(e,t)=>{const n=(b,S)=>e.getRelated(b).exists(k=>Tl(k,S)),o=(b,S)=>{Mt.setContent(b,S)},s=(b,S,_)=>{const k=g.none;r(b,S,_,k)},r=(b,S,_,k)=>{const L=e.lazySink(b).getOrDie();Mt.openWhileCloaked(b,S,()=>xs.positionWithinBounds(L,b,_,k())),ye.setValue(b,g.some({mode:"position",config:_,getBounds:k}))},a=(b,S,_)=>{c(b,S,_,g.none)},c=(b,S,_,k)=>{const L=zF(e,b,S,_,k);Mt.open(b,L),ye.setValue(b,g.some({mode:"menu",menu:L}))},l=b=>{Mt.isOpen(b)&&(ye.setValue(b,g.none()),Mt.close(b))},d=b=>Mt.getState(b),p=b=>{Mt.isOpen(b)&&ye.getValue(b).each(S=>{switch(S.mode){case"menu":Mt.getState(b).each(Dl.repositionMenus);break;case"position":const _=e.lazySink(b).getOrDie();xs.positionWithinBounds(_,b,S.config,S.getBounds());break}})},h={setContent:o,showAt:s,showWithinBounds:r,showMenuAt:a,showMenuWithinBounds:c,hide:l,getContent:d,reposition:p,isOpen:Mt.isOpen};return{uid:e.uid,dom:e.dom,behaviours:Ko(e.inlineBehaviours,[Mt.config({isPartOf:(b,S,_)=>Tl(S,_)||n(b,_),getAttachPoint:b=>e.lazySink(b).getOrDie(),onOpen:b=>{e.onShow(b)},onClose:b=>{e.onHide(b)}}),ye.config({store:{mode:"memory",initialValue:g.none()}}),zr.config({channels:{...hf({isExtraPart:t.isExtraPart,...e.fireDismissalEventInstead.map(b=>({fireEventInstead:{event:b.event}})).getOr({})}),...ff({...e.fireRepositionEventInstead.map(b=>({fireEventInstead:{event:b.event}})).getOr({}),doReposition:p})}})]),eventOrder:e.eventOrder,apis:h}},Nn=Ur({name:"InlineView",configFields:[J("lazySink"),Dt("onShow"),Dt("onHide"),Vc("onEscape"),zo("inlineBehaviours",[Mt,ye,zr]),tr("fireDismissalEventInstead",[N("event",Sl())]),tr("fireRepositionEventInstead",[N("event",Wy())]),N("getRelated",g.none),N("isExtraPart",ne),N("eventOrder",g.none)],factory:UF,apis:{showAt:(e,t,n,o)=>{e.showAt(t,n,o)},showWithinBounds:(e,t,n,o,s)=>{e.showWithinBounds(t,n,o,s)},showMenuAt:(e,t,n,o)=>{e.showMenuAt(t,n,o)},showMenuWithinBounds:(e,t,n,o,s)=>{e.showMenuWithinBounds(t,n,o,s)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,n)=>{e.setContent(t,n)},reposition:(e,t)=>{e.reposition(t)}}});var $g=tinymce.util.Tools.resolve("tinymce.util.Delay");const Yo=Ur({name:"Button",factory:e=>{const t=Mg(e.action),n=e.dom.tag,o=r=>Se(e.dom,"attributes").bind(a=>Se(a,r)),s=()=>{if(n==="button"){const r=o("type").getOr("button"),a=o("role").map(c=>({role:c})).getOr({});return{type:r,...a}}else return{role:e.role.getOr(o("role").getOr("button"))}};return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Ta.augment(e.buttonBehaviours,[Ve.config({}),$e.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:s()},eventOrder:e.eventOrder}},configFields:[N("uid",void 0),J("dom"),N("components",[]),Ta.field("buttonBehaviours",[Ve,$e]),Wt("action"),Wt("role"),N("eventOrder",{})]}),Yt=e=>{const t=XI(e)&&io(e,"uid")?e.uid:yu("memento");return{get:r=>r.getSystem().getByUid(t).getOrDie(),getOpt:r=>r.getSystem().getByUid(t).toOptional(),asSpec:()=>({...e,uid:t})}};var ta=tinymce.util.Tools.resolve("tinymce.util.I18n");const WF={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Xw="temporary-placeholder",zf=e=>()=>Se(e,Xw).getOr("!not found!"),Uf=(e,t)=>{const n=e.toLowerCase();if(ta.isRtl()){const o=So(n,"-rtl");return wt(t,o)?o:n}else return n},Jw=(e,t)=>Se(t,Uf(e,t)),Zw=(e,t)=>{const n=t();return Jw(e,n).getOrThunk(zf(n))},jF=(e,t,n)=>{const o=t();return Jw(e,o).or(n).getOrThunk(zf(o))},GF=e=>ta.isRtl()?wt(WF,e):!1,Wf=()=>st("add-focusable",[Pn(e=>{Ph(e.element,"svg").each(t=>Qe(t,"focusable","false"))})]),Qw=(e,t,n,o)=>{var s,r;const a=GF(t)?["tox-icon--flip"]:[],c=Se(n,Uf(t,n)).or(o).getOrThunk(zf(n));return{dom:{tag:e.tag,attributes:(s=e.attributes)!==null&&s!==void 0?s:{},classes:e.classes.concat(a),innerHtml:c},behaviours:ce([...(r=e.behaviours)!==null&&r!==void 0?r:[],Wf()])}},Oa=(e,t,n,o=g.none())=>Qw(t,e,n(),o),qF=(e,t,n)=>{const o=n(),s=lt(e,r=>wt(o,Uf(r,o)));return Qw(t,s.getOr(Xw),o,g.none())},KF={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},jf=Ur({name:"Notification",factory:e=>{const t=Yt({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:ce([Ze.config({})])}),n=S=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${S}%`}}}),o=S=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${S}%`}}),s=Yt({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},o(0)],behaviours:ce([Ze.config({})])}),c={updateProgress:(S,_)=>{S.getSystem().isConnected()&&s.getOpt(S).each(k=>{Ze.set(k,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(_)]},o(_)])})},updateText:(S,_)=>{if(S.getSystem().isConnected()){const k=t.get(S);Ze.set(k,[ho(_)])}}},l=xt([e.icon.toArray(),e.level.toArray(),e.level.bind(S=>g.from(KF[S])).toArray()]),d=Yt(Yo.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Oa("close",{tag:"span",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:S=>{e.onAction(S)}})),p=qF(l,{tag:"div",classes:["tox-notification__icon"]},e.iconProvider),h={dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:ce([Ze.config({})])},b=[p,h];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(S=>["tox-notification","tox-notification--in",`tox-notification--${S}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:ce([Ve.config({}),st("notification-events",[Z(uc(),S=>{d.getOpt(S).each(Ve.focus)})])]),components:b.concat(e.progress?[s.asSpec()]:[]).concat(e.closeButton?[d.asSpec()]:[]),apis:c}},configFields:[Wt("level"),J("progress"),Wt("icon"),J("onAction"),J("text"),J("iconProvider"),J("translationProvider"),Ho("closeButton",!0)],apis:{updateProgress:(e,t,n)=>{e.updateProgress(t,n)},updateText:(e,t,n)=>{e.updateText(t,n)}}});var YF=(e,t,n)=>{const o=t.backstage.shared,s=()=>{const l=f(te.fromDom(e.getContentAreaContainer())),d=oe(),p=Vr(d.x,l.x,l.right),h=Vr(d.y,l.y,l.bottom),b=Math.max(l.right,d.right),S=Math.max(l.bottom,d.bottom);return g.some(m(p,h,b-p,S-h))};return{open:(l,d)=>{const p=()=>{d(),Nn.hide(b)},h=ps(jf.sketch({text:l.text,level:Tt(["success","error","warning","warn","info"],l.type)?l.type:void 0,progress:l.progressBar===!0,icon:l.icon,closeButton:l.closeButton,onAction:p,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),b=ps(Nn.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{},...o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));n.add(b),ht(l.timeout)&&l.timeout>0&&$g.setEditorTimeout(e,()=>{p()},l.timeout);const _={close:p,reposition:()=>{const k=Qr(h),L={maxHeightFunction:Cu()},R=e.notificationManager.getNotifications();if(R[0]===_){const B={...o.anchors.banner(),overrides:L};Nn.showWithinBounds(b,k,{anchor:B},s)}else Jn(R,_).each(B=>{const q=R[B-1].getEl(),V={type:"node",root:sn(),node:g.some(te.fromDom(q)),overrides:L,layouts:{onRtl:()=>[Vo],onLtr:()=>[Vo]}};Nn.showWithinBounds(b,k,{anchor:V},s)})},text:k=>{jf.updateText(h,k)},settings:l,getEl:()=>h.element.dom,progressBar:{value:k=>{jf.updateProgress(h,k)}}};return _},close:l=>{l.close()},getArgs:l=>l.settings}},Ud=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),XF=tinymce.util.Tools.resolve("tinymce.EditorManager"),Du=tinymce.util.Tools.resolve("tinymce.Env"),na;(function(e){e.default="wrap",e.floating="floating",e.sliding="sliding",e.scrolling="scrolling"})(na||(na={}));var Wd;(function(e){e.auto="auto",e.top="top",e.bottom="bottom"})(Wd||(Wd={}));const wn=e=>t=>t.options.get(e),jd=e=>t=>g.from(e(t)),eC=e=>{const t=Du.deviceType.isPhone(),n=Du.deviceType.isTablet()||t,o=e.options.register,s=a=>Ee(a)||a===!1,r=a=>Ee(a)||ht(a);o("skin",{processor:a=>Ee(a)||a===!1,default:"oxide"}),o("skin_url",{processor:"string"}),o("height",{processor:r,default:Math.max(e.getElement().offsetHeight,400)}),o("width",{processor:r,default:Ud.DOM.getStyle(e.getElement(),"width")}),o("min_height",{processor:"number",default:100}),o("min_width",{processor:"number"}),o("max_height",{processor:"number"}),o("max_width",{processor:"number"}),o("style_formats",{processor:"object[]"}),o("style_formats_merge",{processor:"boolean",default:!1}),o("style_formats_autohide",{processor:"boolean",default:!1}),o("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),o("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),o("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),o("font_size_input_default_unit",{processor:"string",default:"pt"}),o("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),o("content_langs",{processor:"object[]"}),o("removed_menuitems",{processor:"string",default:""}),o("menubar",{processor:a=>Ee(a)||nn(a),default:!t}),o("menu",{processor:"object",default:{}}),o("toolbar",{processor:a=>nn(a)||Ee(a)||ut(a)?{value:a,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),gn(9,a=>{o("toolbar"+(a+1),{processor:"string"})}),o("toolbar_mode",{processor:"string",default:n?"scrolling":"floating"}),o("toolbar_groups",{processor:"object",default:{}}),o("toolbar_location",{processor:"string",default:Wd.auto}),o("toolbar_persist",{processor:"boolean",default:!1}),o("toolbar_sticky",{processor:"boolean",default:e.inline}),o("toolbar_sticky_offset",{processor:"number",default:0}),o("fixed_toolbar_container",{processor:"string",default:""}),o("fixed_toolbar_container_target",{processor:"object"}),o("ui_mode",{processor:"string",default:"combined"}),o("file_picker_callback",{processor:"function"}),o("file_picker_validator_handler",{processor:"function"}),o("file_picker_types",{processor:"string"}),o("typeahead_urls",{processor:"boolean",default:!0}),o("anchor_top",{processor:s,default:"#top"}),o("anchor_bottom",{processor:s,default:"#bottom"}),o("draggable_modal",{processor:"boolean",default:!1}),o("statusbar",{processor:"boolean",default:!0}),o("elementpath",{processor:"boolean",default:!0}),o("branding",{processor:"boolean",default:!0}),o("promotion",{processor:"boolean",default:!0}),o("resize",{processor:a=>a==="both"||nn(a),default:!Du.deviceType.isTouch()}),o("sidebar_show",{processor:"string"})},tC=wn("readonly"),Gf=wn("height"),qf=wn("width"),Kf=jd(wn("min_width")),Yf=jd(wn("min_height")),Ig=jd(wn("max_width")),Xf=jd(wn("max_height")),nC=jd(wn("style_formats")),oC=wn("style_formats_merge"),sC=wn("style_formats_autohide"),rC=wn("content_langs"),aC=wn("removed_menuitems"),Mu=wn("toolbar_mode"),cC=wn("toolbar_groups"),Jf=wn("toolbar_location"),JF=wn("fixed_toolbar_container"),ZF=wn("fixed_toolbar_container_target"),iC=wn("toolbar_persist"),lC=wn("toolbar_sticky_offset"),uC=wn("menubar"),Bg=wn("toolbar"),dC=wn("file_picker_callback"),mC=wn("file_picker_validator_handler"),gC=wn("font_size_input_default_unit"),pC=wn("file_picker_types"),hC=wn("typeahead_urls"),fC=wn("anchor_top"),bC=wn("anchor_bottom"),vC=wn("draggable_modal"),yC=wn("statusbar"),SC=wn("elementpath"),xC=wn("branding"),wC=wn("resize"),CC=wn("paste_as_text"),TC=wn("sidebar_show"),_C=wn("promotion"),Zf=e=>e.options.get("skin")===!1,Fg=e=>e.options.get("menubar")!==!1,OC=e=>{const t=e.options.get("skin_url");if(Zf(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{const n=e.options.get("skin");return XF.baseURL+"/skins/ui/"+n}},kC=e=>e.options.get("line_height_formats").split(" "),Pg=e=>{const t=Bg(e),n=Ee(t),o=ut(t)&&t.length>0;return!Gd(e)&&(o||n||t===!0)},Qf=e=>{const t=gn(9,o=>e.options.get("toolbar"+(o+1))),n=Y(t,Ee);return ts(n.length>0,n)},Gd=e=>Qf(e).fold(()=>{const t=Bg(e);return ie(t,Ee)&&t.length>0},ge),eb=e=>Jf(e)===Wd.bottom,EC=e=>{var t;if(!e.inline)return g.none();const n=(t=JF(e))!==null&&t!==void 0?t:"";if(n.length>0)return fo(sn(),n);const o=ZF(e);return Ye(o)?g.some(te.fromDom(o)):g.none()},$u=e=>e.inline&&EC(e).isSome(),tb=e=>EC(e).getOrThunk(()=>j(P(te.fromDom(e.getElement())))),nb=e=>e.inline&&!Fg(e)&&!Pg(e)&&!Gd(e),qd=e=>(e.options.get("toolbar_sticky")||e.inline)&&!$u(e)&&!nb(e),Ai=e=>!$u(e)&&e.options.get("ui_mode")==="split",AC=e=>{const t=e.options.get("menu");return Ut(t,n=>({...n,items:n.items}))};var QF=Object.freeze({__proto__:null,get ToolbarMode(){return na},get ToolbarLocation(){return Wd},register:eC,getSkinUrl:OC,isReadOnly:tC,isSkinDisabled:Zf,getHeightOption:Gf,getWidthOption:qf,getMinWidthOption:Kf,getMinHeightOption:Yf,getMaxWidthOption:Ig,getMaxHeightOption:Xf,getUserStyleFormats:nC,shouldMergeStyleFormats:oC,shouldAutoHideStyleFormats:sC,getLineHeightFormats:kC,getContentLanguages:rC,getRemovedMenuItems:aC,isMenubarEnabled:Fg,isMultipleToolbars:Gd,isToolbarEnabled:Pg,isToolbarPersist:iC,getMultipleToolbarsOption:Qf,getUiContainer:tb,useFixedContainer:$u,isSplitUiMode:Ai,getToolbarMode:Mu,isDraggableModal:vC,isDistractionFree:nb,isStickyToolbar:qd,getStickyToolbarOffset:lC,getToolbarLocation:Jf,isToolbarLocationBottom:eb,getToolbarGroups:cC,getMenus:AC,getMenubar:uC,getToolbar:Bg,getFilePickerCallback:dC,getFilePickerTypes:pC,useTypeaheadUrls:hC,getAnchorTop:fC,getAnchorBottom:bC,getFilePickerValidatorHandler:mC,getFontSizeInputDefaultUnit:gC,useStatusBar:yC,useElementPath:SC,promotionEnabled:_C,useBranding:xC,getResize:wC,getPasteAsText:CC,getSidebarShow:TC});const DC="[data-mce-autocompleter]",MC=e=>Wa(e,DC),eP=e=>fo(e,DC),tP={setup:(e,t)=>{const n=(s,r)=>{Be(s,nr(),{raw:r})},o=()=>e.getMenu().bind(Vt.getHighlighted);t.on("keydown",s=>{const r=s.which;e.isActive()&&(e.isMenuOpen()?r===13?(o().each(xl),s.preventDefault()):r===40?(o().fold(()=>{e.getMenu().each(Vt.highlightFirst)},a=>{n(a,s)}),s.preventDefault(),s.stopImmediatePropagation()):(r===37||r===38||r===39)&&o().each(a=>{n(a,s),s.preventDefault(),s.stopImmediatePropagation()}):(r===13||r===38||r===40)&&e.cancelIfNecessary())}),t.on("NodeChange",s=>{e.isActive()&&!e.isProcessingAction()&&MC(te.fromDom(s.element)).isNone()&&e.cancelIfNecessary()})}};var ob;(function(e){e[e.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",e[e.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"})(ob||(ob={}));var qa=ob;const sb="tox-menu-nav__js",Rg="tox-collection__item",rb="tox-swatch",nP={normal:sb,color:rb},$C="tox-collection__item--enabled",oP="tox-collection__group-heading",IC="tox-collection__item-icon",ab="tox-collection__item-label",sP="tox-collection__item-accessory",BC="tox-collection__item-caret",rP="tox-collection__item-checkmark",Kd="tox-collection__item--active",FC="tox-collection__item-container",aP="tox-collection__item-container--column",PC="tox-collection__item-container--row",cP="tox-collection__item-container--align-right",iP="tox-collection__item-container--align-left",lP="tox-collection__item-container--valign-top",uP="tox-collection__item-container--valign-middle",dP="tox-collection__item-container--valign-bottom",RC=e=>Se(nP,e).getOr(sb),mP=e=>e==="color"?"tox-swatches":"tox-menu",cb=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:mP(e),tieredMenu:"tox-tiered-menu"}),Ml=e=>{const t=cb(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:RC(e)}},gP=(e,t,n)=>{const o=cb(n);return{tag:"div",classes:xt([[o.menu,`tox-menu-${t}-column`],e?[o.hasIcons]:[]])}},pP=[Al.parts.items({})],Lg=(e,t,n)=>{const o=cb(n);return{dom:{tag:"div",classes:xt([[o.tieredMenu]])},markers:Ml(n)}},LC=O([Wt("data"),N("inputAttributes",{}),N("inputStyles",{}),N("tag","input"),N("inputClasses",[]),Dt("onSetValue"),N("styles",{}),N("eventOrder",{}),zo("inputBehaviours",[ye,Ve]),N("selectOnFocus",!0)]),NC=e=>ce([Ve.config({onFocus:e.selectOnFocus?t=>{const n=t.element,o=pc(n);n.dom.setSelectionRange(0,o.length)}:Q})]),hP=e=>({...NC(e),...Ko(e.inputBehaviours,[ye.config({store:{mode:"manual",...e.data.map(t=>({initialValue:t})).getOr({}),getValue:t=>pc(t.element),setValue:(t,n)=>{pc(t.element)!==n&&xi(t.element,n)}},onSetValue:e.onSetValue})])}),HC=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),fP=(e,t)=>({uid:e.uid,dom:HC(e),components:[],behaviours:hP(e),eventOrder:e.eventOrder}),$l=Ur({name:"Input",configFields:LC(),factory:fP}),VC=Te("refetch-trigger-event"),zC=Te("redirect-menu-item-interaction"),UC="tox-menu__searcher",Ng=e=>fo(e.element,`.${UC}`).bind(t=>e.getSystem().getByDom(t).toOptional()),WC=Ng,bP=(e,t)=>{ye.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd},jC=e=>{const t=ye.getValue(e),n=e.element.dom.selectionStart,o=e.element.dom.selectionEnd;return{fetchPattern:t,selectionStart:n,selectionEnd:o}},vP=(e,t)=>{Go(t.element,"id").each(n=>Qe(e.element,"aria-activedescendant",n))},yP=e=>{const t=(s,r)=>(r.cut(),g.none()),n=(s,r)=>{const a={interactionEvent:r.event,eventType:r.event.raw.type};return Be(s,zC,a),g.some(!0)},o="searcher-events";return{dom:{tag:"div",classes:[Rg]},components:[$l.sketch({inputClasses:[UC,"tox-textfield"],inputAttributes:{...e.placeholder.map(s=>({placeholder:e.i18n(s)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:ce([st(o,[Z(bl(),s=>{jt(s,VC)}),Z(nr(),(s,r)=>{r.event.raw.key==="Escape"&&r.stop()})]),$e.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:n,onEscape:n,onUp:n,onDown:n})]),eventOrder:{keydown:[o,$e.name()]}})]}},Hg="tox-collection--results__js",GC=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...(t=e.dom.attributes)!==null&&t!==void 0?t:{},id:Te("aria-item-search-result-id"),"aria-selected":"false"}}}:e},ib=(e,t)=>n=>{const o=Lo(n,t);return ae(o,s=>({dom:e,components:s}))},SP=e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Al.parts.items({preprocess:e!=="auto"?ib({tag:"div",classes:["tox-swatches__row"]},e):Xe})]}]}),xP=e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Al.parts.items({preprocess:ib({tag:"div",classes:["tox-collection__group"]},e)})]}),qC=(e,t)=>{const n=[];let o=[];return be(e,(s,r)=>{t(s,r)?(o.length>0&&n.push(o),o=[],(wt(s.dom,"innerHtml")||s.components&&s.components.length>0)&&o.push(s)):o.push(s)}),o.length>0&&n.push(o),ae(n,s=>({dom:{tag:"div",classes:["tox-collection__group"]},components:s}))},lb=(e,t,n)=>Al.parts.items({preprocess:o=>{const s=ae(o,n);return e!=="auto"&&e>1?ib({tag:"div",classes:["tox-collection__group"]},e)(s):qC(s,(r,a)=>t[a].type==="separator")}}),KC=(e,t,n=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(e===1?["tox-collection--list"]:["tox-collection--grid"])},components:[lb(e,t,Xe)]}),wP=(e,t,n=!0)=>{const o=Te("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",Hg].concat(e===1?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:o}},components:[lb(e,t,GC)]}},CP=(e,t,n)=>{const o=Te("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(e===1?["tox-collection--list"]:["tox-collection--grid"])},components:[yP({i18n:ta.translate,placeholder:n.placeholder}),{dom:{tag:"div",classes:[...e===1?["tox-collection--list"]:["tox-collection--grid"],Hg],attributes:{id:o}},components:[lb(e,t,GC)]}]}},TP=(e,t=!0)=>({dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Al.parts.items({preprocess:n=>qC(n,(o,s)=>e[s].type==="separator")})]}),Vg=e=>Rn(e,t=>"icon"in t&&t.icon!==void 0),qc=e=>(console.error(vi(e)),console.log(e),g.none()),_P=(e,t,n,o,s)=>{const r=TP(n);return{value:e,dom:r.dom,components:r.components,items:n}},ub=(e,t,n,o,s)=>{const r=()=>s.menuType!=="searchable"?KC(o,n):s.searchMode.searchMode==="search-with-field"?CP(o,n,s.searchMode):wP(o,n);if(s.menuType==="color"){const a=SP(o);return{value:e,dom:a.dom,components:a.components,items:n}}else if(s.menuType==="normal"&&o==="auto"){const a=KC(o,n);return{value:e,dom:a.dom,components:a.components,items:n}}else if(s.menuType==="normal"||s.menuType==="searchable"){const a=r();return{value:e,dom:a.dom,components:a.components,items:n}}else if(s.menuType==="listpreview"&&o!=="auto"){const a=xP(o);return{value:e,dom:a.dom,components:a.components,items:n}}else return{value:e,dom:gP(t,o,s.menuType),components:pP,items:n}},lo=go("type"),db=go("name"),mb=go("label"),Kc=go("text"),YC=go("title"),XC=go("icon"),Yd=go("value"),OP=hr("fetch"),kP=hr("getSubmenuItems"),Iu=hr("onAction"),EP=hr("onItemAction"),Il=ko("onSetup",()=>Q),AP=ms("name"),Di=ms("text"),oa=ms("icon"),zg=ms("tooltip"),gb=ms("label"),DP=ms("shortcut"),MP=Vc("select"),Ug=Ho("active",!1),$P=Ho("borderless",!1),ka=Ho("enabled",!0),Wg=Ho("primary",!1),JC=e=>N("columns",e),pb=N("meta",{}),hb=ko("onAction",Q),Bl=e=>Fr("type",e),fb=e=>Po("name","name",ya(()=>Te(`${e}-name`)),Fo),IP=e=>Po("value","value",ya(()=>Te(`${e}-value`)),Br()),ZC=Re([lo,Di]),BP=e=>jn("separatormenuitem",ZC,e),FP=Re([Bl("autocompleteitem"),Ug,ka,pb,Yd,Di,oa]),PP=e=>jn("Autocompleter.Separator",ZC,e),RP=e=>jn("Autocompleter.Item",FP,e),Xd=[ka,zg,oa,Di,Il],LP=Re([lo,Iu].concat(Xd)),QC=e=>jn("toolbarbutton",LP,e),bb=[Ug].concat(Xd),NP=Re(bb.concat([lo,Iu])),eT=e=>jn("ToggleButton",NP,e),tT=[ko("predicate",ne),br("scope","node",["node","editor"]),br("position","selection",["node","selection","line"])],HP=Xd.concat([Bl("contextformbutton"),Wg,Iu,ds("original",Xe)]),VP=bb.concat([Bl("contextformbutton"),Wg,Iu,ds("original",Xe)]),zP=Xd.concat([Bl("contextformbutton")]),UP=bb.concat([Bl("contextformtogglebutton")]),WP=Hs("type",{contextformbutton:HP,contextformtogglebutton:VP}),jP=Re([Bl("contextform"),ko("initValue",O("")),gb,er("commands",WP),Sa("launch",Hs("type",{contextformbutton:zP,contextformtogglebutton:UP}))].concat(tT)),GP=e=>jn("ContextForm",jP,e),qP=Re([Bl("contexttoolbar"),go("items")].concat(tT)),KP=e=>jn("ContextToolbar",qP,e),YP=[lo,go("src"),ms("alt"),Va("classes",[],Fo)],XP=Re(YP),JP=[lo,Kc,AP,Va("classes",["tox-collection__item-label"],Fo)],ZP=Re(JP),nT=Nm(()=>Hc("type",{cardimage:XP,cardtext:ZP,cardcontainer:QP})),QP=Re([lo,Fr("direction","horizontal"),Fr("align","left"),Fr("valign","middle"),er("items",nT)]),Bu=[ka,Di,DP,IP("menuitem"),pb],eR=Re([lo,gb,er("items",nT),Il,hb].concat(Bu)),tR=e=>jn("cardmenuitem",eR,e),nR=Re([lo,Ug,oa].concat(Bu)),oR=e=>jn("choicemenuitem",nR,e),oT=[lo,go("fancytype"),hb],sR=[N("initData",{})].concat(oT),rR=[Vc("select"),_d("initData",{},[Ho("allowCustomColors",!0),Fr("storageKey","default"),jm("colors",Br())])].concat(oT),aR=Hs("fancytype",{inserttable:sR,colorswatch:rR}),cR=e=>jn("fancymenuitem",aR,e),iR=Re([lo,Il,hb,oa].concat(Bu)),lR=e=>jn("menuitem",iR,e),uR=Re([lo,kP,Il,oa].concat(Bu)),dR=e=>jn("nestedmenuitem",uR,e),mR=Re([lo,oa,Ug,Il,Iu].concat(Bu)),gR=e=>jn("togglemenuitem",mR,e),vb=(e,t,n)=>{const o=Us(e.element,"."+n);if(o.length>0){const s=en(o,r=>{const a=r.dom.getBoundingClientRect().top,c=o[0].dom.getBoundingClientRect().top;return Math.abs(a-c)>t}).getOr(o.length);return g.some({numColumns:s,numRows:Math.ceil(o.length/s)})}else return g.none()},sT=(e,t)=>ce([st(e,t)]),Jd={namedEvents:sT,unnamedEvents:e=>sT(Te("unnamed-events"),e)},rT=Te("tooltip.exclusive"),Zd=Te("tooltip.show"),Qd=Te("tooltip.hide"),aT=(e,t,n)=>{e.getSystem().broadcastOn([rT],{})};var pR=Object.freeze({__proto__:null,hideAllExclusive:aT,setComponents:(e,t,n,o)=>{n.getTooltip().each(s=>{s.getSystem().isConnected()&&Ze.set(s,o)})}}),hR=Object.freeze({__proto__:null,events:(e,t)=>{const n=s=>{t.getTooltip().each(r=>{Gc(r),e.onHide(s,r),t.clearTooltip()}),t.clearTimer()},o=s=>{if(!t.isShowing()){aT(s);const r=e.lazySink(s).getOrDie(),a=s.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:On(e.mode==="normal"?[Z(za(),c=>{jt(s,Zd)}),Z(os(),c=>{jt(s,Qd)})]:[]),behaviours:ce([Ze.config({})])});t.setTooltip(a),kl(r,a),e.onShow(s,a),xs.position(r,a,{anchor:e.anchor(s)})}};return On(xt([[Z(Zd,s=>{t.resetTimer(()=>{o(s)},e.delay)}),Z(Qd,s=>{t.resetTimer(()=>{n(s)},e.delay)}),Z(yl(),(s,r)=>{const a=r;a.universal||Tt(a.channels,rT)&&n(s)}),mc(s=>{n(s)})],e.mode==="normal"?[Z(uc(),s=>{jt(s,Zd)}),Z(yh(),s=>{jt(s,Qd)}),Z(za(),s=>{jt(s,Zd)}),Z(os(),s=>{jt(s,Qd)})]:[Z(Yy(),(s,r)=>{jt(s,Zd)}),Z(Th(),s=>{jt(s,Qd)})]]))}}),fR=[J("lazySink"),J("tooltipDom"),N("exclusive",!0),N("tooltipComponents",[]),N("delay",300),br("mode","normal",["normal","follow-highlight"]),N("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:O([Vo,Ss,as,sr,cs,rr]),onRtl:O([Vo,Ss,as,sr,cs,rr])}})),Dt("onHide"),Dt("onShow")],bR=Object.freeze({__proto__:null,init:()=>{const e=Mn(),t=Mn(),n=()=>{e.on(clearTimeout)},o=(r,a)=>{n(),e.set(setTimeout(r,a))},s=O("not-implemented");return Nr({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:n,resetTimer:o,readState:s})}});const cT=qo({fields:fR,name:"tooltipping",active:hR,state:bR,apis:pR}),vR=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),iT="silver.readonly",yR=Re([fh("readonly")]),jg=(e,t)=>{const o=e.mainUi.outerContainer.element,s=[e.mainUi.mothership,...e.uiMotherships];t&&be(s,r=>{r.broadcastOn([Oi()],{target:o})}),be(s,r=>{r.broadcastOn([iT],{readonly:t})})},lT=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&jg(t,!0)}),e.on("SwitchMode",()=>jg(t,e.mode.isReadOnly())),tC(e)&&e.mode.set("readonly")},Ao=()=>zr.config({channels:{[iT]:{schema:yR,onReceive:(e,t)=>{Ne.set(e,t.readonly)}}}}),Ea={item:e=>Ne.config({disabled:e,disableClass:"tox-collection__item--state-disabled"}),button:e=>Ne.config({disabled:e}),splitButton:e=>Ne.config({disabled:e,disableClass:"tox-tbtn--disabled"}),toolbarButton:e=>Ne.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},Gg=(e,t)=>{const n=e.getApi(t);return o=>{o(n)}},Mi=(e,t)=>Pn(n=>{Gg(e,n)(s=>{const r=e.onSetup(s);qe(r)&&t.set(r)})}),$i=(e,t)=>mc(n=>Gg(e,n)(t.get())),SR=(e,t)=>Uc((n,o)=>{Gg(e,n)(e.onAction),!e.triggersSubmenu&&t===qa.CLOSE_ON_EXECUTE&&(n.getSystem().isConnected()&&jt(n,Km()),o.stop())}),xR={[Lr()]:["disabling","alloy.base.behaviour","toggling","item-events"]},Fu=es,Pu=(e,t,n,o)=>{const s=Le(Q);return{type:"item",dom:t.dom,components:Fu(t.optComponents),data:e.data,eventOrder:xR,hasSubmenu:e.triggersSubmenu,itemBehaviours:ce([st("item-events",[SR(e,n),Mi(e,s),$i(e,s)]),Ea.item(()=>!e.enabled||o.isDisabled()),Ao(),Ze.config({})].concat(e.itemBehaviours))}},Ru=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),wR=e=>{const t=Du.os.isMacOS()||Du.os.isiOS(),s=t?{alt:"",ctrl:"",shift:"",meta:"",access:""}:{meta:"Ctrl",access:"Shift+Alt"},r=e.split("+"),a=ae(r,c=>{const l=c.toLowerCase().trim();return wt(s,l)?s[l]:c});return t?a.join(""):a.join("+")},yb=(e,t,n=[IC])=>Oa(e,{tag:"div",classes:n},t),uT=e=>({dom:{tag:"div",classes:[ab]},components:[ho(ta.translate(e))]}),dT=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),CR=(e,t)=>({dom:{tag:"div",classes:[ab]},components:[{dom:{tag:e.tag,styles:e.styles},components:[ho(ta.translate(t))]}]}),TR=e=>({dom:{tag:"div",classes:[sP]},components:[ho(wR(e))]}),mT=e=>yb("checkmark",e,[rP]),_R=e=>yb("chevron-right",e,[BC]),OR=e=>yb("chevron-down",e,[BC]),kR=(e,t)=>{const n=e.direction==="vertical"?aP:PC,o=e.align==="left"?iP:cP;return{dom:{tag:"div",classes:[FC,n,o,(()=>{switch(e.valign){case"top":return lP;case"middle":return uP;case"bottom":return dP}})()]},components:t}},ER=(e,t,n)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:n.getOr("")}}}),AR=(e,t,n)=>{const o="custom",s="remove",r=e.ariaLabel,a=e.value,c=e.iconContent.map(d=>jF(d,t.icons,n));return{dom:(()=>{const d=rb,p=c.getOr(""),b={tag:"div",attributes:r.map(S=>({title:t.translate(S)})).getOr({}),classes:[d]};return a===o?{...b,tag:"button",classes:[...b.classes,"tox-swatches__picker-btn"],innerHtml:p}:a===s?{...b,classes:[...b.classes,"tox-swatch--remove"],innerHtml:p}:Ye(a)?{...b,attributes:{...b.attributes,"data-mce-color":a},styles:{"background-color":a},innerHtml:p}:b})(),optComponents:[]}},gT=e=>{const t=e.map(n=>({attributes:{title:ta.translate(n),id:Te("menu-item")}})).getOr({});return{tag:"div",classes:[sb,Rg],...t}},DR=(e,t,n,o)=>{const s={tag:"div",classes:[IC]},r=b=>Oa(b,s,t.icons,o),a=()=>g.some({dom:s}),c=n?e.iconContent.map(r).orThunk(a):g.none(),l=e.checkMark,d=g.from(e.meta).fold(()=>uT,b=>wt(b,"style")?Et(CR,b.style):uT),p=e.htmlContent.fold(()=>e.textContent.map(d),b=>g.some(dT(b,[ab])));return{dom:gT(e.ariaLabel),optComponents:[c,p,e.shortcutContent.map(TR),l,e.caret]}},em=(e,t,n,o=g.none())=>e.presets==="color"?AR(e,t,o):DR(e,t,n,o),pT=(e,t)=>Se(e,"tooltipWorker").map(n=>[cT.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:o=>({type:"submenu",item:o,overrides:{maxHeightFunction:Cu}}),mode:"follow-highlight",onShow:(o,s)=>{n(r=>{cT.setComponents(o,[uS({element:te.fromDom(r)})])})}})]).getOr([]),MR=e=>Ud.DOM.encode(e),hT=(e,t)=>{const n=ta.translate(e),o=MR(n);if(t.length>0){const s=new RegExp(vR(t),"gi");return o.replace(s,r=>`<span class="tox-autocompleter-highlight">${r}</span>`)}else return o},$R=(e,t,n,o,s,r,a,c=!0)=>{const l=em({presets:o,textContent:g.none(),htmlContent:n?e.text.map(d=>hT(d,t)):g.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:g.none(),checkMark:g.none(),caret:g.none(),value:e.value},a.providers,c,e.icon);return Pu({data:Ru(e),enabled:e.enabled,getApi:O({}),onAction:d=>s(e.value,e.meta),onSetup:O(Q),triggersSubmenu:!1,itemBehaviours:pT(e.meta,a)},l,r,a.providers)},fT=(e,t)=>ae(e,n=>{switch(n.type){case"cardcontainer":return kR(n,fT(n.items,t));case"cardimage":return ER(n.src,n.classes,n.alt);case"cardtext":const s=n.name.exists(r=>Tt(t.cardText.highlightOn,r))?g.from(t.cardText.matchText).getOr(""):"";return dT(hT(n.text,s),n.classes)}}),IR=(e,t,n,o)=>{const s=a=>({isEnabled:()=>!Ne.isDisabled(a),setEnabled:c=>{Ne.set(a,!c),be(Us(a.element,"*"),l=>{a.getSystem().getByDom(l).each(d=>{d.hasConfigured(Ne)&&Ne.set(d,!c)})})}}),r={dom:gT(e.label),optComponents:[g.some({dom:{tag:"div",classes:[FC,PC]},components:fT(e.items,o)})]};return Pu({data:Ru({text:g.none(),...e}),enabled:e.enabled,getApi:s,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:g.from(o.itemBehaviours).getOr([])},r,t,n.providers)},BR=(e,t,n,o,s,r,a,c=!0)=>{const l=p=>({setActive:h=>{it.set(p,h)},isActive:()=>it.isOn(p),isEnabled:()=>!Ne.isDisabled(p),setEnabled:h=>Ne.set(p,!h)}),d=em({presets:n,textContent:t?e.text:g.none(),htmlContent:g.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:g.none(),checkMark:t?g.some(mT(a.icons)):g.none(),caret:g.none(),value:e.value},a,c);return Wn(Pu({data:Ru(e),enabled:e.enabled,getApi:l,onAction:p=>o(e.value),onSetup:p=>(p.setActive(s),Q),triggersSubmenu:!1,itemBehaviours:[]},d,r,a),{toggling:{toggleClass:$C,toggleOnExecute:!1,selected:e.active,exclusive:!0}})},bT=Cf(Hf(),Vf()),vT=e=>({value:wT(e)}),yT=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ST=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,xT=e=>yT.test(e)||ST.test(e),wT=e=>Es(e,"#").toUpperCase(),FR=e=>xT(e)?g.some({value:wT(e)}):g.none(),PR=e=>({value:e.value.replace(yT,(n,o,s,r)=>o+o+s+s+r+r)}),RR=e=>{const t=PR(e),n=ST.exec(t.value);return n===null?["FFFFFF","FF","FF","FF"]:n},Sb=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},tm=e=>{const t=Sb(e.red)+Sb(e.green)+Sb(e.blue);return vT(t)},CT=Math.min,TT=Math.max,qg=Math.round,LR=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,NR=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Ii=(e,t,n,o)=>({red:e,green:t,blue:n,alpha:o}),xb=e=>{const t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},_T=e=>{let t,n,o;const s=(e.hue||0)%360;let r=e.saturation/100,a=e.value/100;if(r=TT(0,CT(r,1)),a=TT(0,CT(a,1)),r===0)return t=n=o=qg(255*a),Ii(t,n,o,1);const c=s/60,l=a*r,d=l*(1-Math.abs(c%2-1)),p=a-l;switch(Math.floor(c)){case 0:t=l,n=d,o=0;break;case 1:t=d,n=l,o=0;break;case 2:t=0,n=l,o=d;break;case 3:t=0,n=d,o=l;break;case 4:t=d,n=0,o=l;break;case 5:t=l,n=0,o=d;break;default:t=n=o=0}return t=qg(255*(t+p)),n=qg(255*(n+p)),o=qg(255*(o+p)),Ii(t,n,o,1)},nm=e=>{const t=RR(e),n=parseInt(t[1],16),o=parseInt(t[2],16),s=parseInt(t[3],16);return Ii(n,o,s,1)},OT=(e,t,n,o)=>{const s=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),c=parseFloat(o);return Ii(s,r,a,c)},wb=e=>{if(e==="transparent")return g.some(Ii(0,0,0,0));const t=LR.exec(e);if(t!==null)return g.some(OT(t[1],t[2],t[3],"1"));const n=NR.exec(e);return n!==null?g.some(OT(n[1],n[2],n[3],n[4])):g.none()},kT=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,ET=Ii(255,0,0,1),HR=e=>{e.dispatch("SkinLoaded")},VR=(e,t)=>{e.dispatch("SkinLoadError",t)},zR=e=>{e.dispatch("ResizeEditor")},Cb=(e,t)=>{e.dispatch("ResizeContent",t)},UR=(e,t)=>{e.dispatch("ScrollContent",t)},AT=(e,t)=>{e.dispatch("TextColorChange",t)},WR=(e,t)=>{e.dispatch("AfterProgressState",{state:t})},jR=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t}),GR=(e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})},Tb=(e,t)=>()=>{e(),t()},Cs=e=>Fl(e,"NodeChange",t=>{t.setEnabled(e.selection.isEditable())}),qR=(e,t)=>n=>{const o=wu(),s=()=>{n.setActive(e.formatter.match(t));const r=e.formatter.formatChanged(t,n.setActive);o.set(r)};return e.initialized?s():e.once("init",s),()=>{e.off("init",s),o.clear()}},Kg=(e,t)=>n=>{const o=Cs(e)(n),s=qR(e,t)(n);return()=>{o(),s()}},Fl=(e,t,n)=>o=>{const s=()=>n(o),r=()=>{n(o),e.on(t,s)};return e.initialized?r():e.once("init",r),()=>{e.off("init",r),e.off(t,s)}},DT=e=>t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})},Sr=(e,t)=>()=>e.execCommand(t);var Pl=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");const MT={},KR=(e,t=10)=>{const n=Pl.getItem(e),o=Ee(n)?JSON.parse(n):[],r=(d=>t-d.length<0?d.slice(0,t):d)(o),a=d=>{Jn(r,d).each(c),r.unshift(d),r.length>t&&r.pop(),Pl.setItem(e,JSON.stringify(r))},c=d=>{r.splice(d,1)};return{add:a,state:()=>r.slice(0)}},$T=e=>Se(MT,e).getOrThunk(()=>{const t=`tinymce-custom-colors-${e}`,n=Pl.getItem(t);if(Ge(n)){const s=Pl.getItem("tinymce-custom-colors");Pl.setItem(t,Ye(s)?s:"[]")}const o=KR(t,10);return MT[e]=o,o}),YR=e=>ae($T(e).state(),t=>({type:"choiceitem",text:t,icon:"checkmark",value:t})),IT=(e,t)=>{$T(e).add(t)},om=(e,t,n)=>({hue:e,saturation:t,value:n}),_b=e=>{let t=0,n=0,o=0;const s=e.red/255,r=e.green/255,a=e.blue/255,c=Math.min(s,Math.min(r,a)),l=Math.max(s,Math.max(r,a));if(c===l)return o=c,om(0,0,o*100);const d=s===c?r-a:a===c?s-r:a-s;return t=s===c?3:a===c?1:5,t=60*(t-d/(l-c)),n=(l-c)/l,o=l,om(Math.round(t),Math.round(n*100),Math.round(o*100))},XR=e=>_b(nm(e)),BT=e=>tm(_T(e)),JR=e=>FR(e).orThunk(()=>wb(e).map(tm)).getOrThunk(()=>{const t=document.createElement("canvas");t.height=1,t.width=1;const n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);const o=n.getImageData(0,0,1,1).data,s=o[0],r=o[1],a=o[2],c=o[3];return tm(Ii(s,r,a,c))}),Ob="forecolor",kb="hilitecolor",Eb=5,FT=e=>Math.max(Eb,Math.ceil(Math.sqrt(e))),PT=(e,t)=>{const n=FT(t),o=bc("color_cols")(e);return Eb===n?o:n},ZR=e=>{const t=[];for(let n=0;n<e.length;n+=2)t.push({text:e[n+1],value:"#"+JR(e[n]).value,icon:"checkmark",type:"choiceitem"});return t},bc=e=>t=>t.options.get(e),Ab="#000000",QR=e=>{const t=e.options.register,n=o=>ie(o,Ee)?{value:ZR(o),valid:!0}:{valid:!1,message:"Must be an array of strings."};t("color_map",{processor:n,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_background",{processor:n}),t("color_map_foreground",{processor:n}),t("color_cols",{processor:"number",default:FT(sm(e,"default").length)}),t("color_cols_foreground",{processor:"number",default:PT(e,sm(e,Ob).length)}),t("color_cols_background",{processor:"number",default:PT(e,sm(e,kb).length)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:Ab}),t("color_default_background",{processor:"string",default:Ab})},eL=(e,t)=>t===Ob?bc("color_cols_foreground")(e):t===kb?bc("color_cols_background")(e):bc("color_cols")(e),RT=(e,t)=>{const n=eL(e,t);return n>0?n:Eb},LT=bc("custom_colors"),sm=(e,t)=>t===Ob&&e.options.isSet("color_map_foreground")?bc("color_map_foreground")(e):t===kb&&e.options.isSet("color_map_background")?bc("color_map_background")(e):bc("color_map")(e),tL=bc("color_default_foreground"),nL=bc("color_default_background"),oL="rgba(0, 0, 0, 0)",sL=e=>wb(e).exists(t=>t.alpha!==0),rL=e=>gs(e,t=>{if(Co(t)){const n=Un(t,"background-color");return ts(sL(n),n)}else return g.none()}).getOr(oL),NT=(e,t)=>{const n=te.fromDom(e.selection.getStart()),o=t==="hilitecolor"?rL(n):Un(n,"color");return wb(o).map(s=>"#"+tm(s).value)},aL=(e,t,n)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.apply(t,{value:n}),e.nodeChanged()})},cL=(e,t)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()})},iL=e=>{e.addCommand("mceApplyTextcolor",(t,n)=>{aL(e,t,n)}),e.addCommand("mceRemoveTextcolor",t=>{cL(e,t)})},HT=e=>{const t="choiceitem",n={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[n,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[n]},Db=(e,t,n,o)=>{n==="custom"?GT(e)(r=>{r.each(a=>{IT(t,a),e.execCommand("mceApplyTextcolor",t,a),o(a)})},NT(e,t).getOr(Ab)):n==="remove"?(o(""),e.execCommand("mceRemoveTextcolor",t)):(o(n),e.execCommand("mceApplyTextcolor",t,n))},VT=(e,t,n)=>e.concat(YR(t).concat(HT(n))),zT=(e,t,n)=>o=>{o(VT(e,t,n))},Mb=(e,t,n)=>{const o=t==="forecolor"?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";e.setIconFill(o,n)},UT=(e,t)=>n=>{const o=NT(e,t);return Io(o,n.toUpperCase())},WT=(e,t,n,o,s)=>{e.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:t==="forecolor"?"text-color":"highlight-bg-color",select:UT(e,n),columns:RT(e,n),fetch:zT(sm(e,n),n,LT(e)),onAction:r=>{Db(e,n,s.get(),Q)},onItemAction:(r,a)=>{Db(e,n,a,c=>{s.set(c),AT(e,{name:t,color:c})})},onSetup:r=>{Mb(r,t,s.get());const a=c=>{c.name===t&&Mb(r,c.name,c.color)};return e.on("TextColorChange",a),Tb(Cs(e)(r),()=>{e.off("TextColorChange",a)})}})},jT=(e,t,n,o,s)=>{e.ui.registry.addNestedMenuItem(t,{text:o,icon:t==="forecolor"?"text-color":"highlight-bg-color",onSetup:r=>(Mb(r,t,s.get()),Cs(e)(r)),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:UT(e,n),initData:{storageKey:n},onAction:r=>{Db(e,n,r.value,a=>{s.set(a),AT(e,{name:t,color:a})})}}]})},GT=e=>(t,n)=>{let o=!1;const s=c=>{const d=c.getData().colorpicker;o?(t(g.from(d)),c.close()):e.windowManager.alert(e.translate(["Invalid hex color code: {0}",d]))},r=(c,l)=>{l.name==="hex-valid"&&(o=l.value)},a={colorpicker:n};e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onAction:r,onSubmit:s,onClose:Q,onCancel:()=>{t(g.none())}})},lL=e=>{iL(e);const t=tL(e),n=nL(e),o=Le(t),s=Le(n);WT(e,"forecolor","forecolor","Text color",o),WT(e,"backcolor","hilitecolor","Background color",s),jT(e,"forecolor","forecolor","Text color",o),jT(e,"backcolor","hilitecolor","Background color",s)},$b=(e,t,n,o,s,r,a,c)=>{const l=Vg(t),p=uL(t,n,o,s!=="color"?"normal":"color",r,a,c);return ub(e,l,p,o,{menuType:s})},uL=(e,t,n,o,s,r,a)=>es(ae(e,c=>c.type==="choiceitem"?oR(c).fold(qc,l=>g.some(BR(l,n===1,o,t,r(l.value),s,a,Vg(e)))):g.none())),Yg=(e,t)=>{const n=Ml(t);return e===1?{mode:"menu",moveOnTab:!0}:e==="auto"?{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+(t==="color"?"tox-swatches__row":"tox-collection__group"),previousSelector:s=>t==="color"?fo(s.element,"[aria-checked=true]"):g.none()}},dL=(e,t)=>e===1?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:e==="auto"?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:t==="color"?".tox-swatches__row":".tox-collection__group",cell:t==="color"?`.${rb}`:`.${Rg}`}},mL=(e,t)=>{const n=gL(e,t),o=t.colorinput.getColorCols(e.initData.storageKey),s="color",a={...$b(Te("menu-value"),n,c=>{e.onAction({value:c})},o,s,qa.CLOSE_ON_EXECUTE,e.select.getOr(ne),t.shared.providers),markers:Ml(s),movement:Yg(o,s)};return{type:"widget",data:{value:Te("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[bT.widget(Al.sketch(a))]}},gL=(e,t)=>{const n=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>VT(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,n),o=>o.concat(HT(n)))},qT=Te("cell-over"),KT=Te("cell-execute"),pL=(e,t,n)=>{const o=a=>Be(a,qT,{row:e,col:t}),s=a=>Be(a,KT,{row:e,col:t}),r=(a,c)=>{c.stop(),s(a)};return ps({dom:{tag:"div",attributes:{role:"button","aria-labelledby":n}},behaviours:ce([st("insert-table-picker-cell",[Z(za(),Ve.focus),Z(Lr(),s),Z(vl(),r),Z(Ad(),r)]),it.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Ve.config({onFocus:o})])})},hL=(e,t,n)=>{const o=[];for(let s=0;s<t;s++){const r=[];for(let a=0;a<n;a++)r.push(pL(s,a,e));o.push(r)}return o},fL=(e,t,n,o,s)=>{for(let r=0;r<o;r++)for(let a=0;a<s;a++)it.set(e[r][a],r<=t&&a<=n)},bL=e=>At(e,t=>ae(t,Qr)),YT=(e,t)=>ho(`${t}x${e}`),vL={inserttable:e=>{const o=Te("size-label"),s=hL(o,10,10),r=YT(0,0),a=Yt({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[r],behaviours:ce([Ze.config({})])});return{type:"widget",data:{value:Te("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[bT.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:bL(s).concat(a.asSpec()),behaviours:ce([st("insert-table-picker",[Pn(c=>{Ze.set(a.get(c),[r])}),Eh(qT,(c,l,d)=>{const{row:p,col:h}=d.event;fL(s,p,h,10,10),Ze.set(a.get(c),[YT(p+1,h+1)])}),Eh(KT,(c,l,d)=>{const{row:p,col:h}=d.event;e.onAction({numRows:p+1,numColumns:h+1}),jt(c,Km())})]),$e.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:mL},yL=(e,t)=>Se(vL,e.fancytype).map(n=>n(e,t)),SL=(e,t,n,o=!0,s=!1)=>{const r=s?OR(n.icons):_R(n.icons),a=l=>({isEnabled:()=>!Ne.isDisabled(l),setEnabled:d=>Ne.set(l,!d),setIconFill:(d,p)=>{fo(l.element,`svg path[class="${d}"], rect[class="${d}"]`).each(h=>{Qe(h,"fill",p)})}}),c=em({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:g.none(),ariaLabel:e.text,caret:g.some(r),checkMark:g.none(),shortcutContent:e.shortcut},n,o);return Pu({data:Ru(e),getApi:a,enabled:e.enabled,onAction:Q,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,t,n)},xL=(e,t,n,o=!0)=>{const s=a=>({isEnabled:()=>!Ne.isDisabled(a),setEnabled:c=>Ne.set(a,!c)}),r=em({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:g.none(),ariaLabel:e.text,caret:g.none(),checkMark:g.none(),shortcutContent:e.shortcut},n,o);return Pu({data:Ru(e),getApi:s,enabled:e.enabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,n)},wL=e=>({type:"separator",dom:{tag:"div",classes:[Rg,oP]},components:e.text.map(ho).toArray()}),CL=(e,t,n,o=!0)=>{const s=a=>({setActive:c=>{it.set(a,c)},isActive:()=>it.isOn(a),isEnabled:()=>!Ne.isDisabled(a),setEnabled:c=>Ne.set(a,!c)}),r=em({iconContent:e.icon,textContent:e.text,htmlContent:g.none(),ariaLabel:e.text,checkMark:g.some(mT(n.icons)),caret:g.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},n,o);return Wn(Pu({data:Ru(e),enabled:e.enabled,getApi:s,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,n),{toggling:{toggleClass:$C,toggleOnExecute:!1,selected:e.active}})},TL=$R,XT=wL,_L=xL,OL=SL,kL=CL,EL=yL,AL=IR;var DL=Object.freeze({__proto__:null,getCoupled:(e,t,n,o)=>n.getOrCreate(e,t,o),getExistingCoupled:(e,t,n,o)=>n.getExisting(e,t,o)}),ML=[Qs("others",zm(Me.value,Br()))],$L=Object.freeze({__proto__:null,init:()=>{const e={},t=(r,a)=>{if(Lt(r.others).length===0)throw new Error("Cannot find any known coupled components");return Se(e,a)},n=(r,a,c)=>t(a,c).getOrThunk(()=>{const d=Se(a.others,c).getOrDie("No information found for coupled component: "+c)(r),p=r.getSystem().build(d);return e[c]=p,p}),o=(r,a,c)=>t(a,c).orThunk(()=>(Se(a.others,c).getOrDie("No information found for coupled component: "+c),g.none())),s=O({});return Nr({readState:s,getExisting:o,getOrCreate:n})}});const Qn=qo({fields:ML,name:"coupling",apis:DL,state:$L}),Ib=e=>{let t=g.none(),n=[];const o=d=>Ib(p=>{s(h=>{p(d(h))})}),s=d=>{a()?l(d):n.push(d)},r=d=>{a()||(t=g.some(d),c(n),n=[])},a=()=>t.isSome(),c=d=>{be(d,l)},l=d=>{t.each(p=>{setTimeout(()=>{d(p)},0)})};return e(r),{get:s,map:o,isReady:a}},IL={nu:Ib,pure:e=>Ib(t=>{t(e)})},BL=e=>{setTimeout(()=>{throw e},0)},Lu=e=>{const t=l=>{e().then(l,BL)};return{map:l=>Lu(()=>e().then(l)),bind:l=>Lu(()=>e().then(d=>l(d).toPromise())),anonBind:l=>Lu(()=>e().then(()=>l.toPromise())),toLazy:()=>IL.nu(t),toCached:()=>{let l=null;return Lu(()=>(l===null&&(l=e()),l))},toPromise:e,get:t}},is={nu:e=>Lu(()=>new Promise(e)),pure:e=>Lu(()=>Promise.resolve(e))},JT=O("sink"),ZT=O(ea({name:JT(),overrides:O({dom:{tag:"div"},behaviours:ce([xs.config({useFixed:ge})]),events:On([wl(nr()),wl(mt()),wl(vl())])})})),QT=(e,t)=>{const n=e.getHotspot(t).getOr(t),o="hotspot",s=e.getAnchorOverrides();return e.layouts.fold(()=>({type:o,hotspot:n,overrides:s}),r=>({type:o,hotspot:n,overrides:s,layouts:r}))},FL=(e,t,n)=>{const o=e.fetch;return o(n).map(t)},PL=(e,t,n,o,s,r,a)=>{const c=FL(e,t,o),l=e_(o,e);return c.map(d=>d.bind(p=>g.from(Dl.sketch({...r.menu(),uid:yu(""),data:p,highlightOnOpen:a,onOpenMenu:(h,b)=>{const S=l().getOrDie();xs.position(S,b,{anchor:n}),Mt.decloak(s)},onOpenSubmenu:(h,b,S)=>{const _=l().getOrDie();xs.position(_,S,{anchor:{type:"submenu",item:b}}),Mt.decloak(s)},onRepositionMenu:(h,b,S)=>{const _=l().getOrDie();xs.position(_,b,{anchor:n}),be(S,k=>{xs.position(_,k.triggeredMenu,{anchor:{type:"submenu",item:k.triggeringItem}})})},onEscape:()=>(Ve.focus(o),Mt.close(s),g.some(!0))}))))},Xg=(e,t,n,o,s,r,a)=>{const c=QT(e,n);return PL(e,t,c,n,o,s,a).map(d=>(d.fold(()=>{Mt.isOpen(o)&&Mt.close(o)},p=>{Mt.cloak(o),Mt.open(o,p),r(o)}),o))},RL=(e,t,n,o,s,r,a)=>(Mt.close(o),is.pure(o)),Bb=(e,t,n,o,s,r)=>{const a=Qn.getCoupled(n,"sandbox");return(Mt.isOpen(a)?RL:Xg)(e,t,n,a,o,s,r)},LL=(e,t,n)=>{const o=Ot.getCurrent(t).getOr(t),s=Oo(e.element);n?pe(o.element,"min-width",s+"px"):Jl(o.element,s)},e_=(e,t)=>e.getSystem().getByUid(t.uid+"-"+JT()).map(n=>()=>Me.value(n)).getOrThunk(()=>t.lazySink.fold(()=>()=>Me.error(new Error("No internal sink is specified, nor could an external sink be found")),n=>()=>n(e))),t_=e=>{Mt.getState(e).each(t=>{Dl.repositionMenus(t)})},Fb=(e,t,n)=>{const o=hS(),s=(c,l)=>{const d=QT(e,t);o.link(t.element),e.matchWidth&&LL(d.hotspot,l,e.useMinWidth),e.onOpen(d,c,l),n!==void 0&&n.onOpen!==void 0&&n.onOpen(c,l)},r=(c,l)=>{o.unlink(t.element),n!==void 0&&n.onClose!==void 0&&n.onClose(c,l)},a=e_(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Ta.augment(e.sandboxBehaviours,[ye.config({store:{mode:"memory",initialValue:t}}),Mt.config({onOpen:s,onClose:r,isPartOf:(c,l,d)=>Tl(l,d)||Tl(t,d),getAttachPoint:()=>a().getOrDie()}),Ot.config({find:c=>Mt.getState(c).bind(l=>Ot.getCurrent(l))}),zr.config({channels:{...hf({isExtraPart:ne}),...ff({doReposition:t_})}})])}},n_=e=>{const t=Qn.getCoupled(e,"sandbox");t_(t)},Pb=()=>[N("sandboxClasses",[]),Ta.field("sandboxBehaviours",[Ot,zr,Mt,ye])],NL=O([J("dom"),J("fetch"),Dt("onOpen"),vr("onExecute"),N("getHotspot",g.some),N("getAnchorOverrides",O({})),_i(),zo("dropdownBehaviours",[it,Qn,$e,Ve]),J("toggleClass"),N("eventOrder",{}),Wt("lazySink"),N("matchWidth",!1),N("useMinWidth",!1),Wt("role")].concat(Pb())),HL=O([_a({schema:[tg(),N("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),ZT()]),VL=(e,t,n,o)=>{const s=p=>Se(e.dom,"attributes").bind(h=>Se(h,p)),r=p=>{Mt.getState(p).each(h=>{Dl.highlightPrimary(h)})},a=(p,h,b)=>Bb(e,Xe,p,o,h,b),c=p=>{a(p,r,Ws.HighlightMenuAndItem).get(Q)},l={expand:p=>{it.isOn(p)||a(p,Q,Ws.HighlightNone).get(Q)},open:p=>{it.isOn(p)||a(p,Q,Ws.HighlightMenuAndItem).get(Q)},refetch:p=>Qn.getExistingCoupled(p,"sandbox").fold(()=>a(p,Q,Ws.HighlightMenuAndItem).map(Q),b=>Xg(e,Xe,p,b,o,Q,Ws.HighlightMenuAndItem).map(Q)),isOpen:it.isOn,close:p=>{it.isOn(p)&&a(p,Q,Ws.HighlightMenuAndItem).get(Q)},repositionMenus:p=>{it.isOn(p)&&n_(p)}},d=(p,h)=>(xl(p),g.some(!0));return{uid:e.uid,dom:e.dom,components:t,behaviours:Ko(e.dropdownBehaviours,[it.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Qn.config({others:{sandbox:p=>Fb(e,p,{onOpen:()=>it.on(p),onClose:()=>it.off(p)})}}),$e.config({mode:"special",onSpace:d,onEnter:d,onDown:(p,h)=>{if(sa.isOpen(p)){const b=Qn.getCoupled(p,"sandbox");r(b)}else sa.open(p);return g.some(!0)},onEscape:(p,h)=>sa.isOpen(p)?(sa.close(p),g.some(!0)):g.none()}),Ve.config({})]),events:Mg(g.some(c)),eventOrder:{...e.eventOrder,[Lr()]:["disabling","toggling","alloy.base.behaviour"]},apis:l,domModification:{attributes:{"aria-haspopup":"true",...e.role.fold(()=>({}),p=>({role:p})),...e.dom.tag==="button"?{type:s("type").getOr("button")}:{}}}}},sa=ws({name:"Dropdown",configFields:NL(),partFields:HL(),factory:VL,apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),zL=e=>{switch(e.searchMode){case"no-search":return{menuType:"normal"};default:return{menuType:"searchable",searchMode:e}}},UL=e=>{const t=ye.getValue(e),n=Ng(e).map(jC);sa.refetch(t).get(()=>{const o=Qn.getCoupled(t,"sandbox");n.each(s=>Ng(o).each(r=>bP(r,s)))})},WL=(e,t)=>{jL(e).each(n=>{vD(e,n.element,t.event.eventType,t.event.interactionEvent)})},jL=e=>Mt.getState(e).bind(Vt.getHighlighted).bind(Vt.getHighlighted),GL=e=>or(e.element,Hg)?g.some(e.element):fo(e.element,"."+Hg),o_=(e,t,n)=>{WC(e).each(o=>{vP(o,n),GL(t).each(r=>{Go(r,"id").each(a=>Qe(o.element,"aria-controls",a))})}),Qe(n.element,"aria-selected","true")},qL=(e,t,n)=>{Qe(n.element,"aria-selected","false")},KL=e=>{WC(e).each(t=>Ve.focus(t))},YL=e=>Qn.getExistingCoupled(e,"sandbox").bind(Ng).map(jC).map(n=>n.fetchPattern).getOr("");var Jg;(function(e){e[e.ContentFocus=0]="ContentFocus",e[e.UiFocus=1]="UiFocus"})(Jg||(Jg={}));const XL=(e,t,n,o,s)=>{const r=n.shared.providers,a=c=>s?{...c,shortcut:g.none(),icon:c.text.isSome()?g.none():c.icon}:c;switch(e.type){case"menuitem":return lR(e).fold(qc,c=>g.some(_L(a(c),t,r,o)));case"nestedmenuitem":return dR(e).fold(qc,c=>g.some(OL(a(c),t,r,o,s)));case"togglemenuitem":return gR(e).fold(qc,c=>g.some(kL(a(c),t,r,o)));case"separator":return BP(e).fold(qc,c=>g.some(XT(c)));case"fancymenuitem":return cR(e).fold(qc,c=>EL(c,n));default:return console.error("Unknown item in general menu",e),g.none()}},JL=(e,t,n,o,s,r,a)=>{const c=o===1,l=!c||Vg(e);return es(ae(e,d=>{switch(d.type){case"separator":return PP(d).fold(qc,p=>g.some(XT(p)));case"cardmenuitem":return tR(d).fold(qc,p=>g.some(AL({...p,onAction:h=>{p.onAction(h),n(p.value,p.meta)}},s,r,{itemBehaviours:pT(p.meta,r),cardText:{matchText:t,highlightOn:a}})));case"autocompleteitem":default:return RP(d).fold(qc,p=>g.some(TL(p,t,c,"normal",n,s,r,l)))}}))},s_=(e,t,n,o,s,r)=>{const a=Vg(t),c=es(ae(t,p=>{const h=S=>s?!wt(S,"text"):a,b=S=>XL(S,n,o,h(S),s);return p.type==="nestedmenuitem"&&p.getSubmenuItems().length<=0?b({...p,enabled:!1}):b(p)})),l=zL(r);return(s?_P:ub)(e,a,c,1,l)},Rb=e=>Dl.singleData(e.value,e),ZL=(e,t,n,o)=>{const s=Yg(t,o),r=Ml(o);return{data:Rb({...e,movement:s,menuBehaviours:Jd.unnamedEvents(t!=="auto"?[]:[Pn((a,c)=>{vb(a,4,r.item).each(({numColumns:l,numRows:d})=>{$e.setGridSize(a,d,l)})})])}),menu:{markers:Ml(o),fakeFocus:n===Jg.ContentFocus}}},QL=(e,t)=>MC(te.fromDom(t.startContainer)).map(n=>{const o=e.createRng();return o.selectNode(n.dom),o}),eN={register:(e,t)=>{const n=Le(!1),o=Le(!1),s=ps(Nn.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:ce([st("dismissAutocompleter",[Z(Sl(),()=>d())])]),lazySink:t.getSink})),r=()=>Nn.isOpen(s),a=o.get,c=()=>{r()&&Nn.hide(s)},l=()=>Nn.getContent(s).bind(_=>we(_.components(),0)),d=()=>e.execCommand("mceAutocompleterClose"),p=_=>{const k=on(_,L=>g.from(L.columns)).getOr(1);return At(_,L=>{const R=L.items;return JL(R,L.matchText,(B,q)=>{const V=e.selection.getRng();QL(e.dom,V).each(re=>{const ee={hide:()=>d(),reload:le=>{c(),e.execCommand("mceAutocompleterReload",!1,{fetchOptions:le})}};n.set(!0),L.onAction(ee,re,B,q),n.set(!1)})},k,qa.BUBBLE_TO_SANDBOX,t,L.highlightOn)})},h=(_,k)=>{eP(te.fromDom(e.getBody())).each(L=>{const R=on(_,B=>g.from(B.columns)).getOr(1);Nn.showMenuAt(s,{anchor:{type:"node",root:te.fromDom(e.getBody()),node:g.from(L)}},ZL(ub("autocompleter-value",!0,k,R,{menuType:"normal"}),R,Jg.ContentFocus,"normal"))}),l().each(Vt.highlightFirst)},b=_=>{const k=p(_);k.length>0?h(_,k):c()};e.on("AutocompleterStart",({lookupData:_})=>{o.set(!0),n.set(!1),b(_)}),e.on("AutocompleterUpdate",({lookupData:_})=>b(_)),e.on("AutocompleterEnd",()=>{c(),o.set(!1),n.set(!1)});const S={cancelIfNecessary:d,isMenuOpen:r,isActive:a,isProcessingAction:n.get,getMenu:l};tP.setup(S,e)}},tN=["visible","hidden"],r_=e=>{if(ia(e)){const t=Un(e,"overflow");return $n(t).length>0&&!Tt(tN,t)}else return!1},nN=e=>{const t=ex(e,r_),n=t.length===0?Ie(e).map(Jt).map(o=>ex(o,r_)).getOr([]):t;return He(n).map(o=>({element:o,others:n.slice(1)}))},Rl=(e,t)=>Ai(e)?nN(t):g.none(),Nu=e=>{const t=[...ae(e.others,f),oe()];return F(f(e.element),t)},rm=(e,t,n)=>Wa(e,t,n).isSome(),a_=(e,t)=>{let n=null;return{cancel:()=>{n!==null&&(clearTimeout(n),n=null)},schedule:(...r)=>{n=setTimeout(()=>{e.apply(null,r),n=null},t)}}},c_=5,oN=400,i_=e=>{const t=e.raw;return t.touches===void 0||t.touches.length!==1?g.none():g.some(t.touches[0])},sN=(e,t)=>{const n=Math.abs(e.clientX-t.x),o=Math.abs(e.clientY-t.y);return n>c_||o>c_},rN=e=>{const t=Mn(),n=Le(!1),o=a_(d=>{e.triggerEvent(hD(),d),n.set(!0)},oN),s=d=>(i_(d).each(p=>{o.cancel();const h={x:p.clientX,y:p.clientY,target:d.target};o.schedule(d),n.set(!1),t.set(h)}),g.none()),r=d=>(o.cancel(),i_(d).each(p=>{t.on(h=>{sN(p,h)&&t.clear()})}),g.none()),a=d=>{o.cancel();const p=h=>an(h.target,d.target);return t.get().filter(p).map(h=>n.get()?(d.prevent(),!1):e.triggerEvent(Ad(),d))},c=xe([{key:Rr(),value:s},{key:lc(),value:r},{key:zc(),value:a}]);return{fireIfReady:(d,p)=>Se(c,p).bind(h=>h(d))}},aN=e=>e.raw.which===C1[0]&&!Tt(["input","textarea"],Bo(e.target))&&!rm(e.target,'[contenteditable="true"]'),cN=(e,t)=>{const n={stopBackspace:!0,...t},o=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],s=rN(n),r=ae(o.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),S=>zs(e,S,_=>{s.fireIfReady(_,S).each(L=>{L&&_.kill()}),n.triggerEvent(S,_)&&_.kill()})),a=Mn(),c=zs(e,"paste",S=>{s.fireIfReady(S,"paste").each(k=>{k&&S.kill()}),n.triggerEvent("paste",S)&&S.kill(),a.set(setTimeout(()=>{n.triggerEvent(Sh(),S)},0))}),l=zs(e,"keydown",S=>{n.triggerEvent("keydown",S)?S.kill():n.stopBackspace&&aN(S)&&S.prevent()}),d=zs(e,"focusin",S=>{n.triggerEvent("focusin",S)&&S.kill()}),p=Mn(),h=zs(e,"focusout",S=>{n.triggerEvent("focusout",S)&&S.kill(),p.set(setTimeout(()=>{n.triggerEvent(yh(),S)},0))});return{unbind:()=>{be(r,S=>{S.unbind()}),l.unbind(),d.unbind(),h.unbind(),c.unbind(),a.on(clearTimeout),p.on(clearTimeout)}}},l_=(e,t)=>{const n=Se(e,"target").getOr(t);return Le(n)},iN=(e,t)=>{const n=Le(!1),o=Le(!1);return{stop:()=>{n.set(!0)},cut:()=>{o.set(!0)},isStopped:n.get,isCut:o.get,event:e,setSource:t.set,getSource:t.get}},lN=e=>{const t=Le(!1);return{stop:()=>{t.set(!0)},cut:Q,isStopped:t.get,isCut:ne,event:e,setSource:Jo("Cannot set source of a broadcasted event"),getSource:Jo("Cannot get source of a broadcasted event")}},am=i.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),u_=(e,t,n,o,s,r)=>{const a=e(t,o),c=iN(n,s);return a.fold(()=>(r.logEventNoHandlers(t,o),am.complete()),l=>{const d=l.descHandler;return Ih(d)(c),c.isStopped()?(r.logEventStopped(t,l.element,d.purpose),am.stopped()):c.isCut()?(r.logEventCut(t,l.element,d.purpose),am.complete()):Wo(l.element).fold(()=>(r.logNoParent(t,l.element,d.purpose),am.complete()),h=>(r.logEventResponse(t,l.element,d.purpose),am.resume(h)))})},d_=(e,t,n,o,s,r)=>u_(e,t,n,o,s,r).fold(ge,a=>d_(e,t,n,a,s,r),ne),uN=(e,t,n,o,s)=>{const r=l_(n,o);return u_(e,t,n,o,r,s)},dN=(e,t,n)=>{const o=lN(t);return be(e,s=>{const r=s.descHandler;Ih(r)(o)}),o.isStopped()},mN=(e,t,n,o)=>m_(e,t,n,n.target,o),m_=(e,t,n,o,s)=>{const r=l_(n,o);return d_(e,t,n,o,r,s)},gN=(e,t)=>({element:e,descHandler:t}),pN=(e,t)=>({id:e,descHandler:t}),hN=()=>{const e={},t=(a,c,l)=>{un(l,(d,p)=>{const h=e[p]!==void 0?e[p]:{};h[c]=YD(d,a),e[p]=h})},n=(a,c)=>Dd(c).bind(l=>Se(a,l)).map(l=>gN(c,l));return{registerId:t,unregisterId:a=>{un(e,(c,l)=>{wt(c,a)&&delete c[a]})},filterByType:a=>Se(e,a).map(c=>Ln(c,(l,d)=>pN(d,l))).getOr([]),find:(a,c,l)=>Se(e,c).bind(d=>gs(l,p=>n(d,p),a))}},fN=()=>{const e=hN(),t={},n=d=>{const p=d.element;return Dd(p).getOrThunk(()=>FD("uid-",d.element))},o=(d,p)=>{const h=t[p];if(h===d)r(d);else throw new Error('The tagId "'+p+'" is already used by: '+Si(h.element)+`
Cannot use it for: `+Si(d.element)+`
The conflicting element is`+(Zt(h.element)?" ":" not ")+"already in the DOM")},s=d=>{const p=n(d);io(t,p)&&o(d,p);const h=[d];e.registerId(h,p,d.events),t[p]=d},r=d=>{Dd(d.element).each(p=>{delete t[p],e.unregisterId(p)})};return{find:(d,p,h)=>e.find(d,p,h),filter:d=>e.filterByType(d),register:s,unregister:r,getById:d=>Se(t,d)}},Ka=Ur({name:"Container",factory:e=>{const{attributes:t,...n}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...n},components:e.components,behaviours:gg(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[N("components",[]),zo("containerBehaviours",[]),N("events",{}),N("domModification",{}),N("eventOrder",{})]}),Lb=e=>{const t=R=>Wo(e.element).fold(ge,B=>an(R,B)),n=fN(),o=(R,B)=>n.find(t,R,B),s=cN(e.element,{triggerEvent:(R,B)=>Lh(R,B.target,q=>mN(o,R,B,q))}),r={debugInfo:O("real"),triggerEvent:(R,B,q)=>{Lh(R,B,V=>m_(o,R,q,B,V))},triggerFocus:(R,B)=>{Dd(R).fold(()=>{wa(R)},q=>{Lh(yi(),R,V=>(uN(o,yi(),{originator:B,kill:Q,prevent:Q,target:R},R,V),!1))})},triggerEscape:(R,B)=>{r.triggerEvent("keydown",R.element,B.event)},getByUid:R=>k(R),getByDom:R=>L(R),build:ps,buildOrPatch:Fh,addToGui:R=>{l(R)},removeFromGui:R=>{d(R)},addToWorld:R=>{a(R)},removeFromWorld:R=>{c(R)},broadcast:R=>{b(R)},broadcastOn:(R,B)=>{S(R,B)},broadcastEvent:(R,B)=>{_(R,B)},isConnected:ge},a=R=>{R.connect(r),Xs(R.element)||(n.register(R),be(R.components(),a),r.triggerEvent(Ym(),R.element,{target:R.element}))},c=R=>{Xs(R.element)||(be(R.components(),c),n.unregister(R)),R.disconnect()},l=R=>{kl(e,R)},d=R=>{Gc(R)},p=()=>{s.unbind(),gr(e.element)},h=R=>{const B=n.filter(yl());be(B,q=>{const V=q.descHandler;Ih(V)(R)})},b=R=>{h({universal:!0,data:R})},S=(R,B)=>{h({universal:!1,channels:R,data:B})},_=(R,B)=>{const q=n.filter(R);return dN(q,B)},k=R=>n.getById(R).fold(()=>Me.error(new Error('Could not find component with uid: "'+R+'" in system.')),Me.value),L=R=>{const B=Dd(R).getOr("not found");return k(B)};return a(e),{root:e,element:e.element,destroy:p,add:l,remove:d,getByUid:k,getByDom:L,addToWorld:a,removeFromWorld:c,broadcast:b,broadcastOn:S,broadcastEvent:_}},bN=(e,t)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:ae(e.items,t.interpreter)}),vN=O([N("prefix","form-field"),zo("fieldBehaviours",[Ot,ye])]),yN=O([ea({schema:[J("dom")],name:"label"}),ea({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[J("text")],name:"aria-descriptor"}),hs({factory:{sketch:e=>{const t=G(e,["factory"]);return e.factory.sketch(t)}},schema:[J("factory")],name:"field"})]),SN=(e,t,n,o)=>{const s=Ko(e.fieldBehaviours,[Ot.config({find:c=>vn(c,e,"field")}),ye.config({store:{mode:"manual",getValue:c=>Ot.getCurrent(c).bind(ye.getValue),setValue:(c,l)=>{Ot.getCurrent(c).each(d=>{ye.setValue(d,l)})}}})]),r=On([Pn((c,l)=>{const d=Hx(c,e,["label","field","aria-descriptor"]);d.field().each(p=>{const h=Te(e.prefix);d.label().each(b=>{Qe(b.element,"for",h),Qe(p.element,"id",h)}),d["aria-descriptor"]().each(b=>{const S=Te(e.prefix);Qe(b.element,"id",S),Qe(p.element,"aria-describedby",S)})})})]),a={getField:c=>vn(c,e,"field"),getLabel:c=>vn(c,e,"label")};return{uid:e.uid,dom:e.dom,components:t,behaviours:s,events:r,apis:a}},Xt=ws({name:"FormField",configFields:vN(),partFields:yN(),factory:SN,apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}});var xN=Object.freeze({__proto__:null,exhibit:(e,t)=>xa({attributes:xe([{key:t.tabAttr,value:"true"}])})}),wN=[N("tabAttr","data-alloy-tabstop")];const qn=qo({fields:wN,name:"tabstopping",active:xN});var CN=tinymce.util.Tools.resolve("tinymce.html.Entities");const cm=(e,t,n,o)=>{const s=_N(e,t,n,o);return Xt.sketch(s)},TN=(e,t)=>cm(e,t,[],[]),_N=(e,t,n,o)=>({dom:g_(n),components:e.toArray().concat([t]),fieldBehaviours:ce(o)}),ON=()=>g_([]),g_=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),Bi=(e,t)=>Xt.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ho(t.translate(e))]}),xr=Te("form-component-change"),im=Te("form-close"),Fi=Te("form-cancel"),vc=Te("form-action"),lm=Te("form-submit"),Nb=Te("form-block"),Hb=Te("form-unblock"),p_=Te("form-tabchange"),h_=Te("form-resize"),kN=(e,t,n)=>{const o=e.label.map(h=>Bi(h,t)),s=h=>(b,S)=>{Wa(S.event.target,"[data-collection-item-value]").each(_=>{h(b,S,_,To(_,"data-collection-item-value"))})},r=(h,b)=>{const S=ae(b,L=>{const R=ta.translate(L.text),B=e.columns===1?`<div class="tox-collection__item-label">${R}</div>`:"",q=`<div class="tox-collection__item-icon">${L.icon}</div>`,V={_:" "," - ":" ","-":" "},re=R.replace(/\_| \- |\-/g,le=>V[le]);return`<div class="tox-collection__item${t.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${CN.encodeAllRaw(L.value)}" title="${re}" aria-label="${re}">${q}${B}</div>`}),_=e.columns!=="auto"&&e.columns>1?Lo(S,e.columns):[S],k=ae(_,L=>`<div class="tox-collection__group">${L.join("")}</div>`);vu(h.element,k.join(""))},a=s((h,b,S,_)=>{b.stop(),t.isDisabled()||Be(h,vc,{name:e.name,value:_})}),c=[Z(za(),s((h,b,S)=>{wa(S)})),Z(vl(),a),Z(Ad(),a),Z(uc(),s((h,b,S)=>{fo(h.element,"."+Kd).each(_=>{so(_,Kd)}),vo(S,Kd)})),Z(fl(),s(h=>{fo(h.element,"."+Kd).each(b=>{so(b,Kd)})})),Uc(s((h,b,S,_)=>{Be(h,vc,{name:e.name,value:_})}))],l=(h,b)=>ae(Us(h.element,".tox-collection__item"),b),d=Xt.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(e.columns!==1?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:Xe},behaviours:ce([Ne.config({disabled:t.isDisabled,onDisabled:h=>{l(h,b=>{vo(b,"tox-collection__item--state-disabled"),Qe(b,"aria-disabled",!0)})},onEnabled:h=>{l(h,b=>{so(b,"tox-collection__item--state-disabled"),C(b,"aria-disabled")})}}),Ao(),Ze.config({}),ye.config({store:{mode:"memory",initialValue:n.getOr([])},onSetValue:(h,b)=>{r(h,b),e.columns==="auto"&&vb(h,5,"tox-collection__item").each(({numRows:S,numColumns:_})=>{$e.setGridSize(h,S,_)}),jt(h,h_)}}),qn.config({}),$e.config(dL(e.columns,"normal")),st("collection-events",c)]),eventOrder:{[Lr()]:["disabling","alloy.base.behaviour","collection-events"]}});return cm(o,d,["tox-form__group--collection"],[])},EN=["input","textarea"],f_=e=>{const t=Bo(e);return Tt(EN,t)},b_=(e,t)=>{const n=t.getRoot(e).getOr(e.element);so(n,t.invalidClass),t.notify.each(o=>{f_(e.element)&&Qe(e.element,"aria-invalid",!1),o.getContainer(e).each(s=>{vu(s,o.validHtml)}),o.onValid(e)})},v_=(e,t,n,o)=>{const s=t.getRoot(e).getOr(e.element);vo(s,t.invalidClass),t.notify.each(r=>{f_(e.element)&&Qe(e.element,"aria-invalid",!0),r.getContainer(e).each(a=>{vu(a,o)}),r.onInvalid(e,o)})},y_=(e,t,n)=>t.validator.fold(()=>is.pure(Me.value(!0)),o=>o.validate(e)),Vb=(e,t,n)=>(t.notify.each(o=>{o.onValidate(e)}),y_(e,t).map(o=>e.getSystem().isConnected()?o.fold(s=>(v_(e,t,n,s),Me.error(s)),s=>(b_(e,t),Me.value(s))):Me.error("No longer in system")));var AN=Object.freeze({__proto__:null,markValid:b_,markInvalid:v_,query:y_,run:Vb,isInvalid:(e,t)=>{const n=t.getRoot(e).getOr(e.element);return or(n,t.invalidClass)}}),DN=Object.freeze({__proto__:null,events:(e,t)=>e.validator.map(n=>On([Z(n.onEvent,o=>{Vb(o,e,t).get(Xe)})].concat(n.validateOnLoad?[Pn(o=>{Vb(o,e,t).get(Q)})]:[]))).getOr({})}),MN=[J("invalidClass"),N("getRoot",g.none),tr("notify",[N("aria","alert"),N("getContainer",g.none),N("validHtml",""),Dt("onValid"),Dt("onInvalid"),Dt("onValidate")]),tr("validator",[J("validate"),N("onEvent","input"),N("validateOnLoad",!0)])];const yc=qo({fields:MN,name:"invalidating",active:DN,apis:AN,extra:{validation:e=>t=>{const n=ye.getValue(t);return is.pure(e(n))}}});var $N=Object.freeze({__proto__:null,events:()=>On([Jy(gD(),ge)]),exhibit:()=>xa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})});const um=qo({fields:[],name:"unselecting",active:$N}),IN=(e,t)=>sa.sketch({dom:e.dom,components:e.components,toggleClass:"mce-active",dropdownBehaviours:ce([Ea.button(t.providers.isDisabled),Ao(),um.config({}),qn.config({})]),layouts:e.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:n=>is.nu(o=>e.fetch(o)).map(o=>g.from(Rb(Wn($b(Te("menu-value"),o,s=>{e.onItemAction(n,s)},e.columns,e.presets,qa.CLOSE_ON_EXECUTE,ne,t.providers),{movement:Yg(e.columns,e.presets)})))),parts:{menu:Lg(!1,1,e.presets)}}),S_=Te("color-input-change"),x_=Te("color-swatch-change"),w_=Te("color-picker-cancel"),BN=(e,t,n,o)=>{const s=Xt.parts.field({factory:$l,inputClasses:["tox-textfield"],data:o,onSetValue:d=>yc.run(d).get(Q),inputBehaviours:ce([Ne.config({disabled:t.providers.isDisabled}),Ao(),qn.config({}),yc.config({invalidClass:"tox-textbox-field-invalid",getRoot:d=>Is(d.element),notify:{onValid:d=>{const p=ye.getValue(d);Be(d,S_,{color:p})}},validator:{validateOnLoad:!1,validate:d=>{const p=ye.getValue(d);if(p.length===0)return is.pure(Me.value(!0));{const h=te.fromTag("span");pe(h,"background-color",p);const b=xn(h,"background-color").fold(()=>Me.error("blah"),S=>Me.value(p));return is.pure(b)}}}})]),selectOnFocus:!1}),r=e.label.map(d=>Bi(d,t.providers)),a=(d,p)=>{Be(d,x_,{value:p})},c=(d,p)=>{l.getOpt(d).each(h=>{p==="custom"?n.colorPicker(b=>{b.fold(()=>jt(h,w_),S=>{a(h,S),IT(e.storageKey,S)})},"#ffffff"):p==="remove"?a(h,""):a(h,p)})},l=Yt(IN({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:()=>[cs,as,Vo],onLtr:()=>[as,cs,Vo]},components:[],fetch:zT(n.getColors(e.storageKey),e.storageKey,n.hasCustomColors()),columns:n.getColorCols(e.storageKey),presets:"color",onItemAction:c},t));return Xt.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[s,l.asSpec()]}]),fieldBehaviours:ce([st("form-field-events",[Z(S_,(d,p)=>{l.getOpt(d).each(h=>{pe(h.element,"background-color",p.event.color)}),Be(d,xr,{name:e.name})}),Z(x_,(d,p)=>{Xt.getField(d).each(h=>{ye.setValue(h,p.event.value),Ot.getCurrent(d).each(Ve.focus)})}),Z(w_,(d,p)=>{Xt.getField(d).each(h=>{Ot.getCurrent(d).each(Ve.focus)})})])])})},FN=ea({schema:[J("dom")],name:"label"}),Pi=e=>ea({name:""+e+"-edge",overrides:t=>t.model.manager.edgeActions[e].fold(()=>({}),o=>({events:On([kh(Rr(),(s,r,a)=>o(s,a),[t]),kh(mt(),(s,r,a)=>o(s,a),[t]),kh(An(),(s,r,a)=>{a.mouseIsDown.get()&&o(s,a)},[t])])}))}),PN=Pi("top-left"),RN=Pi("top"),LN=Pi("top-right"),NN=Pi("right"),HN=Pi("bottom-right"),VN=Pi("bottom"),zN=Pi("bottom-left"),UN=Pi("left"),WN=hs({name:"thumb",defaults:O({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:On([fu(Rr(),e,"spectrum"),fu(lc(),e,"spectrum"),fu(zc(),e,"spectrum"),fu(mt(),e,"spectrum"),fu(An(),e,"spectrum"),fu(Vs(),e,"spectrum")])})}),jN=hs({schema:[ds("mouseIsDown",()=>Le(!1))],name:"spectrum",overrides:e=>{const n=e.model.manager,o=(s,r)=>n.getValueFromEvent(r).map(a=>n.setValueFrom(s,e,a));return{behaviours:ce([$e.config({mode:"special",onLeft:s=>n.onLeft(s,e),onRight:s=>n.onRight(s,e),onUp:s=>n.onUp(s,e),onDown:s=>n.onDown(s,e)}),Ve.config({})]),events:On([Z(Rr(),o),Z(lc(),o),Z(mt(),o),Z(An(),(s,r)=>{e.mouseIsDown.get()&&o(s,r)})])}}});var GN=[FN,UN,NN,RN,VN,PN,LN,zN,HN,WN,jN];const dm=O("slider.change.value"),qN=e=>e.type.indexOf("touch")!==-1,zb=e=>{const t=e.event.raw;if(qN(t)){const n=t;return n.touches!==void 0&&n.touches.length===1?g.some(n.touches[0]).map(o=>Bn(o.clientX,o.clientY)):g.none()}else{const n=t;return n.clientX!==void 0?g.some(n).map(o=>Bn(o.clientX,o.clientY)):g.none()}},KN="top",YN="right",XN="bottom",JN="left",Ll=e=>e.model.minX,Nl=e=>e.model.minY,Zg=e=>e.model.minX-1,Qg=e=>e.model.minY-1,Hl=e=>e.model.maxX,Vl=e=>e.model.maxY,ep=e=>e.model.maxX+1,tp=e=>e.model.maxY+1,C_=(e,t,n)=>t(e)-n(e),Ub=e=>C_(e,Hl,Ll),Wb=e=>C_(e,Vl,Nl),T_=e=>Ub(e)/2,__=e=>Wb(e)/2,Hu=e=>e.stepSize,O_=e=>e.snapToGrid,k_=e=>e.snapStart,E_=e=>e.rounded,np=(e,t)=>e[t+"-edge"]!==void 0,A_=e=>np(e,JN),D_=e=>np(e,YN),M_=e=>np(e,KN),$_=e=>np(e,XN),Yc=e=>e.model.value.get(),Ri=(e,t)=>({x:e,y:t}),Aa=(e,t)=>{Be(e,dm(),{value:t})},ZN=(e,t)=>{Aa(e,Ri(Zg(t),Qg(t)))},QN=(e,t)=>{Aa(e,Qg(t))},eH=(e,t)=>{Aa(e,Ri(T_(t),Qg(t)))},tH=(e,t)=>{Aa(e,Ri(ep(t),Qg(t)))},nH=(e,t)=>{Aa(e,ep(t))},oH=(e,t)=>{Aa(e,Ri(ep(t),__(t)))},sH=(e,t)=>{Aa(e,Ri(ep(t),tp(t)))},rH=(e,t)=>{Aa(e,tp(t))},aH=(e,t)=>{Aa(e,Ri(T_(t),tp(t)))},cH=(e,t)=>{Aa(e,Ri(Zg(t),tp(t)))},iH=(e,t)=>{Aa(e,Zg(t))},lH=(e,t)=>{Aa(e,Ri(Zg(t),__(t)))},jb=(e,t,n,o)=>e<t?e:e>n?n:e===t?t-1:Math.max(t,e-o),Gb=(e,t,n,o)=>e>n?e:e<t?t:e===n?n+1:Math.min(n,e+o),I_=(e,t,n)=>Math.max(t,Math.min(n,e)),uH=(e,t,n,o,s)=>s.fold(()=>{const r=e-t,a=Math.round(r/o)*o;return I_(t+a,t-1,n+1)},r=>{const a=(e-r)%o,c=Math.round(a/o),l=Math.floor((e-r)/o),d=Math.floor((n-r)/o),p=Math.min(d,l+c),h=r+p*o;return Math.max(r,h)}),dH=(e,t,n)=>Math.min(n,Math.max(e,t))-t,B_=e=>{const{min:t,max:n,range:o,value:s,step:r,snap:a,snapStart:c,rounded:l,hasMinEdge:d,hasMaxEdge:p,minBound:h,maxBound:b,screenRange:S}=e,_=d?t-1:t,k=p?n+1:n;if(s<h)return _;if(s>b)return k;{const L=dH(s,h,b),R=I_(L/S*o+t,_,k);return a&&R>=t&&R<=n?uH(R,t,n,r,c):l?Math.round(R):R}},F_=e=>{const{min:t,max:n,range:o,value:s,hasMinEdge:r,hasMaxEdge:a,maxBound:c,maxOffset:l,centerMinEdge:d,centerMaxEdge:p}=e;return s<t?r?0:d:s>n?a?c:p:(s-t)/o*l},qb="top",P_="right",R_="bottom",Kb="left",mH="width",gH="height",Sc=e=>e.element.dom.getBoundingClientRect(),Da=(e,t)=>e[t],op=e=>{const t=Sc(e);return Da(t,Kb)},L_=e=>{const t=Sc(e);return Da(t,P_)},sp=e=>{const t=Sc(e);return Da(t,qb)},N_=e=>{const t=Sc(e);return Da(t,R_)},H_=e=>{const t=Sc(e);return Da(t,mH)},V_=e=>{const t=Sc(e);return Da(t,gH)},z_=(e,t,n)=>(e+t)/2-n,U_=(e,t)=>{const n=Sc(e),o=Sc(t),s=Da(n,Kb),r=Da(n,P_),a=Da(o,Kb);return z_(s,r,a)},W_=(e,t)=>{const n=Sc(e),o=Sc(t),s=Da(n,qb),r=Da(n,R_),a=Da(o,qb);return z_(s,r,a)},rp=(e,t)=>{Be(e,dm(),{value:t})},Yb=(e,t,n)=>{const o={min:Ll(t),max:Hl(t),range:Ub(t),value:n,step:Hu(t),snap:O_(t),snapStart:k_(t),rounded:E_(t),hasMinEdge:A_(t),hasMaxEdge:D_(t),minBound:op(e),maxBound:L_(e),screenRange:H_(e)};return B_(o)},pH=(e,t,n)=>{const o=Yb(e,t,n);return rp(e,o),o},hH=(e,t)=>{const n=Ll(t);rp(e,n)},fH=(e,t)=>{const n=Hl(t);rp(e,n)},bH=(e,t,n)=>{const s=(e>0?Gb:jb)(Yc(n),Ll(n),Hl(n),Hu(n));return rp(t,s),g.some(s)},j_=e=>(t,n)=>bH(e,t,n).map(ge),vH=e=>zb(e).map(n=>n.left),yH=(e,t,n,o,s)=>{const a=H_(e),c=o.bind(p=>g.some(U_(p,e))).getOr(0),l=s.bind(p=>g.some(U_(p,e))).getOr(a),d={min:Ll(t),max:Hl(t),range:Ub(t),value:n,hasMinEdge:A_(t),hasMaxEdge:D_(t),minBound:op(e),minOffset:0,maxBound:L_(e),maxOffset:a,centerMinEdge:c,centerMaxEdge:l};return F_(d)},Xb=(e,t,n,o,s,r)=>{const a=yH(t,r,n,o,s);return op(t)-op(e)+a},SH=(e,t,n,o)=>{const s=Yc(n),r=Xb(e,o.getSpectrum(e),s,o.getLeftEdge(e),o.getRightEdge(e),n),a=Oo(t.element)/2;pe(t.element,"left",r-a+"px")},xH=j_(-1),wH=j_(1),CH=g.none,TH=g.none,_H={"top-left":g.none(),top:g.none(),"top-right":g.none(),right:g.some(nH),"bottom-right":g.none(),bottom:g.none(),"bottom-left":g.none(),left:g.some(iH)};var OH=Object.freeze({__proto__:null,setValueFrom:pH,setToMin:hH,setToMax:fH,findValueOfOffset:Yb,getValueFromEvent:vH,findPositionOfValue:Xb,setPositionFromValue:SH,onLeft:xH,onRight:wH,onUp:CH,onDown:TH,edgeActions:_H});const ap=(e,t)=>{Be(e,dm(),{value:t})},Jb=(e,t,n)=>{const o={min:Nl(t),max:Vl(t),range:Wb(t),value:n,step:Hu(t),snap:O_(t),snapStart:k_(t),rounded:E_(t),hasMinEdge:M_(t),hasMaxEdge:$_(t),minBound:sp(e),maxBound:N_(e),screenRange:V_(e)};return B_(o)},kH=(e,t,n)=>{const o=Jb(e,t,n);return ap(e,o),o},EH=(e,t)=>{const n=Nl(t);ap(e,n)},AH=(e,t)=>{const n=Vl(t);ap(e,n)},DH=(e,t,n)=>{const s=(e>0?Gb:jb)(Yc(n),Nl(n),Vl(n),Hu(n));return ap(t,s),g.some(s)},G_=e=>(t,n)=>DH(e,t,n).map(ge),MH=e=>zb(e).map(n=>n.top),$H=(e,t,n,o,s)=>{const a=V_(e),c=o.bind(p=>g.some(W_(p,e))).getOr(0),l=s.bind(p=>g.some(W_(p,e))).getOr(a),d={min:Nl(t),max:Vl(t),range:Wb(t),value:n,hasMinEdge:M_(t),hasMaxEdge:$_(t),minBound:sp(e),minOffset:0,maxBound:N_(e),maxOffset:a,centerMinEdge:c,centerMaxEdge:l};return F_(d)},Zb=(e,t,n,o,s,r)=>{const a=$H(t,r,n,o,s);return sp(t)-sp(e)+a},IH=(e,t,n,o)=>{const s=Yc(n),r=Zb(e,o.getSpectrum(e),s,o.getTopEdge(e),o.getBottomEdge(e),n),a=In(t.element)/2;pe(t.element,"top",r-a+"px")},BH=g.none,FH=g.none,PH=G_(-1),RH=G_(1),LH={"top-left":g.none(),top:g.some(QN),"top-right":g.none(),right:g.none(),"bottom-right":g.none(),bottom:g.some(rH),"bottom-left":g.none(),left:g.none()};var NH=Object.freeze({__proto__:null,setValueFrom:kH,setToMin:EH,setToMax:AH,findValueOfOffset:Jb,getValueFromEvent:MH,findPositionOfValue:Zb,setPositionFromValue:IH,onLeft:BH,onRight:FH,onUp:PH,onDown:RH,edgeActions:LH});const cp=(e,t)=>{Be(e,dm(),{value:t})},ip=(e,t)=>({x:e,y:t}),HH=(e,t,n)=>{const o=Yb(e,t,n.left),s=Jb(e,t,n.top),r=ip(o,s);return cp(e,r),r},VH=(e,t,n,o)=>{const s=e>0?Gb:jb,r=t?Yc(o).x:s(Yc(o).x,Ll(o),Hl(o),Hu(o)),a=t?s(Yc(o).y,Nl(o),Vl(o),Hu(o)):Yc(o).y;return cp(n,ip(r,a)),g.some(r)},lp=(e,t)=>(n,o)=>VH(e,t,n,o).map(ge),zH=(e,t)=>{const n=Ll(t),o=Nl(t);cp(e,ip(n,o))},UH=(e,t)=>{const n=Hl(t),o=Vl(t);cp(e,ip(n,o))},WH=e=>zb(e),jH=(e,t,n,o)=>{const s=Yc(n),r=Xb(e,o.getSpectrum(e),s.x,o.getLeftEdge(e),o.getRightEdge(e),n),a=Zb(e,o.getSpectrum(e),s.y,o.getTopEdge(e),o.getBottomEdge(e),n),c=Oo(t.element)/2,l=In(t.element)/2;pe(t.element,"left",r-c+"px"),pe(t.element,"top",a-l+"px")},GH=lp(-1,!1),qH=lp(1,!1),KH=lp(-1,!0),YH=lp(1,!0),XH={"top-left":g.some(ZN),top:g.some(eH),"top-right":g.some(tH),right:g.some(oH),"bottom-right":g.some(sH),bottom:g.some(aH),"bottom-left":g.some(cH),left:g.some(lH)};var JH=Object.freeze({__proto__:null,setValueFrom:HH,setToMin:zH,setToMax:UH,getValueFromEvent:WH,setPositionFromValue:jH,onLeft:GH,onRight:qH,onUp:KH,onDown:YH,edgeActions:XH});const ZH=[N("stepSize",1),N("onChange",Q),N("onChoose",Q),N("onInit",Q),N("onDragStart",Q),N("onDragEnd",Q),N("snapToGrid",!1),N("rounded",!0),Wt("snapStart"),Qs("model",Hs("mode",{x:[N("minX",0),N("maxX",100),ds("value",e=>Le(e.mode.minX)),J("getInitialValue"),Dn("manager",OH)],y:[N("minY",0),N("maxY",100),ds("value",e=>Le(e.mode.minY)),J("getInitialValue"),Dn("manager",NH)],xy:[N("minX",0),N("maxX",100),N("minY",0),N("maxY",100),ds("value",e=>Le({x:e.mode.minX,y:e.mode.minY})),J("getInitialValue"),Dn("manager",JH)]})),zo("sliderBehaviours",[$e,ye]),ds("mouseIsDown",()=>Le(!1))],Ma=ws({name:"Slider",configFields:ZH,partFields:GN,factory:(e,t,n,o)=>{const s=V=>ki(V,e,"thumb"),r=V=>ki(V,e,"spectrum"),a=V=>vn(V,e,"left-edge"),c=V=>vn(V,e,"right-edge"),l=V=>vn(V,e,"top-edge"),d=V=>vn(V,e,"bottom-edge"),p=e.model,h=p.manager,b=(V,re)=>{h.setPositionFromValue(V,re,e,{getLeftEdge:a,getRightEdge:c,getTopEdge:l,getBottomEdge:d,getSpectrum:r})},S=(V,re)=>{p.value.set(re);const ee=s(V);b(V,ee)},_=(V,re)=>{S(V,re);const ee=s(V);return e.onChange(V,ee,re),g.some(!0)},k=V=>{h.setToMin(V,e)},L=V=>{h.setToMax(V,e)},R=V=>{const re=()=>{vn(V,e,"thumb").each(le=>{const fe=p.value.get();e.onChoose(V,le,fe)})},ee=e.mouseIsDown.get();e.mouseIsDown.set(!1),ee&&re()},B=(V,re)=>{re.stop(),e.mouseIsDown.set(!0),e.onDragStart(V,s(V))},q=(V,re)=>{re.stop(),e.onDragEnd(V,s(V)),R(V)};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ko(e.sliderBehaviours,[$e.config({mode:"special",focusIn:V=>vn(V,e,"spectrum").map($e.focusIn).map(ge)}),ye.config({store:{mode:"manual",getValue:V=>p.value.get(),setValue:S}}),zr.config({channels:{[pf()]:{onReceive:R}}})]),events:On([Z(dm(),(V,re)=>{_(V,re.event.value)}),Pn((V,re)=>{const ee=p.getInitialValue();p.value.set(ee);const le=s(V);b(V,le);const fe=r(V);e.onInit(V,le,fe,p.value.get())}),Z(Rr(),B),Z(zc(),q),Z(mt(),B),Z(Vs(),q)]),apis:{resetToMin:k,resetToMax:L,setValue:S,refresh:b},domModification:{styles:{position:"relative"}}}},apis:{setValue:(e,t,n)=>{e.setValue(t,n)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),Qb=Te("rgb-hex-update"),q_=Te("slider-update"),K_=Te("palette-update"),QH=(e,t)=>{const n=Ma.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=Ma.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return Ma.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:O(0)},components:[n,o],sliderBehaviours:ce([Ve.config({})]),onChange:(s,r,a)=>{Be(s,q_,{value:a})}})},Y_="form",eV=[zo("formBehaviours",[ye])],X_=e=>"<alloy.field."+e+">",tV=e=>{const t=(()=>{const r=[];return{field:(c,l)=>(r.push(c),Tf(Y_,X_(c),l)),record:O(r)}})(),n=e(t),o=t.record(),s=ae(o,r=>hs({name:r,pname:X_(r)}));return Af(Y_,eV,s,oV,n)},nV=(e,t)=>e.fold(()=>Me.error(t),Me.value),oV=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:Ko(e.formBehaviours,[ye.config({store:{mode:"manual",getValue:n=>{const o=Vx(n,e);return Ut(o,(s,r)=>s().bind(a=>{const c=Ot.getCurrent(a);return nV(c,new Error(`Cannot find a current component to extract the value from for form part '${r}': `+Si(a.element)))}).map(ye.getValue))},setValue:(n,o)=>{un(o,(s,r)=>{vn(n,e,r).each(a=>{Ot.getCurrent(a).each(c=>{ye.setValue(c,s)})})})}}})]),apis:{getField:(n,o)=>vn(n,e,o).bind(Ot.getCurrent)}}),Vu={getField:eg((e,t,n)=>e.getField(t,n)),sketch:tV},J_=Te("valid-input"),Z_=Te("invalid-input"),Q_=Te("validating-input"),ev="colorcustom.rgb.",sV=(e,t,n,o)=>{const s=(b,S)=>yc.config({invalidClass:t("invalid"),notify:{onValidate:_=>{Be(_,Q_,{type:b})},onValid:_=>{Be(_,J_,{type:b,value:ye.getValue(_)})},onInvalid:_=>{Be(_,Z_,{type:b,value:ye.getValue(_)})}},validator:{validate:_=>{const k=ye.getValue(_),L=S(k)?Me.value(!0):Me.error(e("aria.input.invalid"));return is.pure(L)},validateOnLoad:!1}}),r=(b,S,_,k,L)=>{const R=e(ev+"range"),B=Xt.parts.label({dom:{tag:"label",attributes:{"aria-label":k}},components:[ho(_)]}),q=Xt.parts.field({data:L,factory:$l,inputAttributes:{type:"text",...S==="hex"?{"aria-live":"polite"}:{}},inputClasses:[t("textfield")],inputBehaviours:ce([s(S,b),qn.config({})]),onSetValue:le=>{yc.isInvalid(le)&&yc.run(le).get(Q)}}),V=[B,q],re=S!=="hex"?[Xt.parts["aria-descriptor"]({text:R})]:[],ee=V.concat(re);return{dom:{tag:"div",attributes:{role:"presentation"}},components:ee}},a=(b,S)=>{const _=tm(S);return Vu.getField(b,"hex").each(k=>{Ve.isFocused(k)||ye.setValue(b,{hex:_.value})}),_},c=(b,S)=>{const _=S.red,k=S.green,L=S.blue;ye.setValue(b,{red:_,green:k,blue:L})},l=Yt({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),d=(b,S)=>{l.getOpt(b).each(_=>{pe(_.element,"background-color","#"+S.value)})};return Ur({factory:()=>{const b={red:Le(g.some(255)),green:Le(g.some(255)),blue:Le(g.some(255)),hex:Le(g.some("ffffff"))},S=(Ue,Ct)=>{const De=nm(Ct);c(Ue,De),R(De)},_=Ue=>b[Ue].get(),k=(Ue,Ct)=>{b[Ue].set(Ct)},L=()=>_("red").bind(Ue=>_("green").bind(Ct=>_("blue").map(De=>Ii(Ue,Ct,De,1)))),R=Ue=>{const Ct=Ue.red,De=Ue.green,yt=Ue.blue;k("red",g.some(Ct)),k("green",g.some(De)),k("blue",g.some(yt))},B=(Ue,Ct)=>{const De=Ct.event;De.type!=="hex"?k(De.type,g.none()):o(Ue)},q=(Ue,Ct)=>{n(Ue);const De=vT(Ct);k("hex",g.some(De.value));const yt=nm(De);c(Ue,yt),R(yt),Be(Ue,Qb,{hex:De}),d(Ue,De)},V=(Ue,Ct,De)=>{const yt=parseInt(De,10);k(Ct,g.some(yt)),L().each(de=>{const Ce=a(Ue,de);Be(Ue,Qb,{hex:Ce}),d(Ue,Ce)})},re=Ue=>Ue.type==="hex",ee=(Ue,Ct)=>{const De=Ct.event;re(De)?q(Ue,De.value):V(Ue,De.type,De.value)},le=Ue=>({label:e(ev+Ue+".label"),description:e(ev+Ue+".description")}),fe=le("red"),dt=le("green"),_e=le("blue"),Ke=le("hex");return Wn(Vu.sketch(Ue=>({dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[Ue.field("red",Xt.sketch(r(xb,"red",fe.label,fe.description,255))),Ue.field("green",Xt.sketch(r(xb,"green",dt.label,dt.description,255))),Ue.field("blue",Xt.sketch(r(xb,"blue",_e.label,_e.description,255))),Ue.field("hex",Xt.sketch(r(xT,"hex",Ke.label,Ke.description,"ffffff"))),l.asSpec()],formBehaviours:ce([yc.config({invalidClass:t("form-invalid")}),st("rgb-form-events",[Z(J_,ee),Z(Z_,B),Z(Q_,B)])])})),{apis:{updateHex:(Ue,Ct)=>{ye.setValue(Ue,{hex:Ct.value}),S(Ue,Ct),d(Ue,Ct)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(b,S,_)=>{b.updateHex(S,_)}},extraApis:{}})},rV=(e,t)=>{const n=Ma.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),o=Ma.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:`<div class=${t("sv-palette-inner-thumb")} role="presentation"></div>`}}),s=(d,p)=>{const{width:h,height:b}=d,S=d.getContext("2d");if(S===null)return;S.fillStyle=p,S.fillRect(0,0,h,b);const _=S.createLinearGradient(0,0,h,0);_.addColorStop(0,"rgba(255,255,255,1)"),_.addColorStop(1,"rgba(255,255,255,0)"),S.fillStyle=_,S.fillRect(0,0,h,b);const k=S.createLinearGradient(0,0,0,b);k.addColorStop(0,"rgba(0,0,0,0)"),k.addColorStop(1,"rgba(0,0,0,1)"),S.fillStyle=k,S.fillRect(0,0,h,b)},r=(d,p)=>{const h=d.components()[0].element.dom,b=om(p,100,100),S=_T(b);s(h,kT(S))},a=(d,p)=>{const h=_b(nm(p));Ma.setValue(d,{x:h.saturation,y:100-h.value})};return Ur({factory:d=>{const p=O({x:0,y:0}),h=(_,k,L)=>{Be(_,K_,{value:L})},b=(_,k,L,R)=>{s(L.element.dom,kT(ET))},S=ce([Ot.config({find:g.some}),Ve.config({})]);return Ma.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:p},rounded:!1,components:[n,o],onChange:h,onInit:b,sliderBehaviours:S})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(d,p,h)=>{r(p,h)},setThumb:(d,p,h)=>{a(p,h)}},extraApis:{}})},aV=(e,t)=>{const n=s=>{const r=sV(e,t,s.onValidHex,s.onInvalidHex),a=rV(e,t),c=ee=>(100-ee)/100*360,l=ee=>100-ee/360*100,d={paletteRgba:Le(ET),paletteHue:Le(0)},p=Yt(QH(e,t)),h=Yt(a.sketch({})),b=Yt(r.sketch({})),S=(ee,le,fe)=>{h.getOpt(ee).each(dt=>{a.setHue(dt,fe)})},_=(ee,le)=>{b.getOpt(ee).each(fe=>{r.updateHex(fe,le)})},k=(ee,le,fe)=>{p.getOpt(ee).each(dt=>{Ma.setValue(dt,l(fe))})},L=(ee,le)=>{h.getOpt(ee).each(fe=>{a.setThumb(fe,le)})},R=(ee,le)=>{const fe=nm(ee);d.paletteRgba.set(fe),d.paletteHue.set(le)},B=(ee,le,fe,dt)=>{R(le,fe),be(dt,_e=>{_e(ee,le,fe)})},q=()=>{const ee=[_];return(le,fe)=>{const dt=fe.event.value,_e=d.paletteHue.get(),Ke=om(_e,dt.x,100-dt.y),Ue=BT(Ke);B(le,Ue,_e,ee)}},V=()=>{const ee=[S,_];return(le,fe)=>{const dt=c(fe.event.value),_e=d.paletteRgba.get(),Ke=_b(_e),Ue=om(dt,Ke.saturation,Ke.value),Ct=BT(Ue);B(le,Ct,dt,ee)}},re=()=>{const ee=[S,k,L];return(le,fe)=>{const dt=fe.event.hex,_e=XR(dt);B(le,dt,_e.hue,ee)}};return{uid:s.uid,dom:s.dom,components:[h.asSpec(),p.asSpec(),b.asSpec()],behaviours:ce([st("colour-picker-events",[Z(Qb,re()),Z(K_,q()),Z(q_,V())]),Ot.config({find:ee=>b.getOpt(ee)}),$e.config({mode:"acyclic"})])}};return Ur({name:"ColourPicker",configFields:[J("dom"),N("onValidHex",Q),N("onInvalidHex",Q)],factory:n})},$a={self:()=>Ot.config({find:g.some}),memento:e=>Ot.config({find:e.getOpt}),childAt:e=>Ot.config({find:t=>Bs(t.element,e).bind(n=>t.getSystem().getByDom(n).toOptional())})},cV=Re([N("preprocess",Xe),N("postprocess",Xe)]),iV=(e,t)=>{const n=ys("RepresentingConfigs.memento processors",cV,t);return ye.config({store:{mode:"manual",getValue:o=>{const s=e.get(o),r=ye.getValue(s);return n.postprocess(r)},setValue:(o,s)=>{const r=n.preprocess(s),a=e.get(o);ye.setValue(a,r)}}})},eO=(e,t,n)=>ye.config({store:{mode:"manual",...e.map(o=>({initialValue:o})).getOr({}),getValue:t,setValue:n}}),tv=(e,t,n)=>eO(e,o=>t(o.element),(o,s)=>n(o.element,s)),ra={memento:iV,withElement:tv,withComp:eO,domValue:e=>tv(e,pc,xi),domHtml:e=>tv(e,Ah,vu),memory:e=>ye.config({store:{mode:"memory",initialValue:e}})},lV={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},uV=e=>t=>e.translate(lV[t]),dV=(e,t,n)=>{const o=l=>"tox-"+l,s=aV(uV(t),o),r=l=>{Be(l,vc,{name:"hex-valid",value:!0})},a=l=>{Be(l,vc,{name:"hex-valid",value:!1})},c=Yt(s.sketch({dom:{tag:"div",classes:[o("color-picker-container")],attributes:{role:"presentation"}},onValidHex:r,onInvalidHex:a}));return{dom:{tag:"div"},components:[c.asSpec()],behaviours:ce([ra.withComp(n,l=>{const d=c.get(l);return Ot.getCurrent(d).bind(b=>ye.getValue(b).hex).map(b=>"#"+Es(b,"#")).getOr("")},(l,d)=>{const p=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,h=g.from(p.exec(d)).bind(_=>we(_,1)),b=c.get(l);Ot.getCurrent(b).fold(()=>{console.log("Can not find form")},_=>{ye.setValue(_,{hex:h.getOr("")}),Vu.getField(_,"hex").each(k=>{jt(k,bl())})})}),$a.self()])}};var mV=tinymce.util.Tools.resolve("tinymce.Resource");const gV=e=>wt(e,"init"),pV=e=>{const t=Mn(),n=Yt({dom:{tag:e.tag}}),o=Mn();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:ce([st("custom-editor-events",[Pn(s=>{n.getOpt(s).each(r=>{(gV(e)?e.init(r.element.dom):mV.load(e.scriptId,e.scriptUrl).then(a=>a(r.element.dom,e.settings))).then(a=>{o.on(c=>{a.setValue(c)}),o.clear(),t.set(a)})})})]),ra.withComp(g.none(),()=>t.get().fold(()=>o.get().getOr(""),s=>s.getValue()),(s,r)=>{t.get().fold(()=>o.set(r),a=>a.setValue(r))}),$a.self()]),components:[n.asSpec()]}};var Xc=tinymce.util.Tools.resolve("tinymce.util.Tools");const hV=(e,t)=>{const n=Xc.explode(t.getOption("images_file_types")),o=s=>Rn(n,r=>xo(s.name.toLowerCase(),`.${r.toLowerCase()}`));return Y(Rt(e),o)},fV=(e,t,n)=>{const o=(b,S)=>{S.stop()},s=b=>(S,_)=>{be(b,k=>{k(S,_)})},r=(b,S)=>{var _;if(!Ne.isDisabled(b)){const k=S.event.raw;c(b,(_=k.dataTransfer)===null||_===void 0?void 0:_.files)}},a=(b,S)=>{const _=S.event.raw.target;c(b,_.files)},c=(b,S)=>{S&&(ye.setValue(b,hV(S,t)),Be(b,xr,{name:e.name}))},l=Yt({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:ce([st("input-file-events",[wl(vl()),wl(Ad())])])}),d=b=>({uid:b.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:ce([ra.memory(n.getOr([])),$a.self(),Ne.config({}),it.config({toggleClass:"dragenter",toggleOnExecute:!1}),st("dropzone-events",[Z("dragenter",s([o,it.toggle])),Z("dragleave",s([o,it.toggle])),Z("dragover",o),Z("drop",s([o,r])),Z(pu(),a)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[ho(t.translate("Drop an image here"))]},Yo.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[ho(t.translate("Browse for an image")),l.asSpec()],action:S=>{l.get(S).element.dom.click()},buttonBehaviours:ce([qn.config({}),Ea.button(t.isDisabled),Ao()])})]}]}),p=e.label.map(b=>Bi(b,t)),h=Xt.parts.field({factory:{sketch:d}});return cm(p,h,["tox-form__group--stretched"],[])},bV=(e,t)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:ae(e.items,t.interpreter)}),nv=Te("alloy-fake-before-tabstop"),ov=Te("alloy-fake-after-tabstop"),tO=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:ce([Ve.config({ignore:!0}),qn.config({})])}),nO=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[tO([nv]),e,tO([ov])],behaviours:ce([$a.childAt(1)])}),oO=(e,t)=>{Be(e,nr(),{raw:{which:9,shiftKey:t}})},vV=(e,t)=>{const n=t.element;or(n,nv)?oO(e,!0):or(n,ov)&&oO(e,!1)},mm=e=>rm(e,["."+nv,"."+ov].join(","),ne),yV=(e,t)=>{const n=Le(e.getOr(""));return{getValue:o=>n.get(),setValue:(o,s)=>{if(n.get()!==s){const r=o.element,a=()=>Qe(r,"srcdoc",s);if(t){const c=r.dom;g.from(c.contentDocument).fold(a,l=>{const d=({scrollTop:S,scrollHeight:_,clientHeight:k})=>Math.ceil(S)+k>=_,p=g.from(l.documentElement).forall(d);l.open(),l.write(s),l.close();const h=c.contentWindow,b=l.body;p&&Ye(h)&&Ye(b)&&h.scrollTo(0,b.scrollHeight)})}else a()}n.set(s)}}},SV=(e,t,n)=>{const o="tox-dialog__iframe",s=e.border?[`${o}--bordered`]:[],r=e.transparent?[]:[`${o}--opaque`],a={...e.label.map(h=>({title:h})).getOr({}),...n.map(h=>({srcdoc:h})).getOr({}),...e.sandboxed?{sandbox:"allow-scripts allow-same-origin"}:{}},c=yV(n,e.streamContent),l=e.label.map(h=>Bi(h,t)),d=h=>nO({uid:h.uid,dom:{tag:"iframe",attributes:a,classes:[o,...s,...r]},behaviours:ce([qn.config({}),Ve.config({}),ra.withComp(n,c.getValue,c.setValue)])}),p=Xt.parts.field({factory:{sketch:d}});return cm(l,p,["tox-form__group--stretched"],[])},xV=e=>new Promise((t,n)=>{const o=()=>{r(),t(e)},s=[zs(e,"load",o),zs(e,"error",()=>{r(),n("Unable to load data from image: "+e.dom.src)})],r=()=>be(s,a=>a.unbind());e.dom.complete&&o()}),wV=(e,t,n,o,s)=>{const r=n*s,a=o*s,c=Math.max(0,e/2-r/2),l=Math.max(0,t/2-a/2);return{left:c.toString()+"px",top:l.toString()+"px",width:r.toString()+"px",height:a.toString()+"px"}},CV=(e,t,n)=>{const o=Oo(e),s=In(e);return Math.min(o/t,s/n,1)},TV=(e,t)=>{const n=Le(t.getOr({url:""})),o=Yt({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:t.map(l=>({src:l.url})).getOr({})}}),s=Yt({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[o.asSpec()]}),r=(l,d)=>{const p={url:d.url};d.zoom.each(b=>p.zoom=b),d.cachedWidth.each(b=>p.cachedWidth=b),d.cachedHeight.each(b=>p.cachedHeight=b),n.set(p);const h=()=>{const{cachedWidth:b,cachedHeight:S,zoom:_}=p;if(!pt(b)&&!pt(S)){if(pt(_)){const L=CV(l.element,b,S);p.zoom=L}const k=wV(Oo(l.element),In(l.element),b,S,p.zoom);s.getOpt(l).each(L=>{dn(L.element,k)})}};o.getOpt(l).each(b=>{const S=b.element;d.url!==To(S,"src")&&(Qe(S,"src",d.url),so(l.element,"tox-imagepreview__loaded")),h(),xV(S).then(_=>{l.getSystem().isConnected()&&(vo(l.element,"tox-imagepreview__loaded"),p.cachedWidth=_.dom.naturalWidth,p.cachedHeight=_.dom.naturalHeight,h())})})},a={};e.height.each(l=>a.height=l);const c=t.map(l=>({url:l.url,zoom:g.from(l.zoom),cachedWidth:g.from(l.cachedWidth),cachedHeight:g.from(l.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:a,attributes:{role:"presentation"}},components:[s.asSpec()],behaviours:ce([$a.self(),ra.withComp(c,()=>n.get(),r)])}},_V=(e,t)=>{const n="tox-label",o=e.align==="center"?[`${n}--center`]:[],s=e.align==="end"?[`${n}--end`]:[],r={dom:{tag:"label",classes:[n,...o,...s]},components:[ho(t.providers.translate(e.label))]},a=ae(e.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[r,...a],behaviours:ce([$a.self(),Ze.config({}),ra.domHtml(g.none()),$e.config({mode:"acyclic"})])}},sO=Te("toolbar.button.execute"),OV=e=>Uc((t,n)=>{Gg(e,t)(o=>{Be(t,sO,{buttonApi:o}),e.onAction(o)})}),zl=Te("common-button-display-events"),rO={[Lr()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],[dc()]:["toolbar-button-events",zl],[mt()]:["focusing","alloy.base.behaviour",zl]},sv=e=>pe(e.element,"width",Un(e.element,"width")),aO=(e,t,n)=>Oa(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:n},t),rv=(e,t)=>aO(e,t,[]),Li=(e,t)=>aO(e,t,[Ze.config({})]),cO=(e,t,n)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[ho(n.translate(e))],behaviours:ce([Ze.config({})])}),aa=Te("update-menu-text"),Ul=Te("update-menu-icon"),av=(e,t,n)=>{const o=Le(Q),s=e.text.map(b=>Yt(cO(b,t,n.providers))),r=e.icon.map(b=>Yt(Li(b,n.providers.icons))),a=(b,S)=>{const _=ye.getValue(b);return Ve.focus(_),Be(_,"keydown",{raw:S.event.raw}),sa.close(_),g.some(!0)},c=e.role.fold(()=>({}),b=>({role:b})),l=e.tooltip.fold(()=>({}),b=>{const S=n.providers.translate(b);return{title:S,"aria-label":S}}),d=Oa("chevron-down",{tag:"div",classes:[`${t}__select-chevron`]},n.providers.icons),p=Te("common-button-display-events");return Yt(sa.sketch({...e.uid?{uid:e.uid}:{},...c,dom:{tag:"button",classes:[t,`${t}--select`].concat(ae(e.classes,b=>`${t}--${b}`)),attributes:{...l}},components:Fu([r.map(b=>b.asSpec()),s.map(b=>b.asSpec()),g.some(d)]),matchWidth:!0,useMinWidth:!0,onOpen:(b,S,_)=>{e.searchable&&KL(_)},dropdownBehaviours:ce([...e.dropdownBehaviours,Ea.button(()=>e.disabled||n.providers.isDisabled()),Ao(),um.config({}),Ze.config({}),st("dropdown-events",[Mi(e,o),$i(e,o)]),st(p,[Pn((b,S)=>sv(b))]),st("menubutton-update-display-text",[Z(aa,(b,S)=>{s.bind(_=>_.getOpt(b)).each(_=>{Ze.set(_,[ho(n.providers.translate(S.event.text))])})}),Z(Ul,(b,S)=>{r.bind(_=>_.getOpt(b)).each(_=>{Ze.set(_,[Li(S.event.icon,n.providers.icons)])})})])]),eventOrder:Wn(rO,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[dc()]:["toolbar-button-events","dropdown-events",p]}),sandboxBehaviours:ce([$e.config({mode:"special",onLeft:a,onRight:a}),st("dropdown-sandbox-events",[Z(VC,(b,S)=>{UL(b),S.stop()}),Z(zC,(b,S)=>{WL(b,S),S.stop()})])]),lazySink:n.getSink,toggleClass:`${t}--active`,parts:{menu:{...Lg(!1,e.columns,e.presets),fakeFocus:e.searchable,onHighlightItem:o_,onCollapseMenu:(b,S,_)=>{Vt.getHighlighted(_).each(k=>{o_(b,_,k)})},onDehighlightItem:qL}},fetch:b=>is.nu(Et(e.fetch,b))})).asSpec()},kV=e=>Ee(e),iO=e=>e.type==="separator",EV=e=>wt(e,"getSubmenuItems"),AV={type:"separator"},DV=(e,t)=>{const n=me(e,(o,s)=>kV(s)?s===""?o:s==="|"?o.length>0&&!iO(o[o.length-1])?o.concat([AV]):o:wt(t,s.toLowerCase())?o.concat([t[s.toLowerCase()]]):o:o.concat([s]),[]);return n.length>0&&iO(n[n.length-1])&&n.pop(),n},MV=(e,t)=>{const n=e.getSubmenuItems(),o=lO(n,t),s=Wn(o.menus,{[e.value]:o.items}),r=Wn(o.expansions,{[e.value]:e.value});return{item:e,menus:s,expansions:r}},$V=e=>{const t=Se(e,"value").getOrThunk(()=>Te("generated-menu-item"));return Wn({value:t},e)},lO=(e,t)=>{const n=DV(Ee(e)?e.split(" "):e,t);return Ae(n,(o,s)=>{if(EV(s)){const r=$V(s),a=MV(r,t);return{menus:Wn(o.menus,a.menus),items:[a.item,...o.items],expansions:Wn(o.expansions,a.expansions)}}else return{...o,items:[s,...o.items]}},{menus:{},expansions:{},items:[]})},IV=e=>e.search.fold(()=>({searchMode:"no-search"}),t=>({searchMode:"search-with-field",placeholder:t.placeholder})),BV=e=>e.search.fold(()=>({searchMode:"no-search"}),t=>({searchMode:"search-with-results"})),zu=(e,t,n,o)=>{const s=Te("primary-menu"),r=lO(e,n.shared.providers.menuItems());if(r.items.length===0)return g.none();const a=IV(o),c=s_(s,r.items,t,n,o.isHorizontalMenu,a),l=BV(o),d=Ut(r.menus,(h,b)=>s_(b,h,t,n,!1,l)),p=Wn(d,se(s,c));return g.from(Dl.tieredData(s,p,r.expansions))},cv=e=>!wt(e,"items"),uO="data-value",dO=(e,t,n,o)=>ae(n,s=>cv(s)?{type:"togglemenuitem",text:s.text,value:s.value,active:s.value===o,onAction:()=>{ye.setValue(e,s.value),Be(e,xr,{name:t}),Ve.focus(e)}}:{type:"nestedmenuitem",text:s.text,getSubmenuItems:()=>dO(e,t,s.items,o)}),iv=(e,t)=>on(e,n=>cv(n)?ts(n.value===t,n):iv(n.items,t)),FV=(e,t,n)=>{const o=t.shared.providers,s=n.bind(l=>iv(e.items,l)).orThunk(()=>He(e.items).filter(cv)),r=e.label.map(l=>Bi(l,o)),a=Xt.parts.field({dom:{},factory:{sketch:l=>av({uid:l.uid,text:s.map(d=>d.text),icon:g.none(),tooltip:e.label,role:g.none(),fetch:(d,p)=>{const h=dO(d,e.name,e.items,ye.getValue(d));p(zu(h,qa.CLOSE_ON_EXECUTE,t,{isHorizontalMenu:!1,search:g.none()}))},onSetup:O(Q),getApi:O({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[qn.config({}),ra.withComp(s.map(d=>d.value),d=>To(d.element,uO),(d,p)=>{iv(e.items,p).each(h=>{Qe(d.element,uO,h.value),Be(d,aa,{text:h.text})})})]},"tox-listbox",t.shared)}}),c={dom:{tag:"div",classes:["tox-listboxfield"]},components:[a]};return Xt.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:xt([r.toArray(),[c]]),fieldBehaviours:ce([Ne.config({disabled:O(!e.enabled),onDisabled:l=>{Xt.getField(l).each(Ne.disable)},onEnabled:l=>{Xt.getField(l).each(Ne.enable)}})])})},PV=(e,t)=>({dom:{tag:"div",classes:e.classes},components:ae(e.items,t.shared.interpreter)}),RV=(e,t)=>{const n=ae(e.options,s=>({dom:{tag:"option",value:s.value,innerHtml:s.text}})),o=e.data.map(s=>se("initialValue",s)).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:Ko(e.selectBehaviours,[Ve.config({}),ye.config({store:{mode:"manual",getValue:s=>pc(s.element),setValue:(s,r)=>{const a=He(e.options);lt(e.options,l=>l.value===r).isSome()?xi(s.element,r):s.element.dom.selectedIndex===-1&&r===""&&a.each(l=>xi(s.element,l.value))},...o}})])}},LV=Ur({name:"HtmlSelect",configFields:[J("options"),zo("selectBehaviours",[Ve,ye]),N("selectClasses",[]),N("selectAttributes",{}),Wt("data")],factory:RV}),NV=(e,t,n)=>{const o=ae(e.items,l=>({text:t.translate(l.text),value:l.value})),s=e.label.map(l=>Bi(l,t)),r=Xt.parts.field({dom:{},...n.map(l=>({data:l})).getOr({}),selectAttributes:{size:e.size},options:o,factory:LV,selectBehaviours:ce([Ne.config({disabled:()=>!e.enabled||t.isDisabled()}),qn.config({}),st("selectbox-change",[Z(pu(),(l,d)=>{Be(l,xr,{name:e.name})})])])}),a=e.size>1?g.none():g.some(Oa("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},t.icons)),c={dom:{tag:"div",classes:["tox-selectfield"]},components:xt([[r],a.toArray()])};return Xt.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:xt([s.toArray(),[c]]),fieldBehaviours:ce([Ne.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:l=>{Xt.getField(l).each(Ne.disable)},onEnabled:l=>{Xt.getField(l).each(Ne.enable)}}),Ao()])})},HV=O([N("field1Name","field1"),N("field2Name","field2"),Ol("onLockedChange"),_l(["lockClass"]),N("locked",!1),Ta.field("coupledFieldBehaviours",[Ot,ye])]),VV=(e,t,n)=>vn(e,t,n).bind(Ot.getCurrent),mO=(e,t)=>hs({factory:Xt,name:e,overrides:n=>({fieldBehaviours:ce([st("coupled-input-behaviour",[Z(bl(),o=>{VV(o,n,t).each(s=>{vn(o,n,"lock").each(r=>{it.isOn(r)&&n.onLockedChange(o,s,r)})})})])])})}),zV=O([mO("field1","field2"),mO("field2","field1"),hs({factory:Yo,schema:[J("dom")],name:"lock",overrides:e=>({buttonBehaviours:ce([it.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),UV=(e,t,n,o)=>({uid:e.uid,dom:e.dom,components:t,behaviours:Ta.augment(e.coupledFieldBehaviours,[Ot.config({find:g.some}),ye.config({store:{mode:"manual",getValue:s=>{const r=kf(s,e,["field1","field2"]);return{[e.field1Name]:ye.getValue(r.field1()),[e.field2Name]:ye.getValue(r.field2())}},setValue:(s,r)=>{const a=kf(s,e,["field1","field2"]);io(r,e.field1Name)&&ye.setValue(a.field1(),r[e.field1Name]),io(r,e.field2Name)&&ye.setValue(a.field2(),r[e.field2Name])}}})]),apis:{getField1:s=>vn(s,e,"field1"),getField2:s=>vn(s,e,"field2"),getLock:s=>vn(s,e,"lock")}}),Wr=ws({name:"FormCoupledInputs",configFields:HV(),partFields:zV(),factory:UV,apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),WV=e=>{const t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},n=s=>s in t?t[s]:1;let o=e.value.toFixed(n(e.unit));return o.indexOf(".")!==-1&&(o=o.replace(/\.?0*$/,"")),o+e.unit},lv=e=>{const n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(n!==null){const o=parseFloat(n[1]),s=n[2];return Me.value({value:o,unit:s})}else return Me.error(e)},gO=(e,t)=>{const n={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=s=>wt(n,s);return e.unit===t?g.some(e.value):o(e.unit)&&o(t)?n[e.unit]===n[t]?g.some(e.value):g.some(e.value/n[e.unit]*n[t]):g.none()},uv=e=>g.none(),jV=(e,t)=>n=>gO(n,t).map(o=>({value:o*e,unit:t})),GV=(e,t)=>{const n=lv(e).toOptional(),o=lv(t).toOptional();return qs(n,o,(s,r)=>gO(s,r.unit).map(a=>r.value/a).map(a=>jV(a,r.unit)).getOr(uv)).getOr(uv)},qV=(e,t)=>{let n=uv;const o=Te("ratio-event"),s=h=>Oa(h,{tag:"span",classes:["tox-icon","tox-lock-icon__"+h]},t.icons),r=Wr.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[s("lock"),s("unlock")],buttonBehaviours:ce([Ne.config({disabled:()=>!e.enabled||t.isDisabled()}),Ao(),qn.config({})])}),a=h=>({dom:{tag:"div",classes:["tox-form__group"]},components:h}),c=h=>Xt.parts.field({factory:$l,inputClasses:["tox-textfield"],inputBehaviours:ce([Ne.config({disabled:()=>!e.enabled||t.isDisabled()}),Ao(),qn.config({}),st("size-input-events",[Z(uc(),(b,S)=>{Be(b,o,{isField1:h})}),Z(pu(),(b,S)=>{Be(b,xr,{name:e.name})})])]),selectOnFocus:!1}),l=h=>({dom:{tag:"label",classes:["tox-label"]},components:[ho(t.translate(h))]}),d=Wr.parts.field1(a([Xt.parts.label(l("Width")),c(!0)])),p=Wr.parts.field2(a([Xt.parts.label(l("Height")),c(!1)]));return Wr.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[d,p,a([l(a$),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(h,b,S)=>{lv(ye.getValue(h)).each(_=>{n(_).each(k=>{ye.setValue(b,WV(k))})})},coupledFieldBehaviours:ce([Ne.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:h=>{Wr.getField1(h).bind(Xt.getField).each(Ne.disable),Wr.getField2(h).bind(Xt.getField).each(Ne.disable),Wr.getLock(h).each(Ne.disable)},onEnabled:h=>{Wr.getField1(h).bind(Xt.getField).each(Ne.enable),Wr.getField2(h).bind(Xt.getField).each(Ne.enable),Wr.getLock(h).each(Ne.enable)}}),Ao(),st("size-input-events2",[Z(o,(h,b)=>{const S=b.event.isField1,_=S?Wr.getField1(h):Wr.getField2(h),k=S?Wr.getField2(h):Wr.getField1(h),L=_.map(ye.getValue).getOr(""),R=k.map(ye.getValue).getOr("");n=GV(L,R)})])])})},KV=(e,t,n)=>{const o=Ma.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ho(t.translate(e.label))]}),s=Ma.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),r=Ma.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Ma.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e.min,maxX:e.max,getInitialValue:O(n.getOrThunk(()=>(Math.abs(e.max)-Math.abs(e.min))/2))},components:[o,s,r],sliderBehaviours:ce([$a.self(),Ve.config({})]),onChoose:(a,c,l)=>{Be(a,xr,{name:e.name,value:l})}})},YV=(e,t)=>{const n=c=>({dom:{tag:"th",innerHtml:t.translate(c)}}),o=c=>({dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:ae(c,n)}]}),s=c=>({dom:{tag:"td",innerHtml:t.translate(c)}}),r=c=>({dom:{tag:"tr"},components:ae(c,s)}),a=c=>({dom:{tag:"tbody"},components:ae(c,r)});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[o(e.header),a(e.cells)],behaviours:ce([qn.config({}),Ve.config({})])}},pO=(e,t)=>{const n=e.label.map(S=>Bi(S,t)),o=[Ne.config({disabled:()=>e.disabled||t.isDisabled()}),Ao(),$e.config({mode:"execution",useEnter:e.multiline!==!0,useControlEnter:e.multiline===!0,execute:S=>(jt(S,lm),g.some(!0))}),st("textfield-change",[Z(bl(),(S,_)=>{Be(S,xr,{name:e.name})}),Z(Sh(),(S,_)=>{Be(S,xr,{name:e.name})})]),qn.config({})],s=e.validation.map(S=>yc.config({getRoot:_=>Is(_.element),invalidClass:"tox-invalid",validator:{validate:_=>{const k=ye.getValue(_),L=S.validator(k);return is.pure(L===!0?Me.value(k):Me.error(L))},validateOnLoad:S.validateOnLoad}})).toArray(),r=e.placeholder.fold(O({}),S=>({placeholder:t.translate(S)})),a=e.inputMode.fold(O({}),S=>({inputmode:S})),c={...r,...a},l=Xt.parts.field({tag:e.multiline===!0?"textarea":"input",...e.data.map(S=>({data:S})).getOr({}),inputAttributes:c,inputClasses:[e.classname],inputBehaviours:ce(xt([o,s])),selectOnFocus:!1,factory:$l}),d=e.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[l]}:l,h=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),b=[Ne.config({disabled:()=>e.disabled||t.isDisabled(),onDisabled:S=>{Xt.getField(S).each(Ne.disable)},onEnabled:S=>{Xt.getField(S).each(Ne.enable)}}),Ao()];return cm(n,d,h,b)},XV=(e,t,n)=>pO({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:!e.enabled,classname:"tox-textfield",validation:g.none(),maximized:e.maximized,data:n},t),JV=(e,t,n)=>pO({name:e.name,multiline:!0,label:e.label,inputMode:g.none(),placeholder:e.placeholder,flex:!0,disabled:!e.enabled,classname:"tox-textarea",validation:g.none(),maximized:e.maximized,data:n},t),gm=(e,t)=>t.getAnimationRoot.fold(()=>e.element,n=>n(e)),Jc=e=>e.dimension.property,Wl=(e,t)=>e.dimension.getDimension(t),up=(e,t)=>{const n=gm(e,t);Hr(n,[t.shrinkingClass,t.growingClass])},dv=(e,t)=>{so(e.element,t.openClass),vo(e.element,t.closedClass),pe(e.element,Jc(t),"0px"),pa(e.element)},mv=(e,t)=>{so(e.element,t.closedClass),vo(e.element,t.openClass),Qt(e.element,Jc(t))},hO=(e,t,n,o)=>{n.setCollapsed(),pe(e.element,Jc(t),Wl(t,e.element)),up(e,t),dv(e,t),t.onStartShrink(e),t.onShrunk(e)},ZV=(e,t,n,o)=>{const s=o.getOrThunk(()=>Wl(t,e.element));n.setCollapsed(),pe(e.element,Jc(t),s),pa(e.element);const r=gm(e,t);so(r,t.growingClass),vo(r,t.shrinkingClass),dv(e,t),t.onStartShrink(e)},fO=(e,t,n)=>{const o=Wl(t,e.element);(o==="0px"?hO:ZV)(e,t,n,g.some(o))},bO=(e,t,n)=>{const o=gm(e,t),s=or(o,t.shrinkingClass),r=Wl(t,e.element);mv(e,t);const a=Wl(t,e.element);(s?()=>{pe(e.element,Jc(t),r),pa(e.element)}:()=>{dv(e,t)})(),so(o,t.shrinkingClass),vo(o,t.growingClass),mv(e,t),pe(e.element,Jc(t),a),n.setExpanded(),t.onStartGrow(e)},QV=(e,t,n)=>{if(n.isExpanded()){Qt(e.element,Jc(t));const o=Wl(t,e.element);pe(e.element,Jc(t),o)}},ez=(e,t,n)=>{n.isExpanded()||bO(e,t,n)},tz=(e,t,n)=>{n.isExpanded()&&fO(e,t,n)},nz=(e,t,n)=>{n.isExpanded()&&hO(e,t,n)},oz=(e,t,n)=>n.isExpanded(),sz=(e,t,n)=>n.isCollapsed(),vO=(e,t,n)=>{const o=gm(e,t);return or(o,t.growingClass)===!0},yO=(e,t,n)=>{const o=gm(e,t);return or(o,t.shrinkingClass)===!0};var rz=Object.freeze({__proto__:null,refresh:QV,grow:ez,shrink:tz,immediateShrink:nz,hasGrown:oz,hasShrunk:sz,isGrowing:vO,isShrinking:yO,isTransitioning:(e,t,n)=>vO(e,t)||yO(e,t),toggleGrow:(e,t,n)=>{(n.isExpanded()?fO:bO)(e,t,n)},disableTransitions:up,immediateGrow:(e,t,n)=>{n.isExpanded()||(mv(e,t),pe(e.element,Jc(t),Wl(t,e.element)),up(e,t),n.setExpanded(),t.onStartGrow(e),t.onGrown(e))}}),az=Object.freeze({__proto__:null,exhibit:(e,t,n)=>{const o=t.expanded;return xa(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:se(t.dimension.property,"0px")})},events:(e,t)=>On([bu(kd(),(n,o)=>{o.event.raw.propertyName===e.dimension.property&&(up(n,e),t.isExpanded()&&Qt(n.element,e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(n))})])}),cz=[J("closedClass"),J("openClass"),J("shrinkingClass"),J("growingClass"),Wt("getAnimationRoot"),Dt("onShrunk"),Dt("onStartShrink"),Dt("onGrown"),Dt("onStartGrow"),N("expanded",!1),Qs("dimension",Hs("property",{width:[Dn("property","width"),Dn("getDimension",e=>Oo(e)+"px")],height:[Dn("property","height"),Dn("getDimension",e=>In(e)+"px")]}))],iz=Object.freeze({__proto__:null,init:e=>{const t=Le(e.expanded),n=()=>"expanded: "+t.get();return Nr({isExpanded:()=>t.get()===!0,isCollapsed:()=>t.get()===!1,setCollapsed:Et(t.set,!1),setExpanded:Et(t.set,!0),readState:n})}});const wr=qo({fields:cz,name:"sliding",active:az,apis:rz,state:iz}),SO=e=>({isEnabled:()=>!Ne.isDisabled(e),setEnabled:t=>Ne.set(e,!t),setActive:t=>{const n=e.element;t?(vo(n,"tox-tbtn--enabled"),Qe(n,"aria-pressed",!0)):(so(n,"tox-tbtn--enabled"),C(n,"aria-pressed"))},isActive:()=>or(e.element,"tox-tbtn--enabled"),setText:t=>{Be(e,aa,{text:t})},setIcon:t=>Be(e,Ul,{icon:t})}),pm=(e,t,n,o,s=!0)=>av({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:o,fetch:(r,a)=>{const c={pattern:e.search.isSome()?YL(r):""};e.fetch(l=>{a(zu(l,qa.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:e.search}))},c,SO(r))},onSetup:e.onSetup,getApi:SO,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...s?[qn.config({})]:[]]},t,n.shared),lz=(e,t,n)=>{const o=r=>a=>{const c=!a.isActive();a.setActive(c),r.storage.set(c),n.shared.getSink().each(l=>{t().getOpt(l).each(d=>{wa(d.element),Be(d,vc,{name:r.name,value:r.storage.get()})})})},s=r=>a=>{a.setActive(r.storage.get())};return r=>{r(ae(e,a=>{const c=a.text.fold(()=>({}),l=>({text:l}));return{type:a.type,active:!1,...c,onAction:o(a),onSetup:s(a)}}))}},xO=e=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{title:e,"aria-label":e}},components:[ho(e)]}),wO=Te("leaf-label-event-id"),gv=({leaf:e,onLeafAction:t,visible:n,treeId:o,selectedId:s,backstage:r})=>{const a=e.menu.map(l=>pm(l,"tox-mbtn",r,g.none(),n)),c=[xO(e.title)];return a.each(l=>c.push(l)),Yo.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(n?["tox-tree--leaf__label--visible"]:[])},components:c,role:"treeitem",action:l=>{t(e.id),l.getSystem().broadcastOn([`update-active-item-${o}`],{value:e.id})},eventOrder:{[nr()]:[wO,"keying"]},buttonBehaviours:ce([...n?[qn.config({})]:[],it.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),zr.config({channels:{[`update-active-item-${o}`]:{onReceive:(l,d)=>{(d.value===e.id?it.on:it.off)(l)}}}}),st(wO,[Pn((l,d)=>{s.each(p=>{(p===e.id?it.on:it.off)(l)})}),Z(nr(),(l,d)=>{const p=d.event.raw.code==="ArrowLeft",h=d.event.raw.code==="ArrowRight";p?(wi(l.element,".tox-tree--directory").each(b=>{l.getSystem().getByDom(b).each(S=>{Ph(b,".tox-tree--directory__label").each(_=>{S.getSystem().getByDom(_).each(Ve.focus)})})}),d.stop()):h&&d.stop()})])])})},uz=(e,t,n)=>Oa(e,{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"],behaviours:n},t),dz=(e,t)=>uz(e,t,[]),CO=Te("directory-label-event-id"),mz=({directory:e,visible:t,noChildren:n,backstage:o})=>{const s=e.menu.map(c=>pm(c,"tox-mbtn",o,g.none())),r=[{dom:{tag:"div",classes:["tox-chevron"]},components:[dz("chevron-right",o.shared.providers.icons)]},xO(e.title)];s.each(c=>{r.push(c)});const a=c=>{wi(c.element,".tox-tree--directory").each(l=>{c.getSystem().getByDom(l).each(d=>{const p=!it.isOn(d);it.toggle(d),Be(c,"expand-tree-node",{expanded:p,node:e.id})})})};return Yo.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(t?["tox-tree--directory__label--visible"]:[])},components:r,action:a,eventOrder:{[nr()]:[CO,"keying"]},buttonBehaviours:ce([...t?[qn.config({})]:[],st(CO,[Z(nr(),(c,l)=>{const d=l.event.raw.code==="ArrowRight",p=l.event.raw.code==="ArrowLeft";d&&n&&l.stop(),(d||p)&&wi(c.element,".tox-tree--directory").each(h=>{c.getSystem().getByDom(h).each(b=>{!it.isOn(b)&&d||it.isOn(b)&&p?(a(c),l.stop()):p&&!it.isOn(b)&&(wi(b.element,".tox-tree--directory").each(S=>{Ph(S,".tox-tree--directory__label").each(_=>{b.getSystem().getByDom(_).each(Ve.focus)})}),l.stop())})})})])])})},gz=({children:e,onLeafAction:t,visible:n,treeId:o,expandedIds:s,selectedId:r,backstage:a})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:e.map(c=>c.type==="leaf"?gv({leaf:c,selectedId:r,onLeafAction:t,visible:n,treeId:o,backstage:a}):pv({directory:c,expandedIds:s,selectedId:r,onLeafAction:t,labelTabstopping:n,treeId:o,backstage:a})),behaviours:ce([wr.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking",expanded:n}),Ze.config({})])}),pz=Te("directory-event-id"),pv=({directory:e,onLeafAction:t,labelTabstopping:n,treeId:o,backstage:s,expandedIds:r,selectedId:a})=>{const{children:c}=e,l=Le(r),d=h=>c.map(b=>b.type==="leaf"?gv({leaf:b,selectedId:a,onLeafAction:t,visible:h,treeId:o,backstage:s}):pv({directory:b,expandedIds:l.get(),selectedId:a,onLeafAction:t,labelTabstopping:h,treeId:o,backstage:s})),p=r.includes(e.id);return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[mz({directory:e,visible:n,noChildren:e.children.length===0,backstage:s}),gz({children:c,expandedIds:r,selectedId:a,onLeafAction:t,visible:p,treeId:o,backstage:s})],behaviours:ce([st(pz,[Pn((h,b)=>{it.set(h,p)}),Z("expand-tree-node",(h,b)=>{const{expanded:S,node:_}=b.event;l.set(S?[...l.get(),_]:l.get().filter(k=>k!==_))})]),it.config({...e.children.length>0?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(h,b)=>{const S=h.components()[1],_=d(b);b?wr.grow(S):wr.shrink(S),Ze.set(S,_)}})])}},hz=Te("tree-event-id"),fz=(e,t)=>{const n=e.onLeafAction.getOr(Q),o=e.onToggleExpand.getOr(Q),s=e.defaultExpandedIds,r=Le(s),a=Le(e.defaultSelectedId),c=Te("tree-id"),l=(d,p)=>e.items.map(h=>h.type==="leaf"?gv({leaf:h,selectedId:d,onLeafAction:n,visible:!0,treeId:c,backstage:t}):pv({directory:h,selectedId:d,onLeafAction:n,expandedIds:p,labelTabstopping:!0,treeId:c,backstage:t}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:l(a.get(),r.get()),behaviours:ce([$e.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1}),st(hz,[Z("expand-tree-node",(d,p)=>{const{expanded:h,node:b}=p.event;r.set(h?[...r.get(),b]:r.get().filter(S=>S!==b)),o(r.get(),{expanded:h,node:b})})]),zr.config({channels:{[`update-active-item-${c}`]:{onReceive:(d,p)=>{a.set(g.some(p.value)),Ze.set(d,l(g.some(p.value),r.get()))}}}}),Ze.config({})])}};var bz=Object.freeze({__proto__:null,events:(e,t)=>{const o=e.stream.streams.setup(e,t);return On([Z(e.event,o),mc(()=>t.cancel())].concat(e.cancelEvent.map(s=>[Z(s,()=>t.cancel())]).getOr([])))}});const vz=(e,t)=>{let n=null;return{cancel:()=>{ln(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{ln(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},hv=(e,t)=>{let n=null;const o=()=>{ln(n)||(clearTimeout(n),n=null)};return{cancel:o,throttle:(...r)=>{o(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},TO=e=>{const t=Le(null);return Nr({readState:()=>({timer:t.get()!==null?"set":"unset"}),setTimer:r=>{t.set(r)},cancel:()=>{const r=t.get();r!==null&&r.cancel()}})};var yz=Object.freeze({__proto__:null,throttle:TO,init:e=>e.stream.streams.state(e)});const Sz=(e,t)=>{const n=e.stream,o=hv(e.onStream,n.delay);return t.setTimer(o),(s,r)=>{o.throttle(s,r),n.stopEvent&&r.stop()}};var xz=[Qs("stream",Hs("mode",{throttle:[J("delay"),N("stopEvent",!0),Dn("streams",{setup:Sz,state:TO})]})),N("event","input"),Wt("cancelEvent"),Ol("onStream")];const fv=qo({fields:xz,name:"streaming",active:bz,state:yz}),dp=(e,t,n)=>{const o=ye.getValue(n);ye.setValue(t,o),OO(t)},_O=(e,t)=>{const n=e.element,o=pc(n),s=n.dom;To(n,"type")!=="number"&&t(s,o)},OO=e=>{_O(e,(t,n)=>t.setSelectionRange(n.length,n.length))},wz=(e,t)=>{_O(e,(n,o)=>n.setSelectionRange(t,o.length))},Cz=(e,t,n)=>{if(e.selectsOver){const o=ye.getValue(t),s=e.getDisplayText(o),r=ye.getValue(n);return e.getDisplayText(r).indexOf(s)===0?g.some(()=>{dp(e,t,n),wz(t,s.length)}):g.none()}else return g.none()},bv=O("alloy.typeahead.itemexecute"),Tz=(e,t,n,o)=>{const s=(h,b,S)=>{e.previewing.set(!1);const _=Qn.getCoupled(h,"sandbox");if(Mt.isOpen(_))Ot.getCurrent(_).each(k=>{Vt.getHighlighted(k).fold(()=>{S(k)},()=>{Xy(_,k.element,"keydown",b)})});else{const k=L=>{Ot.getCurrent(L).each(S)};Xg(e,a(h),h,_,o,k,Ws.HighlightMenuAndItem).get(Q)}},r=NC(e),a=h=>b=>b.map(S=>{const _=_s(S.menus),k=At(_,R=>Y(R.items,B=>B.type==="item"));return ye.getState(h).update(ae(k,R=>R.data)),S}),c=h=>Ot.getCurrent(h),l="typeaheadevents",d=[Ve.config({}),ye.config({onSetValue:e.onSetValue,store:{mode:"dataset",getDataKey:h=>pc(h.element),getFallbackEntry:h=>({value:h,meta:{}}),setValue:(h,b)=>{xi(h.element,e.model.getDisplayText(b))},...e.initialData.map(h=>se("initialValue",h)).getOr({})}}),fv.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:(h,b)=>{const S=Qn.getCoupled(h,"sandbox");if(Ve.isFocused(h)&&pc(h.element).length>=e.minChars){const k=c(S).bind(R=>Vt.getHighlighted(R).map(ye.getValue));e.previewing.set(!0);const L=R=>{c(S).each(B=>{k.fold(()=>{e.model.selectsOver&&Vt.highlightFirst(B)},q=>{Vt.highlightBy(B,V=>ye.getValue(V).value===q.value),Vt.getHighlighted(B).orThunk(()=>(Vt.highlightFirst(B),g.none()))})})};Xg(e,a(h),h,S,o,L,Ws.HighlightJustMenu).get(Q)}},cancelEvent:xh()}),$e.config({mode:"special",onDown:(h,b)=>(s(h,b,Vt.highlightFirst),g.some(!0)),onEscape:h=>{const b=Qn.getCoupled(h,"sandbox");return Mt.isOpen(b)?(Mt.close(b),g.some(!0)):g.none()},onUp:(h,b)=>(s(h,b,Vt.highlightLast),g.some(!0)),onEnter:h=>{const b=Qn.getCoupled(h,"sandbox"),S=Mt.isOpen(b);if(S&&!e.previewing.get())return c(b).bind(_=>Vt.getHighlighted(_)).map(_=>(Be(h,bv(),{item:_}),!0));{const _=ye.getValue(h);return jt(h,xh()),e.onExecute(b,h,_),S&&Mt.close(b),g.some(!0)}}}),it.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),Qn.config({others:{sandbox:h=>Fb(e,h,{onOpen:()=>it.on(h),onClose:()=>{e.lazyTypeaheadComp.get().each(b=>C(b.element,"aria-activedescendant")),it.off(h)}})}}),st(l,[Pn(h=>{e.lazyTypeaheadComp.set(g.some(h))}),mc(h=>{e.lazyTypeaheadComp.set(g.none())}),Uc(h=>{const b=Q;Bb(e,a(h),h,o,b,Ws.HighlightMenuAndItem).get(Q)}),Z(bv(),(h,b)=>{const S=Qn.getCoupled(h,"sandbox");dp(e.model,h,b.event.item),jt(h,xh()),e.onItemExecute(h,S,b.event.item,ye.getValue(h)),Mt.close(S),OO(h)})].concat(e.dismissOnBlur?[Z(yh(),h=>{const b=Qn.getCoupled(h,"sandbox");ja(b.element).isNone()&&Mt.close(b)})]:[]))],p={[hu()]:[ye.name(),fv.name(),l],...e.eventOrder};return{uid:e.uid,dom:HC(Wn(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...r,...Ko(e.typeaheadBehaviours,d)},eventOrder:p}},_z=O([Wt("lazySink"),J("fetch"),N("minChars",5),N("responseTime",1e3),Dt("onOpen"),N("getHotspot",g.some),N("getAnchorOverrides",O({})),N("layouts",g.none()),N("eventOrder",{}),_d("model",{},[N("getDisplayText",e=>e.meta!==void 0&&e.meta.text!==void 0?e.meta.text:e.value),N("selectsOver",!0),N("populateFromBrowse",!0)]),Dt("onSetValue"),vr("onExecute"),Dt("onItemExecute"),N("inputClasses",[]),N("inputAttributes",{}),N("inputStyles",{}),N("matchWidth",!0),N("useMinWidth",!1),N("dismissOnBlur",!0),_l(["openClass"]),Wt("initialData"),zo("typeaheadBehaviours",[Ve,ye,fv,$e,it,Qn]),ds("lazyTypeaheadComp",()=>Le(g.none)),ds("previewing",()=>Le(!0))].concat(LC()).concat(Pb())),Oz=O([_a({schema:[tg()],name:"menu",overrides:e=>({fakeFocus:!0,onHighlightItem:(t,n,o)=>{e.previewing.get()?e.lazyTypeaheadComp.get().each(s=>{Cz(e.model,s,o).fold(()=>{e.model.selectsOver?(Vt.dehighlight(n,o),e.previewing.set(!0)):e.previewing.set(!1)},r=>{r(),e.previewing.set(!1)})}):e.lazyTypeaheadComp.get().each(s=>{e.model.populateFromBrowse&&dp(e.model,s,o),Go(o.element,"id").each(r=>Qe(s.element,"aria-activedescendant",r))})},onExecute:(t,n)=>e.lazyTypeaheadComp.get().map(o=>(Be(o,bv(),{item:n}),!0)),onHover:(t,n)=>{e.previewing.set(!1),e.lazyTypeaheadComp.get().each(o=>{e.model.populateFromBrowse&&dp(e.model,o,n)})}})})]),kz=ws({name:"Typeahead",configFields:_z(),partFields:Oz(),factory:Tz}),Ia=e=>({...e,toCached:()=>Ia(e.toCached()),bindFuture:l=>Ia(e.bind(d=>d.fold(p=>is.pure(Me.error(p)),p=>l(p)))),bindResult:l=>Ia(e.map(d=>d.bind(l))),mapResult:l=>Ia(e.map(d=>d.map(l))),mapError:l=>Ia(e.map(d=>d.mapError(l))),foldResult:(l,d)=>e.map(p=>p.fold(l,d)),withTimeout:(l,d)=>Ia(is.nu(p=>{let h=!1;const b=setTimeout(()=>{h=!0,p(Me.error(d()))},l);e.get(S=>{h||(clearTimeout(b),p(S))})}))}),kO=e=>Ia(is.nu(e)),EO=e=>Ia(is.pure(Me.value(e))),Ez={nu:kO,wrap:Ia,pure:EO,value:EO,error:e=>Ia(is.pure(Me.error(e))),fromResult:e=>Ia(is.pure(e)),fromFuture:e=>Ia(e.map(Me.value)),fromPromise:e=>kO(t=>{e.then(n=>{t(Me.value(n))},n=>{t(Me.error(n))})})},mp=(e,t,n=[],o,s,r)=>{const a=t.fold(()=>({}),d=>({action:d})),c={buttonBehaviours:ce([Ea.button(()=>!e.enabled||r.isDisabled()),Ao(),qn.config({}),st("button press",[Zy("click"),Zy("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...a},l=Wn(c,{dom:o});return Wn(l,{components:s})},Az=(e,t,n,o=[])=>{const s=e.tooltip.map(l=>({"aria-label":n.translate(l),title:n.translate(l)})).getOr({}),r={tag:"button",classes:["tox-tbtn"],attributes:s},a=e.icon.map(l=>rv(l,n.icons)),c=Fu([a]);return mp(e,t,o,r,c,n)},vv=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];case"secondary":default:return["tox-button","tox-button--secondary"]}},AO=(e,t,n,o=[],s=[])=>{const r=n.translate(e.text),a=e.icon.map(b=>rv(b,n.icons)),c=[a.getOrThunk(()=>ho(r))],l=e.buttonType.getOr(!e.primary&&!e.borderless?"secondary":"primary"),h={tag:"button",classes:[...vv(l),...a.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...s],attributes:{title:r}};return mp(e,t,o,h,c,n)},DO=(e,t,n,o=[],s=[])=>{const r=AO(e,g.some(t),n,o,s);return Yo.sketch(r)},MO=(e,t)=>n=>{t==="custom"?Be(n,vc,{name:e,value:{}}):t==="submit"?jt(n,lm):t==="cancel"?jt(n,Fi):console.error("Unknown button type: ",t)},Dz=(e,t)=>t==="menu",Mz=(e,t)=>t==="custom"||t==="cancel"||t==="submit",$z=(e,t)=>t==="togglebutton",Iz=(e,t)=>{var n,o;const s=e.icon.map(B=>Li(B,t.icons)).map(Yt),r=B=>{Be(B,vc,{name:e.name,value:{setIcon:q=>{s.map(V=>V.getOpt(B).each(re=>{Ze.set(re,[Li(q,t.icons)])}))}}})},a=e.buttonType.getOr(e.primary?"primary":"secondary"),c={...e,name:(n=e.name)!==null&&n!==void 0?n:"",primary:a==="primary",tooltip:g.from(e.tooltip),enabled:(o=e.enabled)!==null&&o!==void 0?o:!1,borderless:!1},l=c.tooltip.map(B=>({"aria-label":t.translate(B),title:t.translate(B)})).getOr({}),d=vv(a??"secondary"),p=e.icon.isSome()&&e.text.isSome(),h={tag:"button",classes:[...d.concat(e.icon.isSome()?["tox-button--icon"]:[]),...e.active?["tox-button--enabled"]:[],...p?["tox-button--icon-and-text"]:[]],attributes:l},b=[],S=t.translate(e.text.getOr("")),_=ho(S),L=[...Fu([s.map(B=>B.asSpec())]),...e.text.isSome()?[_]:[]],R=mp(c,g.some(r),b,h,L,t);return Yo.sketch(R)},gp=(e,t,n)=>{if(Dz(e,t)){const o=()=>a,s=e,r={...e,type:"menubutton",search:g.none(),onSetup:c=>(c.setEnabled(e.enabled),Q),fetch:lz(s.items,o,n)},a=Yt(pm(r,"tox-tbtn",n,g.none()));return a.asSpec()}else if(Mz(e,t)){const o=MO(e.name,t),s={...e,borderless:!1};return DO(s,o,n.shared.providers,[])}else{if($z(e,t))return Iz(e,n.shared.providers);throw console.error("Unknown footer button type: ",t),new Error("Unknown footer button type")}},Bz=(e,t)=>{const n=MO(e.name,"custom");return TN(g.none(),Xt.parts.field({factory:Yo,...AO(e,g.some(n),t,[ra.memory(""),$a.self()])}))},Fz={type:"separator"},Pz=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:Q}),yv=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:Q}),Rz=e=>ae(e,Pz),Lz=(e,t)=>Y(t,n=>n.type===e),$O=(e,t)=>Rz(Lz(e,t)),Nz=e=>$O("header",e.targets),Hz=e=>$O("anchor",e.targets),Vz=e=>g.from(e.anchorTop).map(t=>yv("<top>",t)).toArray(),zz=e=>g.from(e.anchorBottom).map(t=>yv("<bottom>",t)).toArray(),Uz=e=>ae(e,t=>yv(t,t)),Wz=e=>me(e,(t,n)=>t.length===0||n.length===0?t.concat(n):t.concat(Fz,n),[]),Sv=(e,t)=>{const n=e.toLowerCase();return Y(t,o=>{var s;const r=o.meta!==void 0&&o.meta.text!==void 0?o.meta.text:o.text,a=(s=o.value)!==null&&s!==void 0?s:"";return no(r.toLowerCase(),n)||no(a.toLowerCase(),n)})},jz=(e,t,n)=>{var o,s;const r=ye.getValue(t),a=(s=(o=r==null?void 0:r.meta)===null||o===void 0?void 0:o.text)!==null&&s!==void 0?s:r.value;return n.getLinkInformation().fold(()=>[],l=>{const d=Sv(a,Uz(n.getHistory(e)));return e==="file"?Wz([d,Sv(a,Nz(l)),Sv(a,xt([Vz(l),Hz(l),zz(l)]))]):d})},IO=Te("aria-invalid"),Gz=(e,t,n,o)=>{const s=t.shared.providers,r=B=>{const q=ye.getValue(B);n.addToHistory(q.value,e.filetype)},a={...o.map(B=>({initialData:B})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":IO,type:"url"},minChars:0,responseTime:0,fetch:B=>{const q=jz(e.filetype,B,n),V=zu(q,qa.BUBBLE_TO_SANDBOX,t,{isHorizontalMenu:!1,search:g.none()});return is.pure(V)},getHotspot:B=>_.getOpt(B),onSetValue:(B,q)=>{B.hasConfigured(yc)&&yc.run(B).get(Q)},typeaheadBehaviours:ce([...n.getValidationHandler().map(B=>yc.config({getRoot:q=>Is(q.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(q,V)=>{p.getOpt(q).each(re=>{Qe(re.element,"title",s.translate(V))})}},validator:{validate:q=>{const V=ye.getValue(q);return Ez.nu(re=>{B({type:e.filetype,url:V.value},ee=>{if(ee.status==="invalid"){const le=Me.error(ee.message);re(le)}else{const le=Me.value(ee.message);re(le)}})})},validateOnLoad:!1}})).toArray(),Ne.config({disabled:()=>!e.enabled||s.isDisabled()}),qn.config({}),st("urlinput-events",[Z(bl(),B=>{const q=pc(B.element),V=q.trim();V!==q&&xi(B.element,V),e.filetype==="file"&&Be(B,xr,{name:e.name})}),Z(pu(),B=>{Be(B,xr,{name:e.name}),r(B)}),Z(Sh(),B=>{Be(B,xr,{name:e.name}),r(B)})])]),eventOrder:{[bl()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:B=>B.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:Lg(!1,1,"normal")},onExecute:(B,q,V)=>{Be(q,lm,{})},onItemExecute:(B,q,V,re)=>{r(B),Be(B,xr,{name:e.name})}},c=Xt.parts.field({...a,factory:kz}),l=e.label.map(B=>Bi(B,s)),p=Yt(((B,q,V=B,re=B)=>Oa(V,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+B],attributes:{title:s.translate(re),"aria-live":"polite",...q.fold(()=>({}),ee=>({id:ee}))}},s.icons))("invalid",g.some(IO),"warning")),h=Yt({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[p.asSpec()]}),b=n.getUrlPicker(e.filetype),S=Te("browser.url.event"),_=Yt({dom:{tag:"div",classes:["tox-control-wrap"]},components:[c,h.asSpec()],behaviours:ce([Ne.config({disabled:()=>!e.enabled||s.isDisabled()})])}),k=Yt(DO({name:e.name,icon:g.some("browse"),text:e.label.getOr(""),enabled:e.enabled,primary:!1,buttonType:g.none(),borderless:!0},B=>jt(B,S),s,[],["tox-browse-url"])),L=()=>({dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:xt([[_.asSpec()],b.map(()=>k.asSpec()).toArray()])}),R=B=>{Ot.getCurrent(B).each(q=>{const V=ye.getValue(q),re={fieldname:e.name,...V};b.each(ee=>{ee(re).get(le=>{ye.setValue(q,le),Be(B,xr,{name:e.name})})})})};return Xt.sketch({dom:ON(),components:l.toArray().concat([L()]),fieldBehaviours:ce([Ne.config({disabled:()=>!e.enabled||s.isDisabled(),onDisabled:B=>{Xt.getField(B).each(Ne.disable),k.getOpt(B).each(Ne.disable)},onEnabled:B=>{Xt.getField(B).each(Ne.enable),k.getOpt(B).each(Ne.enable)}}),Ao(),st("url-input-events",[Z(S,R)])])})},qz=(e,t)=>{const n=Zw(e.icon,t.icons);return Ka.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${e.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:e.url?void 0:n},components:e.url?[Yo.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:n,attributes:{title:t.translate(e.iconTooltip)}},action:o=>Be(o,vc,{name:"alert-banner",value:e.url}),buttonBehaviours:ce([Wf()])})]:void 0},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]})},Kz=(e,t)=>{e.dom.checked=t},Yz=e=>e.dom.checked,Xz=(e,t,n)=>{const o=l=>(l.element.dom.click(),g.some(!0)),s=Xt.parts.field({factory:{sketch:Xe},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:ce([$a.self(),Ne.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:l=>{Is(l.element).each(d=>vo(d,"tox-checkbox--disabled"))},onEnabled:l=>{Is(l.element).each(d=>so(d,"tox-checkbox--disabled"))}}),qn.config({}),Ve.config({}),ra.withElement(n,Yz,Kz),$e.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),st("checkbox-events",[Z(pu(),(l,d)=>{Be(l,xr,{name:e.name})})])])}),r=Xt.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[ho(t.translate(e.label))],behaviours:ce([um.config({})])}),a=l=>Oa(l==="checked"?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+l]},t.icons),c=Yt({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return Xt.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[s,c.asSpec(),r],fieldBehaviours:ce([Ne.config({disabled:()=>!e.enabled||t.isDisabled()}),Ao()])})},Jz=e=>e.presets==="presentation"?Ka.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):Ka.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:ce([qn.config({}),Ve.config({})])}),Do=e=>(t,n,o,s)=>Se(n,"name").fold(()=>e(n,s,g.none()),r=>t.field(r,e(n,s,Se(o,r)))),Zz=e=>(t,n,o,s)=>{const r=Wn(n,{source:"dynamic"});return Do(e)(t,r,o,s)},Qz={bar:Do((e,t)=>bN(e,t.shared)),collection:Do((e,t,n)=>kN(e,t.shared.providers,n)),alertbanner:Do((e,t)=>qz(e,t.shared.providers)),input:Do((e,t,n)=>XV(e,t.shared.providers,n)),textarea:Do((e,t,n)=>JV(e,t.shared.providers,n)),label:Do((e,t)=>_V(e,t.shared)),iframe:Zz((e,t,n)=>SV(e,t.shared.providers,n)),button:Do((e,t)=>Bz(e,t.shared.providers)),checkbox:Do((e,t,n)=>Xz(e,t.shared.providers,n)),colorinput:Do((e,t,n)=>BN(e,t.shared,t.colorinput,n)),colorpicker:Do((e,t,n)=>dV(e,t.shared.providers,n)),dropzone:Do((e,t,n)=>fV(e,t.shared.providers,n)),grid:Do((e,t)=>bV(e,t.shared)),listbox:Do((e,t,n)=>FV(e,t,n)),selectbox:Do((e,t,n)=>NV(e,t.shared.providers,n)),sizeinput:Do((e,t)=>qV(e,t.shared.providers)),slider:Do((e,t,n)=>KV(e,t.shared.providers,n)),urlinput:Do((e,t,n)=>Gz(e,t,t.urlinput,n)),customeditor:Do(pV),htmlpanel:Do(Jz),imagepreview:Do((e,t,n)=>TV(e,n)),table:Do((e,t)=>YV(e,t.shared.providers)),tree:Do((e,t)=>fz(e,t)),panel:Do((e,t)=>PV(e,t))},e2={field:(e,t)=>t,record:O([])},BO=(e,t,n,o)=>{const s=Wn(o,{shared:{interpreter:r=>xv(e,r,n,s)}});return xv(e,t,n,s)},xv=(e,t,n,o)=>Se(Qz,t.type).fold(()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t),s=>s(e,t,n,o)),FO=(e,t,n)=>xv(e2,e,t,n),Ni="layout-inset",wv=e=>e.x,PO=(e,t)=>e.x+e.width/2-t.width/2,Cv=(e,t)=>e.x+e.width-t.width,Tv=e=>e.y,_v=(e,t)=>e.y+e.height-t.height,RO=(e,t)=>e.y+e.height/2-t.height/2,pp=(e,t,n)=>ss(Cv(e,t),_v(e,t),n.insetSouthwest(),Uh(),"southwest",rs(e,{right:0,bottom:3}),Ni),hp=(e,t,n)=>ss(wv(e),_v(e,t),n.insetSoutheast(),zh(),"southeast",rs(e,{left:1,bottom:3}),Ni),hm=(e,t,n)=>ss(Cv(e,t),Tv(e),n.insetNorthwest(),Vh(),"northwest",rs(e,{right:0,top:2}),Ni),fm=(e,t,n)=>ss(wv(e),Tv(e),n.insetNortheast(),og(),"northeast",rs(e,{left:1,top:2}),Ni),Ba=(e,t,n)=>ss(PO(e,t),Tv(e),n.insetNorth(),SS(),"north",rs(e,{top:2}),Ni),bm=(e,t,n)=>ss(PO(e,t),_v(e,t),n.insetSouth(),xS(),"south",rs(e,{bottom:3}),Ni),LO=(e,t,n)=>ss(Cv(e,t),RO(e,t),n.insetEast(),CS(),"east",rs(e,{right:0}),Ni),NO=(e,t,n)=>ss(wv(e),RO(e,t),n.insetWest(),wS(),"west",rs(e,{left:1}),Ni),t2=e=>{switch(e){case"north":return Ba;case"northeast":return fm;case"northwest":return hm;case"south":return bm;case"southeast":return hp;case"southwest":return pp;case"east":return LO;case"west":return NO}},HO=(e,t,n,o,s)=>LS(o).map(t2).getOr(Ba)(e,t,n,o,s),n2=e=>{switch(e){case"north":return bm;case"northeast":return hp;case"northwest":return pp;case"south":return Ba;case"southeast":return fm;case"southwest":return hm;case"east":return NO;case"west":return LO}},o2=(e,t,n,o,s)=>LS(o).map(n2).getOr(Ba)(e,t,n,o,s),vm={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},s2=(e,t,n)=>{const s={maxHeightFunction:Cu()},r=()=>({type:"node",root:j(P(e())),node:g.from(e()),bubble:Wc(12,12,vm),layouts:{onRtl:()=>[fm],onLtr:()=>[hm]},overrides:s}),a=()=>({type:"hotspot",hotspot:t(),bubble:Wc(-12,12,vm),layouts:{onRtl:()=>[as,cs,Vo],onLtr:()=>[cs,as,Vo]},overrides:s});return()=>n()?r():a()},r2=(e,t,n,o)=>{const r={maxHeightFunction:Cu()},a=()=>({type:"node",root:j(P(t())),node:g.from(t()),bubble:Wc(12,12,vm),layouts:{onRtl:()=>[Ba],onLtr:()=>[Ba]},overrides:r}),c=()=>e?{type:"node",root:j(P(t())),node:g.from(t()),bubble:Wc(0,-Yr(t()),vm),layouts:{onRtl:()=>[Ss],onLtr:()=>[Ss]},overrides:r}:{type:"hotspot",hotspot:n(),bubble:Wc(0,0,vm),layouts:{onRtl:()=>[Ss],onLtr:()=>[Ss]},overrides:r};return()=>o()?a():c()},a2=(e,t,n)=>{const o=()=>({type:"node",root:j(P(e())),node:g.from(e()),layouts:{onRtl:()=>[Ba],onLtr:()=>[Ba]}}),s=()=>({type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[Vo],onLtr:()=>[Vo]}});return()=>n()?o():s()},c2=(e,t)=>()=>({type:"selection",root:t(),getSelection:()=>{const n=e.selection.getRng(),o=e.model.table.getSelectedCells();if(o.length>1){const s=o[0],r=o[o.length-1],a={firstCell:te.fromDom(s),lastCell:te.fromDom(r)};return g.some(a)}return g.some(Bd.range(te.fromDom(n.startContainer),n.startOffset,te.fromDom(n.endContainer),n.endOffset))}}),i2=e=>t=>({type:"node",root:e(),node:t}),l2=(e,t,n,o)=>{const s=$u(e),r=()=>te.fromDom(e.getBody()),a=()=>te.fromDom(e.getContentAreaContainer()),c=()=>s||!o();return{inlineDialog:s2(a,t,c),inlineBottomDialog:r2(e.inline,a,n,c),banner:a2(a,t,c),cursor:c2(e,r),node:i2(r)}},u2=e=>(t,n)=>{GT(e)(t,n)},d2=e=>()=>LT(e),m2=e=>t=>sm(e,t),g2=e=>t=>RT(e,t),p2=e=>({colorPicker:u2(e),hasCustomColors:d2(e),getColors:m2(e),getColorCols:g2(e)}),h2=e=>()=>vC(e),f2=e=>({isDraggableModal:h2(e)}),b2=e=>{const t=Le(eb(e)?"bottom":"top");return{isPositionedAtTop:()=>t.get()==="top",getDockingMode:t.get,setDockingMode:t.set}},VO=e=>io(e,"items"),zO=e=>io(e,"format"),UO=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],v2=e=>wt(e,"items"),y2=e=>wt(e,"block"),S2=e=>wt(e,"inline"),x2=e=>wt(e,"selector"),WO=e=>me(e,(t,n)=>{if(v2(n)){const o=WO(n.items);return{customFormats:t.customFormats.concat(o.customFormats),formats:t.formats.concat([{title:n.title,items:o.formats}])}}else if(S2(n)||y2(n)||x2(n)){const s=`custom-${Ee(n.name)?n.name:n.title.toLowerCase()}`;return{customFormats:t.customFormats.concat([{name:s,format:n}]),formats:t.formats.concat([{title:n.title,format:s,icon:n.icon}])}}else return{...t,formats:t.formats.concat(n)}},{customFormats:[],formats:[]}),w2=(e,t)=>{const n=WO(t),o=s=>{be(s,r=>{e.formatter.has(r.name)||e.formatter.register(r.name,r.format)})};return e.formatter?o(n.customFormats):e.on("init",()=>{o(n.customFormats)}),n.formats},jO=e=>nC(e).map(t=>{const n=w2(e,t);return oC(e)?UO.concat(n):n}).getOr(UO),C2=e=>{const t=Lt(e);return t.length===1&&Tt(t,"title")},GO=(e,t,n)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)}),qO=(e,t,n,o)=>{const s=l=>GO(l,n,o),r=l=>{const d=c(l.items);return{...l,type:"submenu",getStyleItems:O(d)}},a=l=>{const d=Ee(l.name)?l.name:Te(l.title),p=`custom-${d}`,h={...l,type:"formatter",format:p,isSelected:n(p),getStylePreview:o(p)};return e.formatter.register(d,h),h},c=l=>ae(l,d=>VO(d)?r(d):zO(d)?s(d):C2(d)?{...d,type:"separator"}:a(d));return c(t)},T2=e=>{const t=c=>()=>e.formatter.match(c),n=c=>()=>{const l=e.formatter.get(c);return l!==void 0?g.some({tag:l.length>0&&(l[0].inline||l[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(c))}):g.none()},o=Le([]),s=Le([]),r=Le(!1);return e.on("PreInit",c=>{const l=jO(e),d=qO(e,l,t,n);o.set(d)}),e.on("addStyleModifications",c=>{const l=qO(e,c.items,t,n);s.set(l),r.set(c.replace)}),{getData:()=>{const c=r.get()?[]:o.get(),l=s.get();return c.concat(l)}}},_2=e=>Ye(e)&&e.nodeType===1,O2=Xc.trim,KO=e=>t=>!!(_2(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),k2=KO("true"),E2=KO("false"),YO=(e,t,n,o,s)=>({type:e,title:t,url:n,level:o,attach:s}),A2=e=>{let t=e;for(;t=t.parentNode;){const n=t.contentEditable;if(n&&n!=="inherit")return k2(t)}return!1},D2=(e,t)=>ae(Us(te.fromDom(t),e),n=>n.dom),XO=e=>e.innerText||e.textContent,M2=e=>e.id?e.id:Te("h"),$2=e=>e&&e.nodeName==="A"&&(e.id||e.name)!==void 0,I2=e=>$2(e)&&ZO(e),JO=e=>e&&/^(H[1-6])$/.test(e.nodeName),ZO=e=>A2(e)&&!E2(e),B2=e=>JO(e)&&ZO(e),F2=e=>JO(e)?parseInt(e.nodeName.substr(1),10):0,P2=e=>{var t;const n=M2(e),o=()=>{e.id=n};return YO("header",(t=XO(e))!==null&&t!==void 0?t:"","#"+n,F2(e),o)},R2=e=>{const t=e.id||e.name,n=XO(e);return YO("anchor",n||"#"+t,"#"+t,0,Q)},L2=e=>ae(Y(e,B2),P2),N2=e=>ae(Y(e,I2),R2),H2=e=>D2("h1,h2,h3,h4,h5,h6,a:not([href])",e),V2=e=>O2(e.title).length>0,z2={find:e=>{const t=H2(e);return Y(L2(t).concat(N2(t)),V2)}},fp="tinymce-url-history",QO=5,ek=e=>Ee(e)&&/^https?/.test(e),U2=e=>ut(e)&&e.length<=QO&&yo(e,ek),tk=e=>rt(e)&&pn(e,t=>!U2(t)).isNone(),nk=()=>{const e=Pl.getItem(fp);if(e===null)return{};let t;try{t=JSON.parse(e)}catch(n){if(n instanceof SyntaxError)return console.log("Local storage "+fp+" was not valid JSON",n),{};throw n}return tk(t)?t:(console.log("Local storage "+fp+" was not valid format",t),{})},W2=e=>{if(!tk(e))throw new Error(`Bad format for history:
`+JSON.stringify(e));Pl.setItem(fp,JSON.stringify(e))},j2=e=>{const t=nk();return Se(t,e).getOr([])},G2=(e,t)=>{if(!ek(e))return;const n=nk(),o=Se(n,t).getOr([]),s=Y(o,r=>r!==e);n[t]=[e].concat(s).slice(0,QO),W2(n)},ok=e=>!!e,q2=e=>Ut(Xc.makeMap(e,/[, ]/),ok),Ov=e=>g.from(dC(e)),K2=e=>{const t=g.from(pC(e)).filter(ok).map(q2);return Ov(e).fold(ne,n=>t.fold(ge,o=>Lt(o).length>0?o:!1))},Y2=(e,t)=>{const n=K2(e);return nn(n)?n?Ov(e):g.none():n[t]?Ov(e):g.none()},X2=(e,t)=>Y2(e,t).map(n=>o=>is.nu(s=>{const r=(c,l)=>{if(!Ee(c))throw new Error("Expected value to be string");if(l!==void 0&&!rt(l))throw new Error("Expected meta to be a object");s({value:c,meta:l})},a={filetype:t,fieldname:o.fieldname,...g.from(o.meta).getOr({})};n.call(e,r,o.value,a)})),sk=e=>g.from(e).filter(Ee).getOrUndefined(),J2=e=>hC(e)?g.some({targets:z2.find(e.getBody()),anchorTop:sk(fC(e)),anchorBottom:sk(bC(e))}):g.none(),Z2=e=>g.from(mC(e)),Q2=e=>({getHistory:j2,addToHistory:G2,getLinkInformation:()=>J2(e),getValidationHandler:()=>Z2(e),getUrlPicker:t=>X2(e,t)}),eU=(e,t,n,o)=>{const s=Le(!1),r=b2(t),a={icons:()=>t.ui.registry.getAll().icons,menuItems:()=>t.ui.registry.getAll().menuItems,translate:ta.translate,isDisabled:()=>t.mode.isReadOnly()||!t.ui.isEnabled(),getOption:t.options.get},c=Q2(t),l=T2(t),d=p2(t),p=f2(t),h=()=>s.get(),b=L=>s.set(L),S={shared:{providers:a,anchors:l2(t,n,o,r.isPositionedAtTop),header:r},urlinput:c,styles:l,colorinput:d,dialog:p,isContextMenuOpen:h,setContextMenuState:b},_={...S,shared:{...S.shared,interpreter:L=>FO(L,{},_),getSink:e.popup}},k={...S,shared:{...S.shared,interpreter:L=>FO(L,{},k),getSink:e.dialog}};return{popup:_,dialog:k}},tU=(e,t,n)=>{const o=(ee,le)=>{be([t,...n],fe=>{fe.broadcastEvent(ee,le)})},s=(ee,le)=>{be([t,...n],fe=>{fe.broadcastOn([ee],le)})},r=ee=>s(Oi(),{target:ee.target}),a=rl(),c=zs(a,"touchstart",r),l=zs(a,"touchmove",ee=>o(fD(),ee)),d=zs(a,"touchend",ee=>o(bD(),ee)),p=zs(a,"mousedown",r),h=zs(a,"mouseup",ee=>{ee.raw.button===0&&s(pf(),{target:ee.target})}),b=ee=>s(Oi(),{target:te.fromDom(ee.target)}),S=ee=>{ee.button===0&&s(pf(),{target:te.fromDom(ee.target)})},_=()=>{be(e.editorManager.get(),ee=>{e!==ee&&ee.dispatch("DismissPopups",{relatedTarget:e})})},k=ee=>o(wh(),HS(ee)),L=ee=>{s(Tu(),{}),o(Xm(),HS(ee))},R=P(te.fromDom(e.getElement())),B=of(R,"scroll",ee=>{requestAnimationFrame(()=>{const le=e.getContainer();if(le!=null){const dt=Rl(e,t.element).map(_e=>[_e.element,..._e.others]).getOr([]);Rn(dt,_e=>an(_e,ee.target))&&(e.dispatch("ElementScroll",{target:ee.target.dom}),o(Gy(),ee))}})}),q=()=>s(Tu(),{}),V=ee=>{ee.state&&s(Oi(),{target:te.fromDom(e.getContainer())})},re=ee=>{s(Oi(),{target:te.fromDom(ee.relatedTarget.getContainer())})};e.on("PostRender",()=>{e.on("click",b),e.on("tap",b),e.on("mouseup",S),e.on("mousedown",_),e.on("ScrollWindow",k),e.on("ResizeWindow",L),e.on("ResizeEditor",q),e.on("AfterProgressState",V),e.on("DismissPopups",re)}),e.on("remove",()=>{e.off("click",b),e.off("tap",b),e.off("mouseup",S),e.off("mousedown",_),e.off("ScrollWindow",k),e.off("ResizeWindow",L),e.off("ResizeEditor",q),e.off("AfterProgressState",V),e.off("DismissPopups",re),p.unbind(),c.unbind(),l.unbind(),d.unbind(),h.unbind(),B.unbind()}),e.on("detach",()=>{be([t,...n],Q$),be([t,...n],ee=>ee.destroy())})},Ro=GI,xc=UI,nU=O([N("shell",!1),J("makeItem"),N("setupItem",Q),Ta.field("listBehaviours",[Ze])]),oU=ea({name:"items",overrides:()=>({behaviours:ce([Ze.config({})])})}),sU=O([oU]),rU=O("CustomList"),aU=(e,t,n,o)=>{const s=(c,l)=>{a(c).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},d=>{const p=Ze.contents(d),h=l.length,b=h-p.length,S=b>0?gn(b,()=>e.makeItem()):[],_=p.slice(h);be(_,L=>Ze.remove(d,L)),be(S,L=>Ze.append(d,L));const k=Ze.contents(d);be(k,(L,R)=>{e.setupItem(c,L,l[R],R)})})},r=e.shell?{behaviours:[Ze.config({})],components:[]}:{behaviours:[],components:t},a=c=>e.shell?g.some(c):vn(c,e,"items");return{uid:e.uid,dom:e.dom,components:r.components,behaviours:Ko(e.listBehaviours,r.behaviours),apis:{setItems:s}}},rk=ws({name:rU(),configFields:nU(),partFields:sU(),factory:aU,apis:{setItems:(e,t,n)=>{e.setItems(t,n)}}}),Uu=O([J("dom"),N("shell",!0),zo("toolbarBehaviours",[Ze])]),cU=O([ea({name:"groups",overrides:()=>({behaviours:ce([Ze.config({})])})})]),iU=(e,t,n,o)=>{const s=(c,l)=>{r(c).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},d=>{Ze.set(d,l)})},r=c=>e.shell?g.some(c):vn(c,e,"groups"),a=e.shell?{behaviours:[Ze.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:a.components,behaviours:Ko(e.toolbarBehaviours,a.behaviours),apis:{setGroups:s},domModification:{attributes:{role:"group"}}}},Ya=ws({name:"Toolbar",configFields:Uu(),partFields:cU(),factory:iU,apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)}}}),lU=Q,uU=ne,ak=O([]);var dU=Object.freeze({__proto__:null,setup:lU,isDocked:uU,getBehaviours:ak});const kv=e=>(Io(xn(e,"position"),"fixed")?g.none():Fa(e)).orThunk(()=>{const o=te.fromTag("span");return Wo(e).bind(s=>{Zs(s,o);const r=Fa(o);return gr(o),r})}),ck=e=>kv(e).map(Rs).getOrThunk(()=>Bn(0,0)),mU=(e,t)=>{const n=e.element;vo(n,t.transitionClass),so(n,t.fadeOutClass),vo(n,t.fadeInClass),t.onShow(e)},gU=(e,t)=>{const n=e.element;vo(n,t.transitionClass),so(n,t.fadeInClass),vo(n,t.fadeOutClass),t.onHide(e)},pU=(e,t)=>e.y<t.bottom&&e.bottom>t.y,ik=(e,t)=>e.y>=t.y,lk=(e,t)=>e.bottom<=t.bottom,Ev=(e,t,n)=>({location:"top",leftX:t,topY:n.bounds.y-e.y}),Av=(e,t,n)=>({location:"bottom",leftX:t,bottomY:e.bottom-n.bounds.bottom}),Dv=e=>e.box.x-e.win.x,hU=(e,t,n)=>{const o=t.win,s=t.box,r=Dv(t);return on(e,a=>{switch(a){case"bottom":return lk(s,n.bounds)?g.none():g.some(Av(o,r,n));case"top":return ik(s,n.bounds)?g.none():g.some(Ev(o,r,n));default:return g.none()}}).getOr({location:"no-dock"})},fU=(e,t,n)=>yo(e,o=>{switch(o){case"bottom":return lk(t,n.bounds);case"top":return ik(t,n.bounds)}}),bU=(e,t)=>{const n=t.optScrollEnv.fold(O(e.bounds.y),o=>o.scrollElmTop+(e.bounds.y-o.currentScrollTop));return Bn(e.bounds.x,n)},vU=(e,t)=>{const n=t.optScrollEnv.fold(O(e.y),o=>e.y+o.currentScrollTop-o.scrollElmTop);return Bn(e.x,n)},Mv=(e,t,n)=>n.getInitialPos().map(o=>{const s=bU(o,t);return{box:m(s.left,s.top,Oo(e),In(e)),location:o.location}}),uk=(e,t,n,o,s)=>{const r=vU(t,n),a=m(r.left,r.top,t.width,t.height);o.setInitialPos({style:ga(e),position:Un(e,"position")||"static",bounds:a,location:s.location})},yU=(e,t,n,o,s)=>{o.getInitialPos().fold(()=>uk(e,t,n,o,s),()=>Q)},dk=(e,t,n)=>n.getInitialPos().bind(o=>{var s;switch(n.clearInitialPos(),o.position){case"static":return g.some({morph:"static"});case"absolute":const r=kv(e).getOr(sn()),a=f(r),c=(s=r.dom.scrollTop)!==null&&s!==void 0?s:0;return g.some({morph:"absolute",positionCss:Ca("absolute",Se(o.style,"left").map(l=>t.x-a.x),Se(o.style,"top").map(l=>t.y-a.y+c),Se(o.style,"right").map(l=>a.right-t.right),Se(o.style,"bottom").map(l=>a.bottom-t.bottom))});default:return g.none()}}),SU=(e,t,n)=>Mv(e,t,n).filter(({box:o})=>fU(n.getModes(),o,t)).bind(({box:o})=>dk(e,o,n)),$v=e=>{switch(e.location){case"top":return g.some({morph:"fixed",positionCss:Ca("fixed",g.some(e.leftX),g.some(e.topY),g.none(),g.none())});case"bottom":return g.some({morph:"fixed",positionCss:Ca("fixed",g.some(e.leftX),g.none(),g.none(),g.some(e.bottomY))});default:return g.none()}},xU=(e,t,n)=>{const o=f(e),s=oe(),r=hU(n.getModes(),{win:s,box:o},t);return r.location==="top"||r.location==="bottom"?(uk(e,o,t,n,r),$v(r)):g.none()},wU=(e,t,n)=>SU(e,t,n).orThunk(()=>t.optScrollEnv.bind(o=>Mv(e,t,n)).bind(({box:o,location:s})=>{const r=oe(),a=Dv({win:r,box:o}),c=s==="top"?Ev(r,a,t):Av(r,a,t);return $v(c)})),CU=(e,t,n)=>{const o=e.element;return Io(xn(o,"position"),"fixed")?wU(o,t,n):xU(o,t,n)},TU=(e,t,n)=>{const o=e.element;return Mv(o,t,n).bind(({box:s})=>dk(o,s,n))},_U=(e,t,n,o)=>{const s=f(e),r=oe(),a=Dv({win:r,box:s}),c=o(r,a,t);return c.location==="bottom"||c.location==="top"?(yU(e,s,t,n,c),$v(c)):g.none()},mk=(e,t,n)=>{n.setDocked(!1),be(["left","right","top","bottom","position"],o=>Qt(e.element,o)),t.onUndocked(e)},Iv=(e,t,n,o)=>{const s=o.position==="fixed";n.setDocked(s),BS(e.element,o),(s?t.onDocked:t.onUndocked)(e)},gk=(e,t,n,o,s=!1)=>{t.contextual.each(r=>{r.lazyContext(e).each(a=>{const c=pU(a,o.bounds);c!==n.isVisible()&&(n.setVisible(c),s&&!c?(gc(e.element,[r.fadeOutClass]),r.onHide(e)):(c?mU:gU)(e,r))})})},pk=(e,t,n,o,s)=>{gk(e,t,n,o,!0),Iv(e,t,n,s.positionCss)},OU=(e,t,n,o,s)=>{switch(s.morph){case"static":return mk(e,t,n);case"absolute":return Iv(e,t,n,s.positionCss);case"fixed":return pk(e,t,n,o,s)}},kU=(e,t,n)=>{const o=t.lazyViewport(e);gk(e,t,n,o),CU(e,o,n).each(s=>{OU(e,t,n,o,s)})},EU=(e,t,n)=>{const o=e.element;n.setDocked(!1);const s=t.lazyViewport(e);TU(e,s,n).each(r=>{switch(r.morph){case"static":{mk(e,t,n);break}case"absolute":{Iv(e,t,n,r.positionCss);break}}}),n.setVisible(!0),t.contextual.each(r=>{Hr(o,[r.fadeInClass,r.fadeOutClass,r.transitionClass]),r.onShow(e)}),bp(e,t,n)},bp=(e,t,n)=>{e.getSystem().isConnected()&&kU(e,t,n)},hk=(e,t,n)=>{n.isDocked()&&EU(e,t,n)},fk=e=>(t,n,o)=>{const s=n.lazyViewport(t);_U(t.element,s,o,e).each(a=>{pk(t,n,o,s,a)})},AU=fk(Ev),DU=fk(Av);var MU=Object.freeze({__proto__:null,refresh:bp,reset:hk,isDocked:(e,t,n)=>n.isDocked(),getModes:(e,t,n)=>n.getModes(),setModes:(e,t,n,o)=>n.setModes(o),forceDockToTop:AU,forceDockToBottom:DU}),$U=Object.freeze({__proto__:null,events:(e,t)=>On([bu(kd(),(n,o)=>{e.contextual.each(s=>{or(n.element,s.transitionClass)&&(Hr(n.element,[s.transitionClass,s.fadeInClass]),(t.isVisible()?s.onShown:s.onHidden)(n)),o.stop()})}),Z(wh(),(n,o)=>{bp(n,e,t)}),Z(Gy(),(n,o)=>{bp(n,e,t)}),Z(Xm(),(n,o)=>{hk(n,e,t)})])}),IU=[tr("contextual",[go("fadeInClass"),go("fadeOutClass"),go("transitionClass"),hr("lazyContext"),Dt("onShow"),Dt("onShown"),Dt("onHide"),Dt("onHidden")]),ko("lazyViewport",()=>({bounds:oe(),optScrollEnv:g.none()})),Va("modes",["top","bottom"],Fo),Dt("onDocked"),Dt("onUndocked")],BU=Object.freeze({__proto__:null,init:e=>{const t=Le(!1),n=Le(!0),o=Mn(),s=Le(e.modes),r=()=>`docked:  ${t.get()}, visible: ${n.get()}, modes: ${s.get().join(",")}`;return Nr({isDocked:t.get,setDocked:t.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:n.get,setVisible:n.set,getModes:s.get,setModes:s.set,readState:r})}});const ro=qo({fields:IU,name:"docking",active:$U,apis:MU,state:BU}),Bv=O(Te("toolbar-height-change")),wc={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},bk="tox-tinymce--toolbar-sticky-on",vk="tox-tinymce--toolbar-sticky-off",FU=(e,t)=>{const n=ns(t),s=us(t).dom.innerHeight,r=Ls(n),a=te.fromDom(e.elm),c=x(a),l=In(a),d=c.y,p=d+l,h=Rs(t),b=In(t),S=h.top,_=S+b,k=Math.abs(S-r.top)<2,L=Math.abs(_-(r.top+s))<2;if(k&&d<_)au(r.left,d-b,n);else if(L&&p>S){const R=d-s+l+b;au(r.left,R,n)}},vp=(e,t)=>Tt(ro.getModes(e),t),Fv=e=>{const t=o=>Yr(o)+(parseInt(Un(o,"margin-top"),10)||0)+(parseInt(Un(o,"margin-bottom"),10)||0),n=e.element;Is(n).each(o=>{const s="padding-"+ro.getModes(e)[0];if(ro.isDocked(e)){const r=Oo(o);pe(n,"width",r+"px"),pe(o,s,t(n)+"px")}else Qt(n,"width"),Qt(o,s)})},yk=(e,t)=>{t?(so(e,wc.fadeOutClass),gc(e,[wc.transitionClass,wc.fadeInClass])):(so(e,wc.fadeInClass),gc(e,[wc.fadeOutClass,wc.transitionClass]))},Sk=(e,t)=>{const n=te.fromDom(e.getContainer());t?(vo(n,bk),so(n,vk)):(vo(n,vk),so(n,bk))},PU=(e,t)=>{const n=ns(t);hc(n).filter(o=>!an(t,o)).filter(o=>an(o,te.fromDom(n.dom.body))||Ms(e,o)).each(()=>wa(t))},RU=(e,t)=>ja(e).orThunk(()=>t().toOptional().bind(n=>ja(n.element))),LU=(e,t,n)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{n().each(ro.reset)}),e.on("ResizeWindow ResizeEditor",()=>{n().each(Fv)}),e.on("SkinLoaded",()=>{n().each(o=>{ro.isDocked(o)?ro.reset(o):ro.refresh(o)})}),e.on("FullscreenStateChanged",()=>{n().each(ro.reset)})),e.on("AfterScrollIntoView",o=>{n().each(s=>{ro.refresh(s);const r=s.element;cw(r)&&FU(o,r)})}),e.on("PostRender",()=>{Sk(e,!1)})},NU=e=>e().map(ro.isDocked).getOr(!1),HU=()=>[zr.config({channels:{[Bv()]:{onReceive:Fv}}})],xk=(e,t)=>{const n=Mn(),o=t.getSink,s=c=>{o().each(l=>c(l.element))},r=c=>{e.inline||Fv(c),Sk(e,ro.isDocked(c)),c.getSystem().broadcastOn([Tu()],{}),o().each(l=>l.getSystem().broadcastOn([Tu()],{}))},a=e.inline?[]:HU();return[Ve.config({}),ro.config({contextual:{lazyContext:c=>{const l=Yr(c.element),d=e.inline?e.getContentAreaContainer():e.getContainer();return g.from(d).map(p=>{const h=f(te.fromDom(p));return Rl(e,c.element).fold(()=>{const S=h.height-l,_=h.y+(vp(c,"top")?0:l);return m(h.x,_,h.width,S)},S=>{const _=D(h,Nu(S)),k=vp(c,"top")?_.y:_.y+l;return m(_.x,k,_.width,_.height-l)})})},onShow:()=>{s(c=>yk(c,!0))},onShown:c=>{s(l=>Hr(l,[wc.transitionClass,wc.fadeInClass])),n.get().each(l=>{PU(c.element,l),n.clear()})},onHide:c=>{RU(c.element,o).fold(n.clear,n.set),s(l=>yk(l,!1))},onHidden:()=>{s(c=>Hr(c,[wc.transitionClass]))},...wc},lazyViewport:c=>Rl(e,c.element).fold(()=>{const d=oe(),p=lC(e),h=d.y+(vp(c,"top")?p:0),b=d.height-(vp(c,"bottom")?p:0);return{bounds:m(d.x,h,d.width,b),optScrollEnv:g.none()}},d=>({bounds:Nu(d),optScrollEnv:g.some({currentScrollTop:d.element.dom.scrollTop,scrollElmTop:Rs(d.element).top})})),modes:[t.header.getDockingMode()],onDocked:r,onUndocked:r}),...a]};var VU=Object.freeze({__proto__:null,setup:LU,isDocked:NU,getBehaviours:xk});const zU=e=>{const t=e.editor,n=e.sticky?xk:ak;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:ce(n(t,e.sharedBackstage))}},UU=Re([lo,Qs("items",Hm([ll([db,er("items",Fo)]),Fo]))].concat(Xd)),WU=e=>jn("GroupToolbarButton",UU,e),jU=[ms("text"),ms("tooltip"),ms("icon"),fr("search",!1,Hm([dl,Re([ms("placeholder")])],e=>nn(e)?e?g.some({placeholder:g.none()}):g.none():g.some(e))),hr("fetch"),ko("onSetup",()=>Q)],wk=Re([lo,...jU]),Ck=e=>jn("menubutton",wk,e),GU=Re([lo,zg,oa,Di,MP,OP,Il,br("presets","normal",["normal","color","listpreview"]),JC(1),Iu,EP]),qU=e=>jn("SplitButton",GU,e);var Pv=Ur({factory:(e,t)=>{const n=(s,r)=>{const a=ae(r,c=>{const l={type:"menubutton",text:c.text,fetch:p=>{p(c.getItems())}},d=Ck(l).mapError(p=>vi(p)).getOrDie();return pm(d,"tox-mbtn",t.backstage,g.some("menuitem"))});Ze.set(s,a)},o={focus:$e.focusIn,setMenus:n};return{uid:e.uid,dom:e.dom,components:[],behaviours:ce([Ze.config({}),st("menubar-events",[Pn(s=>{e.onSetup(s)}),Z(za(),(s,r)=>{fo(s.element,".tox-mbtn--active").each(a=>{Wa(r.event.target,".tox-mbtn").each(c=>{an(a,c)||s.getSystem().getByDom(a).each(l=>{s.getSystem().getByDom(c).each(d=>{sa.expand(d),sa.close(l),Ve.focus(d)})})})})}),Z(jy(),(s,r)=>{r.event.prevFocus.bind(a=>s.getSystem().getByDom(a).toOptional()).each(a=>{r.event.newFocus.bind(c=>s.getSystem().getByDom(c).toOptional()).each(c=>{sa.isOpen(a)&&(sa.expand(c),sa.close(a))})})})]),$e.config({mode:"flow",selector:".tox-mbtn",onEscape:s=>(e.onEscape(s),g.some(!0))}),qn.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[J("dom"),J("uid"),J("onEscape"),J("backstage"),N("onSetup",Q)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,n)=>{e.setMenus(t,n)}}});const KU="Upgrade",YU="https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",XU=e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:YU,rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:KU}}]}),Tk="container",JU=[zo("slotBehaviours",[])],_k=e=>"<alloy.field."+e+">",ZU=e=>{const t=(()=>{const r=[];return{slot:(c,l)=>(r.push(c),Tf(Tk,_k(c),l)),record:O(r)}})(),n=e(t),o=t.record(),s=ae(o,r=>hs({name:r,pname:_k(r)}));return Af(Tk,JU,s,QU,n)},QU=(e,t)=>{const n=k=>zx(e),o=(k,L)=>vn(k,e,L),s=(k,L)=>(R,B)=>vn(R,e,B).map(q=>k(q,B)).getOr(L),r=k=>(L,R)=>{be(R,B=>k(L,B))},a=(k,L)=>To(k.element,"aria-hidden")!=="true",c=(k,L)=>{if(!a(k)){const R=k.element;Qt(R,"display"),C(R,"aria-hidden"),Be(k,Ch(),{name:L,visible:!0})}},l=(k,L)=>{if(a(k)){const R=k.element;pe(R,"display","none"),Qe(R,"aria-hidden","true"),Be(k,Ch(),{name:L,visible:!1})}},d=s(a,!1),p=s(l),h=r(p),b=k=>h(k,n()),S=s(c),_={getSlotNames:n,getSlot:o,isShowing:d,hideSlot:p,hideAllSlots:b,showSlot:S};return{uid:e.uid,dom:e.dom,components:t,behaviours:gg(e.slotBehaviours),apis:_}},fs={...Ut({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,n)=>e.getSlot(t,n),isShowing:(e,t,n)=>e.isShowing(t,n),hideSlot:(e,t,n)=>e.hideSlot(t,n),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,n)=>e.showSlot(t,n)},e=>eg(e)),sketch:ZU},eW=Re([oa,zg,ko("onShow",Q),ko("onHide",Q),Il]),tW=e=>jn("sidebar",eW,e),nW=e=>{const{sidebars:t}=e.ui.registry.getAll();be(Lt(t),n=>{const o=t[n],s=()=>Io(g.from(e.queryCommandValue("ToggleSidebar")),n);e.ui.registry.addToggleButton(n,{icon:o.icon,tooltip:o.tooltip,onAction:r=>{e.execCommand("ToggleSidebar",!1,n),r.setActive(s())},onSetup:r=>{r.setActive(s());const a=()=>r.setActive(s());return e.on("ToggleSidebar",a),()=>{e.off("ToggleSidebar",a)}}})})},oW=e=>({element:()=>e.element.dom}),sW=(e,t)=>{const n=ae(Lt(t),o=>{const s=t[o],r=Jr(tW(s));return{name:o,getApi:oW,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}});return ae(n,o=>{const s=Le(Q);return e.slot(o.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Jd.unnamedEvents([Mi(o,s),$i(o,s),Z(Ch(),(r,a)=>{const c=a.event;lt(n,d=>d.name===c.name).each(d=>{(c.visible?d.onShow:d.onHide)(d.getApi(r))})})])})})},rW=e=>fs.sketch(t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:sW(t,e),slotBehaviours:Jd.unnamedEvents([Pn(n=>fs.hideAllSlots(n))])})),aW=(e,t,n)=>{Ot.getCurrent(e).each(s=>{Ze.set(s,[rW(t)]);const r=n==null?void 0:n.toLowerCase();Ee(r)&&wt(t,r)&&Ot.getCurrent(s).each(a=>{fs.showSlot(a,r),wr.immediateGrow(s),Qt(s.element,"width"),yp(e.element,"region")})})},yp=(e,t)=>{Qe(e,"role",t)},cW=(e,t)=>{Ot.getCurrent(e).each(o=>{Ot.getCurrent(o).each(r=>{wr.hasGrown(o)?fs.isShowing(r,t)?(wr.shrink(o),yp(e.element,"presentation")):(fs.hideAllSlots(r),fs.showSlot(r,t),yp(e.element,"region")):(fs.hideAllSlots(r),fs.showSlot(r,t),wr.grow(o),yp(e.element,"region"))})})},iW=e=>Ot.getCurrent(e).bind(n=>wr.isGrowing(n)||wr.hasGrown(n)?Ot.getCurrent(n).bind(r=>lt(fs.getSlotNames(r),a=>fs.isShowing(r,a))):g.none()),Rv=Te("FixSizeEvent"),Lv=Te("AutoSizeEvent"),lW=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:ce([qn.config({}),Ve.config({}),wr.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:t=>{Ot.getCurrent(t).each(fs.hideAllSlots),jt(t,Lv)},onGrown:t=>{jt(t,Lv)},onStartGrow:t=>{Be(t,Rv,{width:xn(t.element,"width").getOr("")})},onStartShrink:t=>{Be(t,Rv,{width:Oo(t.element)+"px"})}}),Ze.config({}),Ot.config({find:t=>{const n=Ze.contents(t);return He(n)}})])}],behaviours:ce([$a.childAt(0),st("sidebar-sliding-events",[Z(Rv,(t,n)=>{pe(t.element,"width",n.event.width)}),Z(Lv,(t,n)=>{Qt(t.element,"width")})])])});var uW=Object.freeze({__proto__:null,block:(e,t,n,o)=>{Qe(e.element,"aria-busy",!0);const s=t.getRoot(e).getOr(e),r=ce([$e.config({mode:"special",onTab:()=>g.some(!0),onShiftTab:()=>g.some(!0)}),Ve.config({})]),a=o(s,r),c=s.getSystem().build(a);Ze.append(s,Qr(c)),c.hasConfigured($e)&&t.focus&&$e.focusIn(c),n.isBlocked()||t.onBlock(e),n.blockWith(()=>Ze.remove(s,c))},unblock:(e,t,n)=>{C(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()},isBlocked:(e,t,n)=>n.isBlocked()}),dW=[ko("getRoot",g.none),Ho("focus",!0),Dt("onBlock"),Dt("onUnblock")],mW=Object.freeze({__proto__:null,init:()=>{const e=O0(),t=n=>{e.set({destroy:n})};return Nr({readState:e.isSet,blockWith:t,clear:e.clear,isBlocked:e.isSet})}});const Xa=qo({fields:dW,name:"blocking",apis:uW,state:mW}),gW=e=>{const t=e.dom.attributes!==void 0?e.dom.attributes:[];return me(t,(n,o)=>o.name==="class"?n:{...n,[o.name]:o.value},{})},pW=e=>Array.prototype.slice.call(e.dom.classList,0),Hi=e=>{const t=te.fromHtml(e),n=jo(t),o=gW(t),s=pW(t),r=n.length===0?{}:{innerHtml:Ah(t)};return{tag:Bo(t),classes:s,attributes:o,...r}},hW=e=>(t,n)=>({dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:Hi('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),Ok=e=>Ot.getCurrent(e).each(t=>wa(t.element)),fW=(e,t)=>{const n="tabindex",o=`data-mce-${n}`;g.from(e.iframeElement).map(te.fromDom).each(s=>{t?(Go(s,n).each(r=>Qe(s,o,r)),Qe(s,n,-1)):(C(s,n),Go(s,o).each(r=>{Qe(s,n,r),C(s,o)}))})},bW=(e,t,n,o)=>{const s=t.element;if(fW(e,n),n)Xa.block(t,hW(o)),Qt(s,"display"),C(s,"aria-hidden"),e.hasFocus()&&Ok(t);else{const r=Ot.getCurrent(t).exists(a=>Id(a.element));Xa.unblock(t),pe(s,"display","none"),Qe(s,"aria-hidden","true"),r&&e.focus()}},vW=e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:ce([Ze.config({}),Xa.config({focus:!1}),Ot.config({find:t=>He(t.components())})]),components:[]}),yW=e=>e.type==="focusin",SW=e=>yW(e)?(e.composed?He(e.composedPath()):g.from(e.target)).map(te.fromDom).filter(Co).exists(n=>or(n,"mce-pastebin")):!1,xW=(e,t,n)=>{const o=Le(!1),s=Mn(),r=c=>{o.get()&&!SW(c)&&(c.preventDefault(),Ok(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",()=>{e.dom.bind(e.getWin(),"focusin",r),e.on("BeforeExecCommand",c=>{c.command.toLowerCase()==="mcefocus"&&c.value!==!0&&r(c)})});const a=c=>{c!==o.get()&&(o.set(c),bW(e,t(),c,n.providers),WR(e,c))};e.on("ProgressState",c=>{if(s.on(clearTimeout),ht(c.time)){const l=$g.setEditorTimeout(e,()=>a(c.state),c.time);s.set(l)}else a(c.state),s.clear()})},wW=(e,t)=>me(e,(s,r)=>t(r,s.len).fold(O(s),c=>({len:c.finish,list:s.list.concat([c])})),{len:0,list:[]}).list,Nv=(e,t,n)=>({within:e,extra:t,withinWidth:n}),kk=(e,t,n)=>{const o=wW(e,(c,l)=>{const d=n(c);return g.some({element:c,start:l,finish:l+d,width:d})}),s=Y(o,c=>c.finish<=t),r=Ae(s,(c,l)=>c+l.width,0),a=o.slice(s.length);return{within:s,extra:a,withinWidth:r}},Sp=e=>ae(e,t=>t.element),CW=(e,t,n)=>{const o=Sp(e.concat(t));return Nv(o,[],n)},TW=(e,t,n,o)=>{const s=Sp(e).concat([n]);return Nv(s,Sp(t),o)},_W=(e,t,n)=>Nv(Sp(e),[],n),OW=(e,t,n)=>{const o=kk(t,e,n);return o.extra.length===0?g.some(o):g.none()},kW=(e,t,n,o)=>{const s=OW(e,t,n).getOrThunk(()=>kk(t,e-n(o),n)),r=s.within,a=s.extra,c=s.withinWidth;return a.length===1&&a[0].width<=n(o)?CW(r,a,c):a.length>=1?TW(r,a,o,c):_W(r,a,c)},Ek=(e,t)=>{const n=ae(t,o=>Qr(o));Ya.setGroups(e,n)},EW=e=>on(e,t=>ja(t.element).bind(n=>t.getSystem().getByDom(n).toOptional())),Ak=(e,t,n)=>{const o=t.builtGroups.get();if(o.length===0)return;const s=ki(e,t,"primary"),r=Qn.getCoupled(e,"overflowGroup");pe(s.element,"visibility","hidden");const a=o.concat([r]),c=EW(a);n([]),Ek(s,a);const l=Oo(s.element),d=kW(l,t.builtGroups.get(),p=>Oo(p.element),r);d.extra.length===0?(Ze.remove(s,r),n([])):(Ek(s,d.within),n(d.extra)),Qt(s.element,"visibility"),pa(s.element),c.each(Ve.focus)},Dk=O([zo("splitToolbarBehaviours",[Qn]),ds("builtGroups",()=>Le([]))]),AW=O([_l(["overflowToggledClass"]),Vc("getOverflowBounds"),J("lazySink"),ds("overflowGroups",()=>Le([])),Dt("onOpened"),Dt("onClosed")].concat(Dk())),DW=O([hs({factory:Ya,schema:Uu(),name:"primary"}),_a({schema:Uu(),name:"overflow"}),_a({name:"overflow-button"}),_a({name:"overflow-group"})]),Hv=O((e,t)=>{oi(e,Math.floor(t))}),MW=O([_l(["toggledClass"]),J("lazySink"),hr("fetch"),Vc("getBounds"),tr("fireDismissalEventInstead",[N("event",Sl())]),_i(),Dt("onToggled")]),$W=O([_a({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:ce([it.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),_a({factory:Ya,schema:Uu(),name:"toolbar",overrides:e=>({toolbarBehaviours:ce([$e.config({mode:"cyclic",onEscape:t=>(vn(t,e,"button").each(Ve.focus),g.none())})])})})]),xp=Mn(),IW=(e,t)=>{xp.set(!0),Vv(e,t),xp.clear()},Vv=(e,t)=>{const n=Qn.getCoupled(e,"toolbarSandbox");Mt.isOpen(n)?Mt.close(n):Mt.open(n,t.toolbar())},zv=(e,t,n,o)=>{const s=n.getBounds.map(a=>a()),r=n.lazySink(e).getOrDie();xs.positionWithinBounds(r,t,{anchor:{type:"hotspot",hotspot:e,layouts:o,overrides:{maxWidthFunction:Hv()}}},s)},Mk=(e,t,n,o,s)=>{Ya.setGroups(t,s),zv(e,t,n,o),it.on(e)},BW=(e,t,n)=>{const o=hS(),s=(a,c)=>{const l=xp.get().getOr(!1);n.fetch().get(d=>{Mk(e,c,n,t.layouts,d),o.link(e.element),l||$e.focusIn(c)})},r=()=>{it.off(e),xp.get().getOr(!1)||Ve.focus(e),o.unlink(e.element)};return{dom:{tag:"div",attributes:{id:o.id}},behaviours:ce([$e.config({mode:"special",onEscape:a=>(Mt.close(a),g.some(!0))}),Mt.config({onOpen:s,onClose:r,isPartOf:(a,c,l)=>Tl(c,l)||Tl(e,l),getAttachPoint:()=>n.lazySink(e).getOrDie()}),zr.config({channels:{...hf({isExtraPart:ne,...n.fireDismissalEventInstead.map(a=>({fireEventInstead:{event:a.event}})).getOr({})}),...ff({doReposition:()=>{Mt.getState(Qn.getCoupled(e,"toolbarSandbox")).each(a=>{zv(e,a,n,t.layouts)})}})}})])}},Vi=ws({name:"FloatingToolbarButton",factory:(e,t,n,o)=>({...Yo.sketch({...o.button(),action:s=>{Vv(s,o)},buttonBehaviours:Ta.augment({dump:o.button().buttonBehaviours},[Qn.config({others:{toolbarSandbox:s=>BW(s,n,e)}})])}),apis:{setGroups:(s,r)=>{Mt.getState(Qn.getCoupled(s,"toolbarSandbox")).each(a=>{Mk(s,a,e,n.layouts,r)})},reposition:s=>{Mt.getState(Qn.getCoupled(s,"toolbarSandbox")).each(r=>{zv(s,r,e,n.layouts)})},toggle:s=>{Vv(s,o)},toggleWithoutFocusing:s=>{IW(s,o)},getToolbar:s=>Mt.getState(Qn.getCoupled(s,"toolbarSandbox")),isOpen:s=>Mt.isOpen(Qn.getCoupled(s,"toolbarSandbox"))}}),configFields:MW(),partFields:$W(),apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggleWithoutFocusing(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),FW=O([J("items"),_l(["itemSelector"]),zo("tgroupBehaviours",[$e])]),PW=O([xg({name:"items",unit:"item"})]),RW=(e,t,n,o)=>({uid:e.uid,dom:e.dom,components:t,behaviours:Ko(e.tgroupBehaviours,[$e.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}),wp=ws({name:"ToolbarGroup",configFields:FW(),partFields:PW(),factory:RW}),$k=e=>ae(e,t=>Qr(t)),Ik=(e,t,n)=>{Ak(e,n,o=>{n.overflowGroups.set(o),t.getOpt(e).each(s=>{Vi.setGroups(s,$k(o))})})},LW=(e,t,n,o)=>{const s=Yt(Vi.sketch({fetch:()=>is.nu(r=>{r($k(e.overflowGroups.get()))}),layouts:{onLtr:()=>[cs,as],onRtl:()=>[as,cs],onBottomLtr:()=>[rr,sr],onBottomRtl:()=>[sr,rr]},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()},onToggled:(r,a)=>e[a?"onOpened":"onClosed"](r)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:Ko(e.splitToolbarBehaviours,[Qn.config({others:{overflowGroup:()=>wp.sketch({...o["overflow-group"](),items:[s.asSpec()]})}})]),apis:{setGroups:(r,a)=>{e.builtGroups.set(ae(a,r.getSystem().build)),Ik(r,s,e)},refresh:r=>Ik(r,s,e),toggle:r=>{s.getOpt(r).each(a=>{Vi.toggle(a)})},toggleWithoutFocusing:r=>{s.getOpt(r).each(Vi.toggleWithoutFocusing)},isOpen:r=>s.getOpt(r).map(Vi.isOpen).getOr(!1),reposition:r=>{s.getOpt(r).each(a=>{Vi.reposition(a)})},getOverflow:r=>s.getOpt(r).bind(Vi.getToolbar)},domModification:{attributes:{role:"group"}}}},Bk=ws({name:"SplitFloatingToolbar",configFields:AW(),partFields:DW(),factory:LW,apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),NW=O([_l(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Dt("onOpened"),Dt("onClosed")].concat(Dk())),HW=O([hs({factory:Ya,schema:Uu(),name:"primary"}),hs({factory:Ya,schema:Uu(),name:"overflow",overrides:e=>({toolbarBehaviours:ce([wr.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:t=>{vn(t,e,"overflow-button").each(n=>{it.off(n),Ve.focus(n)}),e.onClosed(t)},onGrown:t=>{$e.focusIn(t),e.onOpened(t)},onStartGrow:t=>{vn(t,e,"overflow-button").each(it.on)}}),$e.config({mode:"acyclic",onEscape:t=>(vn(t,e,"overflow-button").each(Ve.focus),g.some(!0))})])})}),_a({name:"overflow-button",overrides:e=>({buttonBehaviours:ce([it.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),_a({name:"overflow-group"})]),VW=(e,t)=>vn(e,t,"overflow").map(wr.hasGrown).getOr(!1),Fk=(e,t)=>{vn(e,t,"overflow-button").bind(()=>vn(e,t,"overflow")).each(n=>{Uv(e,t),wr.toggleGrow(n)})},Uv=(e,t)=>{vn(e,t,"overflow").each(n=>{Ak(e,t,o=>{const s=ae(o,r=>Qr(r));Ya.setGroups(n,s)}),vn(e,t,"overflow-button").each(o=>{wr.hasGrown(n)&&it.on(o)}),wr.refresh(n)})},zW=(e,t,n,o)=>{const s="alloy.toolbar.toggle",r=(a,c)=>{const l=ae(c,a.getSystem().build);e.builtGroups.set(l)};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ko(e.splitToolbarBehaviours,[Qn.config({others:{overflowGroup:a=>wp.sketch({...o["overflow-group"](),items:[Yo.sketch({...o["overflow-button"](),action:c=>{jt(a,s)}})]})}}),st("toolbar-toggle-events",[Z(s,a=>{Fk(a,e)})])]),apis:{setGroups:(a,c)=>{r(a,c),Uv(a,e)},refresh:a=>Uv(a,e),toggle:a=>Fk(a,e),isOpen:a=>VW(a,e)},domModification:{attributes:{role:"group"}}}},Wv=ws({name:"SplitSlidingToolbar",configFields:NW(),partFields:HW(),factory:zW,apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),Pk=e=>{const t=e.title.fold(()=>({}),n=>({attributes:{title:n}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...t},components:[wp.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:ce([qn.config({}),Ve.config({})])}},Cp=e=>wp.sketch(Pk(e)),Rk=(e,t)=>{const n=Pn(o=>{const s=ae(e.initGroups,Cp);Ya.setGroups(o,s)});return ce([Ea.toolbarButton(e.providers.isDisabled),Ao(),$e.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),st("toolbar-events",[n])])},Lk=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":Pk({title:g.none(),items:[]}),"overflow-button":Az({name:"more",icon:g.some("more-drawer"),enabled:!0,tooltip:g.some("More..."),primary:!1,buttonType:g.none(),borderless:!1},g.none(),e.providers)},splitToolbarBehaviours:Rk(e,t)}},UW=e=>{const t=Lk(e),n=4,o=Bk.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return Bk.sketch({...t,lazySink:e.getSink,getOverflowBounds:()=>{const s=e.moreDrawerData.lazyHeader().element,r=x(s),a=da(s),c=x(a),l=Math.max(a.dom.scrollHeight,c.height);return m(r.x+n,c.y,r.width-n*2,l)},parts:{...t.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}},components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:s=>e.onToggled(s,!0),onClosed:s=>e.onToggled(s,!1)})},WW=e=>{const t=Wv.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=Wv.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=Lk(e);return Wv.sketch({...o,components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:s=>{s.getSystem().broadcastOn([Bv()],{type:"opened"}),e.onToggled(s,!0)},onClosed:s=>{s.getSystem().broadcastOn([Bv()],{type:"closed"}),e.onToggled(s,!1)}})},Tp=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return Ya.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===na.scrolling?["tox-toolbar--scrolling"]:[])},components:[Ya.parts.groups({})],toolbarBehaviours:Rk(e,t)})},Nk=[Di,oa,ms("tooltip"),br("buttonType","secondary",["primary","secondary"]),Ho("borderless",!1),hr("onAction")],jW=[...Nk,Kc,Ha("type",["button"])],GW=[...Nk,Ho("active",!1),Ha("type",["togglebutton"])],Hk={button:jW,togglebutton:GW},qW=[Ha("type",["group"]),Va("buttons",[],Hs("type",Hk))],KW=Hs("type",{...Hk,group:qW}),YW=Re([Va("buttons",[],KW),hr("onShow"),hr("onHide")]),XW=e=>jn("view",YW,e),JW=(e,t)=>{var n,o;const s=e.type==="togglebutton",r=e.icon.map(q=>Li(q,t.icons)).map(Yt),c=(()=>q=>{const V=le=>{r.map(fe=>fe.getOpt(q).each(dt=>{Ze.set(dt,[Li(le,t.icons)])}))},re=le=>{const fe=q.element;le?(vo(fe,"tox-button--enabled"),Qe(fe,"aria-pressed",!0)):(so(fe,"tox-button--enabled"),C(fe,"aria-pressed"))},ee=()=>or(q.element,"tox-button--enabled");if(s)return e.onAction({setIcon:V,setActive:re,isActive:ee});if(e.type==="button")return e.onAction({setIcon:V})})(),l={...e,name:s?e.text.getOr(e.icon.getOr("")):(n=e.text)!==null&&n!==void 0?n:e.icon.getOr(""),primary:e.buttonType==="primary",buttonType:g.from(e.buttonType),tooltip:e.tooltip,icon:e.icon,enabled:!0,borderless:e.borderless},d=vv((o=e.buttonType)!==null&&o!==void 0?o:"secondary"),p=s?e.text.map(t.translate):g.some(t.translate(e.text)),h=p.map(ho),b=l.tooltip.or(p).map(q=>({"aria-label":t.translate(q),title:t.translate(q)})).getOr({}),S=r.map(q=>q.asSpec()),_=Fu([S,h]),k=e.icon.isSome()&&h.isSome(),L={tag:"button",classes:d.concat(...e.icon.isSome()&&!k?["tox-button--icon"]:[]).concat(...k?["tox-button--icon-and-text"]:[]).concat(...e.borderless?["tox-button--naked"]:[]).concat(...e.type==="togglebutton"&&e.active?["tox-button--enabled"]:[]),attributes:b},R=[],B=mp(l,g.some(c),R,L,_,t);return Yo.sketch(B)},Vk=(e,t)=>JW(e,t),ZW=(e,t)=>({dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:ae(e.buttons,n=>Vk(n,t))}),zk=Ir().deviceType,QW=zk.isPhone(),e3=zk.isTablet(),t3=e=>{let t=!1;const n=ae(e.buttons,o=>o.type==="group"?(t=!0,ZW(o,e.providers)):Vk(o,e.providers));return{uid:e.uid,dom:{tag:"div",classes:[t?"tox-view__toolbar":"tox-view__header",...QW||e3?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:ce([Ve.config({}),$e.config({mode:"flow",selector:"button, .tox-button",focusInside:Eu.OnEnterOrSpaceMode})]),components:t?n:[Ka.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),Ka.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:n})]}},n3=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}}),o3=(e,t,n,o)=>{const s={getPane:r=>Ro.getPart(r,e,"pane"),getOnShow:r=>e.viewConfig.onShow,getOnHide:r=>e.viewConfig.onHide};return{uid:e.uid,dom:e.dom,components:t,apis:s}};var Wu=ws({name:"silver.View",configFields:[J("viewConfig")],partFields:[ea({factory:{sketch:t3},schema:[J("buttons"),J("providers")],name:"header"}),ea({factory:{sketch:n3},schema:[],name:"pane"})],factory:o3,apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});const s3=(e,t,n)=>Ln(t,(o,s)=>{const r=Jr(XW(o));return e.slot(s,Wu.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:r,components:[...r.buttons.length>0?[Wu.parts.header({buttons:r.buttons,providers:n})]:[],Wu.parts.pane({})]}))}),r3=(e,t)=>fs.sketch(n=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:s3(n,e,t),slotBehaviours:Jd.unnamedEvents([Pn(o=>fs.hideAllSlots(o))])})),Uk=e=>lt(fs.getSlotNames(e),t=>fs.isShowing(e,t)),a3=e=>{const t=e.element;pe(t,"display","none"),Qe(t,"aria-hidden","true")},c3=e=>{const t=e.element;Qt(t,"display"),C(t,"aria-hidden")},i3=e=>({getContainer:O(e)}),Wk=(e,t,n)=>{fs.getSlot(e,t).each(o=>{Wu.getPane(o).each(s=>{n(o)(i3(s.element.dom))})})},l3=(e,t)=>Wk(e,t,Wu.getOnShow),u3=(e,t)=>Wk(e,t,Wu.getOnHide);var _p=Ur({factory:(e,t)=>{const r={setViews:(a,c)=>{Ze.set(a,[r3(c,t.backstage.shared.providers)])},whichView:a=>Ot.getCurrent(a).bind(Uk),toggleView:(a,c,l,d)=>Ot.getCurrent(a).exists(p=>{const h=Uk(p),b=h.exists(_=>d===_),S=fs.getSlot(p,d).isSome();return S&&(fs.hideAllSlots(p),b?(a3(a),c()):(l(),c3(a),fs.showSlot(p,d),l3(p,d)),h.each(_=>u3(p,_))),S})};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:ce([Ze.config({}),Ot.config({find:a=>{const c=Ze.contents(a);return He(c)}})]),apis:r}},name:"silver.ViewWrapper",configFields:[J("backstage")],apis:{setViews:(e,t,n)=>e.setViews(t,n),toggleView:(e,t,n,o,s)=>e.toggleView(t,n,o,s),whichView:(e,t)=>e.whichView(t)}});const d3=(e,t,n)=>{let o=!1;const s={getSocket:r=>Ro.getPart(r,e,"socket"),setSidebar:(r,a,c)=>{Ro.getPart(r,e,"sidebar").each(l=>aW(l,a,c))},toggleSidebar:(r,a)=>{Ro.getPart(r,e,"sidebar").each(c=>cW(c,a))},whichSidebar:r=>Ro.getPart(r,e,"sidebar").bind(iW).getOrNull(),getHeader:r=>Ro.getPart(r,e,"header"),getToolbar:r=>Ro.getPart(r,e,"toolbar"),setToolbar:(r,a)=>{Ro.getPart(r,e,"toolbar").each(c=>{const l=ae(a,Cp);c.getApis().setGroups(c,l)})},setToolbars:(r,a)=>{Ro.getPart(r,e,"multiple-toolbar").each(c=>{const l=ae(a,d=>ae(d,Cp));rk.setItems(c,l)})},refreshToolbar:r=>{Ro.getPart(r,e,"toolbar").each(c=>c.getApis().refresh(c))},toggleToolbarDrawer:r=>{Ro.getPart(r,e,"toolbar").each(a=>{ir(a.getApis().toggle,c=>c(a))})},toggleToolbarDrawerWithoutFocusing:r=>{Ro.getPart(r,e,"toolbar").each(a=>{ir(a.getApis().toggleWithoutFocusing,c=>c(a))})},isToolbarDrawerToggled:r=>Ro.getPart(r,e,"toolbar").bind(a=>g.from(a.getApis().isOpen).map(c=>c(a))).getOr(!1),getThrobber:r=>Ro.getPart(r,e,"throbber"),focusToolbar:r=>{Ro.getPart(r,e,"toolbar").orThunk(()=>Ro.getPart(r,e,"multiple-toolbar")).each(c=>{$e.focusIn(c)})},setMenubar:(r,a)=>{Ro.getPart(r,e,"menubar").each(c=>{Pv.setMenus(c,a)})},focusMenubar:r=>{Ro.getPart(r,e,"menubar").each(a=>{Pv.focus(a)})},setViews:(r,a)=>{Ro.getPart(r,e,"viewWrapper").each(c=>{_p.setViews(c,a)})},toggleView:(r,a)=>Ro.getPart(r,e,"viewWrapper").exists(c=>_p.toggleView(c,()=>s.showMainView(r),()=>s.hideMainView(r),a)),whichView:r=>Ro.getPart(r,e,"viewWrapper").bind(_p.whichView).getOrNull(),hideMainView:r=>{o=s.isToolbarDrawerToggled(r),o&&s.toggleToolbarDrawer(r),Ro.getPart(r,e,"editorContainer").each(a=>{const c=a.element;pe(c,"display","none"),Qe(c,"aria-hidden","true")})},showMainView:r=>{o&&s.toggleToolbarDrawer(r),Ro.getPart(r,e,"editorContainer").each(a=>{const c=a.element;Qt(c,"display"),C(c,"aria-hidden")})}};return{uid:e.uid,dom:e.dom,components:t,apis:s,behaviours:e.behaviours}},m3=xc.optional({factory:Pv,name:"menubar",schema:[J("backstage")]}),g3=e=>e.type===na.sliding?WW:e.type===na.floating?UW:Tp,p3=xc.optional({factory:{sketch:e=>rk.sketch({uid:e.uid,dom:e.dom,listBehaviours:ce([$e.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>Tp({type:e.type,uid:Te("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),g.some(!0))}),setupItem:(t,n,o,s)=>{Ya.setGroups(n,o)},shell:!0})},name:"multiple-toolbar",schema:[J("dom"),J("onEscape")]}),h3=xc.optional({factory:{sketch:e=>{const t=g3(e),n={type:e.type,uid:e.uid,onEscape:()=>(e.onEscape(),g.some(!0)),onToggled:(o,s)=>e.onToolbarToggled(s),cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes};return t(n)}},name:"toolbar",schema:[J("dom"),J("onEscape"),J("getSink")]}),f3=xc.optional({factory:{sketch:zU},name:"header",schema:[J("dom")]}),b3=xc.optional({factory:{sketch:XU},name:"promotion",schema:[J("dom")]}),v3=xc.optional({name:"socket",schema:[J("dom")]}),y3=xc.optional({factory:{sketch:lW},name:"sidebar",schema:[J("dom")]}),S3=xc.optional({factory:{sketch:vW},name:"throbber",schema:[J("dom")]}),x3=xc.optional({factory:_p,name:"viewWrapper",schema:[J("backstage")]}),w3=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components}),C3=xc.optional({factory:{sketch:w3},name:"editorContainer",schema:[]});var yn=ws({name:"OuterContainer",factory:d3,configFields:[J("dom"),J("behaviours")],partFields:[f3,m3,h3,p3,v3,y3,b3,S3,x3,C3],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,n,o)=>{e.setSidebar(t,n,o)},toggleSidebar:(e,t,n)=>{e.toggleSidebar(t,n)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,n)=>{e.setToolbar(t,n)},setToolbars:(e,t,n)=>{e.setToolbars(t,n)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},toggleToolbarDrawerWithoutFocusing:(e,t)=>{e.toggleToolbarDrawerWithoutFocusing(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,n)=>{e.setMenubar(t,n)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,n)=>{e.setViews(t,n)},toggleView:(e,t,n)=>e.toggleView(t,n),whichView:(e,t)=>e.whichView(t)}});const T3="file edit view insert format tools table help",jk={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template inserttemplate codesample inserttable accordion | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"aidialog aishortcuts | spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},_3=(e,t,n)=>{const o=aC(n).split(/[ ,]/);return{text:e.title,getItems:()=>At(e.items,s=>{const r=s.toLowerCase();return r.trim().length===0?[]:Rn(o,a=>a===r)?[]:r==="separator"||r==="|"?[{type:"separator"}]:t.menuItems[r]?[t.menuItems[r]]:[]})}},jv=e=>e.split(" "),Gk=(e,t)=>{const n={...jk,...t.menus},o=Lt(t.menus).length>0,s=t.menubar===void 0||t.menubar===!0?jv(T3):jv(t.menubar===!1?"":t.menubar),r=Y(s,c=>{const l=wt(jk,c);return o?l||Se(t.menus,c).exists(d=>wt(d,"items")):l}),a=ae(r,c=>{const l=n[c];return _3({title:l.title,items:jv(l.items)},t,e)});return Y(a,c=>{const l=d=>Ee(d)||d.type!=="separator";return c.getItems().length>0&&Rn(c.getItems(),l)})},qk=e=>{const t=()=>{e._skinLoaded=!0,HR(e)};return()=>{e.initialized?t():e.on("init",t)}},O3=(e,t)=>()=>VR(e,{message:t}),Kk=(e,t,n)=>(e.on("remove",()=>n.unload(t)),n.load(t)),k3=(e,t)=>{const n=t+"/skin.min.css";return Kk(e,n,e.ui.styleSheetLoader)},E3=(e,t)=>{if(ue(te.fromDom(e.getElement()))){const o=t+"/skin.shadowdom.min.css";return Kk(e,o,Ud.DOM.styleSheetLoader)}else return Promise.resolve()},Yk=(e,t)=>{const n=OC(t);return n&&t.contentCSS.push(n+(e?"/content.inline":"/content")+".min.css"),!Zf(t)&&Ee(n)?Promise.all([k3(t,n),E3(t,n)]).then(qk(t),O3(t,"Skin could not be loaded")):Promise.resolve(qk(t)())},A3=Et(Yk,!1),D3=Et(Yk,!0),M3=(e,t,n)=>{const o=(c,l,d,p)=>{const h=t.shared.providers.translate(c.title);if(c.type==="separator")return g.some({type:"separator",text:h});if(c.type==="submenu"){const b=At(c.getStyleItems(),S=>s(S,l,p));return l===0&&b.length<=0?g.none():g.some({type:"nestedmenuitem",text:h,enabled:b.length>0,getSubmenuItems:()=>At(c.getStyleItems(),S=>s(S,l,p))})}else return g.some({type:"togglemenuitem",text:h,icon:c.icon,active:c.isSelected(p),enabled:!d,onAction:n.onAction(c),...c.getStylePreview().fold(()=>({}),b=>({meta:{style:b}}))})},s=(c,l,d)=>{const p=c.type==="formatter"&&n.isInvalid(c);return l===0?p?[]:o(c,l,!1,d).toArray():o(c,l,p,d).toArray()},r=c=>{const l=n.getCurrentValue(),d=n.shouldHide?0:1;return At(c,p=>s(p,d,l))};return{validateItems:r,getFetch:(c,l)=>(d,p)=>{const h=l(),b=r(h),S=zu(b,qa.CLOSE_ON_EXECUTE,c,{isHorizontalMenu:!1,search:g.none()});p(S)}}},ju=(e,t,n)=>{const o=n.dataset,s=o.type==="basic"?()=>ae(o.data,r=>GO(r,n.isSelectedFor,n.getPreviewFor)):o.getData;return{items:M3(e,t,n),getStyleItems:s}},ym=(e,t,n)=>{const{items:o,getStyleItems:s}=ju(e,t,n),r=c=>({getComponent:O(c)}),a=Fl(e,"NodeChange",c=>{const l=c.getComponent();n.updateText(l),Ne.set(c.getComponent(),!e.selection.isEditable())});return av({text:n.icon.isSome()?g.none():n.text,icon:n.icon,tooltip:g.from(n.tooltip),role:g.none(),fetch:o.getFetch(t,s),onSetup:a,getApi:r,columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},$3=e=>ae(e,t=>{let n=t,o=t;const s=t.split("=");return s.length>1&&(n=s[0],o=s[1]),{title:n,format:o}}),I3=e=>({type:"basic",data:e});var Gu;(function(e){e[e.SemiColon=0]="SemiColon",e[e.Space=1]="Space"})(Gu||(Gu={}));const B3=(e,t)=>t===Gu.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),Gv=(e,t,n)=>{const o=e.options.get(t);return{type:"basic",data:$3(B3(o,n))}},qv=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],Xk=e=>{const t=()=>lt(qv,c=>e.formatter.match(c.format)),n=c=>()=>e.formatter.match(c),o=c=>g.none,s=c=>{const d=t().fold(O("left"),p=>p.title.toLowerCase());Be(c,Ul,{icon:`align-${d}`})},r=I3(qv),a=c=>()=>lt(qv,l=>l.format===c.format).each(l=>e.execCommand(l.command));return{tooltip:"Align",text:g.none(),icon:g.some("align-left"),isSelectedFor:n,getCurrentValue:g.none,getPreviewFor:o,onAction:a,updateText:s,dataset:r,shouldHide:!1,isInvalid:c=>!e.formatter.canApply(c.format)}},F3=(e,t)=>ym(e,t,Xk(e)),P3=(e,t)=>{const n=ju(e,t,Xk(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),onSetup:Cs(e),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},Jk=(e,t)=>{const n=t(),o=ae(n,s=>s.format);return g.from(e.formatter.closest(o)).bind(s=>lt(n,r=>r.format===s)).orThunk(()=>ts(e.formatter.match("p"),{title:"Paragraph",format:"p"}))},Zk=e=>{const t="Paragraph",n=a=>()=>e.formatter.match(a),o=a=>()=>{const c=e.formatter.get(a);return c?g.some({tag:c.length>0&&(c[0].inline||c[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(a))}):g.none()},s=a=>{const l=Jk(e,()=>r.data).fold(O(t),d=>d.title);Be(a,aa,{text:l})},r=Gv(e,"block_formats",Gu.SemiColon);return{tooltip:"Blocks",text:g.some(t),icon:g.none(),isSelectedFor:n,getCurrentValue:g.none,getPreviewFor:o,onAction:DT(e),updateText:s,dataset:r,shouldHide:!1,isInvalid:a=>!e.formatter.canApply(a.format)}},R3=(e,t)=>ym(e,t,Zk(e)),L3=(e,t)=>{const n=ju(e,t,Zk(e));e.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",onSetup:Cs(e),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},N3=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Qk=e=>{const t=e.split(/\s*,\s*/);return ae(t,n=>n.replace(/^['"]+|['"]+$/g,""))},H3=e=>{const t=()=>{const n=Qk(e.toLowerCase());return yo(N3,o=>n.indexOf(o.toLowerCase())>-1)};return e.indexOf("-apple-system")===0&&t()},eE=e=>{const t="System Font",n=()=>{const d=_=>_?Qk(_)[0]:"",p=e.queryCommandValue("FontName"),h=l.data,b=p?p.toLowerCase():"";return{matchOpt:lt(h,_=>{const k=_.format;return k.toLowerCase()===b||d(k).toLowerCase()===d(b).toLowerCase()}).orThunk(()=>ts(H3(b),{title:t,format:b})),font:p}},o=d=>p=>p.exists(h=>h.format===d),s=()=>{const{matchOpt:d}=n();return d},r=d=>()=>g.some({tag:"div",styles:d.indexOf("dings")===-1?{"font-family":d}:{}}),a=d=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontName",!1,d.format)})},c=d=>{const{matchOpt:p,font:h}=n(),b=p.fold(O(h),S=>S.title);Be(d,aa,{text:b})},l=Gv(e,"font_family_formats",Gu.SemiColon);return{tooltip:"Fonts",text:g.some(t),icon:g.none(),isSelectedFor:o,getCurrentValue:s,getPreviewFor:r,onAction:a,updateText:c,dataset:l,shouldHide:!1,isInvalid:ne}},V3=(e,t)=>ym(e,t,eE(e)),z3=(e,t)=>{const n=ju(e,t,eE(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate("Fonts"),onSetup:Cs(e),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},U3={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},W3=(()=>{const e="[0-9]+",n="[eE]"+("[+-]?"+e),o="\\.",s=c=>`(?:${c})?`,a=`[+-]?(?:${["Infinity",e+o+s(e)+s(n),o+e+s(n),e+s(n)].join("|")})`;return new RegExp(`^(${a})(.*)$`)})(),j3=(e,t)=>Rn(t,n=>Rn(U3[n],o=>e===o)),Op=(e,t)=>g.from(W3.exec(e)).bind(o=>{const s=Number(o[1]),r=o[2];return j3(r,t)?g.some({value:s,unit:r}):g.none()}),G3=(e,t)=>Op(e,t).map(({value:n,unit:o})=>n+o),tE={tab:O(9),escape:O(27),enter:O(13),backspace:O(8),delete:O(46),left:O(37),up:O(38),right:O(39),down:O(40),space:O(32),home:O(36),end:O(35),pageUp:O(33),pageDown:O(34)},q3=(e,t,n)=>{let o=g.none();const s=B=>B.map(q=>ye.getValue(q)).getOr(""),r=Fl(e,"NodeChange",B=>{const q=B.getComponent();o=g.some(q),n.updateInputValue(q),Ne.set(q,!e.selection.isEditable())}),a=B=>({getComponent:O(B)}),c=Le(Q),l=Te("custom-number-input-events"),d=(B,q,V)=>{const re=s(o),ee=n.getNewValue(re,B),le=re.length-`${ee}`.length,fe=o.map(_e=>_e.element.dom.selectionStart-le),dt=o.map(_e=>_e.element.dom.selectionEnd-le);n.onAction(ee,V),o.each(_e=>{ye.setValue(_e,ee),q&&(fe.each(Ke=>_e.element.dom.selectionStart=Ke),dt.each(Ke=>_e.element.dom.selectionEnd=Ke))})},p=(B,q)=>d((V,re)=>V-re,B,q),h=(B,q)=>d((V,re)=>V+re,B,q),b=B=>Is(B.element).fold(g.none,q=>(wa(q),g.some(!0))),S=B=>Id(B.element)?(tc(B.element).each(q=>wa(q)),g.some(!0)):g.none(),_=(B,q,V,re)=>{const ee=t.shared.providers.translate(V),le=Te("altExecuting"),fe=Fl(e,"NodeChange",_e=>{Ne.set(_e.getComponent(),!e.selection.isEditable())}),dt=_e=>{Ne.isDisabled(_e)||B(!0)};return Yo.sketch({dom:{tag:"button",attributes:{title:ee,"aria-label":ee},classes:re.concat(q)},components:[rv(q,t.shared.providers.icons)],buttonBehaviours:ce([Ne.config({}),st(le,[Mi({onSetup:fe,getApi:a},c),$i({getApi:a},c),Z(nr(),(_e,Ke)=>{(Ke.event.raw.keyCode===tE.space()||Ke.event.raw.keyCode===tE.enter())&&(Ne.isDisabled(_e)||B(!1))}),Z(vl(),dt),Z(zc(),dt)])]),eventOrder:{[nr()]:[le,"keying"],[vl()]:[le,"alloy.base.behaviour"],[zc()]:[le,"alloy.base.behaviour"]}})},k=Yt(_(B=>p(!1,B),"minus","Decrease font size",["highlight-on-focus"])),L=Yt(_(B=>h(!1,B),"plus","Increase font size",["highlight-on-focus"])),R=Yt({dom:{tag:"div",classes:["tox-input-wrapper","highlight-on-focus"]},components:[$l.sketch({inputBehaviours:ce([Ne.config({}),st(l,[Mi({onSetup:r,getApi:a},c),$i({getApi:a},c)]),st("input-update-display-text",[Z(aa,(B,q)=>{ye.setValue(B,q.event.text)}),Z(fl(),B=>{n.onAction(ye.getValue(B))}),Z(pu(),B=>{n.onAction(ye.getValue(B))})]),$e.config({mode:"special",onEnter:B=>(d(Xe,!0,!0),g.some(!0)),onEscape:b,onUp:B=>(h(!0,!1),g.some(!0)),onDown:B=>(p(!0,!1),g.some(!0)),onLeft:(B,q)=>(q.cut(),g.none()),onRight:(B,q)=>(q.cut(),g.none())})])})],behaviours:ce([Ve.config({}),$e.config({mode:"special",onEnter:S,onSpace:S,onEscape:b}),st("input-wrapper-events",[Z(za(),B=>{be([k,L],q=>{const V=te.fromDom(q.get(B).element.dom);Id(V)&&Jh(V)})})])])});return{dom:{tag:"div",classes:["tox-number-input"]},components:[k.asSpec(),R.asSpec(),L.asSpec()],behaviours:ce([Ve.config({}),$e.config({mode:"flow",focusInside:Eu.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:B=>Id(B.element)?g.none():(wa(B.element),g.some(!0))})])}},K3={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Y3={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},X3=(e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},J3=(e,t)=>/[0-9.]+px$/.test(e)?X3(parseInt(e,10)*72/96,t||0)+"pt":Se(Y3,e).getOr(e),Z3=e=>Se(K3,e).getOr(""),nE=e=>{const t=()=>{let l=g.none();const d=c.data,p=e.queryCommandValue("FontSize");if(p)for(let h=3;l.isNone()&&h>=0;h--){const b=J3(p,h),S=Z3(b);l=lt(d,_=>_.format===p||_.format===b||_.format===S)}return{matchOpt:l,size:p}},n=l=>d=>d.exists(p=>p.format===l),o=()=>{const{matchOpt:l}=t();return l},s=O(g.none),r=l=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontSize",!1,l.format)})},a=l=>{const{matchOpt:d,size:p}=t(),h=d.fold(O(p),b=>b.title);Be(l,aa,{text:h})},c=Gv(e,"font_size_formats",Gu.Space);return{tooltip:"Font sizes",text:g.some("12pt"),icon:g.none(),isSelectedFor:n,getPreviewFor:s,getCurrentValue:o,onAction:r,updateText:a,dataset:c,shouldHide:!1,isInvalid:ne}},Q3=(e,t)=>ym(e,t,nE(e)),ej=e=>{var t;const n={step:1};return(t={em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}}[e])!==null&&t!==void 0?t:n},tj=16,nj=e=>e>=0,oj=e=>{const t=()=>e.queryCommandValue("FontSize");return{updateInputValue:o=>Be(o,aa,{text:t()}),onAction:(o,s)=>e.execCommand("FontSize",!1,o,{skip_focus:!s}),getNewValue:(o,s)=>{Op(o,["unsupportedLength","empty"]);const r=Op(o,["unsupportedLength","empty"]).or(Op(t(),["unsupportedLength","empty"])),a=r.map(p=>p.value).getOr(tj),c=gC(e),l=r.map(p=>p.unit).filter(p=>p!=="").getOr(c),d=s(a,ej(l).step);return`${nj(d)?d:a}${l}`}}},sj=(e,t)=>q3(e,t,oj(e)),rj=(e,t)=>{const n=ju(e,t,nE(e));e.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",onSetup:Cs(e),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},oE=(e,t)=>{const n="Paragraph",o=a=>()=>e.formatter.match(a),s=a=>()=>{const c=e.formatter.get(a);return c!==void 0?g.some({tag:c.length>0&&(c[0].inline||c[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(a))}):g.none()},r=a=>{const c=h=>VO(h)?At(h.items,c):zO(h)?[{title:h.title,format:h.format}]:[],l=At(jO(e),c),p=Jk(e,O(l)).fold(O(n),h=>h.title);Be(a,aa,{text:p})};return{tooltip:"Formats",text:g.some(n),icon:g.none(),isSelectedFor:o,getCurrentValue:g.none,getPreviewFor:s,onAction:DT(e),updateText:r,shouldHide:sC(e),isInvalid:a=>!e.formatter.canApply(a.format),dataset:t}},aj=(e,t)=>{const n={type:"advanced",...t.styles};return ym(e,t,oE(e,n))},cj=(e,t)=>{const n={type:"advanced",...t.styles},o=ju(e,t,oE(e,n));e.ui.registry.addNestedMenuItem("styles",{text:"Formats",onSetup:Cs(e),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},ij=O([J("toggleClass"),J("fetch"),Ol("onExecute"),N("getHotspot",g.some),N("getAnchorOverrides",O({})),_i(),Ol("onItemExecute"),Wt("lazySink"),J("dom"),Dt("onOpen"),zo("splitDropdownBehaviours",[Qn,$e,Ve]),N("matchWidth",!1),N("useMinWidth",!1),N("eventOrder",{}),Wt("role")].concat(Pb())),lj=hs({factory:Yo,schema:[J("dom")],name:"arrow",defaults:()=>({buttonBehaviours:ce([Ve.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(xl)},buttonBehaviours:ce([it.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),uj=hs({factory:Yo,schema:[J("dom")],name:"button",defaults:()=>({buttonBehaviours:ce([Ve.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(n=>{e.onExecute(n,t)})}})}),dj=O([lj,uj,ea({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[J("text")],name:"aria-descriptor"}),_a({schema:[tg()],name:"menu",defaults:e=>({onExecute:(t,n)=>{t.getSystem().getByUid(e.uid).each(o=>{e.onItemExecute(o,t,n)})}})}),ZT()]),mj=(e,t,n,o)=>{const s=p=>{Ot.getCurrent(p).each(h=>{Vt.highlightFirst(h),$e.focusIn(h)})},r=p=>{Bb(e,Xe,p,o,s,Ws.HighlightMenuAndItem).get(Q)},a=p=>(r(p),g.some(!0)),c=p=>{const h=ki(p,e,"button");return xl(h),g.some(!0)},l={...On([Pn((p,h)=>{vn(p,e,"aria-descriptor").each(S=>{const _=Te("aria");Qe(S.element,"id",_),Qe(p.element,"aria-describedby",_)})})]),...Mg(g.some(r))},d={repositionMenus:p=>{it.isOn(p)&&n_(p)}};return{uid:e.uid,dom:e.dom,components:t,apis:d,eventOrder:{...e.eventOrder,[Lr()]:["disabling","toggling","alloy.base.behaviour"]},events:l,behaviours:Ko(e.splitDropdownBehaviours,[Qn.config({others:{sandbox:p=>{const h=ki(p,e,"arrow");return Fb(e,p,{onOpen:()=>{it.on(h),it.on(p)},onClose:()=>{it.off(h),it.off(p)}})}}}),$e.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),Ve.config({}),it.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},kp=ws({name:"SplitDropdown",configFields:ij(),partFields:dj(),factory:mj,apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),sE=e=>({isEnabled:()=>!Ne.isDisabled(e),setEnabled:t=>Ne.set(e,!t),setText:t=>Be(e,aa,{text:t}),setIcon:t=>Be(e,Ul,{icon:t})}),gj=e=>({setActive:t=>{it.set(e,t)},isActive:()=>it.isOn(e),isEnabled:()=>!Ne.isDisabled(e),setEnabled:t=>Ne.set(e,!t),setText:t=>Be(e,aa,{text:t}),setIcon:t=>Be(e,Ul,{icon:t})}),rE=(e,t)=>e.map(n=>({"aria-label":t.translate(n),title:t.translate(n)})).getOr({}),aE=Te("focus-button"),Kv=(e,t,n,o,s)=>{const r=t.map(c=>Yt(cO(c,"tox-tbtn",s))),a=e.map(c=>Yt(Li(c,s.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:rE(n,s)},components:Fu([a.map(c=>c.asSpec()),r.map(c=>c.asSpec())]),eventOrder:{[mt()]:["focusing","alloy.base.behaviour",zl],[dc()]:[zl,"toolbar-group-button-events"]},buttonBehaviours:ce([Ea.toolbarButton(s.isDisabled),Ao(),st(zl,[Pn((c,l)=>sv(c)),Z(aa,(c,l)=>{r.bind(d=>d.getOpt(c)).each(d=>{Ze.set(d,[ho(s.translate(l.event.text))])})}),Z(Ul,(c,l)=>{a.bind(d=>d.getOpt(c)).each(d=>{Ze.set(d,[Li(l.event.icon,s.icons)])})}),Z(mt(),(c,l)=>{l.event.prevent(),jt(c,aE)})])].concat(o.getOr([])))}},pj=(e,t,n,o)=>{const s=t.shared,r=Le(Q),a={toolbarButtonBehaviours:[],getApi:sE,onSetup:e.onSetup},c=[st("toolbar-group-button-events",[Mi(a,r),$i(a,r)])];return Vi.sketch({lazySink:s.getSink,fetch:()=>is.nu(l=>{l(ae(n(e.items),Cp))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:Kv(e.icon,e.text,e.tooltip,g.some(c),s.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},cE=(e,t,n)=>{var o;const s=Le(Q),r=Kv(e.icon,e.text,e.tooltip,g.none(),n);return Yo.sketch({dom:r.dom,components:r.components,eventOrder:rO,buttonBehaviours:{...ce([st("toolbar-button-events",[OV({onAction:e.onAction,getApi:t.getApi}),Mi(t,s),$i(t,s)]),Ea.toolbarButton(()=>!e.enabled||n.isDisabled()),Ao()].concat(t.toolbarButtonBehaviours)),[zl]:(o=r.buttonBehaviours)===null||o===void 0?void 0:o[zl]}})},hj=(e,t)=>iE(e,t,[]),iE=(e,t,n)=>cE(e,{toolbarButtonBehaviours:n.length>0?[st("toolbarButtonWith",n)]:[],getApi:sE,onSetup:e.onSetup},t),fj=(e,t)=>lE(e,t,[]),lE=(e,t,n)=>cE(e,{toolbarButtonBehaviours:[Ze.config({}),it.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(n.length>0?[st("toolbarToggleButtonWith",n)]:[]),getApi:gj,onSetup:e.onSetup},t),bj=(e,t,n)=>o=>is.nu(s=>t.fetch(s)).map(s=>g.from(Rb(Wn($b(Te("menu-value"),s,r=>{t.onItemAction(e(o),r)},t.columns,t.presets,qa.CLOSE_ON_EXECUTE,t.select.getOr(ne),n),{movement:Yg(t.columns,t.presets),menuBehaviours:Jd.unnamedEvents(t.columns!=="auto"?[]:[Pn((r,a)=>{vb(r,4,RC(t.presets)).each(({numRows:c,numColumns:l})=>{$e.setGridSize(r,c,l)})})])})))),vj=(e,t)=>{const n=r=>({isEnabled:()=>!Ne.isDisabled(r),setEnabled:a=>Ne.set(r,!a),setIconFill:(a,c)=>{fo(r.element,`svg path[class="${a}"], rect[class="${a}"]`).each(l=>{Qe(l,"fill",c)})},setActive:a=>{Qe(r.element,"aria-pressed",a),fo(r.element,"span").each(c=>{r.getSystem().getByDom(c).each(l=>it.set(l,a))})},isActive:()=>fo(r.element,"span").exists(a=>r.getSystem().getByDom(a).exists(it.isOn)),setText:a=>fo(r.element,"span").each(c=>r.getSystem().getByDom(c).each(l=>Be(l,aa,{text:a}))),setIcon:a=>fo(r.element,"span").each(c=>r.getSystem().getByDom(c).each(l=>Be(l,Ul,{icon:a})))}),o=Le(Q),s={getApi:n,onSetup:e.onSetup};return kp.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...rE(e.tooltip,t.providers)}},onExecute:r=>{const a=n(r);a.isEnabled()&&e.onAction(a)},onItemExecute:(r,a,c)=>{},splitDropdownBehaviours:ce([Ea.splitButton(t.providers.isDisabled),Ao(),st("split-dropdown-events",[Pn((r,a)=>sv(r)),Z(aE,Ve.focus),Mi(s,o),$i(s,o)]),um.config({})]),eventOrder:{[dc()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:bj(n,e,t.providers),parts:{menu:Lg(!1,e.columns,e.presets)},components:[kp.parts.button(Kv(e.icon,e.text,g.none(),g.some([it.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),kp.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Zw("chevron-down",t.providers.icons)},buttonBehaviours:ce([Ea.splitButton(t.providers.isDisabled),Ao(),Wf()])}),kp.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},yj=[{name:"history",items:["undo","redo"]},{name:"ai",items:["aidialog","aishortcuts"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Sm=(e,t)=>(n,o,s)=>{const r=e(n).mapError(a=>vi(a)).getOrDie();return t(r,o,s)},Sj={button:Sm(QC,(e,t)=>hj(e,t.shared.providers)),togglebutton:Sm(eT,(e,t)=>fj(e,t.shared.providers)),menubutton:Sm(Ck,(e,t)=>pm(e,"tox-tbtn",t,g.none(),!1)),splitbutton:Sm(qU,(e,t)=>vj(e,t.shared)),grouptoolbarbutton:Sm(WU,(e,t,n)=>{const o=n.ui.registry.getAll().buttons,s=a=>Ep(n,{buttons:o,toolbar:a,allowToolbarGroups:!1},t,g.none()),r={[rf]:t.shared.header.isPositionedAtTop()?jc.TopToBottom:jc.BottomToTop};switch(Mu(n)){case na.floating:return pj(e,t,s,r);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})},xj=(e,t,n)=>Se(Sj,e.type).fold(()=>(console.error("skipping button defined by",e),g.none()),o=>g.some(o(e,t,n))),uE={styles:aj,fontsize:Q3,fontsizeinput:sj,fontfamily:V3,blocks:R3,align:F3},wj=e=>{const t=ae(yj,n=>{const o=Y(n.items,s=>wt(e,s)||wt(uE,s));return{name:n.name,items:o}});return Y(t,n=>n.items.length>0)},Cj=e=>{const t=e.split("|");return ae(t,n=>({items:n.trim().split(" ")}))},Tj=e=>ie(e,t=>wt(t,"name")&&wt(t,"items")),_j=e=>{const t=e.toolbar,n=e.buttons;return t===!1?[]:t===void 0||t===!0?wj(n):Ee(t)?Cj(t):Tj(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},Oj=(e,t,n,o,s,r)=>Se(t,n.toLowerCase()).orThunk(()=>r.bind(a=>on(a,c=>Se(t,c+n.toLowerCase())))).fold(()=>Se(uE,n.toLowerCase()).map(a=>a(e,s)),a=>a.type==="grouptoolbarbutton"&&!o?(console.warn(`Ignoring the '${n}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),g.none()):xj(a,s,e)),Ep=(e,t,n,o)=>{const s=_j(t),r=ae(s,a=>{const c=At(a.items,l=>l.trim().length===0?[]:Oj(e,t.buttons,l,t.allowToolbarGroups,n,o).toArray());return{title:g.from(e.translate(a.name)),items:c}});return Y(r,a=>a.items.length>0)},dE=(e,t,n,o)=>{const s=t.mainUi.outerContainer,r=n.toolbar,a=n.buttons;if(ie(r,Ee)){const c=r.map(l=>{const d={toolbar:l,buttons:a,allowToolbarGroups:n.allowToolbarGroups};return Ep(e,d,o,g.none())});yn.setToolbars(s,c)}else yn.setToolbar(s,Ep(e,n,o,g.none()))},mE=Ir(),kj=mE.os.isiOS()&&mE.os.version.major<=12,Ej=(e,t)=>{const{uiMotherships:n}=t,o=e.dom;let s=e.getWin();const r=e.getDoc().documentElement,a=Le(Bn(s.innerWidth,s.innerHeight)),c=Le(Bn(r.offsetWidth,r.offsetHeight)),l=()=>{const b=a.get();(b.left!==s.innerWidth||b.top!==s.innerHeight)&&(a.set(Bn(s.innerWidth,s.innerHeight)),Cb(e))},d=()=>{const b=e.getDoc().documentElement,S=c.get();(S.left!==b.offsetWidth||S.top!==b.offsetHeight)&&(c.set(Bn(b.offsetWidth,b.offsetHeight)),Cb(e))},p=b=>{UR(e,b)};o.bind(s,"resize",l),o.bind(s,"scroll",p);const h=of(te.fromDom(e.getBody()),"load",d);e.on("hide",()=>{be(n,b=>{pe(b.element,"display","none")})}),e.on("show",()=>{be(n,b=>{Qt(b.element,"display")})}),e.on("NodeChange",d),e.on("remove",()=>{h.unbind(),o.unbind(s,"resize",l),o.unbind(s,"scroll",p),s=null})},Aj=(e,t,n)=>{Ai(e)&&mg(n.mainUi.mothership.element,n.popupUi.mothership),gf(t,n.dialogUi.mothership)};var Dj=Object.freeze({__proto__:null,render:async(e,t,n,o,s)=>{const{mainUi:r,uiMotherships:a}=t,c=Le(0),l=r.outerContainer;await A3(e);const d=te.fromDom(s.targetNode),p=j(P(d));mg(d,r.mothership),Aj(e,p,t),e.on("PostRender",()=>{yn.setSidebar(l,n.sidebar,TC(e)),dE(e,t,n,o),c.set(e.getWin().innerWidth),yn.setMenubar(l,Gk(e,n)),yn.setViews(l,n.views),Ej(e,t)});const h=yn.getSocket(l).getOrDie("Could not find expected socket element");if(kj){dn(h.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});const k=vz(()=>{e.dispatch("ScrollContent")},20),L=zs(h.element,"scroll",k.throttle);e.on("remove",L.unbind)}lT(e,t),e.addCommand("ToggleSidebar",(k,L)=>{yn.toggleSidebar(l,L),e.dispatch("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",()=>{var k;return(k=yn.whichSidebar(l))!==null&&k!==void 0?k:""}),e.addCommand("ToggleView",(k,L)=>{if(yn.toggleView(l,L)){const R=l.element;r.mothership.broadcastOn([Oi()],{target:R}),be(a,B=>{B.broadcastOn([Oi()],{target:R})}),ln(yn.whichView(l))&&(e.focus(),e.nodeChanged(),yn.refreshToolbar(l))}}),e.addQueryValueHandler("ToggleView",()=>{var k;return(k=yn.whichView(l))!==null&&k!==void 0?k:""});const b=Mu(e),S=()=>{yn.refreshToolbar(t.mainUi.outerContainer)};(b===na.sliding||b===na.floating)&&e.on("ResizeWindow ResizeEditor ResizeContent",()=>{const k=e.getWin().innerWidth;k!==c.get()&&(S(),c.set(k))});const _={setEnabled:k=>{jg(t,!k)},isEnabled:()=>!Ne.isDisabled(l)};return{iframeContainer:h.element.dom,editorContainer:l.element.dom,api:_}}});const Yv=e=>/^[0-9\.]+(|px)$/i.test(""+e)?g.some(parseInt(""+e,10)):g.none(),Xv=e=>ht(e)?e+"px":e,Ap=(e,t,n)=>{const o=t.filter(r=>e<r),s=n.filter(r=>e>r);return o.or(s).getOr(e)},Mj=e=>{const t=Gf(e),n=Yf(e),o=Xf(e);return Yv(t).map(s=>Ap(s,n,o))},$j=e=>Mj(e).getOr(Gf(e)),gE=e=>{const t=qf(e),n=Kf(e),o=Ig(e);return Yv(t).map(s=>Ap(s,n,o))},Ij=e=>gE(e).getOr(qf(e)),{ToolbarLocation:Jv,ToolbarMode:pE}=QF,Bj=40,Fj=(e,t,n,o,s)=>{const{mainUi:r,uiMotherships:a}=n,c=Ud.DOM,l=$u(e),d=qd(e),p=Ig(e).or(gE(e)),h=o.shared.header,b=h.isPositionedAtTop,S=Mu(e),_=S===pE.sliding||S===pE.floating,k=Le(!1),L=()=>k.get()&&!e.removed,R=De=>_?De.fold(O(0),yt=>yt.components().length>1?In(yt.components()[1].element):0):0,B=De=>{switch(Jf(e)){case Jv.auto:const yt=yn.getToolbar(r.outerContainer),de=R(yt),Ce=In(De.element)-de,ze=f(t);if(ze.y>Ce)return"top";{const Fe=da(t),je=Math.max(Fe.dom.scrollHeight,In(Fe));return ze.bottom<je-Ce||oe().bottom<ze.bottom-Ce?"bottom":"top"}case Jv.bottom:return"bottom";case Jv.top:default:return"top"}},q=De=>{s.on(yt=>{ro.setModes(yt,[De]),h.setDockingMode(De);const de=b()?jc.TopToBottom:jc.BottomToTop;Qe(yt.element,rf,de)})},V=()=>{s.on(De=>{const yt=p.getOrThunk(()=>{const de=Yv(Un(sn(),"margin-left")).getOr(0);return Oo(sn())-Rs(t).left+de});pe(De.element,"max-width",yt+"px")})},re=De=>{s.on(yt=>{const de=yn.getToolbar(r.outerContainer),Ce=R(de),ze=f(t),{top:gt,left:Fe}=ee(e,r.outerContainer.element).fold(()=>({top:b()?Math.max(ze.y-In(yt.element)+Ce,0):ze.bottom,left:ze.x}),Bt=>{var Xo;const Tn=f(Bt),Ts=(Xo=Bt.dom.scrollTop)!==null&&Xo!==void 0?Xo:0,Gr=an(Bt,sn()),Tc=Gr?Math.max(ze.y-In(yt.element)+Ce,0):ze.y-Tn.y+Ts-In(yt.element)+Ce;return{top:b()?Tc:ze.bottom,left:Gr?ze.x:ze.x-Tn.x}}),je={position:"absolute",left:Math.round(Fe)+"px",top:Math.round(gt)+"px"},tn=De.map(Bt=>{const Xo=Ls(),Tn=150,Ts=window.innerWidth-(Fe-Xo.left);return{width:Math.max(Math.min(Bt,Ts),Tn)+"px"}}).getOr({});dn(r.outerContainer.element,{...je,...tn})})},ee=(De,yt)=>Ai(De)?kv(yt):g.none(),le=()=>{be(a,De=>{De.broadcastOn([Tu()],{})})},fe=()=>{if(l)return g.none();if(Rs(r.outerContainer.element).left+Mr(r.outerContainer.element)>=window.innerWidth-Bj||xn(r.outerContainer.element,"width").isSome()){pe(r.outerContainer.element,"position","absolute"),pe(r.outerContainer.element,"left","0px"),Qt(r.outerContainer.element,"width");const yt=Mr(r.outerContainer.element);return g.some(yt)}else return g.none()},dt=De=>{if(!L())return;l||V();const yt=l?g.none():fe();_&&yn.refreshToolbar(r.outerContainer),l||re(yt),d&&s.on(De),le()},_e=()=>l||!d||!L()?!1:s.get().exists(De=>{const yt=h.getDockingMode(),de=B(De);return de!==yt?(q(de),!0):!1});return{isVisible:L,isPositionedAtTop:b,show:()=>{k.set(!0),pe(r.outerContainer.element,"display","flex"),c.addClass(e.getBody(),"mce-edit-focus"),be(a,De=>{Qt(De.element,"display")}),_e(),Ai(e)?dt(De=>ro.isDocked(De)?ro.reset(De):ro.refresh(De)):dt(ro.refresh)},hide:()=>{k.set(!1),pe(r.outerContainer.element,"display","none"),c.removeClass(e.getBody(),"mce-edit-focus"),be(a,De=>{pe(De.element,"display","none")})},update:dt,updateMode:()=>{_e()&&dt(ro.reset)},repositionPopups:le}},hE=(e,t)=>{const n=f(e);return{pos:t?n.y:n.bottom,bounds:n}},Pj=(e,t,n,o)=>{const s=Le(hE(t,n.isPositionedAtTop())),r=d=>{const{pos:p,bounds:h}=hE(t,n.isPositionedAtTop()),{pos:b,bounds:S}=s.get(),_=h.height!==S.height||h.width!==S.width;s.set({pos:p,bounds:h}),_&&Cb(e,d),n.isVisible()&&(b!==p?n.update(ro.reset):_&&(n.updateMode(),n.repositionPopups()))};o||(e.on("activate",n.show),e.on("deactivate",n.hide)),e.on("SkinLoaded ResizeWindow",()=>n.update(ro.reset)),e.on("NodeChange keydown",d=>{requestAnimationFrame(()=>r(d))});let a=0;const c=hv(()=>n.update(ro.refresh),33);e.on("ScrollWindow",()=>{const d=Ls().left;d!==a&&(a=d,c.throttle()),n.updateMode()}),Ai(e)&&e.on("ElementScroll",d=>{n.update(ro.refresh)});const l=wu();l.set(of(te.fromDom(e.getBody()),"load",d=>r(d.raw))),e.on("remove",()=>{l.clear()})};var Rj=Object.freeze({__proto__:null,render:async(e,t,n,o,s)=>{const{mainUi:r}=t,a=Mn(),c=te.fromDom(s.targetNode),l=Fj(e,c,t,o,a),d=iC(e);await D3(e);const p=()=>{if(a.isSet()){l.show();return}a.set(yn.getHeader(r.outerContainer).getOrDie());const b=tb(e);Ai(e)?(mg(c,r.mothership),mg(c,t.popupUi.mothership)):gf(b,r.mothership),gf(b,t.dialogUi.mothership),dE(e,t,n,o),yn.setMenubar(r.outerContainer,Gk(e,n)),l.show(),Pj(e,c,l,d),e.nodeChanged()};e.on("show",p),e.on("hide",l.hide),d||(e.on("focus",p),e.on("blur",l.hide)),e.on("init",()=>{(e.hasFocus()||d)&&p()}),lT(e,t);const h={show:p,hide:l.hide,setEnabled:b=>{jg(t,!b)},isEnabled:()=>!Ne.isDisabled(r.outerContainer)};return{editorContainer:r.outerContainer.element.dom,api:h}}});const Lj=()=>{const e=Mn(),t=Mn(),n=Mn();return{dialogUi:e,popupUi:t,mainUi:n,getUiMotherships:()=>{const r=e.get().map(c=>c.mothership),a=t.get().map(c=>c.mothership);return r.fold(()=>a.toArray(),c=>a.fold(()=>[c],l=>an(c.element,l.element)?[c]:[c,l]))},lazyGetInOuterOrDie:(r,a)=>()=>n.get().bind(c=>a(c.outerContainer)).getOrDie(`Could not find ${r} element in OuterContainer`)}},Nj="contexttoolbar-show",fE="contexttoolbar-hide",Hj=e=>({hide:()=>jt(e,Km()),getValue:()=>ye.getValue(e)}),bE=(e,t)=>Z(sO,(n,o)=>{const s=e.get(n),r=Hj(s);t.onAction(r,o.event.buttonApi)}),Vj=(e,t,n)=>{const{primary:o,...s}=t.original,r=Jr(QC({...s,type:"button",onAction:Q}));return iE(r,n,[bE(e,t)])},zj=(e,t,n)=>{const{primary:o,...s}=t.original,r=Jr(eT({...s,type:"togglebutton",onAction:Q}));return lE(r,n,[bE(e,t)])},Uj=e=>e.type==="contextformtogglebutton",Wj=(e,t,n)=>Uj(t)?zj(e,t,n):Vj(e,t,n),jj=(e,t,n)=>{const o=ae(t,a=>Yt(Wj(e,a,n)));return{asSpecs:()=>ae(o,a=>a.asSpec()),findPrimary:a=>on(t,(c,l)=>c.primary?g.from(o[l]).bind(d=>d.getOpt(a)).filter(Vn(Ne.isDisabled)):g.none())}},vE=(e,t)=>{const n=e.label.fold(()=>({}),r=>({"aria-label":r})),o=Yt($l.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:n,selectOnFocus:!0,inputBehaviours:ce([$e.config({mode:"special",onEnter:r=>s.findPrimary(r).map(a=>(xl(a),!0)),onLeft:(r,a)=>(a.cut(),g.none()),onRight:(r,a)=>(a.cut(),g.none())})])})),s=jj(o,e.commands,t);return[{title:g.none(),items:[o.asSpec()]},{title:g.none(),items:s.asSpecs()}]},Gj={renderContextForm:(e,t,n)=>Tp({type:e,uid:Te("context-toolbar"),initGroups:vE(t,n),onEscape:g.none,cyclicKeying:!0,providers:n}),buildInitGroups:vE},yE=(e,t,n)=>t.bottom-e.y>=n&&e.bottom-t.y>=n,qj=e=>{const t=e.getBoundingClientRect();if(t.height<=0&&t.width<=0){const n=Pa(te.fromDom(e.startContainer),e.startOffset).element;return(Xs(n)?Wo(n):g.some(n)).filter(Co).map(s=>s.dom.getBoundingClientRect()).getOr(t)}else return t},Zv=e=>{const t=e.selection.getRng(),n=qj(t);if(e.inline){const o=Ls();return m(o.left+n.left,o.top+n.top,n.width,n.height)}else{const o=x(te.fromDom(e.getBody()));return m(o.x+n.left,o.y+n.top,n.width,n.height)}},Kj=(e,t)=>t.filter(n=>Zt(n)&&ia(n)).map(x).getOrThunk(()=>Zv(e)),Yj=(e,t,n)=>{const o=Math.max(e.x+n,t.x),s=Math.min(e.right-n,t.right);return{x:o,width:s-o}},Xj=(e,t,n,o,s,r)=>{const a=te.fromDom(e.getContainer()),c=fo(a,".tox-editor-header").getOr(a),l=f(c),d=l.y>=t.bottom,p=o&&!d;if(e.inline&&p)return{y:Math.max(l.bottom+r,n.y),bottom:n.bottom};if(e.inline&&!p)return{y:n.y,bottom:Math.min(l.y-r,n.bottom)};const h=s==="line"?f(a):t;return p?{y:Math.max(l.bottom+r,n.y),bottom:Math.min(h.bottom-r,n.bottom)}:{y:Math.max(h.y+r,n.y),bottom:Math.min(l.y-r,n.bottom)}},SE=(e,t,n,o=0)=>{const s=sl(window),r=f(te.fromDom(e.getContentAreaContainer())),a=Fg(e)||Pg(e)||Gd(e),{x:c,width:l}=Yj(r,s,o);if(e.inline&&!a)return m(c,s.y,l,s.height);{const d=t.header.isPositionedAtTop(),{y:p,bottom:h}=Xj(e,r,s,d,n,o);return m(c,p,l,h-p)}},Dp=12,xE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},wE={maxHeightFunction:Cu(),maxWidthFunction:Hv()},Jj=(e,t)=>{const n=e.selection.getRng(),o=Pa(te.fromDom(n.startContainer),n.startOffset);return n.startContainer===n.endContainer&&n.startOffset===n.endOffset-1&&an(o.element,t)},Zj=(e,t,n)=>{const o=xn(e,"position");pe(e,"position",t);const s=n(e);return o.each(r=>pe(e,"position",r)),s},CE=e=>e==="node",Qj=(e,t,n,o,s)=>{const r=Zv(e),a=o.lastElement().exists(c=>an(n,c));if(Jj(e,n))return a?HO:Ba;if(a)return Zj(t,o.getMode(),()=>yE(r,f(t),-20)&&!o.isReposition()?o2:HO);{const c=o.getMode()==="fixed"?s.y+Ls().top:s.y,l=In(t)+Dp;return c+l<=r.y?Ba:bm}},eG=(e,t,n,o)=>{const s=l=>(d,p,h,b,S)=>{const _=Qj(e,b,l,n,S),k={...d,y:S.y,height:S.height};return{..._(k,p,h,b,S),alwaysFit:!0}},r=l=>CE(o)?[s(l)]:[];return t?{onLtr:l=>[Vo,as,cs,sr,rr,Ss].concat(r(l)),onRtl:l=>[Vo,cs,as,rr,sr,Ss].concat(r(l))}:{onLtr:l=>[Ss,Vo,sr,as,rr,cs].concat(r(l)),onRtl:l=>[Ss,Vo,rr,cs,sr,as].concat(r(l))}},tG=(e,t,n,o)=>t==="line"?{bubble:Wc(Dp,0,xE),layouts:{onLtr:()=>[Gh],onRtl:()=>[qh]},overrides:wE}:{bubble:Wc(0,Dp,xE,1/Dp),layouts:eG(e,n,o,t),overrides:wE},Qv=(e,t)=>{const n=Y(t,r=>r.predicate(e.dom)),{pass:o,fail:s}=he(n,r=>r.type==="contexttoolbar");return{contextToolbars:o,contextForms:s}},nG=e=>{if(e.length<=1)return e;{const t=r=>Rn(e,a=>a.position===r),n=r=>Y(e,a=>a.position===r),o=t("selection"),s=t("node");if(o||s)if(s&&o){const r=n("node"),a=ae(n("selection"),c=>({...c,position:"node"}));return r.concat(a)}else return n(o?"selection":"node");else return n("line")}},oG=e=>{if(e.length<=1)return e;{const t=o=>lt(e,s=>s.position===o);return t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(o=>o.position).fold(()=>[],o=>Y(e,s=>s.position===o))}},sG=(e,t,n)=>{const o=Qv(e,t);if(o.contextForms.length>0)return g.some({elem:e,toolbars:[o.contextForms[0]]});{const s=Qv(e,n);if(s.contextForms.length>0)return g.some({elem:e,toolbars:[s.contextForms[0]]});if(o.contextToolbars.length>0||s.contextToolbars.length>0){const r=nG(o.contextToolbars.concat(s.contextToolbars));return g.some({elem:e,toolbars:r})}else return g.none()}},rG=(e,t,n)=>e(t)?g.none():En(t,o=>{if(Co(o)){const{contextToolbars:s,contextForms:r}=Qv(o,n.inNodeScope),a=r.length>0?r:oG(s);return a.length>0?g.some({elem:o,toolbars:a}):g.none()}else return g.none()},e),aG=(e,t)=>{const n=te.fromDom(t.getBody()),o=a=>an(a,n),s=a=>!o(a)&&!Ms(n,a),r=te.fromDom(t.selection.getNode());return s(r)?g.none():sG(r,e.inNodeScope,e.inEditorScope).orThunk(()=>rG(o,r,e))},cG=(e,t)=>{const n={},o=[],s=[],r={},a={},c=(p,h)=>{const b=Jr(GP(h));n[p]=b,b.launch.map(S=>{r["form:"+p]={...h.launch,type:S.type==="contextformtogglebutton"?"togglebutton":"button",onAction:()=>{t(b)}}}),b.scope==="editor"?s.push(b):o.push(b),a[p]=b},l=(p,h)=>{KP(h).each(b=>{h.scope==="editor"?s.push(b):o.push(b),a[p]=b})},d=Lt(e);return be(d,p=>{const h=e[p];h.type==="contextform"?c(p,h):h.type==="contexttoolbar"&&l(p,h)}),{forms:n,inNodeScope:o,inEditorScope:s,lookupTable:a,formNavigators:r}},TE=Te("forward-slide"),_E=Te("backward-slide"),ey=Te("change-slide-event"),ty="tox-pop--resizing",iG=e=>{const t=Le([]);return Nn.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:n=>{t.set([]),Nn.getContent(n).each(o=>{Qt(o.element,"visibility")}),so(n.element,ty),Qt(n.element,"width")},inlineBehaviours:ce([st("context-toolbar-events",[bu(kd(),(n,o)=>{o.event.raw.propertyName==="width"&&(so(n.element,ty),Qt(n.element,"width"))}),Z(ey,(n,o)=>{const s=n.element;Qt(s,"width");const r=Oo(s);Nn.setContent(n,o.event.contents),vo(s,ty);const a=Oo(s);pe(s,"width",r+"px"),Nn.getContent(n).each(c=>{o.event.focus.bind(l=>(wa(l),ja(s))).orThunk(()=>($e.focusIn(c),hc(P(s))))}),setTimeout(()=>{pe(n.element,"width",a+"px")},0)}),Z(TE,(n,o)=>{Nn.getContent(n).each(s=>{t.set(t.get().concat([{bar:s,focus:hc(P(n.element))}]))}),Be(n,ey,{contents:o.event.forwardContents,focus:g.none()})}),Z(_E,(n,o)=>{Pt(t.get()).each(s=>{t.set(t.get().slice(0,t.get().length-1)),Be(n,ey,{contents:Qr(s.bar),focus:s.focus})})})]),$e.config({mode:"special",onEscape:n=>Pt(t.get()).fold(()=>e.onEscape(),o=>(jt(n,_E),g.some(!0)))})]),lazySink:()=>Me.value(e.sink)})},ny="tox-pop--transition",lG=(e,t,n,o)=>{const s=o.backstage,r=s.shared,a=Ir().deviceType.isTouch,c=Mn(),l=Mn(),d=Mn(),p=ps(iG({sink:n,onEscape:()=>(e.focus(),g.some(!0))})),h=()=>{const _e=d.get().getOr("node"),Ke=CE(_e)?1:0;return SE(e,r,_e,Ke)},b=()=>!e.removed&&!(a()&&s.isContextMenuOpen()),S=_e=>Io(qs(_e,c.get(),an),!0),_=()=>{if(b()){const _e=h(),Ke=Io(d.get(),"node")?Kj(e,c.get()):Zv(e);return _e.height<=0||!yE(Ke,_e,.01)}else return!0},k=()=>{c.clear(),l.clear(),d.clear(),Nn.hide(p)},L=()=>{if(Nn.isOpen(p)){const _e=p.element;Qt(_e,"display"),_()?pe(_e,"display","none"):(l.set(0),Nn.reposition(p))}},R=_e=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[_e],behaviours:ce([$e.config({mode:"acyclic"}),st("pop-dialog-wrap-events",[Pn(Ke=>{e.shortcuts.add("ctrl+F9","focus statusbar",()=>$e.focusIn(Ke))}),mc(Ke=>{e.shortcuts.remove("ctrl+F9")})])])}),B=$r(()=>cG(t,_e=>{const Ke=re([_e]);Be(p,TE,{forwardContents:R(Ke)})})),q=(_e,Ke)=>Ep(e,{buttons:_e,toolbar:Ke.items,allowToolbarGroups:!1},o.backstage,g.some(["form:"])),V=(_e,Ke)=>Gj.buildInitGroups(_e,Ke),re=_e=>{const{buttons:Ke}=e.ui.registry.getAll(),Ue=B(),Ct={...Ke,...Ue.formNavigators},De=Mu(e)===na.scrolling?na.scrolling:na.default,yt=xt(ae(_e,de=>de.type==="contexttoolbar"?q(Ct,de):V(de,r.providers)));return Tp({type:De,uid:Te("context-toolbar"),initGroups:yt,onEscape:g.none,cyclicKeying:!0,providers:r.providers})},ee=(_e,Ke)=>{const Ue=_e==="node"?r.anchors.node(Ke):r.anchors.cursor(),Ct=tG(e,_e,a(),{lastElement:c.get,isReposition:()=>Io(l.get(),0),getMode:()=>xs.getMode(n)});return Wn(Ue,Ct)},le=(_e,Ke)=>{if(dt.cancel(),!b())return;const Ue=re(_e),Ct=_e[0].position,De=ee(Ct,Ke);d.set(Ct),l.set(1);const yt=p.element;Qt(yt,"display"),S(Ke)||(so(yt,ny),xs.reset(n,p)),Nn.showWithinBounds(p,R(Ue),{anchor:De,transition:{classes:[ny],mode:"placement"}},()=>g.some(h())),Ke.fold(c.clear,c.set),_()&&pe(yt,"display","none")};let fe=!1;const dt=hv(()=>{if(!(!e.hasFocus()||e.removed||fe))if(or(p.element,ny))dt.throttle();else{const _e=B();aG(_e,e).fold(k,Ke=>{le(Ke.toolbars,g.some(Ke.elem))})}},17);e.on("init",()=>{e.on("remove",k),e.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",L),e.on("click keyup focus SetContent",dt.throttle),e.on(fE,k),e.on(Nj,_e=>{const Ke=B();Se(Ke.lookupTable,_e.toolbarKey).each(Ue=>{le([Ue],ts(_e.target!==e,_e.target)),Nn.getContent(p).each($e.focusIn)})}),e.on("focusout",_e=>{$g.setEditorTimeout(e,()=>{ja(n.element).isNone()&&ja(p.element).isNone()&&k()},0)}),e.on("SwitchMode",()=>{e.mode.isReadOnly()&&k()}),e.on("AfterProgressState",_e=>{_e.state?k():e.hasFocus()&&dt.throttle()}),e.on("dragstart",()=>{fe=!0}),e.on("dragend drop",()=>{fe=!1}),e.on("NodeChange",_e=>{ja(p.element).fold(dt.throttle,Q)})})},uG=e=>{be([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],n=>{e.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:Sr(e,n.cmd),onSetup:Kg(e,n.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onSetup:Cs(e),onAction:Sr(e,"JustifyNone")})},OE=(e,t)=>{const n=()=>{const o=t.getOptions(e),s=t.getCurrent(e).map(t.hash),r=Mn();return ae(o,a=>({type:"togglemenuitem",text:t.display(a),onSetup:c=>{const l=p=>{p&&(r.on(h=>h.setActive(!1)),r.set(c)),c.setActive(p)};l(Io(s,t.hash(a)));const d=t.watcher(e,a,l);return()=>{r.clear(),d()}},onAction:()=>t.setCurrent(e,a)}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:o=>o(n()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:n,onSetup:t.onMenuSetup})},dG=e=>({name:"lineheight",text:"Line height",icon:"line-height",getOptions:kC,hash:t=>G3(t,["fixed","relative","empty"]).getOr(t),display:Xe,watcher:(t,n,o)=>t.formatter.formatChanged("lineheight",o,!1,{value:n}).unbind,getCurrent:t=>g.from(t.queryCommandValue("LineHeight")),setCurrent:(t,n)=>t.execCommand("LineHeight",!1,n),onToolbarSetup:Cs(e),onMenuSetup:Cs(e)}),mG=e=>g.from(rC(e)).map(n=>({name:"language",text:"Language",icon:"language",getOptions:O(n),hash:o=>pt(o.customCode)?o.code:`${o.code}/${o.customCode}`,display:o=>o.title,watcher:(o,s,r)=>{var a;return o.formatter.formatChanged("lang",r,!1,{value:s.code,customValue:(a=s.customCode)!==null&&a!==void 0?a:null}).unbind},getCurrent:o=>{const s=te.fromDom(o.selection.getNode());return gs(s,r=>g.some(r).filter(Co).bind(a=>Go(a,"lang").map(l=>{const d=Go(a,"data-mce-lang").getOrUndefined();return{code:l,customCode:d,title:""}})))},setCurrent:(o,s)=>o.execCommand("Lang",!1,s),onToolbarSetup:o=>{const s=wu();return o.setActive(e.formatter.match("lang",{},void 0,!0)),s.set(e.formatter.formatChanged("lang",o.setActive,!0)),Tb(s.clear,Cs(e)(o))},onMenuSetup:Cs(e)})),gG=e=>{OE(e,dG(e)),mG(e).each(t=>OE(e,t))},pG=(e,t)=>{P3(e,t),z3(e,t),cj(e,t),L3(e,t),rj(e,t)},hG=e=>Fl(e,"NodeChange",t=>{t.setEnabled(e.queryCommandState("outdent")&&e.selection.isEditable())}),fG=e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:hG(e),onAction:Sr(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onSetup:Cs(e),onAction:Sr(e,"indent")})},bG=e=>{fG(e)},kE=(e,t)=>n=>{n.setActive(t.get());const o=s=>{t.set(s.state),n.setActive(s.state)};return e.on("PastePlainTextToggle",o),Tb(()=>e.off("PastePlainTextToggle",o),Cs(e)(n))},vG=e=>{const t=Le(CC(e)),n=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:n,onSetup:kE(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:n,onSetup:kE(e,t)})},oy=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},yG=e=>{Xc.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(t,n)=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Kg(e,t.name),onAction:oy(e,t.name)})});for(let t=1;t<=6;t++){const n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:Kg(e,n),onAction:oy(e,n)})}},SG=e=>{Xc.each([{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"print",text:"Print",action:"mcePrint",icon:"print"}],t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Sr(e,t.action)})}),Xc.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Cs(e),onAction:Sr(e,t.action)})})},xG=e=>{Xc.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Sr(e,t.action),onSetup:Kg(e,t.name)})})},wG=e=>{yG(e),SG(e),xG(e)},CG=e=>{Xc.each([{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"}],t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Sr(e,t.action)})}),Xc.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onSetup:Cs(e),onAction:Sr(e,t.action)})}),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onSetup:Cs(e),onAction:oy(e,"code")})},TG=e=>{wG(e),CG(e)},Mp=(e,t)=>Fl(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",n=>{n.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())}),_G=e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:Mp(e,"hasUndo"),onAction:Sr(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:Mp(e,"hasRedo"),onAction:Sr(e,"redo")})},OG=e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:Mp(e,"hasUndo"),onAction:Sr(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:Mp(e,"hasRedo"),onAction:Sr(e,"redo")})},kG=e=>{_G(e),OG(e)},EG=e=>Fl(e,"VisualAid",t=>{t.setActive(e.hasVisual)}),AG=e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:EG(e),onAction:Sr(e,"mceToggleVisualAid")})},DG=e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Sr(e,"mceToggleVisualAid")})},MG=e=>{DG(e),AG(e)},$G=(e,t)=>{uG(e),TG(e),pG(e,t),kG(e),lL(e),MG(e),bG(e),gG(e),vG(e)},IG=e=>Ee(e)?e.split(/[ ,]/):e,EE=e=>t=>t.options.get(e),BG=e=>{const t=e.options.register;t("contextmenu_avoid_overlap",{processor:"string",default:""}),t("contextmenu_never_use_native",{processor:"boolean",default:!1}),t("contextmenu",{processor:n=>n===!1?{value:[],valid:!0}:Ee(n)||ie(n,Ee)?{value:IG(n),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})},AE=EE("contextmenu_never_use_native"),FG=EE("contextmenu_avoid_overlap"),PG=e=>DE(e).length===0,DE=e=>{const t=e.ui.registry.getAll().contextMenus,n=e.options.get("contextmenu");return e.options.isSet("contextmenu")?n:Y(n,o=>wt(t,o))},xm=(e,t)=>({type:"makeshift",x:e,y:t}),RG=(e,t,n)=>xm(e.x+t,e.y+n),ME=e=>e.type==="longpress"||e.type.indexOf("touch")===0,LG=e=>{if(ME(e)){const t=e.touches[0];return xm(t.pageX,t.pageY)}else return xm(e.pageX,e.pageY)},NG=e=>{if(ME(e)){const t=e.touches[0];return xm(t.clientX,t.clientY)}else return xm(e.clientX,e.clientY)},HG=(e,t)=>{const n=Ud.DOM.getPos(e);return RG(t,n.x,n.y)},VG=(e,t)=>t.type==="contextmenu"||t.type==="longpress"?e.inline?LG(t):HG(e.getContentAreaContainer(),NG(t)):$E(e),$E=e=>({type:"selection",root:te.fromDom(e.selection.getNode())}),zG=e=>({type:"node",node:g.some(te.fromDom(e.selection.getNode())),root:te.fromDom(e.getBody())}),IE=(e,t,n)=>{switch(n){case"node":return zG(e);case"point":return VG(e,t);case"selection":return $E(e)}},UG=(e,t,n,o,s,r)=>{const a=n(),c=IE(e,t,r);zu(a,qa.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:g.none()}).map(l=>{t.preventDefault(),Nn.showMenuAt(s,{anchor:c},{menu:{markers:Ml("normal")},data:l})})},WG={onLtr:()=>[Vo,as,cs,sr,rr,Ss,Ba,bm,fm,hp,hm,pp],onRtl:()=>[Vo,cs,as,rr,sr,Ss,Ba,bm,hm,pp,fm,hp]},jG=12,GG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},qG=(e,t)=>{const n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;{const o=t.touches[0],s=n.getRng();return nx(e.getWin(),Bd.domRange(s)).exists(a=>a.left<=o.clientX&&a.right>=o.clientX&&a.top<=o.clientY&&a.bottom>=o.clientY)}},KG=e=>{const t=e.selection.getRng(),n=()=>{$g.setEditorTimeout(e,()=>{e.selection.setRng(t)},10),r()};e.once("touchend",n);const o=a=>{a.preventDefault(),a.stopImmediatePropagation()};e.on("mousedown",o,!0);const s=()=>r();e.once("longpresscancel",s);const r=()=>{e.off("touchend",n),e.off("longpresscancel",s),e.off("mousedown",o)}},YG=(e,t,n)=>{const o=IE(e,t,n);return{bubble:Wc(0,n==="point"?jG:0,GG),layouts:WG,overrides:{maxWidthFunction:Hv(),maxHeightFunction:Cu()},...o}},XG=(e,t,n,o,s,r,a)=>{const c=YG(e,t,r);zu(n,qa.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!0,search:g.none()}).map(l=>{t.preventDefault();const d=a?Ws.HighlightMenuAndItem:Ws.HighlightNone;Nn.showMenuWithinBounds(s,{anchor:c},{menu:{markers:Ml("normal"),highlightOnOpen:d},data:l,type:"horizontal"},()=>g.some(SE(e,o.shared,r==="node"?"node":"selection"))),e.dispatch(fE)})},JG=(e,t,n,o,s,r)=>{const a=Ir(),c=a.os.isiOS(),l=a.os.isMacOS(),d=a.os.isAndroid(),p=a.deviceType.isTouch(),h=()=>!(d||c||l&&p),b=()=>{const S=n();XG(e,t,S,o,s,r,h())};if((l||c)&&r!=="node"){const S=()=>{KG(e),b()};qG(e,t)?S():(e.once("selectionchange",S),e.once("touchend",()=>e.off("selectionchange",S)))}else b()},BE=e=>Ee(e)?e==="|":e.type==="separator",sy={type:"separator"},FE=e=>{const t=n=>({text:n.text,icon:n.icon,enabled:n.enabled,shortcut:n.shortcut});if(Ee(e))return e;switch(e.type){case"separator":return sy;case"submenu":return{type:"nestedmenuitem",...t(e),getSubmenuItems:()=>{const o=e.getSubmenuItems();return Ee(o)?o:ae(o,FE)}};default:const n=e;return{type:"menuitem",...t(n),onAction:kt(n.onAction)}}},PE=(e,t)=>{if(t.length===0)return e;const o=Pt(e).filter(s=>!BE(s)).fold(()=>[],s=>[sy]);return e.concat(o).concat(t).concat([sy])},ZG=(e,t,n)=>{const o=me(t,(s,r)=>Se(e,r.toLowerCase()).map(a=>{const c=a.update(n);if(Ee(c))return PE(s,c.split(" "));if(c.length>0){const l=ae(c,FE);return PE(s,l)}else return s}).getOrThunk(()=>s.concat([r])),[]);return o.length>0&&BE(o[o.length-1])&&o.pop(),o},QG=(e,t)=>t.ctrlKey&&!AE(e),e5=e=>e.type==="longpress"||wt(e,"touches"),RE=(e,t)=>!e5(t)&&(t.button!==2||t.target===e.getBody()&&t.pointerType===""),LE=(e,t)=>RE(e,t)?e.selection.getStart(!0):t.target,t5=(e,t)=>{const n=FG(e),o=RE(e,t)?"selection":"point";if(_r(n)){const s=LE(e,t);return rm(te.fromDom(s),n)?"node":o}else return o},n5=(e,t,n)=>{const s=Ir().deviceType.isTouch,r=ps(Nn.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>n.setContextMenuState(!0),onHide:()=>n.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:ce([st("dismissContextMenu",[Z(Sl(),(l,d)=>{Mt.close(l),e.focus()})])])})),a=()=>Nn.hide(r),c=l=>{if(AE(e)&&l.preventDefault(),QG(e,l)||PG(e))return;const d=t5(e,l),p=()=>{const b=LE(e,l),S=e.ui.registry.getAll(),_=DE(e);return ZG(S.contextMenus,_,b)};(s()?JG:UG)(e,l,p,n,r,d)};e.on("init",()=>{const l="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(s()?"":" ResizeWindow");e.on(l,a),e.on("longpress contextmenu",c)})},ry=i.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),$p=e=>t=>t.translate(-e.left,-e.top),Ip=e=>t=>t.translate(e.left,e.top),Zc=e=>(t,n)=>me(e,(o,s)=>s(o),Bn(t,n)),Bp=(e,t,n)=>e.fold(Zc([Ip(n),$p(t)]),Zc([$p(t)]),Zc([])),qu=(e,t,n)=>e.fold(Zc([Ip(n)]),Zc([]),Zc([Ip(t)])),NE=(e,t,n)=>e.fold(Zc([]),Zc([$p(n)]),Zc([Ip(t),$p(n)])),o5=(e,t,n,o,s,r)=>{const a=qu(e,s,r),c=qu(t,s,r);return Math.abs(a.left-c.left)<=n&&Math.abs(a.top-c.top)<=o},s5=(e,t,n,o,s,r)=>{const a=qu(e,s,r),c=qu(t,s,r),l=Math.abs(a.left-c.left),d=Math.abs(a.top-c.top);return Bn(l,d)},HE=(e,t,n)=>{const o=e.fold((s,r)=>({position:g.some("absolute"),left:g.some(s+"px"),top:g.some(r+"px")}),(s,r)=>({position:g.some("absolute"),left:g.some(s-n.left+"px"),top:g.some(r-n.top+"px")}),(s,r)=>({position:g.some("fixed"),left:g.some(s+"px"),top:g.some(r+"px")}));return{right:g.none(),bottom:g.none(),...o}},r5=(e,t,n)=>e.fold((o,s)=>Fp(o+t,s+n),(o,s)=>zi(o+t,s+n),(o,s)=>jl(o+t,s+n)),ay=(e,t,n,o)=>{const s=(r,a)=>(c,l)=>{const d=r(t,n,o);return a(c.getOr(d.left),l.getOr(d.top))};return e.fold(s(NE,Fp),s(qu,zi),s(Bp,jl))},Fp=ry.offset,zi=ry.absolute,jl=ry.fixed,VE=(e,t)=>{const n=To(e,t);return pt(n)?NaN:parseInt(n,10)},a5=(e,t)=>{const n=e.element,o=VE(n,t.leftAttr),s=VE(n,t.topAttr);return isNaN(o)||isNaN(s)?g.none():g.some(Bn(o,s))},c5=(e,t,n)=>{const o=e.element;Qe(o,t.leftAttr,n.left+"px"),Qe(o,t.topAttr,n.top+"px")},i5=(e,t)=>{const n=e.element;C(n,t.leftAttr),C(n,t.topAttr)},l5=(e,t,n,o)=>a5(e,t).fold(()=>n,s=>jl(s.left+o.left,s.top+o.top)),u5=(e,t,n,o,s,r)=>{const a=l5(e,t,n,o),c=t.mustSnap?m5(e,t,a,s,r):g5(e,t,a,s,r),l=Bp(a,s,r);return c5(e,t,l),c.fold(()=>({coord:jl(l.left,l.top),extra:g.none()}),d=>({coord:d.output,extra:d.extra}))},d5=(e,t)=>{i5(e,t)},zE=(e,t,n,o)=>on(e,s=>{const r=s.sensor;return o5(t,r,s.range.left,s.range.top,n,o)?g.some({output:ay(s.output,t,n,o),extra:s.extra}):g.none()}),m5=(e,t,n,o,s)=>{const r=t.getSnapPoints(e);return zE(r,n,o,s).orThunk(()=>me(r,(l,d)=>{const p=d.sensor,h=s5(n,p,d.range.left,d.range.top,o,s);return l.deltas.fold(()=>({deltas:g.some(h),snap:g.some(d)}),b=>{const S=(h.left+h.top)/2,_=(b.left+b.top)/2;return S<=_?{deltas:g.some(h),snap:g.some(d)}:l})},{deltas:g.none(),snap:g.none()}).snap.map(l=>({output:ay(l.output,n,o,s),extra:l.extra})))},g5=(e,t,n,o,s)=>{const r=t.getSnapPoints(e);return zE(r,n,o,s)},p5=(e,t,n)=>({coord:ay(e.output,e.output,t,n),extra:e.extra});var h5=Object.freeze({__proto__:null,snapTo:(e,t,n,o)=>{const s=t.getTarget(e.element);if(t.repositionTarget){const r=ns(e.element),a=Ls(r),c=ck(s),l=p5(o,a,c),d=HE(l.coord,a,c);_o(s,d)}}});const cy="data-initial-z-index",f5=e=>{Wo(e.element).filter(Co).each(t=>{Go(t,cy).fold(()=>Qt(t,"z-index"),n=>pe(t,"z-index",n)),C(t,cy)})},b5=e=>{Wo(e.element).filter(Co).each(t=>{xn(t,"z-index").each(n=>{Qe(t,cy,n)}),pe(t,"z-index",Un(e.element,"z-index"))})},UE=(e,t)=>{e.getSystem().addToGui(t),b5(t)},v5=e=>{f5(e),e.getSystem().removeFromGui(e)},WE=(e,t,n)=>e.getSystem().build(Ka.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}));var y5=tr("snaps",[J("getSnapPoints"),Dt("onSensor"),J("leftAttr"),J("topAttr"),N("lazyViewport",oe),N("mustSnap",!1)]);const iy=[N("useFixed",ne),J("blockerClass"),N("getTarget",Xe),N("onDrag",Q),N("repositionTarget",!0),N("onDrop",Q),ko("getBounds",oe),y5],S5=e=>ls(xn(e,"left"),xn(e,"top"),xn(e,"position"),(t,n,o)=>(o==="fixed"?jl:Fp)(parseInt(t,10),parseInt(n,10))).getOrThunk(()=>{const t=Rs(e);return zi(t.left,t.top)}),x5=(e,t,n,o,s)=>{const r=s.bounds,a=qu(t,n,o),c=Vr(a.left,r.x,r.x+r.width-s.width),l=Vr(a.top,r.y,r.y+r.height-s.height),d=zi(c,l);return t.fold(()=>{const p=NE(d,n,o);return Fp(p.left,p.top)},O(d),()=>{const p=Bp(d,n,o);return jl(p.left,p.top)})},w5=(e,t,n,o,s,r,a)=>{const c=t.fold(()=>{const l=r5(n,r.left,r.top),d=Bp(l,o,s);return jl(d.left,d.top)},l=>{const d=u5(e,l,n,r,o,s);return d.extra.each(p=>{l.onSensor(e,p)}),d.coord});return x5(e,c,o,s,a)},C5=(e,t,n,o)=>{const s=t.getTarget(e.element);if(t.repositionTarget){const r=ns(e.element),a=Ls(r),c=ck(s),l=S5(s),d=w5(e,t.snaps,l,a,c,o,n),p=HE(d,a,c);_o(s,p)}t.onDrag(e,s,o)},jE=(e,t)=>({bounds:e.getBounds(),height:Yr(t.element),width:Mr(t.element)}),ly=(e,t,n,o,s)=>{const r=n.update(o,s),a=n.getStartData().getOrThunk(()=>jE(t,e));r.each(c=>{C5(e,t,a,c)})},GE=(e,t,n,o)=>{t.each(v5),n.snaps.each(r=>{d5(e,r)});const s=n.getTarget(e.element);o.reset(),n.onDrop(e,s)},uy=e=>(t,n)=>{const o=s=>{n.setStartData(jE(t,s))};return On([Z(wh(),s=>{n.getStartData().each(()=>o(s))}),...e(t,n,o)])},T5=e=>On([Z(mt(),e.forceDrop),Z(Vs(),e.drop),Z(An(),(t,n)=>{e.move(n.event)}),Z(os(),e.delayDrop)]);var _5=Object.freeze({__proto__:null,getData:e=>g.from(Bn(e.x,e.y)),getDelta:(e,t)=>Bn(t.left-e.left,t.top-e.top)});const qE=(e,t,n)=>[Z(mt(),(o,s)=>{if(s.event.raw.button!==0)return;s.stop();const a=()=>GE(o,g.some(d),e,t),c=a_(a,200),l={drop:a,delayDrop:c.schedule,forceDrop:a,move:h=>{c.cancel(),ly(o,e,t,_5,h)}},d=WE(o,e.blockerClass,T5(l));(()=>{n(o),UE(o,d)})()})],O5=[...iy,Dn("dragger",{handlers:uy(qE)})],k5=e=>On([Z(Rr(),e.forceDrop),Z(zc(),e.drop),Z(qm(),e.drop),Z(lc(),(t,n)=>{e.move(n.event)})]),E5=e=>{const t=e[0];return g.some(Bn(t.clientX,t.clientY))};var KE=Object.freeze({__proto__:null,getData:e=>{const n=e.raw.touches;return n.length===1?E5(n):g.none()},getDelta:(e,t)=>Bn(t.left-e.left,t.top-e.top)});const YE=(e,t,n)=>{const o=Mn(),s=r=>{GE(r,o.get(),e,t),o.clear()};return[Z(Rr(),(r,a)=>{a.stop();const c=()=>s(r),l={drop:c,delayDrop:Q,forceDrop:c,move:h=>{ly(r,e,t,KE,h)}},d=WE(r,e.blockerClass,k5(l));o.set(d),(()=>{n(r),UE(r,d)})()}),Z(lc(),(r,a)=>{a.stop(),ly(r,e,t,KE,a.event)}),Z(zc(),(r,a)=>{a.stop(),s(r)}),Z(qm(),s)]},A5=[...iy,Dn("dragger",{handlers:uy(YE)})],D5=(e,t,n)=>[...qE(e,t,n),...YE(e,t,n)],M5=[...iy,Dn("dragger",{handlers:uy(D5)})];var $5=Object.freeze({__proto__:null,mouse:O5,touch:A5,mouseOrTouch:M5}),I5=Object.freeze({__proto__:null,init:()=>{let e=g.none(),t=g.none();const n=()=>{e=g.none(),t=g.none()},o=(l,d)=>{const p=e.map(h=>l.getDelta(h,d));return e=g.some(d),p},s=(l,d)=>l.getData(d).bind(p=>o(l,p)),r=l=>{t=g.some(l)},a=()=>t,c=O({});return Nr({readState:c,reset:n,update:s,getStartData:a,setStartData:r})}});const Gl=IS({branchKey:"mode",branches:$5,name:"dragging",active:{events:(e,t)=>e.dragger.handlers(e,t)},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:g.from(e.extra)})},state:I5,apis:h5}),dy=40,Pp=dy/2,XE=(e,t,n,o,s,r)=>e.fold(()=>Gl.snap({sensor:zi(n-Pp,o-Pp),range:Bn(s,r),output:zi(g.some(n),g.some(o)),extra:{td:t}}),a=>{const c=n-Pp,l=o-Pp,d=dy,p=dy,h=a.element.dom.getBoundingClientRect();return Gl.snap({sensor:zi(c,l),range:Bn(d,p),output:zi(g.some(n-h.width/2),g.some(o-h.height/2)),extra:{td:t}})}),JE=(e,t,n)=>{const o=(s,r)=>s.exists(a=>an(a,r));return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(s,r)=>{const a=r.td;o(t.get(),a)||(t.set(a),n(a))},mustSnap:!0}},ZE=e=>Yt(Yo.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:ce([Gl.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),um.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),B5=(e,t)=>{const n=Le([]),o=Le([]),s=Le(!1),r=Mn(),a=Mn(),c=le=>{const fe=x(le);return XE(S.getOpt(t),le,fe.x,fe.y,fe.width,fe.height)},l=()=>ae(n.get(),le=>c(le)),d=le=>{const fe=x(le);return XE(_.getOpt(t),le,fe.right,fe.bottom,fe.width,fe.height)},p=()=>ae(o.get(),le=>d(le)),h=JE(l,r,le=>{a.get().each(fe=>{e.dispatch("TableSelectorChange",{start:le,finish:fe})})}),b=JE(p,a,le=>{r.get().each(fe=>{e.dispatch("TableSelectorChange",{start:fe,finish:le})})}),S=ZE(h),_=ZE(b),k=ps(S.asSpec()),L=ps(_.asSpec()),R=(le,fe,dt,_e)=>{const Ke=fe.dom.getBoundingClientRect();Qt(le.element,"display");const Ue=us(te.fromDom(e.getBody())).dom.innerHeight,Ct=dt(Ke),De=_e(Ke,Ue);(Ct||De)&&pe(le.element,"display","none")},B=(le,fe,dt,_e)=>{const Ke=dt(fe);Gl.snapTo(le,Ke),R(le,fe,De=>De[_e]<0,(De,yt)=>De[_e]>yt)},q=le=>B(k,le,c,"top"),V=()=>r.get().each(q),re=le=>B(L,le,d,"bottom"),ee=()=>a.get().each(re);Ir().deviceType.isTouch()&&(e.on("TableSelectionChange",le=>{s.get()||(kl(t,k),kl(t,L),s.set(!0)),r.set(le.start),a.set(le.finish),le.otherCells.each(fe=>{n.set(fe.upOrLeftCells),o.set(fe.downOrRightCells),q(le.start),re(le.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",()=>{V(),ee()}),e.on("TableSelectionClear",()=>{s.get()&&(Gc(k),Gc(L),s.set(!1)),r.clear(),a.clear()}))};var F5=`<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>
</svg>
`;const P5=e=>e.nodeName==="BR"||!!e.getAttribute("data-mce-bogus")||e.getAttribute("data-mce-type")==="bookmark",R5=(e,t,n)=>{var o;const s=(o=t.delimiter)!==null&&o!==void 0?o:"",r=(d,p,h)=>Yo.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":h,"aria-level":h+1}},components:[ho(d)],action:b=>{e.focus(),e.selection.select(p),e.nodeChanged()},buttonBehaviours:ce([Ea.button(n.isDisabled),Ao()])}),a=()=>({dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[ho(` ${s} `)]}),c=d=>me(d,(p,h,b)=>{const S=r(h.name,h.element,b);return b===0?p.concat([S]):p.concat([a(),S])},[]),l=d=>{const p=[];let h=d.length;for(;h-- >0;){const b=d[h];if(b.nodeType===1&&!P5(b)){const S=jR(e,b);if(S.isDefaultPrevented()||p.push({name:S.name,element:b}),S.isPropagationStopped())break}}return p};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:ce([$e.config({mode:"flow",selector:"div[role=button]"}),Ne.config({disabled:n.isDisabled}),Ao(),qn.config({}),Ze.config({}),st("elementPathEvents",[Pn((d,p)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",()=>$e.focusIn(d)),e.on("NodeChange",h=>{const b=l(h.parents),S=b.length>0?c(b):[];Ze.set(d,S)})})])]),components:[]}};var Ui;(function(e){e[e.None=0]="None",e[e.Both=1]="Both",e[e.Vertical=2]="Vertical"})(Ui||(Ui={}));const L5=(e,t,n,o,s)=>{const r={height:Ap(o+t.top,Yf(e),Xf(e))};return n===Ui.Both&&(r.width=Ap(s+t.left,Kf(e),Ig(e))),r},QE=(e,t,n)=>{const o=te.fromDom(e.getContainer()),s=L5(e,t,n,In(o),Oo(o));un(s,(r,a)=>{ht(r)&&pe(o,a,Xv(r))}),zR(e)},N5=e=>{const t=wC(e);return t===!1?Ui.None:t==="both"?Ui.Both:Ui.Vertical},Rp=(e,t,n,o)=>{const r=Bn(n*20,o*20);return QE(e,r,t),g.some(!0)},H5=(e,t)=>{const n=N5(e);if(n===Ui.None)return g.none();const o=n===Ui.Both?"Press the arrow keys to resize the editor.":"Press the Up and Down arrow keys to resize the editor.";return g.some(Oa("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-label":t.translate(o)},behaviours:[Gl.config({mode:"mouse",repositionTarget:!1,onDrag:(s,r,a)=>QE(e,a,n),blockerClass:"tox-blocker"}),$e.config({mode:"special",onLeft:()=>Rp(e,n,-1,0),onRight:()=>Rp(e,n,1,0),onUp:()=>Rp(e,n,0,-1),onDown:()=>Rp(e,n,0,1)}),qn.config({}),Ve.config({})]},t.icons))},V5=(e,t)=>{const n=(o,s,r)=>Ze.set(o,[ho(t.translate(["{0} "+r,s[r]]))]);return Yo.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:ce([Ea.button(t.isDisabled),Ao(),qn.config({}),Ze.config({}),ye.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),st("wordcount-events",[Uc(o=>{const s=ye.getValue(o),r=s.mode==="words"?"characters":"words";ye.setValue(o,{mode:r,count:s.count}),n(o,s.count,r)}),Pn(o=>{e.on("wordCountUpdate",s=>{const{mode:r}=ye.getValue(o);ye.setValue(o,{mode:r,count:s.wordCount}),n(o,s.wordCount,r)})})])]),eventOrder:{[Lr()]:["disabling","alloy.base.behaviour","wordcount-events"]}})},z5=(e,t)=>{const n=()=>({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":ta.translate(["Powered by {0}","Tiny"])},innerHtml:F5.trim()},behaviours:ce([Ve.config({})])}]}),o=()=>{const r=[];return SC(e)&&r.push(R5(e,{},t)),e.hasPlugin("wordcount")&&r.push(V5(e,t)),xC(e)&&r.push(n()),r.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:r}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{const r=o(),a=H5(e,t);return r.concat(a.toArray())})()}},eA=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),U5=(e,t)=>{const n=e.inline,o=n?Rj:Dj,s=qd(e)?VU:dU,r=Lj(),a=Mn(),c=Mn(),l=Mn(),b=Ir().deviceType.isTouch()?["tox-platform-touch"]:[],S=eb(e),_=Mu(e),k=Yt({dom:{tag:"div",classes:["tox-anchorbar"]}}),L=Yt({dom:{tag:"div",classes:["tox-bottom-anchorbar"]}}),R=()=>r.mainUi.get().map(Fe=>Fe.outerContainer).bind(yn.getHeader),B=()=>Me.fromOption(r.dialogUi.get().map(Fe=>Fe.sink),"UI has not been rendered"),q=()=>Me.fromOption(r.popupUi.get().map(Fe=>Fe.sink),"(popup) UI has not been rendered"),V=r.lazyGetInOuterOrDie("anchor bar",k.getOpt),re=r.lazyGetInOuterOrDie("bottom anchor bar",L.getOpt),ee=r.lazyGetInOuterOrDie("toolbar",yn.getToolbar),le=r.lazyGetInOuterOrDie("throbber",yn.getThrobber),fe=eU({popup:q,dialog:B},e,V,re),dt=()=>{const Fe={attributes:{[rf]:S?jc.BottomToTop:jc.TopToBottom}},je=yn.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:fe.popup,onEscape:()=>{e.focus()}}),tn=yn.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:fe.popup.shared.getSink,providers:fe.popup.shared.providers,onEscape:()=>{e.focus()},onToolbarToggled:ec=>{GR(e,ec)},type:_,lazyToolbar:ee,lazyHeader:()=>R().getOrDie("Could not find header element"),...Fe}),Bt=yn.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:fe.popup.shared.providers,onEscape:()=>{e.focus()},type:_}),Xo=Gd(e),Tn=Pg(e),Ts=Fg(e),Gr=_C(e),Tc=_e(),_c=Xo||Tn||Ts,Qc=()=>Xo?[Bt]:Tn?[tn]:[],Oc=Gr?[Tc,je]:[je];return yn.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(_c?[]:["tox-editor-header--empty"]),...Fe},components:xt([Ts?Oc:[],Qc(),$u(e)?[]:[k.asSpec()]]),sticky:qd(e),editor:e,sharedBackstage:fe.popup.shared})},_e=()=>yn.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),Ke=()=>{const Fe=yn.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),je=yn.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}});return{dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[Fe,je]}},Ue=()=>{const Fe=tb(e),je=an(sn(),Fe)&&Un(Fe,"display")==="grid",tn={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(b),attributes:{...ta.isRtl()?{dir:"rtl"}:{}}},behaviours:ce([xs.config({useFixed:()=>s.isDocked(R)})])},Bt={dom:{styles:{width:document.body.clientWidth+"px"}},events:On([Z(Xm(),Ts=>{pe(Ts.element,"width",document.body.clientWidth+"px")})])},Xo=ps(Wn(tn,je?Bt:{})),Tn=Lb(Xo);return c.set(Tn),{sink:Xo,mothership:Tn}},Ct=()=>{const Fe={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(b),attributes:{...ta.isRtl()?{dir:"rtl"}:{}}},behaviours:ce([xs.config({useFixed:()=>s.isDocked(R),getBounds:()=>t.getPopupSinkBounds()})])},je=ps(Fe),tn=Lb(je);return l.set(tn),{sink:je,mothership:tn}},De=()=>{const Fe=dt(),je=Ke(),tn=yn.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:fe.popup}),Bt=yn.parts.viewWrapper({backstage:fe.popup}),Xo=yC(e)&&!n?g.some(z5(e,fe.popup.shared.providers)):g.none(),Tn=xt([S?[]:[Fe],n?[]:[je],S?[Fe]:[]]),Ts=yn.parts.editorContainer({components:xt([Tn,n?[]:[L.asSpec(),...Xo.toArray()]])}),Gr=nb(e),Tc={role:"application",...ta.isRtl()?{dir:"rtl"}:{},...Gr?{"aria-hidden":"true"}:{}},_c=ps(yn.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(n?["tox-tinymce-inline"]:[]).concat(S?["tox-tinymce--toolbar-bottom"]:[]).concat(b),styles:{visibility:"hidden",...Gr?{opacity:"0",border:"0"}:{}},attributes:Tc},components:[Ts,...n?[]:[Bt],tn],behaviours:ce([Ao(),Ne.config({disableClass:"tox-tinymce--disabled"}),$e.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),Qc=Lb(_c);return a.set(Qc),{mothership:Qc,outerContainer:_c}},yt=Fe=>{const je=Xv($j(e)),tn=Xv(Ij(e));return e.inline||(nc("div","width",tn)&&pe(Fe.element,"width",tn),nc("div","height",je)?pe(Fe.element,"height",je):pe(Fe.element,"height","400px")),je},de=Fe=>{e.addShortcut("alt+F9","focus menubar",()=>{yn.focusMenubar(Fe)}),e.addShortcut("alt+F10","focus toolbar",()=>{yn.focusToolbar(Fe)}),e.addCommand("ToggleToolbarDrawer",(je,tn)=>{tn!=null&&tn.skipFocus?yn.toggleToolbarDrawerWithoutFocusing(Fe):yn.toggleToolbarDrawer(Fe)}),e.addQueryStateHandler("ToggleToolbarDrawer",()=>yn.isToolbarDrawerToggled(Fe))},Ce=Fe=>{const{mainUi:je,popupUi:tn,uiMotherships:Bt}=Fe;Ut(cC(e),(Tm,ji)=>{e.ui.registry.addGroupToolbarButton(ji,Tm)});const{buttons:Xo,menuItems:Tn,contextToolbars:Ts,sidebars:Gr,views:Tc}=e.ui.registry.getAll(),_c=Qf(e),Qc={menuItems:Tn,menus:AC(e),menubar:uC(e),toolbar:_c.getOrThunk(()=>Bg(e)),allowToolbarGroups:_===na.floating,buttons:Xo,sidebar:Gr,views:Tc};de(je.outerContainer),tU(e,je.mothership,Bt),s.setup(e,fe.popup.shared,R),$G(e,fe.popup),n5(e,fe.popup.shared.getSink,fe.popup),nW(e),xW(e,le,fe.popup.shared),lG(e,Ts,tn.sink,{backstage:fe.popup}),B5(e,tn.sink);const Oc=e.getElement(),ec=yt(je.outerContainer),Cm={targetNode:Oc,height:ec};return o.render(e,Fe,Qc,fe.popup,Cm)},ze=Fe=>(l.set(Fe.mothership),Fe),gt=()=>{const Fe=De(),je=Ue(),tn=Ai(e)?Ct():ze(je);r.dialogUi.set(je),r.popupUi.set(tn),r.mainUi.set(Fe);const Bt={popupUi:tn,dialogUi:je,mainUi:Fe,uiMotherships:r.getUiMotherships()};return Ce(Bt)};return{popups:{backstage:fe.popup,getMothership:()=>eA("popups",l)},dialogs:{backstage:fe.dialog,getMothership:()=>eA("dialogs",c)},renderUI:gt}},W5=(e,t)=>{const n=Go(e,"id").fold(()=>{const o=Te("dialog-label");return Qe(t,"id",o),o},Xe);Qe(e,"aria-labelledby",n)},j5=O([J("lazySink"),Wt("dragBlockClass"),ko("getBounds",oe),N("useTabstopAt",ge),N("firstTabstop",0),N("eventOrder",{}),zo("modalBehaviours",[$e]),vr("onExecute"),Hh("onEscape")]),my={sketch:Xe},G5=O([ea({name:"draghandle",overrides:(e,t)=>({behaviours:ce([Gl.config({mode:"mouse",getTarget:n=>wi(n,'[role="dialog"]').getOr(n),blockerClass:e.dragBlockClass.getOrDie(new Error(`The drag blocker class was not specified for a dialog with a drag handle: 
`+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),hs({schema:[J("dom")],name:"title"}),hs({factory:my,schema:[J("dom")],name:"close"}),hs({factory:my,schema:[J("dom")],name:"body"}),ea({factory:my,schema:[J("dom")],name:"footer"}),_a({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[N("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),N("components",[])],name:"blocker"})]),q5=(e,t,n,o)=>{const s=Mn(),r=S=>{s.set(S);const _=e.lazySink(S).getOrDie(),k=o.blocker(),L=_.getSystem().build({...k,components:k.components.concat([Qr(S)]),behaviours:ce([Ve.config({}),st("dialog-blocker-events",[bu(uc(),()=>{Xa.isBlocked(S)?Q():$e.focusIn(S)})])])});kl(_,L),$e.focusIn(S)},a=S=>{s.clear(),Wo(S.element).each(_=>{S.getSystem().getByDom(_).each(k=>{Gc(k)})})},c=S=>ki(S,e,"body"),l=S=>vn(S,e,"footer"),d=(S,_)=>{Xa.block(S,_)},p=S=>{Xa.unblock(S)},h=Te("modal-events"),b={...e.eventOrder,[dc()]:[h].concat(e.eventOrder["alloy.system.attached"]||[])};return{uid:e.uid,dom:e.dom,components:t,apis:{show:r,hide:a,getBody:c,getFooter:l,setIdle:p,setBusy:d},eventOrder:b,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Ko(e.modalBehaviours,[Ze.config({}),$e.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt,firstTabstop:e.firstTabstop}),Xa.config({getRoot:s.get}),st(h,[Pn(S=>{W5(S.element,ki(S,e,"title").element)})])])}},Mo=ws({name:"ModalDialog",configFields:j5(),partFields:G5(),factory:q5,apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,n)=>{e.setBusy(t,n)},setIdle:(e,t)=>{e.setIdle(t)}}}),K5=Re([lo,db].concat(Bu)),Y5=dl,gy=[fb("button"),oa,br("align","end",["start","end"]),Wg,ka,Wm("buttonType",["primary","secondary"])],tA=[...gy,Kc],py=[Ha("type",["submit","cancel","custom"]),...tA],X5=[Ha("type",["menu"]),Di,zg,oa,er("items",K5),...gy],J5=[...gy,Ha("type",["togglebutton"]),go("tooltip"),oa,Di,Ho("active",!1)],Z5=Hs("type",{submit:py,cancel:py,custom:py,menu:X5,togglebutton:J5}),Q5=[lo,Kc,Ha("level",["info","warn","error","success"]),XC,N("url","")],e4=Re(Q5),t4=e=>[lo,e],n4=[lo,Kc,ka,fb("button"),oa,$P,Wm("buttonType",["primary","secondary","toolbar"]),Wg],o4=Re(n4),Ku=[lo,db],Ja=Ku.concat([gb]),s4=Ku.concat([mb,ka]),r4=Re(s4),a4=dl,c4=Ja.concat([JC("auto")]),i4=Re(c4),l4=ll([Yd,Kc,XC]),u4=Ja.concat([Fr("storageKey","default")]),d4=Re(u4),m4=Fo,g4=Re(Ja),p4=Fo,h4=Ku.concat([Fr("tag","textarea"),go("scriptId"),go("scriptUrl"),vh("settings",void 0)]),f4=Ku.concat([Fr("tag","textarea"),hr("init")]),b4=ml(e=>jn("customeditor.old",pr(f4),e).orThunk(()=>jn("customeditor.new",pr(h4),e))),v4=Fo,y4=Re(Ja),S4=gh(),x4=e=>[lo,hh("columns"),e],w4=[lo,go("html"),br("presets","presentation",["presentation","document"])],C4=Re(w4),T4=Ja.concat([Ho("border",!1),Ho("sandboxed",!0),Ho("streamContent",!1),Ho("transparent",!0)]),_4=Re(T4),O4=Fo,k4=Re(Ku.concat([ms("height")])),E4=Re([go("url"),gl("zoom"),gl("cachedWidth"),gl("cachedHeight")]),A4=Ja.concat([ms("inputMode"),ms("placeholder"),Ho("maximized",!1),ka]),D4=Re(A4),M4=Fo,$4=e=>[lo,mb,e,br("align","start",["start","center","end"])],I4=[Kc,Yd],B4=[Kc,er("items",Um("items",()=>nA))],nA=Hm([Re(I4),Re(B4)]),F4=Ja.concat([er("items",nA),ka]),P4=Re(F4),R4=Fo,L4=Ja.concat([Td("items",[Kc,Yd]),mu("size",1),ka]),N4=Re(L4),H4=Fo,V4=Ja.concat([Ho("constrain",!0),ka]),z4=Re(V4),oA=Re([go("width"),go("height")]),U4=Ku.concat([mb,mu("min",0),mu("max",0)]),W4=Re(U4),j4=bi,G4=[lo,er("header",Fo),er("cells",Nc(Fo))],q4=Re(G4),K4=Ja.concat([ms("placeholder"),Ho("maximized",!1),ka]),Y4=Re(K4),X4=Fo,sA=[Ha("type",["directory","leaf"]),YC,go("id"),Sa("menu",wk)],rA=Re(sA),J4=sA.concat([er("children",Um("children",()=>Hc("type",{directory:aA,leaf:rA})))]),aA=Re(J4),Z4=Hc("type",{directory:aA,leaf:rA}),Q4=[lo,er("items",Z4),Vc("onLeafAction"),Vc("onToggleExpand"),Va("defaultExpandedIds",[],Fo),ms("defaultSelectedId")],e9=Re(Q4),t9=Ja.concat([br("filetype","file",["image","media","file"]),ka]),n9=Re(t9),o9=Re([Yd,pb]),hy=e=>Po("items","items",Ns(),Nc(ml(t=>jn(`Checking item of ${e}`,fy,t).fold(n=>Me.error(vi(n)),n=>Me.value(n))))),fy=Nm(()=>Hc("type",{alertbanner:e4,bar:Re(t4(hy("bar"))),button:o4,checkbox:r4,colorinput:d4,colorpicker:g4,dropzone:y4,grid:Re(x4(hy("grid"))),iframe:_4,input:D4,listbox:P4,selectbox:N4,sizeinput:z4,slider:W4,textarea:Y4,urlinput:n9,customeditor:b4,htmlpanel:C4,imagepreview:k4,collection:i4,label:Re($4(hy("label"))),table:q4,tree:e9,panel:cA})),s9=[lo,N("classes",[]),er("items",fy)],cA=Re(s9),r9=[fb("tab"),YC,er("items",fy)],a9=[lo,Td("tabs",r9)],c9=Re(a9),i9=tA,l9=Z5,u9=Re([go("title"),Qs("body",Hc("type",{panel:cA,tabpanel:c9})),Fr("size","normal"),Va("buttons",[],l9),N("initialData",{}),ko("onAction",Q),ko("onChange",Q),ko("onSubmit",Q),ko("onClose",Q),ko("onCancel",Q),ko("onTabChange",Q)]),d9=e=>jn("dialog",u9,e),m9=Re([Ha("type",["cancel","custom"]),...i9]),g9=Re([go("title"),go("url"),gl("height"),gl("width"),jm("buttons",m9),ko("onAction",Q),ko("onCancel",Q),ko("onClose",Q),ko("onMessage",Q)]),p9=e=>jn("dialog",g9,e),by=e=>rt(e)?[e].concat(At(_s(e),by)):ut(e)?At(e,by):[],h9=e=>Ee(e.type)&&Ee(e.name),f9={checkbox:a4,colorinput:m4,colorpicker:p4,dropzone:S4,input:M4,iframe:O4,imagepreview:E4,selectbox:H4,sizeinput:oA,slider:j4,listbox:R4,size:oA,textarea:X4,urlinput:o9,customeditor:v4,collection:l4,togglemenuitem:Y5},b9=e=>g.from(f9[e.type]),v9=e=>Y(by(e),h9),y9=e=>{const t=v9(e),n=At(t,o=>b9(o).fold(()=>[],s=>[Qs(o.name,s)]));return Re(n)},iA=e=>{var t;const n=Jr(d9(e)),o=y9(e),s=(t=e.initialData)!==null&&t!==void 0?t:{};return{internalDialog:n,dataValidator:o,initialData:s}},ql={open:(e,t)=>{const n=iA(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:(e,t)=>{const n=Jr(p9(t));return e(n)},redial:e=>iA(e)};var S9=Object.freeze({__proto__:null,events:(e,t)=>{const n=(o,s)=>{e.updateState.each(r=>{const a=r(o,s);t.set(a)}),e.renderComponents.each(r=>{const a=r(s,t.get());(e.reuseDom?Mw:Dw)(o,a)})};return On([Z(yl(),(o,s)=>{const r=s;if(!r.universal){const a=e.channel;Tt(r.channels,a)&&n(o,r.data)}}),Pn((o,s)=>{e.initialData.each(r=>{n(o,r)})})])}}),x9=Object.freeze({__proto__:null,getState:(e,t,n)=>n}),w9=[J("channel"),Wt("renderComponents"),Wt("updateState"),Wt("initialData"),Ho("reuseDom",!0)],C9=Object.freeze({__proto__:null,init:()=>{const e=Le(g.none()),t=()=>e.set(g.none());return{readState:()=>e.get().getOr("none"),get:e.get,set:e.set,clear:t}}});const jr=qo({fields:w9,name:"reflecting",active:S9,apis:x9,state:C9}),lA=e=>{const t=[],n={};return un(e,(o,s)=>{o.fold(()=>{t.push(s)},r=>{n[s]=r})}),t.length>0?Me.error(t):Me.value(n)},T9=(e,t,n)=>{const o=Yt(Vu.sketch(s=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:ae(e.items,r=>BO(s,r,t,n))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[o.asSpec()]}],behaviours:ce([$e.config({mode:"acyclic",useTabstopAt:Vn(mm)}),$a.memento(o),ra.memento(o,{postprocess:s=>lA(s).fold(r=>(console.error(r),{}),Xe)})])}},_9=(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:Mg(e.action),behaviours:Ko(e.tabButtonBehaviours,[Ve.config({}),$e.config({mode:"execution",useSpace:!0,useEnter:!0}),ye.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}),O9=Ur({name:"TabButton",configFields:[N("uid",void 0),J("value"),Po("dom","dom",Rc(()=>({attributes:{role:"tab",id:Te("aria"),"aria-selected":"false"}})),Br()),Wt("action"),N("domModification",{}),zo("tabButtonBehaviours",[Ve,$e,ye]),J("view")],factory:_9}),k9=O([J("tabs"),J("dom"),N("clickToDismiss",!1),zo("tabbarBehaviours",[Vt,$e]),_l(["tabClass","selectedClass"])]),E9=xg({factory:O9,name:"tabs",unit:"tab",overrides:e=>{const t=(o,s)=>{Vt.dehighlight(o,s),Be(o,Ky(),{tabbar:o,button:s})},n=(o,s)=>{Vt.highlight(o,s),Be(o,qy(),{tabbar:o,button:s})};return{action:o=>{const s=o.getSystem().getByUid(e.uid).getOrDie(),r=Vt.isHighlighted(s,o);(()=>r&&e.clickToDismiss?t:r?Q:n)()(s,o)},domModification:{classes:[e.markers.tabClass]}}}}),A9=O([E9]),D9=(e,t,n,o)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Ko(e.tabbarBehaviours,[Vt.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(s,r)=>{Qe(r.element,"aria-selected","true")},onDehighlight:(s,r)=>{Qe(r.element,"aria-selected","false")}}),$e.config({mode:"flow",getInitial:s=>Vt.getHighlighted(s).map(r=>r.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])}),uA=ws({name:"Tabbar",configFields:k9(),partFields:A9(),factory:D9}),M9=(e,t)=>({uid:e.uid,dom:e.dom,behaviours:Ko(e.tabviewBehaviours,[Ze.config({})]),domModification:{attributes:{role:"tabpanel"}}}),$9=Ur({name:"Tabview",configFields:[zo("tabviewBehaviours",[Ze])],factory:M9}),I9=O([N("selectFirst",!0),Dt("onChangeTab"),Dt("onDismissTab"),N("tabs",[]),zo("tabSectionBehaviours",[])]),B9=hs({factory:uA,schema:[J("dom"),cc("markers",[J("tabClass"),J("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),F9=hs({factory:$9,name:"tabview"}),P9=O([B9,F9]),R9=(e,t,n,o)=>{const s=a=>{const c=ye.getValue(a);vn(a,e,"tabview").each(l=>{lt(e.tabs,p=>p.value===c).each(p=>{const h=p.view();Go(a.element,"id").each(b=>{Qe(l.element,"aria-labelledby",b)}),Ze.set(l,h),e.onChangeTab(l,a,h)})})},r=(a,c)=>{vn(a,e,"tabbar").each(l=>{c(l).each(xl)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:gg(e.tabSectionBehaviours),events:On(xt([e.selectFirst?[Pn((a,c)=>{r(a,Vt.getFirst)})]:[],[Z(qy(),(a,c)=>{const l=c.event.button;s(l)}),Z(Ky(),(a,c)=>{const l=c.event.button;e.onDismissTab(a,l)})]])),apis:{getViewItems:a=>vn(a,e,"tabview").map(c=>Ze.contents(c)).getOr([]),showTab:(a,c)=>{r(a,d=>{const p=Vt.getCandidates(d);return lt(p,b=>ye.getValue(b)===c).filter(b=>!Vt.isHighlighted(d,b))})}}}},Yu=ws({name:"TabSection",configFields:I9(),partFields:P9(),factory:R9,apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,n)=>{e.showTab(t,n)}}}),L9=(e,t,n)=>ae(e,(o,s)=>{Ze.set(n,e[s].view());const r=t.dom.getBoundingClientRect();return Ze.set(n,[]),r.height}),N9=e=>He(K(e,(t,n)=>t>n?-1:t<n?1:0)),H9=(e,t,n)=>{const o=da(e).dom,s=wi(e,".tox-dialog-wrap").getOr(e),r=Un(s,"position")==="fixed";let a;r?a=Math.max(o.clientHeight,window.innerHeight):a=Math.max(o.offsetHeight,o.scrollHeight);const c=In(t),d=t.dom.offsetLeft>=n.dom.offsetLeft+Oo(n)?Math.max(In(n),c):c,p=parseInt(Un(e,"margin-top"),10)||0,h=parseInt(Un(e,"margin-bottom"),10)||0,S=In(e)+p+h-d;return a-S},V9=(e,t)=>{He(e).each(n=>Yu.showTab(t,n.value))},dA=(e,t)=>{pe(e,"height",t+"px"),pe(e,"flex-basis",t+"px")},Lp=(e,t,n)=>{wi(e,'[role="dialog"]').each(o=>{fo(o,'[role="tablist"]').each(s=>{n.get().map(r=>(pe(t,"height","0"),pe(t,"flex-basis","0"),Math.min(r,H9(o,t,s)))).each(r=>{dA(t,r)})})})},vy=e=>fo(e,'[role="tabpanel"]'),z9=e=>{const t=Mn();return{extraEvents:[Pn(s=>{const r=s.element;vy(r).each(a=>{pe(a,"visibility","hidden"),s.getSystem().getByDom(a).toOptional().each(c=>{const l=L9(e,a,c);N9(l).fold(t.clear,t.set)}),Lp(r,a,t),Qt(a,"visibility"),V9(e,s),requestAnimationFrame(()=>{Lp(r,a,t)})})}),Z(Xm(),s=>{const r=s.element;vy(r).each(a=>{Lp(r,a,t)})}),Z(h_,(s,r)=>{const a=s.element;vy(a).each(c=>{const l=hc(P(c));pe(c,"visibility","hidden");const d=xn(c,"height").map(b=>parseInt(b,10));Qt(c,"height"),Qt(c,"flex-basis");const p=c.dom.getBoundingClientRect().height;d.forall(b=>p>b)?(t.set(p),Lp(a,c,t)):d.each(b=>{dA(c,b)}),Qt(c,"visibility"),l.each(wa)})})],selectFirst:!1}},mA="send-data-to-section",gA="send-data-to-view",U9=(e,t,n)=>{const o=Le({}),s=d=>{const p=ye.getValue(d),h=lA(p).getOr({}),b=o.get(),S=Wn(b,h);o.set(S)},r=d=>{const p=o.get();ye.setValue(d,p)},a=Le(null),c=ae(e.tabs,d=>({value:d.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[ho(n.shared.providers.translate(d.title))],view:()=>[Vu.sketch(p=>({dom:{tag:"div",classes:["tox-form"]},components:ae(d.items,h=>BO(p,h,t,n)),formBehaviours:ce([$e.config({mode:"acyclic",useTabstopAt:Vn(mm)}),st("TabView.form.events",[Pn(r),mc(s)]),zr.config({channels:xe([{key:mA,value:{onReceive:s}},{key:gA,value:{onReceive:r}}])})])}))]})),l=z9(c);return Yu.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(d,p,h)=>{const b=ye.getValue(p);Be(d,p_,{name:b,oldName:a.get()}),a.set(b)},tabs:c,components:[Yu.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[uA.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:ce([qn.config({})])}),Yu.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:l.selectFirst,tabSectionBehaviours:ce([st("tabpanel",l.extraEvents),$e.config({mode:"acyclic"}),Ot.config({find:d=>He(Yu.getViewItems(d))}),ra.withComp(g.none(),d=>(d.getSystem().broadcastOn([mA],{}),o.get()),(d,p)=>{o.set(p),d.getSystem().broadcastOn([gA],{})})])})},yy=Te("update-dialog"),pA=Te("update-title"),hA=Te("update-body"),fA=Te("update-footer"),bA=Te("body-send-message"),vA=(e,t,n,o,s)=>{const r=l=>{const d=l.body;switch(d.type){case"tabpanel":return[U9(d,l.initialData,o)];default:return[T9(d,l.initialData,o)]}},a=(l,d)=>g.some({isTabPanel:()=>d.body.type==="tabpanel"}),c={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...n.map(l=>({id:l})).getOr({}),...s?c:{}}},components:[],behaviours:ce([$a.childAt(0),jr.config({channel:`${hA}-${t}`,updateState:a,renderComponents:r,initialData:e})])}},W9=(e,t,n,o,s)=>vA(e,t,g.some(n),o,s),j9=(e,t,n)=>{const o=vA(e,t,g.none(),n,!1);return Mo.parts.body(o)},G9=e=>{const t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[nO({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:ce([qn.config({}),Ve.config({})])})]}],behaviours:ce([$e.config({mode:"acyclic",useTabstopAt:Vn(mm)})])};return Mo.parts.body(t)};function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function Sy(e,t){return Sy=Object.setPrototypeOf||function(o,s){return o.__proto__=s,o},Sy(e,t)}function q9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e,t,n){return q9()?Np=Reflect.construct:Np=function(s,r,a){var c=[null];c.push.apply(c,r);var l=Function.bind.apply(s,c),d=new l;return a&&Sy(d,a.prototype),d},Np.apply(null,arguments)}function Za(e){return K9(e)||Y9(e)||X9(e)||J9()}function K9(e){if(Array.isArray(e))return xy(e)}function Y9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function X9(e,t){if(e){if(typeof e=="string")return xy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xy(e,t)}}function xy(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function J9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Z9=Object.hasOwnProperty,yA=Object.setPrototypeOf,Q9=Object.isFrozen,eq=Object.getPrototypeOf,tq=Object.getOwnPropertyDescriptor,Cr=Object.freeze,Cc=Object.seal,nq=Object.create,SA=typeof Reflect<"u"&&Reflect,Hp=SA.apply,wy=SA.construct;Hp||(Hp=function(t,n,o){return t.apply(n,o)}),Cr||(Cr=function(t){return t}),Cc||(Cc=function(t){return t}),wy||(wy=function(t,n){return Np(t,Za(n))});var oq=Qa(Array.prototype.forEach),sq=Qa(Array.prototype.pop),wm=Qa(Array.prototype.push),Vp=Qa(String.prototype.toLowerCase),rq=Qa(String.prototype.match),Wi=Qa(String.prototype.replace),aq=Qa(String.prototype.indexOf),cq=Qa(String.prototype.trim),Tr=Qa(RegExp.prototype.test),Cy=iq(TypeError);function Qa(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return Hp(e,t,o)}}function iq(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return wy(e,n)}}function mn(e,t){yA&&yA(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var s=Vp(o);s!==o&&(Q9(t)||(t[n]=s),o=s)}e[o]=!0}return e}function Yl(e){var t=nq(null),n;for(n in e)Hp(Z9,e,[n])&&(t[n]=e[n]);return t}function zp(e,t){for(;e!==null;){var n=tq(e,t);if(n){if(n.get)return Qa(n.get);if(typeof n.value=="function")return Qa(n.value)}e=eq(e)}function o(s){return console.warn("fallback value for",s),null}return o}var xA=Cr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ty=Cr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_y=Cr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lq=Cr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Oy=Cr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),uq=Cr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),wA=Cr(["#text"]),CA=Cr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ky=Cr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),TA=Cr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Up=Cr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dq=Cc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),mq=Cc(/<%[\w\W]*|[\w\W]*%>/gm),gq=Cc(/^data-[\-\w.\u00B7-\uFFFF]/),pq=Cc(/^aria-[\-\w]+$/),hq=Cc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fq=Cc(/^(?:\w+script|data):/i),bq=Cc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vq=Cc(/^html$/i),yq=function(){return typeof window>"u"?null:window},Sq=function(t,n){if(Kl(t)!=="object"||typeof t.createPolicy!="function")return null;var o=null,s="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(s)&&(o=n.currentScript.getAttribute(s));var r="dompurify"+(o?"#"+o:"");try{return t.createPolicy(r,{createHTML:function(c){return c}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function _A(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yq(),t=function(z){return _A(z)};if(t.version="2.3.8",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,o=e.document,s=e.DocumentFragment,r=e.HTMLTemplateElement,a=e.Node,c=e.Element,l=e.NodeFilter,d=e.NamedNodeMap,p=d===void 0?e.NamedNodeMap||e.MozNamedAttrMap:d,h=e.HTMLFormElement,b=e.DOMParser,S=e.trustedTypes,_=c.prototype,k=zp(_,"cloneNode"),L=zp(_,"nextSibling"),R=zp(_,"childNodes"),B=zp(_,"parentNode");if(typeof r=="function"){var q=o.createElement("template");q.content&&q.content.ownerDocument&&(o=q.content.ownerDocument)}var V=Sq(S,n),re=V?V.createHTML(""):"",ee=o,le=ee.implementation,fe=ee.createNodeIterator,dt=ee.createDocumentFragment,_e=ee.getElementsByTagName,Ke=n.importNode,Ue={};try{Ue=Yl(o).documentMode?o.documentMode:{}}catch{}var Ct={};t.isSupported=typeof B=="function"&&le&&typeof le.createHTMLDocument<"u"&&Ue!==9;var De=dq,yt=mq,de=gq,Ce=pq,ze=fq,gt=bq,Fe=hq,je=null,tn=mn({},[].concat(Za(xA),Za(Ty),Za(_y),Za(Oy),Za(wA))),Bt=null,Xo=mn({},[].concat(Za(CA),Za(ky),Za(TA),Za(Up))),Tn=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ts=null,Gr=null,Tc=!0,_c=!0,Qc=!1,Oc=!1,ec=!1,Cm=!1,Tm=!1,ji=!1,Wp=!1,jp=!1,YA=!0,$y=!0,_m=!1,Xu={},Ju=null,XA=mn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),JA=null,ZA=mn({},["audio","video","img","source","image","track"]),Iy=null,QA=mn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),By="http://www.w3.org/1998/Math/MathML",Fy="http://www.w3.org/2000/svg",Gi="http://www.w3.org/1999/xhtml",Gp=Gi,Py=!1,Zu,jq=["application/xhtml+xml","text/html"],Gq="text/html",Xl,Qu=null,qq=o.createElement("form"),eD=function(z){return z instanceof RegExp||z instanceof Function},Ry=function(z){Qu&&Qu===z||((!z||Kl(z)!=="object")&&(z={}),z=Yl(z),je="ALLOWED_TAGS"in z?mn({},z.ALLOWED_TAGS):tn,Bt="ALLOWED_ATTR"in z?mn({},z.ALLOWED_ATTR):Xo,Iy="ADD_URI_SAFE_ATTR"in z?mn(Yl(QA),z.ADD_URI_SAFE_ATTR):QA,JA="ADD_DATA_URI_TAGS"in z?mn(Yl(ZA),z.ADD_DATA_URI_TAGS):ZA,Ju="FORBID_CONTENTS"in z?mn({},z.FORBID_CONTENTS):XA,Ts="FORBID_TAGS"in z?mn({},z.FORBID_TAGS):{},Gr="FORBID_ATTR"in z?mn({},z.FORBID_ATTR):{},Xu="USE_PROFILES"in z?z.USE_PROFILES:!1,Tc=z.ALLOW_ARIA_ATTR!==!1,_c=z.ALLOW_DATA_ATTR!==!1,Qc=z.ALLOW_UNKNOWN_PROTOCOLS||!1,Oc=z.SAFE_FOR_TEMPLATES||!1,ec=z.WHOLE_DOCUMENT||!1,ji=z.RETURN_DOM||!1,Wp=z.RETURN_DOM_FRAGMENT||!1,jp=z.RETURN_TRUSTED_TYPE||!1,Tm=z.FORCE_BODY||!1,YA=z.SANITIZE_DOM!==!1,$y=z.KEEP_CONTENT!==!1,_m=z.IN_PLACE||!1,Fe=z.ALLOWED_URI_REGEXP||Fe,Gp=z.NAMESPACE||Gi,z.CUSTOM_ELEMENT_HANDLING&&eD(z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Tn.tagNameCheck=z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),z.CUSTOM_ELEMENT_HANDLING&&eD(z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Tn.attributeNameCheck=z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),z.CUSTOM_ELEMENT_HANDLING&&typeof z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Tn.allowCustomizedBuiltInElements=z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Zu=jq.indexOf(z.PARSER_MEDIA_TYPE)===-1?Zu=Gq:Zu=z.PARSER_MEDIA_TYPE,Xl=Zu==="application/xhtml+xml"?function(Oe){return Oe}:Vp,Oc&&(_c=!1),Wp&&(ji=!0),Xu&&(je=mn({},Za(wA)),Bt=[],Xu.html===!0&&(mn(je,xA),mn(Bt,CA)),Xu.svg===!0&&(mn(je,Ty),mn(Bt,ky),mn(Bt,Up)),Xu.svgFilters===!0&&(mn(je,_y),mn(Bt,ky),mn(Bt,Up)),Xu.mathMl===!0&&(mn(je,Oy),mn(Bt,TA),mn(Bt,Up))),z.ADD_TAGS&&(je===tn&&(je=Yl(je)),mn(je,z.ADD_TAGS)),z.ADD_ATTR&&(Bt===Xo&&(Bt=Yl(Bt)),mn(Bt,z.ADD_ATTR)),z.ADD_URI_SAFE_ATTR&&mn(Iy,z.ADD_URI_SAFE_ATTR),z.FORBID_CONTENTS&&(Ju===XA&&(Ju=Yl(Ju)),mn(Ju,z.FORBID_CONTENTS)),$y&&(je["#text"]=!0),ec&&mn(je,["html","head","body"]),je.table&&(mn(je,["tbody"]),delete Ts.tbody),Cr&&Cr(z),Qu=z)},tD=mn({},["mi","mo","mn","ms","mtext"]),nD=mn({},["foreignobject","desc","title","annotation-xml"]),Kq=mn({},["title","style","font","a","script"]),qp=mn({},Ty);mn(qp,_y),mn(qp,lq);var Ly=mn({},Oy);mn(Ly,uq);var Yq=function(z){var Oe=B(z);(!Oe||!Oe.tagName)&&(Oe={namespaceURI:Gi,tagName:"template"});var nt=Vp(z.tagName),ao=Vp(Oe.tagName);return z.namespaceURI===Fy?Oe.namespaceURI===Gi?nt==="svg":Oe.namespaceURI===By?nt==="svg"&&(ao==="annotation-xml"||tD[ao]):!!qp[nt]:z.namespaceURI===By?Oe.namespaceURI===Gi?nt==="math":Oe.namespaceURI===Fy?nt==="math"&&nD[ao]:!!Ly[nt]:z.namespaceURI===Gi?Oe.namespaceURI===Fy&&!nD[ao]||Oe.namespaceURI===By&&!tD[ao]?!1:!Ly[nt]&&(Kq[nt]||!qp[nt]):!1},ei=function(z){wm(t.removed,{element:z});try{z.parentNode.removeChild(z)}catch{try{z.outerHTML=re}catch{z.remove()}}},Kp=function(z,Oe){try{wm(t.removed,{attribute:Oe.getAttributeNode(z),from:Oe})}catch{wm(t.removed,{attribute:null,from:Oe})}if(Oe.removeAttribute(z),z==="is"&&!Bt[z])if(ji||Wp)try{ei(Oe)}catch{}else try{Oe.setAttribute(z,"")}catch{}},oD=function(z){var Oe,nt;if(Tm)z="<remove></remove>"+z;else{var ao=rq(z,/^[\r\n\t ]+/);nt=ao&&ao[0]}Zu==="application/xhtml+xml"&&(z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+z+"</body></html>");var qr=V?V.createHTML(z):z;if(Gp===Gi)try{Oe=new b().parseFromString(qr,Zu)}catch{}if(!Oe||!Oe.documentElement){Oe=le.createDocument(Gp,"template",null);try{Oe.documentElement.innerHTML=Py?"":qr}catch{}}var ar=Oe.body||Oe.documentElement;return z&&nt&&ar.insertBefore(o.createTextNode(nt),ar.childNodes[0]||null),Gp===Gi?_e.call(Oe,ec?"html":"body")[0]:ec?Oe.documentElement:ar},sD=function(z){return fe.call(z.ownerDocument||z,z,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Xq=function(z){return z instanceof h&&(typeof z.nodeName!="string"||typeof z.textContent!="string"||typeof z.removeChild!="function"||!(z.attributes instanceof p)||typeof z.removeAttribute!="function"||typeof z.setAttribute!="function"||typeof z.namespaceURI!="string"||typeof z.insertBefore!="function")},Om=function(z){return Kl(a)==="object"?z instanceof a:z&&Kl(z)==="object"&&typeof z.nodeType=="number"&&typeof z.nodeName=="string"},ti=function(z,Oe,nt){Ct[z]&&oq(Ct[z],function(ao){ao.call(t,Oe,nt,Qu)})},rD=function(z){var Oe;if(ti("beforeSanitizeElements",z,null),Xq(z)||Tr(/[\u0080-\uFFFF]/,z.nodeName))return ei(z),!0;var nt=Xl(z.nodeName);if(ti("uponSanitizeElement",z,{tagName:nt,allowedTags:je}),z.hasChildNodes()&&!Om(z.firstElementChild)&&(!Om(z.content)||!Om(z.content.firstElementChild))&&Tr(/<[/\w]/g,z.innerHTML)&&Tr(/<[/\w]/g,z.textContent)||nt==="select"&&Tr(/<template/i,z.innerHTML))return ei(z),!0;if(!je[nt]||Ts[nt]){if(!Ts[nt]&&cD(nt)&&(Tn.tagNameCheck instanceof RegExp&&Tr(Tn.tagNameCheck,nt)||Tn.tagNameCheck instanceof Function&&Tn.tagNameCheck(nt)))return!1;if($y&&!Ju[nt]){var ao=B(z)||z.parentNode,qr=R(z)||z.childNodes;if(qr&&ao)for(var ar=qr.length,js=ar-1;js>=0;--js)ao.insertBefore(k(qr[js],!0),L(z))}return ei(z),!0}return z instanceof c&&!Yq(z)||(nt==="noscript"||nt==="noembed")&&Tr(/<\/no(script|embed)/i,z.innerHTML)?(ei(z),!0):(Oc&&z.nodeType===3&&(Oe=z.textContent,Oe=Wi(Oe,De," "),Oe=Wi(Oe,yt," "),z.textContent!==Oe&&(wm(t.removed,{element:z.cloneNode()}),z.textContent=Oe)),ti("afterSanitizeElements",z,null),!1)},aD=function(z,Oe,nt){if(YA&&(Oe==="id"||Oe==="name")&&(nt in o||nt in qq))return!1;if(!(_c&&!Gr[Oe]&&Tr(de,Oe))){if(!(Tc&&Tr(Ce,Oe))){if(!Bt[Oe]||Gr[Oe]){if(!(cD(z)&&(Tn.tagNameCheck instanceof RegExp&&Tr(Tn.tagNameCheck,z)||Tn.tagNameCheck instanceof Function&&Tn.tagNameCheck(z))&&(Tn.attributeNameCheck instanceof RegExp&&Tr(Tn.attributeNameCheck,Oe)||Tn.attributeNameCheck instanceof Function&&Tn.attributeNameCheck(Oe))||Oe==="is"&&Tn.allowCustomizedBuiltInElements&&(Tn.tagNameCheck instanceof RegExp&&Tr(Tn.tagNameCheck,nt)||Tn.tagNameCheck instanceof Function&&Tn.tagNameCheck(nt))))return!1}else if(!Iy[Oe]){if(!Tr(Fe,Wi(nt,gt,""))){if(!((Oe==="src"||Oe==="xlink:href"||Oe==="href")&&z!=="script"&&aq(nt,"data:")===0&&JA[z])){if(!(Qc&&!Tr(ze,Wi(nt,gt,"")))){if(nt)return!1}}}}}}return!0},cD=function(z){return z.indexOf("-")>0},iD=function(z){var Oe,nt,ao,qr;ti("beforeSanitizeAttributes",z,null);var ar=z.attributes;if(ar){var js={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Bt};for(qr=ar.length;qr--;){Oe=ar[qr];var Yp=Oe,Gs=Yp.name,lD=Yp.namespaceURI;nt=Gs==="value"?Oe.value:cq(Oe.value),ao=Xl(Gs);var Zq=nt;if(js.attrName=ao,js.attrValue=nt,js.keepAttr=!0,js.forceKeepAttr=void 0,ti("uponSanitizeAttribute",z,js),nt=js.attrValue,!js.forceKeepAttr){if(!js.keepAttr){Kp(Gs,z);continue}if(Tr(/\/>/i,nt)){Kp(Gs,z);continue}Oc&&(nt=Wi(nt,De," "),nt=Wi(nt,yt," "));var Qq=Xl(z.nodeName);if(!aD(Qq,ao,nt)){Kp(Gs,z);continue}if(nt!==Zq)try{lD?z.setAttributeNS(lD,Gs,nt):z.setAttribute(Gs,nt)}catch{Kp(Gs,z)}}}ti("afterSanitizeAttributes",z,null)}},Jq=function vt(z){var Oe,nt=sD(z);for(ti("beforeSanitizeShadowDOM",z,null);Oe=nt.nextNode();)ti("uponSanitizeShadowNode",Oe,null),!rD(Oe)&&(Oe.content instanceof s&&vt(Oe.content),iD(Oe));ti("afterSanitizeShadowDOM",z,null)};return t.sanitize=function(vt,z){var Oe,nt,ao,qr,ar;if(Py=!vt,Py&&(vt="<!-->"),typeof vt!="string"&&!Om(vt)){if(typeof vt.toString!="function")throw Cy("toString is not a function");if(vt=vt.toString(),typeof vt!="string")throw Cy("dirty is not a string, aborting")}if(!t.isSupported){if(Kl(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof vt=="string")return e.toStaticHTML(vt);if(Om(vt))return e.toStaticHTML(vt.outerHTML)}return vt}if(Cm||Ry(z),t.removed=[],typeof vt=="string"&&(_m=!1),_m){if(vt.nodeName){var js=Xl(vt.nodeName);if(!je[js]||Ts[js])throw Cy("root node is forbidden and cannot be sanitized in-place")}}else if(vt instanceof a)Oe=oD("<!---->"),nt=Oe.ownerDocument.importNode(vt,!0),nt.nodeType===1&&nt.nodeName==="BODY"||nt.nodeName==="HTML"?Oe=nt:Oe.appendChild(nt);else{if(!ji&&!Oc&&!ec&&vt.indexOf("<")===-1)return V&&jp?V.createHTML(vt):vt;if(Oe=oD(vt),!Oe)return ji?null:jp?re:""}Oe&&Tm&&ei(Oe.firstChild);for(var Yp=sD(_m?vt:Oe);ao=Yp.nextNode();)ao.nodeType===3&&ao===qr||rD(ao)||(ao.content instanceof s&&Jq(ao.content),iD(ao),qr=ao);if(qr=null,_m)return vt;if(ji){if(Wp)for(ar=dt.call(Oe.ownerDocument);Oe.firstChild;)ar.appendChild(Oe.firstChild);else ar=Oe;return Bt.shadowroot&&(ar=Ke.call(n,ar,!0)),ar}var Gs=ec?Oe.outerHTML:Oe.innerHTML;return ec&&je["!doctype"]&&Oe.ownerDocument&&Oe.ownerDocument.doctype&&Oe.ownerDocument.doctype.name&&Tr(vq,Oe.ownerDocument.doctype.name)&&(Gs="<!DOCTYPE "+Oe.ownerDocument.doctype.name+`>
`+Gs),Oc&&(Gs=Wi(Gs,De," "),Gs=Wi(Gs,yt," ")),V&&jp?V.createHTML(Gs):Gs},t.setConfig=function(vt){Ry(vt),Cm=!0},t.clearConfig=function(){Qu=null,Cm=!1},t.isValidAttribute=function(vt,z,Oe){Qu||Ry({});var nt=Xl(vt),ao=Xl(z);return aD(nt,ao,Oe)},t.addHook=function(vt,z){typeof z=="function"&&(Ct[vt]=Ct[vt]||[],wm(Ct[vt],z))},t.removeHook=function(vt){if(Ct[vt])return sq(Ct[vt])},t.removeHooks=function(vt){Ct[vt]&&(Ct[vt]=[])},t.removeAllHooks=function(){Ct={}},t}var xq=_A();const wq=e=>xq().sanitize(e),Cq=Du.deviceType.isTouch(),OA=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),kA=(e,t)=>Mo.parts.close(Yo.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:ce([qn.config({})])})),EA=()=>Mo.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),AA=(e,t)=>Mo.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Hi(`<p>${wq(t.translate(e))}</p>`)}]}]}),DA=e=>Mo.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),MA=(e,t)=>[Ka.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),Ka.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],Ey=e=>{const t="tox-dialog",n=t+"-wrap",o=n+"__backdrop",s=t+"__disable-scroll";return Mo.sketch({lazySink:e.lazySink,onEscape:r=>(e.onEscape(r),g.some(!0)),useTabstopAt:r=>!mm(r),firstTabstop:e.firstTabstop,dom:{tag:"div",classes:[t].concat(e.extraClasses),styles:{position:"relative",...e.extraStyles}},components:[e.header,e.body,...e.footer.toArray()],parts:{blocker:{dom:Hi(`<div class="${n}"></div>`),components:[{dom:{tag:"div",classes:Cq?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:n,modalBehaviours:ce([Ve.config({}),st("dialog-events",e.dialogEvents.concat([bu(uc(),(r,a)=>{Xa.isBlocked(r)?Q():$e.focusIn(r)})])),st("scroll-lock",[Pn(()=>{vo(sn(),s)}),mc(()=>{so(sn(),s)})]),...e.extraBehaviours]),eventOrder:{[Lr()]:["dialog-events"],[dc()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[hu()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...e.eventOrder}})},$A=e=>Yo.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},buttonBehaviours:ce([qn.config({})]),components:[Oa("close",{tag:"span",classes:["tox-icon"]},e.icons)],action:t=>{jt(t,Fi)}}),IA=(e,t,n,o)=>{const s=r=>[ho(o.translate(r.title))];return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...n.map(r=>({id:r})).getOr({})}},components:[],behaviours:ce([jr.config({channel:`${pA}-${t}`,initialData:e,renderComponents:s})])}},BA=()=>({dom:Hi('<div class="tox-dialog__draghandle"></div>')}),Tq=(e,t,n,o)=>Ka.sketch({dom:Hi('<div class="tox-dialog__header"></div>'),components:[IA(e,t,g.some(n),o),BA(),$A(o)],containerBehaviours:ce([Gl.config({mode:"mouse",blockerClass:"blocker",getTarget:s=>Wa(s,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}),_q=(e,t,n)=>{const o=Mo.parts.title(IA(e,t,g.none(),n)),s=Mo.parts.draghandle(BA()),r=Mo.parts.close($A(n)),a=[o].concat(e.draggable?[s]:[]).concat([r]);return Ka.sketch({dom:Hi('<div class="tox-dialog__header"></div>'),components:a})},FA=(e,t,n)=>_q({title:n.shared.providers.translate(e),draggable:n.dialog.isDraggableModal()},t,n.shared.providers),PA=(e,t,n,o)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:`${o.getOr(0)}px`,position:"absolute"}},behaviours:t,components:[{dom:Hi('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),RA=(e,t,n)=>({onClose:()=>n.closeWindow(),onBlock:o=>{const s=fo(e().element,".tox-dialog__header").map(r=>In(r));Mo.setBusy(e(),(r,a)=>PA(o.message,a,t,s))},onUnblock:()=>{Mo.setIdle(e())}}),LA=(e,t,n,o)=>{const s=(r,a)=>g.some(a);return ps(Ey({...e,firstTabstop:1,lazySink:o.shared.getSink,extraBehaviours:[jr.config({channel:`${yy}-${e.id}`,updateState:s,initialData:t}),ra.memory({}),...e.extraBehaviours],onEscape:r=>{jt(r,Fi)},dialogEvents:n,eventOrder:{[yl()]:[jr.name(),zr.name()],[dc()]:["scroll-lock",jr.name(),"messages","dialog-events","alloy.base.behaviour"],[hu()]:["alloy.base.behaviour","dialog-events","messages",jr.name(),"scroll-lock"]}}))},Ay=(e,t={})=>{const n=o=>{const s=ae(o.items,r=>{const a=Se(t,r.name).getOr(Le(!1));return{...r,storage:a}});return{...o,items:s}};return ae(e,o=>o.type==="menu"?n(o):o)},NA=e=>me(e,(t,n)=>n.type==="menu"?me(n.items,(s,r)=>(s[r.name]=r.storage,s),t):t,{}),HA=(e,t)=>[Eh(uc(),vV),e(im,(n,o,s,r)=>{hc(P(r.element)).fold(Q,Jh),t.onClose(),o.onClose()}),e(Fi,(n,o,s,r)=>{o.onCancel(n),jt(r,im)}),Z(Hb,(n,o)=>t.onUnblock()),Z(Nb,(n,o)=>t.onBlock(o.event))],Dy={initUrlDialog:(e,t)=>{const n=(s,r)=>Z(s,(a,c)=>{o(a,(l,d)=>{r(e(),l,c.event,a)})}),o=(s,r)=>{jr.getState(s).get().each(a=>{r(a,s)})};return[...HA(n,t),n(vc,(s,r,a)=>{r.onAction(s,{name:a.name})})]},initDialog:(e,t,n)=>{const o=(r,a)=>Z(r,(c,l)=>{s(c,(d,p)=>{a(e(),d,l.event,c)})}),s=(r,a)=>{jr.getState(r).get().each(c=>{a(c.internalDialog,r)})};return[...HA(o,t),o(lm,(r,a)=>a.onSubmit(r)),o(xr,(r,a,c)=>{a.onChange(r,{name:c.name})}),o(vc,(r,a,c,l)=>{const d=()=>$e.focusIn(l),p=S=>v(S,"disabled")||Go(S,"aria-disabled").exists(_=>_==="true"),h=P(l.element),b=hc(h);a.onAction(r,{name:c.name,value:c.value}),hc(h).fold(d,S=>{p(S)||b.exists(_=>Ms(S,_)&&p(_))?d():n().toOptional().filter(_=>!Ms(_.element,S)).each(d)})}),o(p_,(r,a,c)=>{a.onTabChange(r,{newTabName:c.name,oldTabName:c.oldName})}),mc(r=>{const a=e();ye.setValue(r,a.getData())})]}},Oq=(e,t)=>gp(e,e.type,t),kq=(e,t,n)=>lt(t,o=>o.name===n).bind(o=>o.memento.getOpt(e)),Eq=(e,t)=>{const n=t.map(c=>c.footerButtons).getOr([]),o=he(n,c=>c.align==="start"),s=(c,l)=>Ka.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${c}`]},components:ae(l,d=>d.memento.asSpec())}),r=s("start",o.pass),a=s("end",o.fail);return[r,a]},VA=(e,t,n)=>{const o=(s,r)=>{const a=ae(r.buttons,l=>{const d=Yt(Oq(l,n));return{name:l.name,align:l.align,memento:d}}),c=l=>kq(s,a,l);return g.some({lookupByName:c,footerButtons:a})};return{dom:Hi('<div class="tox-dialog__footer"></div>'),components:[],behaviours:ce([jr.config({channel:`${fA}-${t}`,initialData:e,updateState:o,renderComponents:Eq})])}},Aq=(e,t,n)=>VA(e,t,n),zA=(e,t,n)=>Mo.parts.footer(VA(e,t,n)),UA=(e,t)=>{if(e.getRoot().getSystem().isConnected()){const o=Ot.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return Vu.getField(o,t).orThunk(()=>e.getFooter().bind(a=>jr.getState(a).get()).bind(a=>a.lookupByName(t)))}else return g.none()},Dq=(e,t)=>{const n=e.getRoot();return jr.getState(n).get().map(o=>Jr(jn("data",o.dataValidator,t))).getOr(t)},WA=(e,t,n)=>{const o=_=>{const k=e.getRoot();k.getSystem().isConnected()&&_(k)},S={getData:()=>{const _=e.getRoot(),k=_.getSystem().isConnected()?e.getFormWrapper():_,L=ye.getValue(k),R=Ut(n,B=>B.get());return{...L,...R}},setData:_=>{o(k=>{const L=S.getData(),R=Wn(L,_),B=Dq(e,R),q=e.getFormWrapper();ye.setValue(q,B),un(n,(V,re)=>{wt(R,re)&&V.set(R[re])})})},setEnabled:(_,k)=>{UA(e,_).each(k?Ne.enable:Ne.disable)},focus:_=>{UA(e,_).each(Ve.focus)},block:_=>{if(!Ee(_))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o(k=>{Be(k,Nb,{message:_})})},unblock:()=>{o(_=>{jt(_,Hb)})},showTab:_=>{o(k=>{const L=e.getBody();jr.getState(L).get().exists(B=>B.isTabPanel())&&Ot.getCurrent(L).each(B=>{Yu.showTab(B,_)})})},redial:_=>{o(k=>{const L=e.getId(),R=t(_),B=Ay(R.internalDialog.buttons,n);k.getSystem().broadcastOn([`${yy}-${L}`],R),k.getSystem().broadcastOn([`${pA}-${L}`],R.internalDialog),k.getSystem().broadcastOn([`${hA}-${L}`],R.internalDialog),k.getSystem().broadcastOn([`${fA}-${L}`],{...R.internalDialog,buttons:B}),S.setData(R.initialData)})},close:()=>{o(_=>{jt(_,im)})},toggleFullscreen:e.toggleFullscreen};return S},Mq=e=>{switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},$q=(e,t,n)=>{const o=Te("dialog"),s=e.internalDialog,r=FA(s.title,o,n),a=j9({body:s.body,initialData:s.initialData},o,n),c=Ay(s.buttons),l=NA(c),d=ts(c.length!==0,zA({buttons:c},o,n)),p=Dy.initDialog(()=>k,RA(()=>S,n.shared.providers,t),n.shared.getSink),h=Mq(s.size),S=LA({id:o,header:r,body:a,footer:d,extraClasses:h,extraBehaviours:[],extraStyles:{}},e,p,n),_=(()=>{const L=()=>{const B=Mo.getBody(S);return Ot.getCurrent(B).getOr(B)},R=()=>{const B="tox-dialog--fullscreen",q=te.fromDom(S.element.dom);or(q,B)?(so(q,B),gc(q,h)):(Hr(q,h),vo(q,B))};return{getId:O(o),getRoot:O(S),getBody:()=>Mo.getBody(S),getFooter:()=>Mo.getFooter(S),getFormWrapper:L,toggleFullscreen:R}})(),k=WA(_,t.redial,l);return{dialog:S,instanceApi:k}},Iq=e=>{switch(e){case"medium":return g.some("tox-dialog--width-md");default:return g.none()}},jA=(e,t,n,o=!1)=>{const s=Te("dialog"),r=Te("dialog-label"),a=Te("dialog-content"),c=e.internalDialog,l=Iq(c.size),d=(V,re)=>g.some(re),p=Yt(Tq({title:c.title,draggable:!0},s,r,n.shared.providers)),h=Yt(W9({body:c.body,initialData:c.initialData},s,a,n,o)),b=Ay(c.buttons),S=NA(b),_=ts(b.length!==0,Yt(Aq({buttons:b},s,n))),k=Dy.initDialog(()=>q,{onBlock:V=>{Xa.block(R,(re,ee)=>{const le=p.getOpt(R).map(fe=>In(fe.element));return PA(V.message,ee,n.shared.providers,le)})},onUnblock:()=>{Xa.unblock(R)},onClose:()=>t.closeWindow()},n.shared.getSink),L="tox-dialog-inline",R=ps({dom:{tag:"div",classes:["tox-dialog",L,...l.toArray()],attributes:{role:"dialog","aria-labelledby":r}},eventOrder:{[yl()]:[jr.name(),zr.name()],[Lr()]:["execute-on-form"],[dc()]:["reflecting","execute-on-form"]},behaviours:ce([$e.config({mode:"cyclic",onEscape:V=>(jt(V,im),g.some(!0)),useTabstopAt:V=>!mm(V)&&(Bo(V)!=="button"||To(V,"disabled")!=="disabled"),firstTabstop:1}),jr.config({channel:`${yy}-${s}`,updateState:d,initialData:e}),Ve.config({}),st("execute-on-form",k.concat([bu(uc(),(V,re)=>{$e.focusIn(V)})])),Xa.config({getRoot:()=>g.some(R)}),Ze.config({}),ra.memory({})]),components:[p.asSpec(),h.asSpec(),..._.map(V=>V.asSpec()).toArray()]}),B=()=>{const V="tox-dialog--fullscreen",re=te.fromDom(R.element.dom);rS(re,[V])?(Hr(re,[V]),gc(re,[L])):(Hr(re,[L]),gc(re,[V]))},q=WA({getId:O(s),getRoot:O(R),getFooter:()=>_.map(V=>V.get(R)),getBody:()=>h.get(R),getFormWrapper:()=>{const V=h.get(R);return Ot.getCurrent(V).getOr(V)},toggleFullscreen:B},t.redial,S);return{dialog:R,instanceApi:q}};var My=tinymce.util.Tools.resolve("tinymce.util.URI");const Bq=e=>{const t=a=>{e.getSystem().isConnected()&&a(e)};return{block:a=>{if(!Ee(a))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(c=>{Be(c,Nb,{message:a})})},unblock:()=>{t(a=>{jt(a,Hb)})},close:()=>{t(a=>{jt(a,im)})},sendMessage:a=>{t(c=>{c.getSystem().broadcastOn([bA],a)})}}},Fq=["insertContent","setContent","execCommand","close","block","unblock"],GA=e=>rt(e)&&Fq.indexOf(e.mceAction)!==-1,Pq=e=>!GA(e)&&rt(e)&&wt(e,"mceAction"),Rq=(e,t,n)=>{switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":const o=nn(n.ui)?n.ui:!1;e.execCommand(n.cmd,o,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock();break}},Lq=(e,t,n,o)=>{const s=Te("dialog"),r=FA(e.title,s,o),a=G9(e),c=e.buttons.bind(B=>B.length===0?g.none():g.some(zA({buttons:B},s,o))),l=Dy.initUrlDialog(()=>R,RA(()=>L,o.shared.providers,t)),d={...e.height.fold(()=>({}),B=>({height:B+"px","max-height":B+"px"})),...e.width.fold(()=>({}),B=>({width:B+"px","max-width":B+"px"}))},p=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],h=new My(e.url,{base_uri:new My(window.location.href)}),b=`${h.protocol}://${h.host}${h.port?":"+h.port:""}`,S=wu(),_=[st("messages",[Pn(()=>{const B=zs(te.fromDom(window),"message",q=>{if(h.isSameOrigin(new My(q.raw.origin))){const V=q.raw.data;GA(V)?Rq(n,R,V):Pq(V)&&e.onMessage(R,V)}});S.set(B)}),mc(S.clear)]),zr.config({channels:{[bA]:{onReceive:(B,q)=>{fo(B.element,"iframe").each(V=>{const re=V.dom.contentWindow;Ye(re)&&re.postMessage(q,b)})}}}})],L=LA({id:s,header:r,body:a,footer:c,extraClasses:p,extraBehaviours:_,extraStyles:d},e,l,o),R=Bq(L);return{dialog:L,instanceApi:R}},Nq=e=>{const t=e.shared;return{open:(o,s)=>{const r=()=>{Mo.hide(d),s()},a=Yt(gp({name:"close-alert",text:"OK",primary:!0,buttonType:g.some("primary"),align:"end",enabled:!0,icon:g.none()},"cancel",e)),c=EA(),l=kA(r,t.providers),d=ps(Ey({lazySink:()=>t.getSink(),header:OA(c,l),body:AA(o,t.providers),footer:g.some(DA(MA([],[a.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Z(Fi,r)],eventOrder:{}}));Mo.show(d);const p=a.get(d);Ve.focus(p)}}},Hq=e=>{const t=e.shared;return{open:(o,s)=>{const r=b=>{Mo.hide(p),s(b)},a=Yt(gp({name:"yes",text:"Yes",primary:!0,buttonType:g.some("primary"),align:"end",enabled:!0,icon:g.none()},"submit",e)),c=gp({name:"no",text:"No",primary:!1,buttonType:g.some("secondary"),align:"end",enabled:!0,icon:g.none()},"cancel",e),l=EA(),d=kA(()=>r(!1),t.providers),p=ps(Ey({lazySink:()=>t.getSink(),header:OA(l,d),body:AA(o,t.providers),footer:g.some(DA(MA([],[c,a.asSpec()]))),onEscape:()=>r(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Z(Fi,()=>r(!1)),Z(lm,()=>r(!0))],eventOrder:{}}));Mo.show(p);const h=a.get(p);Ve.focus(h)}}},qA=(e,t)=>Jr(jn("data",t,e)),KA=e=>rm(e,".tox-alert-dialog")||rm(e,".tox-confirm-dialog"),Vq=(e,t,n)=>t&&n?[]:[ro.config({contextual:{lazyContext:()=>g.some(f(te.fromDom(e.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:o=>Rl(e,o.element).map(r=>({bounds:Nu(r),optScrollEnv:g.some({currentScrollTop:r.element.dom.scrollTop,scrollElmTop:Rs(r.element).top})})).getOrThunk(()=>({bounds:oe(),optScrollEnv:g.none()}))})],zq=e=>{const t=e.editor,n=qd(t),o=Nq(e.backstages.dialog),s=Hq(e.backstages.dialog),r=(_,k,L)=>{if(!pt(k)){if(k.inline==="toolbar")return d(_,e.backstages.popup.shared.anchors.inlineDialog(),L,k);if(k.inline==="bottom")return p(_,e.backstages.popup.shared.anchors.inlineBottomDialog(),L,k);if(k.inline==="cursor")return d(_,e.backstages.popup.shared.anchors.cursor(),L,k)}return l(_,L)},a=(_,k)=>c(_,k),c=(_,k)=>{const L=R=>{const B=Lq(R,{closeWindow:()=>{Mo.hide(B.dialog),k(B.instanceApi)}},t,e.backstages.dialog);return Mo.show(B.dialog),B.instanceApi};return ql.openUrl(L,_)},l=(_,k)=>{const L=(R,B,q)=>{const V=B,ee=$q({dataValidator:q,initialData:V,internalDialog:R},{redial:ql.redial,closeWindow:()=>{Mo.hide(ee.dialog),k(ee.instanceApi)}},e.backstages.dialog);return Mo.show(ee.dialog),ee.instanceApi.setData(V),ee.instanceApi};return ql.open(L,_)},d=(_,k,L,R)=>{const B=(q,V,re)=>{const ee=qA(V,re),le=Mn(),fe=e.backstages.popup.shared.header.isPositionedAtTop(),dt={dataValidator:re,initialData:ee,internalDialog:q},_e=()=>le.on(De=>{Nn.reposition(De),ro.refresh(De)}),Ke=jA(dt,{redial:ql.redial,closeWindow:()=>{le.on(Nn.hide),t.off("ResizeEditor",_e),le.clear(),L(Ke.instanceApi)}},e.backstages.popup,R.ariaAttrs),Ue=ps(Nn.sketch({lazySink:e.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:R.persistent?{event:"doNotDismissYet"}:{},...fe?{}:{fireRepositionEventInstead:{}},inlineBehaviours:ce([st("window-manager-inline-events",[Z(Sl(),(De,yt)=>{jt(Ke.dialog,Fi)})]),...Vq(t,n,fe)]),isExtraPart:(De,yt)=>KA(yt)}));le.set(Ue);const Ct=()=>{const De=t.inline?sn():te.fromDom(t.getContainer()),yt=f(De);return g.some(yt)};return Nn.showWithinBounds(Ue,Qr(Ke.dialog),{anchor:k},Ct),(!n||!fe)&&(ro.refresh(Ue),t.on("ResizeEditor",_e)),Ke.instanceApi.setData(ee),$e.focusIn(Ke.dialog),Ke.instanceApi};return ql.open(B,_)},p=(_,k,L,R)=>{const B=(q,V,re)=>{const ee=qA(V,re),le=Mn(),fe=e.backstages.popup.shared.header.isPositionedAtTop(),dt={dataValidator:re,initialData:ee,internalDialog:q},_e=()=>le.on(De=>{Nn.reposition(De),ro.refresh(De)}),Ke=jA(dt,{redial:ql.redial,closeWindow:()=>{le.on(Nn.hide),t.off("ResizeEditor ScrollWindow ElementScroll",_e),le.clear(),L(Ke.instanceApi)}},e.backstages.popup,R.ariaAttrs),Ue=ps(Nn.sketch({lazySink:e.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:R.persistent?{event:"doNotDismissYet"}:{},...fe?{}:{fireRepositionEventInstead:{}},inlineBehaviours:ce([st("window-manager-inline-events",[Z(Sl(),(De,yt)=>{jt(Ke.dialog,Fi)})]),ro.config({contextual:{lazyContext:()=>g.some(f(te.fromDom(t.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top","bottom"],lazyViewport:De=>Rl(t,De.element).map(de=>({bounds:Nu(de),optScrollEnv:g.some({currentScrollTop:de.element.dom.scrollTop,scrollElmTop:Rs(de.element).top})})).getOrThunk(()=>({bounds:oe(),optScrollEnv:g.none()}))})]),isExtraPart:(De,yt)=>KA(yt)}));le.set(Ue);const Ct=()=>e.backstages.popup.shared.getSink().toOptional().bind(De=>{const yt=Rl(t,De.element),de=15,Ce=yt.map(Fe=>Nu(Fe)).getOr(oe()),ze=f(te.fromDom(t.getContentAreaContainer())),gt=D(ze,Ce);return g.some(m(gt.x,gt.y,gt.width,gt.height-de))});return Nn.showWithinBounds(Ue,Qr(Ke.dialog),{anchor:k},Ct),ro.refresh(Ue),t.on("ResizeEditor ScrollWindow ElementScroll",_e),Ke.instanceApi.setData(ee),$e.focusIn(Ke.dialog),Ke.instanceApi};return ql.open(B,_)};return{open:r,openUrl:a,alert:(_,k)=>{o.open(_,k)},close:_=>{_.close()},confirm:(_,k)=>{s.open(_,k)}}},Uq=e=>{eC(e),QR(e),BG(e)};var Wq=()=>{Je.add("silver",e=>{Uq(e);let t=()=>oe();const{dialogs:n,popups:o,renderUI:s}=U5(e,{getPopupSinkBounds:()=>t()}),r=async()=>{const l=await s();return Rl(e,o.getMothership().element).each(p=>{t=()=>Nu(p)}),l};eN.register(e,o.backstage.shared);const a=zq({editor:e,backstages:{popup:o.backstage,dialog:n.backstage}}),c=()=>YF(e,{backstage:o.backstage},o.getMothership());return{renderUI:r,getWindowManagerImpl:O(a),getNotificationManagerImpl:c}})};Wq()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(Ee,rt)=>{Ee.focus(),Ee.undoManager.transact(()=>{Ee.setContent(rt)}),Ee.selection.setCursorLocation(),Ee.nodeChanged()},bo=Ee=>Ee.getContent({source_view:!0}),cn=Ee=>{const rt=bo(Ee);Ee.windowManager.open({title:"Source Code",size:"large",body:{type:"panel",items:[{type:"textarea",name:"code"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{code:rt},onSubmit:Nt=>{eo(Ee,Nt.getData().code),Nt.close()}})},_n=Ee=>{Ee.addCommand("mceCodeEditor",()=>{cn(Ee)})},Hn=Ee=>{const rt=()=>Ee.execCommand("mceCodeEditor");Ee.ui.registry.addButton("code",{icon:"sourcecode",tooltip:"Source code",onAction:rt}),Ee.ui.registry.addMenuItem("code",{icon:"sourcecode",text:"Source code",onAction:rt})};var Sn=()=>{$o.add("code",Ee=>(_n(Ee),Hn(Ee),{}))};Sn()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=Object.getPrototypeOf,bo=(v,C,A)=>{var H;return A(v,C.prototype)?!0:((H=v.constructor)===null||H===void 0?void 0:H.name)===C.name},cn=v=>{const C=typeof v;return v===null?"null":C==="object"&&Array.isArray(v)?"array":C==="object"&&bo(v,String,(A,H)=>H.isPrototypeOf(A))?"string":C},_n=v=>C=>cn(C)===v,Hn=v=>C=>typeof C===v,Sn=v=>C=>v===C,Ee=(v,C)=>Nt(v)&&bo(v,C,(A,H)=>eo(A)===H),rt=_n("string"),Nt=_n("object"),ut=v=>Ee(v,Object),ln=_n("array"),nn=Sn(null),pt=Hn("boolean"),Ge=v=>v==null,Ye=v=>!Ge(v),qe=Hn("function"),ht=Hn("number"),ie=(v,C)=>{if(ln(v)){for(let A=0,H=v.length;A<H;++A)if(!C(v[A]))return!1;return!0}return!1},Q=()=>{};class kt{constructor(C,A){this.tag=C,this.value=A}static some(C){return new kt(!0,C)}static none(){return kt.singletonNone}fold(C,A){return this.tag?A(this.value):C()}isSome(){return this.tag}isNone(){return!this.tag}map(C){return this.tag?kt.some(C(this.value)):kt.none()}bind(C){return this.tag?C(this.value):kt.none()}exists(C){return this.tag&&C(this.value)}forall(C){return!this.tag||C(this.value)}filter(C){return!this.tag||C(this.value)?this:kt.none()}getOr(C){return this.tag?this.value:C}or(C){return this.tag?this:C}getOrThunk(C){return this.tag?this.value:C()}orThunk(C){return this.tag?this:C()}getOrDie(C){if(this.tag)return this.value;throw new Error(C??"Called getOrDie on None")}static from(C){return Ye(C)?kt.some(C):kt.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(C){this.tag&&C(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}kt.singletonNone=new kt(!1);const to=Object.keys,Kn=Object.hasOwnProperty,O=(v,C)=>{const A=to(v);for(let H=0,ve=A.length;H<ve;H++){const pe=A[H],dn=v[pe];C(dn,pe)}},Xe=v=>(C,A)=>{v[A]=C},Gt=(v,C,A,H)=>{O(v,(ve,pe)=>{(C(ve,pe)?A:H)(ve,pe)})},Et=(v,C)=>{const A={};return Gt(v,C,Xe(A),Q),A},Vn=(v,C)=>Kn.call(v,C),Jo=(v,C)=>Vn(v,C)&&v[C]!==void 0&&v[C]!==null,Yn=Array.prototype.push,ne=v=>{const C=[];for(let A=0,H=v.length;A<H;++A){if(!ln(v[A]))throw new Error("Arr.flatten item "+A+" was not an array, input: "+v);Yn.apply(C,v[A])}return C},ge=(v,C)=>C>=0&&C<v.length?kt.some(v[C]):kt.none(),g=v=>ge(v,0),St=(v,C)=>{for(let A=0;A<v.length;A++){const H=C(v[A],A);if(H.isSome())return H}return kt.none()};typeof window<"u"||Function("return this;")();const qt=(v,C,A)=>{if(rt(A)||pt(A)||ht(A))v.setAttribute(C,A+"");else throw console.error("Invalid call to Attribute.set. Key ",C,":: Value ",A,":: Element ",v),new Error("Attribute value was not simple")},rn=(v,C,A)=>{qt(v.dom,C,A)},Xn=(v,C)=>{v.dom.removeAttribute(C)},Jn=(v,C)=>{const H=(C||document).createElement("div");if(H.innerHTML=v,!H.hasChildNodes()||H.childNodes.length>1){const ve="HTML does not have a single root node";throw console.error(ve,v),new Error(ve)}return gn(H.childNodes[0])},Tt=(v,C)=>{const H=(C||document).createElement(v);return gn(H)},Rn=(v,C)=>{const H=(C||document).createTextNode(v);return gn(H)},gn=v=>{if(v==null)throw new Error("Node cannot be null or undefined");return{dom:v}},ae={fromHtml:Jn,fromTag:Tt,fromText:Rn,fromDom:gn,fromPoint:(v,C,A)=>kt.from(v.dom.elementFromPoint(C,A)).map(gn)};var be=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),kn=tinymce.util.Tools.resolve("tinymce.util.URI");const he=v=>v.length>0,Y=v=>C=>C.options.get(v),Ae=v=>{const C=v.options.register;C("image_dimensions",{processor:"boolean",default:!0}),C("image_advtab",{processor:"boolean",default:!1}),C("image_uploadtab",{processor:"boolean",default:!0}),C("image_prepend_url",{processor:"string",default:""}),C("image_class_list",{processor:"object[]"}),C("image_description",{processor:"boolean",default:!0}),C("image_title",{processor:"boolean",default:!1}),C("image_caption",{processor:"boolean",default:!1}),C("image_list",{processor:A=>{const H=A===!1||rt(A)||ie(A,Nt)||qe(A);return H?{value:A,valid:H}:{valid:!1,message:"Must be false, a string, an array or a function."}},default:!1})},me=Y("image_dimensions"),zt=Y("image_advtab"),lt=Y("image_uploadtab"),en=Y("image_prepend_url"),xt=Y("image_class_list"),At=Y("image_description"),yo=Y("image_title"),Zo=Y("image_caption"),Qo=Y("image_list"),cr=Y("a11y_advanced_options"),X=Y("automatic_uploads"),K=v=>he(v.options.get("images_upload_url")),we=v=>Ye(v.options.get("images_upload_handler")),He=(v,C)=>Math.max(parseInt(v,10),parseInt(C,10)),Pt=v=>new Promise(C=>{const A=document.createElement("img"),H=pe=>{A.onload=A.onerror=null,A.parentNode&&A.parentNode.removeChild(A),C(pe)};A.onload=()=>{const pe=He(A.width,A.clientWidth),dn=He(A.height,A.clientHeight),_o={width:pe,height:dn};H(Promise.resolve(_o))},A.onerror=()=>{H(Promise.reject(`Failed to get image dimensions for: ${v}`))};const ve=A.style;ve.visibility="hidden",ve.position="fixed",ve.bottom=ve.left="0px",ve.width=ve.height="auto",document.body.appendChild(A),A.src=v}),Rt=v=>(v&&(v=v.replace(/px$/,"")),v),on=v=>(v.length>0&&/^[0-9]+$/.test(v)&&(v+="px"),v),Lt=v=>{if(v.margin){const C=String(v.margin).split(" ");switch(C.length){case 1:v["margin-top"]=v["margin-top"]||C[0],v["margin-right"]=v["margin-right"]||C[0],v["margin-bottom"]=v["margin-bottom"]||C[0],v["margin-left"]=v["margin-left"]||C[0];break;case 2:v["margin-top"]=v["margin-top"]||C[0],v["margin-right"]=v["margin-right"]||C[1],v["margin-bottom"]=v["margin-bottom"]||C[0],v["margin-left"]=v["margin-left"]||C[1];break;case 3:v["margin-top"]=v["margin-top"]||C[0],v["margin-right"]=v["margin-right"]||C[1],v["margin-bottom"]=v["margin-bottom"]||C[2],v["margin-left"]=v["margin-left"]||C[1];break;case 4:v["margin-top"]=v["margin-top"]||C[0],v["margin-right"]=v["margin-right"]||C[1],v["margin-bottom"]=v["margin-bottom"]||C[2],v["margin-left"]=v["margin-left"]||C[3]}delete v.margin}return v},bs=(v,C)=>{const A=Qo(v);rt(A)?fetch(A).then(H=>{H.ok&&H.json().then(C)}):qe(A)?A(C):C(A)},un=(v,C,A)=>{const H=()=>{A.onload=A.onerror=null,v.selection&&(v.selection.select(A),v.nodeChanged())};A.onload=()=>{!C.width&&!C.height&&me(v)&&v.dom.setAttribs(A,{width:String(A.clientWidth),height:String(A.clientHeight)}),H()},A.onerror=H},Ut=v=>new Promise((C,A)=>{const H=new FileReader;H.onload=()=>{C(H.result)},H.onerror=()=>{var ve;A((ve=H.error)===null||ve===void 0?void 0:ve.message)},H.readAsDataURL(v)}),Ht=v=>v.nodeName==="IMG"&&(v.hasAttribute("data-mce-object")||v.hasAttribute("data-mce-placeholder")),We=(v,C)=>{const A=v.options.get;return kn.isDomSafe(C,"img",{allow_html_data_urls:A("allow_html_data_urls"),allow_script_urls:A("allow_script_urls"),allow_svg_data_urls:A("allow_svg_data_urls")})},ft=be.DOM,uo=v=>v.style.marginLeft&&v.style.marginRight&&v.style.marginLeft===v.style.marginRight?Rt(v.style.marginLeft):"",co=v=>v.style.marginTop&&v.style.marginBottom&&v.style.marginTop===v.style.marginBottom?Rt(v.style.marginTop):"",Ln=v=>v.style.borderWidth?Rt(v.style.borderWidth):"",pn=(v,C)=>{var A;return v.hasAttribute(C)&&(A=v.getAttribute(C))!==null&&A!==void 0?A:""},_s=v=>v.parentNode!==null&&v.parentNode.nodeName==="FIGURE",Se=(v,C,A)=>{A===""||A===null?v.removeAttribute(C):v.setAttribute(C,A)},wt=v=>{const C=ft.create("figure",{class:"image"});ft.insertAfter(C,v),C.appendChild(v),C.appendChild(ft.create("figcaption",{contentEditable:"true"},"Caption")),C.contentEditable="false"},io=v=>{const C=v.parentNode;Ye(C)&&(ft.insertAfter(v,C),ft.remove(C))},Io=v=>{_s(v)?io(v):wt(v)},Os=(v,C)=>{const A=v.getAttribute("style"),H=C(A!==null?A:"");H.length>0?(v.setAttribute("style",H),v.setAttribute("data-mce-style",H)):v.removeAttribute("style")},es=(v,C)=>(A,H,ve)=>{const pe=A.style;pe[H]?(pe[H]=on(ve),Os(A,C)):Se(A,H,ve)},ca=(v,C)=>v.style[C]?Rt(v.style[C]):pn(v,C),qs=(v,C)=>{const A=on(C);v.style.marginLeft=A,v.style.marginRight=A},ls=(v,C)=>{const A=on(C);v.style.marginTop=A,v.style.marginBottom=A},ir=(v,C)=>{const A=on(C);v.style.borderWidth=A},ts=(v,C)=>{v.style.borderStyle=C},lr=v=>{var C;return(C=v.style.borderStyle)!==null&&C!==void 0?C:""},ur=v=>Ye(v)&&v.nodeName==="FIGURE",ks=v=>v.nodeName==="IMG",Es=v=>ft.getAttrib(v,"alt").length===0&&ft.getAttrib(v,"role")==="presentation",So=v=>Es(v)?"":pn(v,"alt"),no=()=>({src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}),Ks=(v,C)=>{var A;const H=document.createElement("img");return Se(H,"style",C.style),(uo(H)||C.hspace!=="")&&qs(H,C.hspace),(co(H)||C.vspace!=="")&&ls(H,C.vspace),(Ln(H)||C.border!=="")&&ir(H,C.border),(lr(H)||C.borderStyle!=="")&&ts(H,C.borderStyle),v((A=H.getAttribute("style"))!==null&&A!==void 0?A:"")},xo=(v,C)=>{const A=document.createElement("img");if(U(v,{...C,caption:!1},A),_r(A,C.alt,C.isDecorative),C.caption){const H=ft.create("figure",{class:"image"});return H.appendChild(A),H.appendChild(ft.create("figcaption",{contentEditable:"true"},"Caption")),H.contentEditable="false",H}else return A},Ys=(v,C)=>({src:pn(C,"src"),alt:So(C),title:pn(C,"title"),width:ca(C,"width"),height:ca(C,"height"),class:pn(C,"class"),style:v(pn(C,"style")),caption:_s(C),hspace:uo(C),vspace:co(C),border:Ln(C),borderStyle:lr(C),isDecorative:Es(C)}),$n=(v,C,A,H,ve)=>{A[H]!==C[H]&&ve(v,H,String(A[H]))},_r=(v,C,A)=>{if(A){ft.setAttrib(v,"role","presentation");const H=ae.fromDom(v);rn(H,"alt","")}else{if(nn(C)){const H=ae.fromDom(v);Xn(H,"alt")}else{const H=ae.fromDom(v);rn(H,"alt",C)}ft.getAttrib(v,"role")==="presentation"&&ft.setAttrib(v,"role","")}},M=(v,C,A)=>{(A.alt!==C.alt||A.isDecorative!==C.isDecorative)&&_r(v,A.alt,A.isDecorative)},E=(v,C)=>(A,H,ve)=>{v(A,ve),Os(A,C)},U=(v,C,A)=>{const H=Ys(v,A);$n(A,H,C,"caption",(ve,pe,dn)=>Io(ve)),$n(A,H,C,"src",Se),$n(A,H,C,"title",Se),$n(A,H,C,"width",es("width",v)),$n(A,H,C,"height",es("height",v)),$n(A,H,C,"class",Se),$n(A,H,C,"style",E((ve,pe)=>Se(ve,"style",pe),v)),$n(A,H,C,"hspace",E(qs,v)),$n(A,H,C,"vspace",E(ls,v)),$n(A,H,C,"border",E(ir,v)),$n(A,H,C,"borderStyle",E(ts,v)),M(A,H,C)},W=(v,C)=>{const A=v.dom.styles.parse(C),H=Lt(A),ve=v.dom.styles.parse(v.dom.styles.serialize(H));return v.dom.styles.serialize(ve)},ke=v=>{const C=v.selection.getNode(),A=v.dom.getParent(C,"figure.image");return A?v.dom.select("img",A)[0]:C&&(C.nodeName!=="IMG"||Ht(C))?null:C},Pe=(v,C)=>{var A;const H=v.dom,ve=Et(v.schema.getTextBlockElements(),(dn,_o)=>!v.schema.isValidChild(_o,"figure")),pe=H.getParent(C.parentNode,dn=>Jo(ve,dn.nodeName),v.getBody());return pe&&(A=H.split(pe,C))!==null&&A!==void 0?A:C},at=v=>{const C=ke(v);return C?Ys(A=>W(v,A),C):no()},te=(v,C)=>{const A=xo(ve=>W(v,ve),C);v.dom.setAttrib(A,"data-mce-id","__mcenew"),v.focus(),v.selection.setContent(A.outerHTML);const H=v.dom.select('*[data-mce-id="__mcenew"]')[0];if(v.dom.setAttrib(H,"data-mce-id",null),ur(H)){const ve=Pe(v,H);v.selection.select(ve)}else v.selection.select(H)},It=(v,C)=>{v.dom.setAttrib(C,"src",C.getAttribute("src"))},bt=(v,C)=>{if(C){const A=v.dom.is(C.parentNode,"figure.image")?C.parentNode:C;v.dom.remove(A),v.focus(),v.nodeChanged(),v.dom.isEmpty(v.getBody())&&(v.setContent(""),v.selection.setCursorLocation())}},Cn=(v,C)=>{const A=ke(v);if(A)if(U(H=>W(v,H),C,A),It(v,A),ur(A.parentNode)){const H=A.parentNode;Pe(v,H),v.selection.select(A.parentNode)}else v.selection.select(A),un(v,C,A)},zn=(v,C)=>{const A=C.src;return{...C,src:We(v,A)?A:""}},wo=(v,C)=>{const A=ke(v);if(A){const ve={...Ys(dn=>W(v,dn),A),...C},pe=zn(v,ve);ve.src?Cn(v,pe):bt(v,A)}else C.src&&te(v,{...no(),...C})},mo=(v=>(...C)=>{if(C.length===0)throw new Error("Can't merge zero objects");const A={};for(let H=0;H<C.length;H++){const ve=C[H];for(const pe in ve)Vn(ve,pe)&&(A[pe]=v(A[pe],ve[pe]))}return A})((v,C)=>ut(v)&&ut(C)?mo(v,C):C);var kr=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),hn=tinymce.util.Tools.resolve("tinymce.util.Tools");const fn=v=>rt(v.value)?v.value:"",As=v=>rt(v.text)?v.text:rt(v.title)?v.title:"",Bo=(v,C)=>{const A=[];return hn.each(v,H=>{const ve=As(H);if(H.menu!==void 0){const pe=Bo(H.menu,C);A.push({text:ve,items:pe})}else{const pe=C(H);A.push({text:ve,value:pe})}}),A},Er=(v=fn)=>C=>C?kt.from(C).map(A=>Bo(A,v)):kt.none(),dr=v=>Er(fn)(v),ia=v=>Vn(v,"items"),Co=(v,C)=>St(v,A=>ia(A)?Co(A.items,C):A.value===C?kt.some(A):kt.none()),Ds={sanitizer:Er,sanitize:dr,findEntry:(v,C)=>v.bind(A=>Co(A,C))},Ar={makeTab:v=>({title:"Advanced",name:"advanced",items:[{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]})},Uo=v=>{const C=Ds.sanitizer(Ps=>v.convertURL(Ps.value||Ps.url||"","src")),A=new Promise(Ps=>{bs(v,In=>{Ps(C(In).map(Yr=>ne([[{text:"None",value:""}],Yr])))})}),H=Ds.sanitize(xt(v)),ve=zt(v),pe=lt(v),dn=K(v),_o=we(v),Un=at(v),Dr=At(v),xn=yo(v),ga=me(v),nc=Zo(v),Qt=cr(v),pa=X(v),Dc=kt.some(en(v)).filter(Ps=>rt(Ps)&&Ps.length>0);return A.then(Ps=>({image:Un,imageList:Ps,classList:H,hasAdvTab:ve,hasUploadTab:pe,hasUploadUrl:dn,hasUploadHandler:_o,hasDescription:Dr,hasImageTitle:xn,hasDimensions:ga,hasImageCaption:nc,prependURL:Dc,hasAccessibilityOptions:Qt,automaticUploads:pa}))},la=v=>{const C={name:"src",type:"urlinput",filetype:"image",label:"Source"},A=v.imageList.map(xn=>({name:"images",type:"listbox",label:"Image list",items:xn})),H={name:"alt",type:"input",label:"Alternative description",enabled:!(v.hasAccessibilityOptions&&v.image.isDecorative)},ve={name:"title",type:"input",label:"Image title"},pe={name:"dimensions",type:"sizeinput"},dn={type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]},_o=v.classList.map(xn=>({name:"classes",type:"listbox",label:"Class",items:xn})),Un={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]},Dr=xn=>xn?{type:"grid",columns:2}:{type:"panel"};return ne([[C],A.toArray(),v.hasAccessibilityOptions&&v.hasDescription?[dn]:[],v.hasDescription?[H]:[],v.hasImageTitle?[ve]:[],v.hasDimensions?[pe]:[],[{...Dr(v.classList.isSome()&&v.hasImageCaption),items:ne([_o.toArray(),v.hasImageCaption?[Un]:[]])}]])},ua={makeTab:v=>({title:"General",name:"general",items:la(v)}),makeItems:la},Ms={makeTab:v=>({title:"Upload",name:"upload",items:[{type:"dropzone",name:"fileinput"}]})},ns=v=>({prevImage:Ds.findEntry(v.imageList,v.image.src),prevAlt:v.image.alt,open:!0}),$s=v=>({src:{value:v.src,meta:{}},images:v.src,alt:v.alt,title:v.title,dimensions:{width:v.width,height:v.height},classes:v.class,caption:v.caption,style:v.style,vspace:v.vspace,border:v.border,hspace:v.hspace,borderstyle:v.borderStyle,fileinput:[],isDecorative:v.isDecorative}),da=(v,C)=>({src:v.src.value,alt:(v.alt===null||v.alt.length===0)&&C?null:v.alt,title:v.title,width:v.dimensions.width,height:v.dimensions.height,class:v.classes,style:v.style,caption:v.caption,hspace:v.hspace,vspace:v.vspace,border:v.border,borderStyle:v.borderstyle,isDecorative:v.isDecorative}),us=(v,C)=>/^(?:[a-zA-Z]+:)?\/\//.test(C)?kt.none():v.prependURL.bind(A=>C.substring(0,A.length)!==A?kt.some(A+C):kt.none()),Wo=(v,C)=>{const A=C.getData();us(v,A.src.value).each(H=>{C.setData({src:{value:H,meta:A.src.meta}})})},Is=(v,C,A)=>{v.hasDescription&&rt(A.alt)&&(C.alt=A.alt),v.hasAccessibilityOptions&&(C.isDecorative=A.isDecorative||C.isDecorative||!1),v.hasImageTitle&&rt(A.title)&&(C.title=A.title),v.hasDimensions&&(rt(A.width)&&(C.dimensions.width=A.width),rt(A.height)&&(C.dimensions.height=A.height)),rt(A.class)&&Ds.findEntry(v.classList,A.class).each(H=>{C.classes=H.value}),v.hasImageCaption&&pt(A.caption)&&(C.caption=A.caption),v.hasAdvTab&&(rt(A.style)&&(C.style=A.style),rt(A.vspace)&&(C.vspace=A.vspace),rt(A.border)&&(C.border=A.border),rt(A.hspace)&&(C.hspace=A.hspace),rt(A.borderstyle)&&(C.borderstyle=A.borderstyle))},ni=(v,C)=>{const A=C.getData(),H=A.src.meta;if(H!==void 0){const ve=mo({},A);Is(v,ve,H),C.setData(ve)}},Fa=(v,C,A,H)=>{const ve=H.getData(),pe=ve.src.value,dn=ve.src.meta||{};!dn.width&&!dn.height&&C.hasDimensions&&(he(pe)?v.imageSize(pe).then(_o=>{A.open&&H.setData({dimensions:_o})}).catch(_o=>console.error(_o)):H.setData({dimensions:{width:"",height:""}}))},ma=(v,C,A)=>{const H=A.getData(),ve=Ds.findEntry(v.imageList,H.src.value);C.prevImage=ve,A.setData({images:ve.map(pe=>pe.value).getOr("")})},jo=(v,C,A,H)=>{Wo(C,H),ni(C,H),Fa(v,C,A,H),ma(C,A,H)},Bs=(v,C,A,H)=>{const ve=H.getData(),pe=Ds.findEntry(C.imageList,ve.images);pe.each(dn=>{ve.alt===""||A.prevImage.map(Un=>Un.text===ve.alt).getOr(!1)?dn.value===""?H.setData({src:dn,alt:A.prevAlt}):H.setData({src:dn,alt:dn.text}):H.setData({src:dn})}),A.prevImage=pe,jo(v,C,A,H)},tc=(v,C,A,H)=>{const ve=H.getData();H.block("Uploading image"),g(ve.fileinput).fold(()=>{H.unblock()},pe=>{const dn=URL.createObjectURL(pe),_o=()=>{H.unblock(),URL.revokeObjectURL(dn)},Un=Dr=>{H.setData({src:{value:Dr,meta:{}}}),H.showTab("general"),jo(v,C,A,H)};Ut(pe).then(Dr=>{const xn=v.createBlobCache(pe,dn,Dr);C.automaticUploads?v.uploadImage(xn).then(ga=>{Un(ga.url),_o()}).catch(ga=>{_o(),v.alertErr(ga)}):(v.addToBlobCache(xn),Un(xn.blobUri()),H.unblock())})})},Fs=(v,C,A)=>(H,ve)=>{ve.name==="src"?jo(v,C,A,H):ve.name==="images"?Bs(v,C,A,H):ve.name==="alt"?A.prevAlt=H.getData().alt:ve.name==="fileinput"?tc(v,C,A,H):ve.name==="isDecorative"&&H.setEnabled("alt",!H.getData().isDecorative)},Pa=v=>()=>{v.open=!1},Ra=v=>v.hasAdvTab||v.hasUploadUrl||v.hasUploadHandler?{type:"tabpanel",tabs:ne([[ua.makeTab(v)],v.hasAdvTab?[Ar.makeTab(v)]:[],v.hasUploadTab&&(v.hasUploadUrl||v.hasUploadHandler)?[Ms.makeTab(v)]:[]])}:{type:"panel",items:ua.makeItems(v)},w=(v,C,A)=>H=>{const ve=mo($s(C.image),H.getData()),pe={...ve,style:Ks(A.normalizeCss,da(ve,!1))};v.execCommand("mceUpdateImage",!1,da(pe,C.hasAccessibilityOptions)),v.editorUpload.uploadImagesAuto(),H.close()},$=v=>C=>We(v,C)?Pt(v.documentBaseURI.toAbsolute(C)).then(A=>({width:String(A.width),height:String(A.height)})):Promise.resolve({width:"",height:""}),P=v=>(C,A,H)=>{var ve;return v.editorUpload.blobCache.create({blob:C,blobUri:A,name:(ve=C.name)===null||ve===void 0?void 0:ve.replace(/\.[^\.]+$/,""),filename:C.name,base64:H.split(",")[1]})},j=v=>C=>{v.editorUpload.blobCache.add(C)},ue=v=>C=>{v.windowManager.alert(C)},Ie=v=>C=>W(v,C),Jt=v=>C=>v.dom.parseStyle(C),Zn=v=>(C,A)=>v.dom.serializeStyle(C,A),Kt=v=>C=>kr(v).upload([C],!1).then(A=>{var H;return A.length===0?Promise.reject("Failed to upload image"):A[0].status===!1?Promise.reject((H=A[0].error)===null||H===void 0?void 0:H.message):A[0]}),Zt=v=>{const C={imageSize:$(v),addToBlobCache:j(v),createBlobCache:P(v),alertErr:ue(v),normalizeCss:Ie(v),parseStyle:Jt(v),serializeStyle:Zn(v),uploadImage:Kt(v)};return{open:()=>{Uo(v).then(H=>{const ve=ns(H);return{title:"Insert/Edit Image",size:"normal",body:Ra(H),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:$s(H.image),onSubmit:w(v,H,C),onChange:Fs(C,H,ve),onClose:Pa(ve)}}).then(v.windowManager.open)}}},sn=v=>{v.addCommand("mceImage",Zt(v).open),v.addCommand("mceUpdateImage",(C,A)=>{v.undoManager.transact(()=>wo(v,A))})},mr=v=>{const C=v.attr("class");return Ye(C)&&/\bimage\b/.test(C)},La=v=>C=>{let A=C.length;const H=ve=>{ve.attr("contenteditable",v?"true":null)};for(;A--;){const ve=C[A];mr(ve)&&(ve.attr("contenteditable",v?"false":null),hn.each(ve.getAll("figcaption"),H))}},Qe=v=>{v.on("PreInit",()=>{v.parser.addNodeFilter("figure",La(!0)),v.serializer.addNodeFilter("figure",La(!1))})},Ac=v=>C=>{const A=()=>{C.setEnabled(v.selection.isEditable())};return v.on("NodeChange",A),A(),()=>{v.off("NodeChange",A)}},To=v=>{v.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:Zt(v).open,onSetup:C=>{C.setActive(Ye(ke(v)));const A=v.selection.selectorChangedWithUnbind("img:not([data-mce-object]):not([data-mce-placeholder]),figure.image",C.setActive).unbind,H=Ac(v)(C);return()=>{A(),H()}}}),v.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:Zt(v).open,onSetup:Ac(v)}),v.ui.registry.addContextMenu("image",{update:C=>ur(C)||ks(C)&&!Ht(C)?["image"]:[]})};var Go=()=>{$o.add("image",v=>{Ae(v),Qe(v),To(v),sn(v)})};Go()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(M,E,U)=>{var W;return U(M,E.prototype)?!0:((W=M.constructor)===null||W===void 0?void 0:W.name)===E.name},bo=M=>{const E=typeof M;return M===null?"null":E==="object"&&Array.isArray(M)?"array":E==="object"&&eo(M,String,(U,W)=>W.isPrototypeOf(U))?"string":E},cn=M=>E=>bo(E)===M,_n=cn("string"),Hn=cn("object"),Sn=cn("array"),Ee=M=>M==null,rt=M=>!Ee(M);class Nt{constructor(E,U){this.tag=E,this.value=U}static some(E){return new Nt(!0,E)}static none(){return Nt.singletonNone}fold(E,U){return this.tag?U(this.value):E()}isSome(){return this.tag}isNone(){return!this.tag}map(E){return this.tag?Nt.some(E(this.value)):Nt.none()}bind(E){return this.tag?E(this.value):Nt.none()}exists(E){return this.tag&&E(this.value)}forall(E){return!this.tag||E(this.value)}filter(E){return!this.tag||E(this.value)?this:Nt.none()}getOr(E){return this.tag?this.value:E}or(E){return this.tag?this:E}getOrThunk(E){return this.tag?this.value:E()}orThunk(E){return this.tag?this:E()}getOrDie(E){if(this.tag)return this.value;throw new Error(E??"Called getOrDie on None")}static from(E){return rt(E)?Nt.some(E):Nt.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(E){this.tag&&E(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}Nt.singletonNone=new Nt(!1);const ut=Array.prototype.push,ln=(M,E)=>{for(let U=0,W=M.length;U<W;U++){const ke=M[U];E(ke,U)}},nn=M=>{const E=[];for(let U=0,W=M.length;U<W;++U){if(!Sn(M[U]))throw new Error("Arr.flatten item "+U+" was not an array, input: "+M);ut.apply(E,M[U])}return E},pt=M=>{let E=M;return{get:()=>E,set:ke=>{E=ke}}},Ge=Object.keys,Ye=Object.hasOwnProperty,qe=(M,E)=>{const U=Ge(M);for(let W=0,ke=U.length;W<ke;W++){const Pe=U[W],at=M[Pe];E(at,Pe)}},ht=(M,E)=>ie(M,E)?Nt.from(M[E]):Nt.none(),ie=(M,E)=>Ye.call(M,E),Q=M=>E=>E.options.get(M),kt=M=>{const E=M.options.register;E("audio_template_callback",{processor:"function"}),E("video_template_callback",{processor:"function"}),E("iframe_template_callback",{processor:"function"}),E("media_live_embeds",{processor:"boolean",default:!0}),E("media_filter_html",{processor:"boolean",default:!0}),E("media_url_resolver",{processor:"function"}),E("media_alt_source",{processor:"boolean",default:!0}),E("media_poster",{processor:"boolean",default:!0}),E("media_dimensions",{processor:"boolean",default:!0})},to=Q("audio_template_callback"),Kn=Q("video_template_callback"),O=Q("iframe_template_callback"),Xe=Q("media_live_embeds"),Gt=Q("media_filter_html"),Et=Q("media_url_resolver"),Vn=Q("media_alt_source"),Jo=Q("media_poster"),Yn=Q("media_dimensions");var ne=tinymce.util.Tools.resolve("tinymce.util.Tools"),ge=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),g=tinymce.util.Tools.resolve("tinymce.html.DomParser");const St=ge.DOM,qt=M=>M.replace(/px$/,""),rn=M=>{const E=M.attr("style"),U=E?St.parseStyle(E):{};return{type:"ephox-embed-iri",source:M.attr("data-ephox-embed-iri"),altsource:"",poster:"",width:ht(U,"max-width").map(qt).getOr(""),height:ht(U,"max-height").map(qt).getOr("")}},Xn=(M,E)=>{let U={};const ke=g({validate:!1,forced_root_block:!1},E).parse(M);for(let Pe=ke;Pe;Pe=Pe.walk())if(Pe.type===1){const at=Pe.name;if(Pe.attr("data-ephox-embed-iri")){U=rn(Pe);break}else!U.source&&at==="param"&&(U.source=Pe.attr("movie")),(at==="iframe"||at==="object"||at==="embed"||at==="video"||at==="audio")&&(U.type||(U.type=at),U=ne.extend(Pe.attributes.map,U)),at==="script"&&(U={type:"script",source:Pe.attr("src")}),at==="source"&&(U.source?U.altsource||(U.altsource=Pe.attr("src")):U.source=Pe.attr("src")),at==="img"&&!U.poster&&(U.poster=Pe.attr("src"))}return U.source=U.source||U.src||"",U.altsource=U.altsource||"",U.poster=U.poster||"",U},Jn=M=>{var E;const U={mp3:"audio/mpeg",m4a:"audio/x-m4a",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"},W=(E=M.toLowerCase().split(".").pop())!==null&&E!==void 0?E:"";return ht(U,W).getOr("")};var Tt=tinymce.util.Tools.resolve("tinymce.html.Node"),Rn=tinymce.util.Tools.resolve("tinymce.html.Serializer");const gn=(M,E={})=>g({forced_root_block:!1,validate:!1,allow_conditional_comments:!0,...E},M),Lo=ge.DOM,ae=M=>/^[0-9.]+$/.test(M)?M+"px":M,be=(M,E)=>{const U=E.attr("style"),W=U?Lo.parseStyle(U):{};rt(M.width)&&(W["max-width"]=ae(M.width)),rt(M.height)&&(W["max-height"]=ae(M.height)),E.attr("style",Lo.serializeStyle(W))},kn=["source","altsource"],he=(M,E,U,W)=>{let ke=0,Pe=0;const at=gn(W);at.addNodeFilter("source",It=>ke=It.length);const te=at.parse(M);for(let It=te;It;It=It.walk())if(It.type===1){const bt=It.name;if(It.attr("data-ephox-embed-iri")){be(E,It);break}else{switch(bt){case"video":case"object":case"embed":case"img":case"iframe":E.height!==void 0&&E.width!==void 0&&(It.attr("width",E.width),It.attr("height",E.height));break}if(U)switch(bt){case"video":It.attr("poster",E.poster),It.attr("src",null);for(let zn=ke;zn<2;zn++)if(E[kn[zn]]){const wo=new Tt("source",1);wo.attr("src",E[kn[zn]]),wo.attr("type",E[kn[zn]+"mime"]||null),It.append(wo)}break;case"iframe":It.attr("src",E.source);break;case"object":const Cn=It.getAll("img").length>0;if(E.poster&&!Cn){It.attr("src",E.poster);const zn=new Tt("img",1);zn.attr("src",E.poster),zn.attr("width",E.width),zn.attr("height",E.height),It.append(zn)}break;case"source":if(Pe<2&&(It.attr("src",E[kn[Pe]]),It.attr("type",E[kn[Pe]+"mime"]||null),!E[kn[Pe]])){It.remove();continue}Pe++;break;case"img":E.poster||It.remove();break}}}return Rn({},W).serialize(te)},Y=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)\?h=(\w+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$1?h=$2&title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)\?h=(\w+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$2?h=$3&title=0&amp;byline=0",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],Ae=M=>{const E=M.match(/^(https?:\/\/|www\.)(.+)$/i);return E&&E.length>1?E[1]==="www."?"https://":E[1]:"https://"},me=(M,E)=>{const U=Ae(E),W=M.regex.exec(E);let ke=U+M.url;if(rt(W))for(let Pe=0;Pe<W.length;Pe++)ke=ke.replace("$"+Pe,()=>W[Pe]?W[Pe]:"");return ke.replace(/\?$/,"")},zt=M=>{const E=Y.filter(U=>U.regex.test(M));return E.length>0?ne.extend({},E[0],{url:me(E[0],M)}):null},lt=(M,E)=>{if(E)return E(M);{const U=M.allowfullscreen?' allowFullscreen="1"':"";return'<iframe src="'+M.source+'" width="'+M.width+'" height="'+M.height+'"'+U+"></iframe>"}},en=M=>{let E='<object data="'+M.source+'" width="'+M.width+'" height="'+M.height+'" type="application/x-shockwave-flash">';return M.poster&&(E+='<img src="'+M.poster+'" width="'+M.width+'" height="'+M.height+'" />'),E+="</object>",E},xt=(M,E)=>E?E(M):'<audio controls="controls" src="'+M.source+'">'+(M.altsource?`
<source src="`+M.altsource+'"'+(M.altsourcemime?' type="'+M.altsourcemime+'"':"")+` />
`:"")+"</audio>",At=(M,E)=>E?E(M):'<video width="'+M.width+'" height="'+M.height+'"'+(M.poster?' poster="'+M.poster+'"':"")+` controls="controls">
<source src="`+M.source+'"'+(M.sourcemime?' type="'+M.sourcemime+'"':"")+` />
`+(M.altsource?'<source src="'+M.altsource+'"'+(M.altsourcemime?' type="'+M.altsourcemime+'"':"")+` />
`:"")+"</video>",yo=M=>'<script src="'+M.source+'"><\/script>',Zo=(M,E)=>{var U;const W=ne.extend({},E);if(!W.source&&(ne.extend(W,Xn((U=W.embed)!==null&&U!==void 0?U:"",M.schema)),!W.source))return"";W.altsource||(W.altsource=""),W.poster||(W.poster=""),W.source=M.convertURL(W.source,"source"),W.altsource=M.convertURL(W.altsource,"source"),W.sourcemime=Jn(W.source),W.altsourcemime=Jn(W.altsource),W.poster=M.convertURL(W.poster,"poster");const ke=zt(W.source);if(ke&&(W.source=ke.url,W.type=ke.type,W.allowfullscreen=ke.allowFullscreen,W.width=W.width||String(ke.w),W.height=W.height||String(ke.h)),W.embed)return he(W.embed,W,!0,M.schema);{const Pe=to(M),at=Kn(M),te=O(M);return W.width=W.width||"300",W.height=W.height||"150",ne.each(W,(It,bt)=>{W[bt]=M.dom.encode(""+It)}),W.type==="iframe"?lt(W,te):W.sourcemime==="application/x-shockwave-flash"?en(W):W.sourcemime.indexOf("audio")!==-1?xt(W,Pe):W.type==="script"?yo(W):At(W,at)}},Qo=M=>M.hasAttribute("data-mce-object")||M.hasAttribute("data-ephox-embed-iri"),cr=M=>{M.on("click keyup touchend",()=>{const E=M.selection.getNode();E&&M.dom.hasClass(E,"mce-preview-object")&&M.dom.getAttrib(E,"data-mce-selected")&&E.setAttribute("data-mce-selected","2")}),M.on("ObjectSelected",E=>{E.target.getAttribute("data-mce-object")==="script"&&E.preventDefault()}),M.on("ObjectResized",E=>{const U=E.target;if(U.getAttribute("data-mce-object")){let W=U.getAttribute("data-mce-html");W&&(W=unescape(W),U.setAttribute("data-mce-html",escape(he(W,{width:String(E.width),height:String(E.height)},!1,M.schema))))}})},X={},K=(M,E,U)=>new Promise((W,ke)=>{const Pe=at=>(at.html&&(X[M.source]=at),W({url:M.source,html:at.html?at.html:E(M)}));X[M.source]?Pe(X[M.source]):U({url:M.source},Pe,ke)}),we=(M,E)=>Promise.resolve({html:E(M),url:M.source}),He=M=>E=>Zo(M,E),Pt=(M,E)=>{const U=Et(M);return U?K(E,He(M),U):we(E,He(M))},Rt=M=>ie(X,M),on=(M,E)=>ht(E,M).bind(U=>ht(U,"meta")),Lt=(M,E,U)=>W=>{const ke=()=>ht(M,W),Pe=()=>ht(E,W),at=bt=>ht(bt,"value").bind(Cn=>Cn.length>0?Nt.some(Cn):Nt.none()),te=()=>ke().bind(bt=>Hn(bt)?at(bt).orThunk(Pe):Pe().orThunk(()=>Nt.from(bt))),It=()=>Pe().orThunk(()=>ke().bind(bt=>Hn(bt)?at(bt):Nt.from(bt)));return{[W]:(W===U?te():It()).getOr("")}},bs=(M,E)=>{const U={};return ht(M,"dimensions").each(W=>{ln(["width","height"],ke=>{ht(E,ke).orThunk(()=>ht(W,ke)).each(Pe=>U[ke]=Pe)})}),U},un=(M,E)=>{const U=E&&E!=="dimensions"?on(E,M).getOr({}):{},W=Lt(M,U,E);return{...W("source"),...W("altsource"),...W("poster"),...W("embed"),...bs(M,U)}},Ut=M=>{const E={...M,source:{value:ht(M,"source").getOr("")},altsource:{value:ht(M,"altsource").getOr("")},poster:{value:ht(M,"poster").getOr("")}};return ln(["width","height"],U=>{ht(M,U).each(W=>{const ke=E.dimensions||{};ke[U]=W,E.dimensions=ke})}),E},Ht=M=>E=>{const U=E&&E.msg?"Media embed handler error: "+E.msg:"Media embed handler threw unknown error.";M.notificationManager.open({type:"error",text:U})},We=M=>{const E=M.selection.getNode(),U=Qo(E)?M.serializer.serialize(E,{selection:!0}):"",W=Xn(U,M.schema),Pe=(()=>{if(Ln(W.source,W.type)){const at=M.dom.getRect(E);return{width:at.w.toString().replace(/px$/,""),height:at.h.toString().replace(/px$/,"")}}else return{}})();return{embed:U,...W,...Pe}},ft=(M,E)=>U=>{if(_n(U.url)&&U.url.trim().length>0){const W=U.html,Pe={...Xn(W,E.schema),source:U.url,embed:W};M.setData(Ut(Pe))}},uo=(M,E)=>{const U=M.dom.select("*[data-mce-object]");for(let W=0;W<E.length;W++)for(let ke=U.length-1;ke>=0;ke--)E[W]===U[ke]&&U.splice(ke,1);M.selection.select(U[0])},co=(M,E)=>{const U=M.dom.select("*[data-mce-object]");M.insertContent(E),uo(M,U),M.nodeChanged()},Ln=(M,E)=>rt(E)&&E==="ephox-embed-iri"&&rt(zt(M)),pn=(M,E)=>((W,ke)=>W.width!==ke.width||W.height!==ke.height)(M,E)&&Ln(E.source,M.type),_s=(M,E,U)=>{var W;E.embed=pn(M,E)&&Yn(U)?Zo(U,{...E,embed:""}):he((W=E.embed)!==null&&W!==void 0?W:"",E,!1,U.schema),E.embed&&(M.source===E.source||Rt(E.source))?co(U,E.embed):Pt(U,E).then(ke=>{co(U,ke.html)}).catch(Ht(U))},Se=M=>{const E=We(M),U=pt(E),W=Ut(E),ke=(hn,fn)=>{const As=un(fn.getData(),"source");hn.source!==As.source&&(ft(kr,M)({url:As.source,html:""}),Pt(M,As).then(ft(kr,M)).catch(Ht(M)))},Pe=hn=>{var fn;const As=un(hn.getData()),Bo=Xn((fn=As.embed)!==null&&fn!==void 0?fn:"",M.schema);hn.setData(Ut(Bo))},at=(hn,fn,As)=>{const Bo=un(hn.getData(),fn),Er=pn(As,Bo)&&Yn(M)?{...Bo,embed:""}:Bo,dr=Zo(M,Er);hn.setData(Ut({...Er,embed:dr}))},te=[{name:"source",type:"urlinput",filetype:"media",label:"Source"}],It=Yn(M)?[{type:"sizeinput",name:"dimensions",label:"Constrain proportions",constrain:!0}]:[],bt={title:"General",name:"general",items:nn([te,It])},zn={title:"Embed",items:[{type:"textarea",name:"embed",label:"Paste your embed code below:"}]},wo=[];Vn(M)&&wo.push({name:"altsource",type:"urlinput",filetype:"media",label:"Alternative source URL"}),Jo(M)&&wo.push({name:"poster",type:"urlinput",filetype:"image",label:"Media poster (Image URL)"});const Kr={title:"Advanced",name:"advanced",items:wo},Or=[bt,zn];wo.length>0&&Or.push(Kr);const mo={type:"tabpanel",tabs:Or},kr=M.windowManager.open({title:"Insert/Edit Media",size:"normal",body:mo,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:hn=>{const fn=un(hn.getData());_s(U.get(),fn,M),hn.close()},onChange:(hn,fn)=>{switch(fn.name){case"source":ke(U.get(),hn);break;case"embed":Pe(hn);break;case"dimensions":case"altsource":case"poster":at(hn,fn.name,U.get());break}U.set(un(hn.getData()))},initialData:W})},wt=M=>({showDialog:()=>{Se(M)}}),io=M=>{const E=()=>{Se(M)};M.addCommand("mceMedia",E)},Io=(M,E,U)=>E===""||M.length>=E.length&&M.substr(U,U+E.length)===E,Os=(M,E)=>Io(M,E,0);var es=tinymce.util.Tools.resolve("tinymce.Env");const ca=M=>{const E=M.name;return E==="iframe"||E==="video"||E==="audio"},qs=(M,E,U,W=null)=>{const ke=M.attr(U);return rt(ke)?ke:ie(E,U)?null:W},ls=(M,E,U)=>{const W=E.name==="img"||M.name==="video",ke=W?"300":null,Pe=M.name==="audio"?"30":"150",at=W?Pe:null;E.attr({width:qs(M,U,"width",ke),height:qs(M,U,"height",at)})},ir=(M,E,U,W)=>{const ke=gn(M.schema).parse(W,{context:E});for(;ke.firstChild;)U.append(ke.firstChild)},ts=(M,E)=>{const U=E.name,W=new Tt("img",1);return ur(M,E,W),ls(E,W,{}),W.attr({style:E.attr("style"),src:es.transparentSrc,"data-mce-object":U,class:"mce-object mce-object-"+U}),W},lr=(M,E)=>{var U;const W=E.name,ke=new Tt("span",1);ke.attr({contentEditable:"false",style:E.attr("style"),"data-mce-object":W,class:"mce-preview-object mce-object-"+W}),ur(M,E,ke);const Pe=M.dom.parseStyle((U=E.attr("style"))!==null&&U!==void 0?U:""),at=new Tt(W,1);if(ls(E,at,Pe),at.attr({src:E.attr("src"),style:E.attr("style"),class:E.attr("class")}),W==="iframe")at.attr({allowfullscreen:E.attr("allowfullscreen"),frameborder:"0"});else{ln(["controls","crossorigin","currentTime","loop","muted","poster","preload"],Cn=>{at.attr(Cn,E.attr(Cn))});const bt=ke.attr("data-mce-html");rt(bt)&&ir(M,W,at,unescape(bt))}const te=new Tt("span",1);return te.attr("class","mce-shim"),ke.append(at),ke.append(te),ke},ur=(M,E,U)=>{var W;const ke=(W=E.attributes)!==null&&W!==void 0?W:[];let Pe=ke.length;for(;Pe--;){const bt=ke[Pe].name;let Cn=ke[Pe].value;bt!=="width"&&bt!=="height"&&bt!=="style"&&!Os(bt,"data-mce-")&&((bt==="data"||bt==="src")&&(Cn=M.convertURL(Cn,bt)),U.attr("data-mce-p-"+bt,Cn))}const at=Rn({inner:!0},M.schema),te=new Tt("div",1);ln(E.children(),bt=>te.append(bt));const It=at.serialize(te);It&&(U.attr("data-mce-html",escape(It)),U.empty())},ks=M=>{const E=M.attr("class");return _n(E)&&/\btiny-pageembed\b/.test(E)},Es=M=>{let E=M;for(;E=E.parent;)if(E.attr("data-ephox-embed-iri")||ks(E))return!0;return!1},So=M=>E=>{let U=E.length,W;for(;U--;)W=E[U],W.parent&&(W.parent.attr("data-mce-object")||(ca(W)&&Xe(M)?Es(W)||W.replace(lr(M,W)):Es(W)||W.replace(ts(M,W))))},no=(M,E,U)=>{const W=M.options.get,ke=W("xss_sanitization"),Pe=Gt(M);return gn(M.schema,{sanitize:ke,validate:Pe}).parse(U,{context:E})},Ks=M=>{M.on("PreInit",()=>{const{schema:E,serializer:U,parser:W}=M,ke=E.getBoolAttrs();ln("webkitallowfullscreen mozallowfullscreen".split(" "),Pe=>{ke[Pe]={}}),qe({embed:["wmode"]},(Pe,at)=>{const te=E.getElementRule(at);te&&ln(Pe,It=>{te.attributes[It]={},te.attributesOrder.push(It)})}),W.addNodeFilter("iframe,video,audio,object,embed,script",So(M)),U.addAttributeFilter("data-mce-object",(Pe,at)=>{var te;let It=Pe.length;for(;It--;){const bt=Pe[It];if(!bt.parent)continue;const Cn=bt.attr(at),zn=new Tt(Cn,1);if(Cn!=="audio"&&Cn!=="script"){const mo=bt.attr("class");mo&&mo.indexOf("mce-preview-object")!==-1&&bt.firstChild?zn.attr({width:bt.firstChild.attr("width"),height:bt.firstChild.attr("height")}):zn.attr({width:bt.attr("width"),height:bt.attr("height")})}zn.attr({style:bt.attr("style")});const wo=(te=bt.attributes)!==null&&te!==void 0?te:[];let Kr=wo.length;for(;Kr--;){const mo=wo[Kr].name;mo.indexOf("data-mce-p-")===0&&zn.attr(mo.substr(11),wo[Kr].value)}Cn==="script"&&zn.attr("type","text/javascript");const Or=bt.attr("data-mce-html");if(Or){const mo=no(M,Cn,unescape(Or));ln(mo.children(),kr=>zn.append(kr))}bt.replace(zn)}})}),M.on("SetContent",()=>{const E=M.dom;ln(E.select("span.mce-preview-object"),U=>{E.select("span.mce-shim",U).length===0&&E.add(U,"span",{class:"mce-shim"})})})},xo=M=>{M.on("ResolveName",E=>{let U;E.target.nodeType===1&&(U=E.target.getAttribute("data-mce-object"))&&(E.name=U)})},Ys=M=>E=>{const U=()=>{E.setEnabled(M.selection.isEditable())};return M.on("NodeChange",U),U(),()=>{M.off("NodeChange",U)}},$n=M=>{const E=()=>M.execCommand("mceMedia");M.ui.registry.addToggleButton("media",{tooltip:"Insert/edit media",icon:"embed",onAction:E,onSetup:U=>{const W=M.selection;U.setActive(Qo(W.getNode()));const ke=W.selectorChangedWithUnbind("img[data-mce-object],span[data-mce-object],div[data-ephox-embed-iri]",U.setActive).unbind,Pe=Ys(M)(U);return()=>{ke(),Pe()}}}),M.ui.registry.addMenuItem("media",{icon:"embed",text:"Media...",onAction:E,onSetup:Ys(M)})};var _r=()=>{$o.add("media",M=>(kt(M),io(M),$n(M),xo(M),Ks(M),cr(M),wt(M)))};_r()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(w,$,P)=>{var j;return P(w,$.prototype)?!0:((j=w.constructor)===null||j===void 0?void 0:j.name)===$.name},bo=w=>{const $=typeof w;return w===null?"null":$==="object"&&Array.isArray(w)?"array":$==="object"&&eo(w,String,(P,j)=>j.isPrototypeOf(P))?"string":$},cn=w=>$=>bo($)===w,_n=w=>$=>typeof $===w,Hn=w=>$=>w===$,Sn=cn("string"),Ee=cn("object"),rt=cn("array"),Nt=Hn(null),ut=_n("boolean"),ln=w=>w==null,nn=w=>!ln(w),pt=_n("function"),Ge=(w,$)=>{if(rt(w)){for(let P=0,j=w.length;P<j;++P)if(!$(w[P]))return!1;return!0}return!1},Ye=()=>{},qe=w=>()=>w,ht=(w,$)=>w===$;class ie{constructor($,P){this.tag=$,this.value=P}static some($){return new ie(!0,$)}static none(){return ie.singletonNone}fold($,P){return this.tag?P(this.value):$()}isSome(){return this.tag}isNone(){return!this.tag}map($){return this.tag?ie.some($(this.value)):ie.none()}bind($){return this.tag?$(this.value):ie.none()}exists($){return this.tag&&$(this.value)}forall($){return!this.tag||$(this.value)}filter($){return!this.tag||$(this.value)?this:ie.none()}getOr($){return this.tag?this.value:$}or($){return this.tag?this:$}getOrThunk($){return this.tag?this.value:$()}orThunk($){return this.tag?this:$()}getOrDie($){if(this.tag)return this.value;throw new Error($??"Called getOrDie on None")}static from($){return nn($)?ie.some($):ie.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each($){this.tag&&$(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}ie.singletonNone=new ie(!1);const Q=Array.prototype.indexOf,kt=Array.prototype.push,to=(w,$)=>Q.call(w,$),Kn=(w,$)=>to(w,$)>-1,O=(w,$)=>{const P=w.length,j=new Array(P);for(let ue=0;ue<P;ue++){const Ie=w[ue];j[ue]=$(Ie,ue)}return j},Xe=(w,$)=>{for(let P=0,j=w.length;P<j;P++){const ue=w[P];$(ue,P)}},Gt=(w,$,P)=>(Xe(w,(j,ue)=>{P=$(P,j,ue)}),P),Et=w=>{const $=[];for(let P=0,j=w.length;P<j;++P){if(!rt(w[P]))throw new Error("Arr.flatten item "+P+" was not an array, input: "+w);kt.apply($,w[P])}return $},Vn=(w,$)=>Et(O(w,$)),Jo=(w,$)=>{for(let P=0;P<w.length;P++){const j=$(w[P],P);if(j.isSome())return j}return ie.none()},Yn=(w,$,P=ht)=>w.exists(j=>P(j,$)),ne=w=>{const $=[],P=j=>{$.push(j)};for(let j=0;j<w.length;j++)w[j].each(P);return $},ge=(w,$)=>w?ie.some($):ie.none(),g=w=>$=>$.options.get(w),St=w=>{const $=w.options.register;$("link_assume_external_targets",{processor:P=>{const j=Sn(P)||ut(P);return j?P===!0?{value:1,valid:j}:P==="http"||P==="https"?{value:P,valid:j}:{value:0,valid:j}:{valid:!1,message:"Must be a string or a boolean."}},default:!1}),$("link_context_toolbar",{processor:"boolean",default:!1}),$("link_list",{processor:P=>Sn(P)||pt(P)||Ge(P,Ee)}),$("link_default_target",{processor:"string"}),$("link_default_protocol",{processor:"string",default:"https"}),$("link_target_list",{processor:P=>ut(P)||Ge(P,Ee),default:!0}),$("link_rel_list",{processor:"object[]",default:[]}),$("link_class_list",{processor:"object[]",default:[]}),$("link_title",{processor:"boolean",default:!0}),$("allow_unsafe_link_target",{processor:"boolean",default:!1}),$("link_quicklink",{processor:"boolean",default:!1})},qt=g("link_assume_external_targets"),rn=g("link_context_toolbar"),Xn=g("link_list"),Jn=g("link_default_target"),Tt=g("link_default_protocol"),Rn=g("link_target_list"),gn=g("link_rel_list"),Lo=g("link_class_list"),ae=g("link_title"),be=g("allow_unsafe_link_target"),kn=g("link_quicklink");var he=tinymce.util.Tools.resolve("tinymce.util.Tools");const Y=w=>Sn(w.value)?w.value:"",Ae=w=>Sn(w.text)?w.text:Sn(w.title)?w.title:"",me=(w,$)=>{const P=[];return he.each(w,j=>{const ue=Ae(j);if(j.menu!==void 0){const Ie=me(j.menu,$);P.push({text:ue,items:Ie})}else{const Ie=$(j);P.push({text:ue,value:Ie})}}),P},zt=(w=Y)=>$=>ie.from($).map(P=>me(P,w)),xt={sanitize:w=>zt(Y)(w),sanitizeWith:zt,createUi:(w,$)=>P=>({name:w,type:"listbox",label:$,items:P}),getValue:Y},At=Object.keys,yo=Object.hasOwnProperty,Zo=(w,$)=>{const P=At(w);for(let j=0,ue=P.length;j<ue;j++){const Ie=P[j],Jt=w[Ie];$(Jt,Ie)}},Qo=w=>($,P)=>{w[P]=$},cr=(w,$,P,j)=>{Zo(w,(ue,Ie)=>{($(ue,Ie)?P:j)(ue,Ie)})},X=(w,$)=>{const P={};return cr(w,$,Qo(P),Ye),P},K=(w,$)=>yo.call(w,$),we=(w,$)=>K(w,$)&&w[$]!==void 0&&w[$]!==null;var He=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Pt=tinymce.util.Tools.resolve("tinymce.util.URI");const Rt=w=>nn(w)&&w.nodeName.toLowerCase()==="a",on=w=>Rt(w)&&!!un(w),Lt=(w,$)=>{if(w.collapsed)return[];{const P=w.cloneContents(),j=P.firstChild,ue=new He(j,P),Ie=[];let Jt=j;do $(Jt)&&Ie.push(Jt);while(Jt=ue.next());return Ie}},bs=w=>/^\w+:/i.test(w),un=w=>{var $,P;return(P=($=w.getAttribute("data-mce-href"))!==null&&$!==void 0?$:w.getAttribute("href"))!==null&&P!==void 0?P:""},Ut=(w,$)=>{const P=["noopener"],j=w?w.split(/\s+/):[],ue=Kt=>he.trim(Kt.sort().join(" ")),Ie=Kt=>(Kt=Jt(Kt),Kt.length>0?Kt.concat(P):P),Jt=Kt=>Kt.filter(Zt=>he.inArray(P,Zt)===-1),Zn=$?Ie(j):Jt(j);return Zn.length>0?ue(Zn):""},Ht=w=>w.replace(/\uFEFF/g,""),We=(w,$)=>($=$||co(w.selection.getRng())[0]||w.selection.getNode(),wt($)?ie.from(w.dom.select("a[href]",$)[0]):ie.from(w.dom.getParent($,"a[href]"))),ft=(w,$)=>We(w,$).isSome(),uo=(w,$)=>{const P=$.fold(()=>w.getContent({format:"text"}),j=>j.innerText||j.textContent||"");return Ht(P)},co=w=>Lt(w,on),Ln=w=>he.grep(w,on),pn=w=>Ln(w).length>0,_s=w=>co(w).length>0,Se=w=>{const $=w.schema.getTextInlineElements(),P=Ie=>Ie.nodeType===1&&!Rt(Ie)&&!K($,Ie.nodeName.toLowerCase());if(We(w).exists(Ie=>Ie.hasAttribute("data-mce-block")))return!1;const ue=w.selection.getRng();return ue.collapsed?!0:Lt(ue,P).length===0},wt=w=>nn(w)&&w.nodeName==="FIGURE"&&/\bimage\b/i.test(w.className),io=w=>Gt(["title","rel","class","target"],(P,j)=>(w[j].each(ue=>{P[j]=ue.length>0?ue:null}),P),{href:w.href}),Io=(w,$)=>($==="http"||$==="https")&&!bs(w)?$+"://"+w:w,Os=(w,$)=>{const P={...$};if(gn(w).length===0&&!be(w)){const j=Ut(P.rel,P.target==="_blank");P.rel=j||null}return ie.from(P.target).isNone()&&Rn(w)===!1&&(P.target=Jn(w)),P.href=Io(P.href,qt(w)),P},es=(w,$,P,j)=>{P.each(ue=>{K($,"innerText")?$.innerText=ue:$.textContent=ue}),w.dom.setAttribs($,j),w.selection.select($)},ca=(w,$,P,j)=>{const ue=w.dom;wt($)?So(ue,$,j):P.fold(()=>{w.execCommand("mceInsertLink",!1,j)},Ie=>{w.insertContent(ue.createHTML("a",j,ue.encode(Ie)))})},qs=(w,$,P)=>{const j=w.selection.getNode(),ue=We(w,j),Ie=Os(w,io(P));w.undoManager.transact(()=>{P.href===$.href&&$.attach(),ue.fold(()=>{ca(w,j,P.text,Ie)},Jt=>{w.focus(),es(w,Jt,P.text,Ie)})})},ls=w=>{const $=w.dom,P=w.selection,j=P.getBookmark(),ue=P.getRng().cloneRange(),Ie=$.getParent(ue.startContainer,"a[href]",w.getBody()),Jt=$.getParent(ue.endContainer,"a[href]",w.getBody());Ie&&ue.setStartBefore(Ie),Jt&&ue.setEndAfter(Jt),P.setRng(ue),w.execCommand("unlink"),P.moveToBookmark(j)},ir=w=>{w.undoManager.transact(()=>{const $=w.selection.getNode();wt($)?Es(w,$):ls(w),w.focus()})},ts=w=>{const{class:$,href:P,rel:j,target:ue,text:Ie,title:Jt}=w;return X({class:$.getOrNull(),href:P,rel:j.getOrNull(),target:ue.getOrNull(),text:Ie.getOrNull(),title:Jt.getOrNull()},(Zn,Kt)=>Nt(Zn)===!1)},lr=(w,$)=>{const P=w.options.get,j={allow_html_data_urls:P("allow_html_data_urls"),allow_script_urls:P("allow_script_urls"),allow_svg_data_urls:P("allow_svg_data_urls")},ue=$.href;return{...$,href:Pt.isDomSafe(ue,"a",j)?ue:""}},ur=(w,$,P)=>{const j=lr(w,P);w.hasPlugin("rtc",!0)?w.execCommand("createlink",!1,ts(j)):qs(w,$,j)},ks=w=>{w.hasPlugin("rtc",!0)?w.execCommand("unlink"):ir(w)},Es=(w,$)=>{var P;const j=w.dom.select("img",$)[0];if(j){const ue=w.dom.getParents(j,"a[href]",$)[0];ue&&((P=ue.parentNode)===null||P===void 0||P.insertBefore(j,ue),w.dom.remove(ue))}},So=(w,$,P)=>{var j;const ue=w.select("img",$)[0];if(ue){const Ie=w.create("a",P);(j=ue.parentNode)===null||j===void 0||j.insertBefore(Ie,ue),Ie.appendChild(ue)}},no=w=>we(w,"items"),Ks=(w,$)=>Jo($,P=>no(P)?Ks(w,P.items):ge(P.value===w,P)),xo=(w,$,P,j)=>{const ue=j[$],Ie=w.length>0;return ue!==void 0?Ks(ue,P).map(Jt=>({url:{value:Jt.value,meta:{text:Ie?w:Jt.text,attach:Ye}},text:Ie?w:Jt.text})):ie.none()},Ys=(w,$)=>$==="link"?w.link:$==="anchor"?w.anchor:ie.none(),_r={init:(w,$)=>{const P={text:w.text,title:w.title},j=Kt=>{var Zt;return ge(P.title.length<=0,ie.from((Zt=Kt.meta)===null||Zt===void 0?void 0:Zt.title).getOr(""))},ue=Kt=>{var Zt;return ge(P.text.length<=0,ie.from((Zt=Kt.meta)===null||Zt===void 0?void 0:Zt.text).getOr(Kt.value))},Ie=Kt=>{const Zt=ue(Kt.url),sn=j(Kt.url);return Zt.isSome()||sn.isSome()?ie.some({...Zt.map(mr=>({text:mr})).getOr({}),...sn.map(mr=>({title:mr})).getOr({})}):ie.none()},Jt=(Kt,Zt)=>{const sn=Ys($,Zt).getOr([]);return xo(P.text,Zt,sn,Kt)};return{onChange:(Kt,Zt)=>{const sn=Zt.name;return sn==="url"?Ie(Kt()):Kn(["anchor","link"],sn)?Jt(Kt(),sn):((sn==="text"||sn==="title")&&(P[sn]=Kt()[sn]),ie.none())}}},getDelta:xo};var M=tinymce.util.Tools.resolve("tinymce.util.Delay");const E=(w,$,P)=>{const j=w.selection.getRng();M.setEditorTimeout(w,()=>{w.windowManager.confirm($,ue=>{w.selection.setRng(j),P(ue)})})},U=w=>{const $=w.href;return $.indexOf("@")>0&&$.indexOf("/")===-1&&$.indexOf("mailto:")===-1?ie.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:j=>({...j,href:"mailto:"+$})}):ie.none()},W=(w,$)=>P=>{const j=P.href;return w===1&&!bs(j)||w===0&&/^\s*www(\.|\d\.)/i.test(j)?ie.some({message:`The URL you entered seems to be an external link. Do you want to add the required ${$}:// prefix?`,preprocess:Ie=>({...Ie,href:$+"://"+j})}):ie.none()},Pe={preprocess:(w,$)=>Jo([U,W(qt(w),Tt(w))],P=>P($)).fold(()=>Promise.resolve($),P=>new Promise(j=>{E(w,P.message,ue=>{j(ue?P.preprocess($):$)})}))},te={getAnchors:w=>{const $=w.dom.select("a:not([href])"),P=Vn($,j=>{const ue=j.name||j.id;return ue?[{text:ue,value:"#"+ue}]:[]});return P.length>0?ie.some([{text:"None",value:""}].concat(P)):ie.none()}},bt={getClasses:w=>{const $=Lo(w);return $.length>0?xt.sanitize($):ie.none()}},Cn=w=>{try{return ie.some(JSON.parse(w))}catch{return ie.none()}},wo={getLinks:w=>{const $=j=>w.convertURL(j.value||j.url||"","href"),P=Xn(w);return new Promise(j=>{Sn(P)?fetch(P).then(ue=>ue.ok?ue.text().then(Cn):Promise.reject()).then(j,()=>j(ie.none())):pt(P)?P(ue=>j(ie.some(ue))):j(ie.from(P))}).then(j=>j.bind(xt.sanitizeWith($)).map(ue=>ue.length>0?[{text:"None",value:""}].concat(ue):ue))}},Or={getRels:(w,$)=>{const P=gn(w);if(P.length>0){const j=Yn($,"_blank"),ue=be(w)===!1,Ie=Zn=>Ut(xt.getValue(Zn),j);return(ue?xt.sanitizeWith(Ie):xt.sanitize)(P)}return ie.none()}},mo=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],hn={getTargets:w=>{const $=Rn(w);return rt($)?xt.sanitize($).orThunk(()=>ie.some(mo)):$===!1?ie.none():ie.some(mo)}},fn=(w,$,P)=>{const j=w.getAttrib($,P);return j!==null&&j.length>0?ie.some(j):ie.none()},As=(w,$)=>{const P=w.dom,ue=Se(w)?ie.some(uo(w.selection,$)):ie.none(),Ie=$.bind(sn=>ie.from(P.getAttrib(sn,"href"))),Jt=$.bind(sn=>ie.from(P.getAttrib(sn,"target"))),Zn=$.bind(sn=>fn(P,sn,"rel")),Kt=$.bind(sn=>fn(P,sn,"class")),Zt=$.bind(sn=>fn(P,sn,"title"));return{url:Ie,text:ue,title:Zt,target:Jt,rel:Zn,linkClass:Kt}},Er={collect:(w,$)=>wo.getLinks(w).then(P=>{const j=As(w,$);return{anchor:j,catalogs:{targets:hn.getTargets(w),rels:Or.getRels(w,j.target),classes:bt.getClasses(w),anchor:te.getAnchors(w),link:P},optNode:$,flags:{titleEnabled:ae(w)}}})},dr=(w,$)=>P=>{const j=P.getData();if(!j.url.value){ks(w),P.close();return}const ue=Zn=>ie.from(j[Zn]).filter(Kt=>!Yn($.anchor[Zn],Kt)),Ie={href:j.url.value,text:ue("text"),target:ue("target"),rel:ue("rel"),class:ue("linkClass"),title:ue("title")},Jt={href:j.url.value,attach:j.url.meta!==void 0&&j.url.meta.attach?j.url.meta.attach:Ye};Pe.preprocess(w,Ie).then(Zn=>{ur(w,Jt,Zn)}),P.close()},ia=w=>{const $=We(w);return Er.collect(w,$)},Co=(w,$)=>{const P=w.anchor,j=P.url.getOr("");return{url:{value:j,meta:{original:{value:j}}},text:P.text.getOr(""),title:P.title.getOr(""),anchor:j,link:j,rel:P.rel.getOr(""),target:P.target.or($).getOr(""),linkClass:P.linkClass.getOr("")}},Xs=(w,$,P)=>{const j=[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],ue=w.anchor.text.map(()=>({name:"text",type:"input",label:"Text to display"})).toArray(),Ie=w.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],Jt=ie.from(Jn(P)),Zn=Co(w,Jt),Kt=w.catalogs,Zt=_r.init(Zn,Kt);return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:Et([j,ue,Ie,ne([Kt.anchor.map(xt.createUi("anchor","Anchors")),Kt.rels.map(xt.createUi("rel","Rel")),Kt.targets.map(xt.createUi("target","Open link in...")),Kt.link.map(xt.createUi("link","Link list")),Kt.classes.map(xt.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Zn,onChange:(mr,{name:La})=>{Zt.onChange(mr.getData,{name:La}).each(Qe=>{mr.setData(Qe)})},onSubmit:$}},Ds=w=>{ia(w).then(P=>{const j=dr(w,P);return Xs(P,j,w)}).then(P=>{w.windowManager.open(P)})},kc=w=>{w.addCommand("mceLink",($,P)=>{(P==null?void 0:P.dialog)===!0||!kn(w)?Ds(w):w.dispatch("contexttoolbar-show",{toolbarKey:"quicklink"})})};var Ar=tinymce.util.Tools.resolve("tinymce.util.VK");const Uo=(w,$)=>{document.body.appendChild(w),w.dispatchEvent($),document.body.removeChild(w)},la=w=>{const $=document.createElement("a");$.target="_blank",$.href=w,$.rel="noreferrer noopener";const P=document.createEvent("MouseEvents");P.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Uo($,P)},Ec=(w,$)=>w.dom.getParent($,"a[href]"),ua=w=>Ec(w,w.selection.getStart()),an=w=>w.altKey===!0&&w.shiftKey===!1&&w.ctrlKey===!1&&w.metaKey===!1,Ms=(w,$)=>{if($){const P=un($);if(/^#/.test(P)){const j=w.dom.select(P);j.length&&w.selection.scrollIntoView(j[0],!0)}else la($.href)}},ns=w=>()=>{w.execCommand("mceLink",!1,{dialog:!0})},$s=w=>()=>{Ms(w,ua(w))},da=w=>{w.on("click",$=>{const P=Ec(w,$.target);P&&Ar.metaKeyPressed($)&&($.preventDefault(),Ms(w,P))}),w.on("keydown",$=>{if(!$.isDefaultPrevented()&&$.keyCode===13&&an($)){const P=ua(w);P&&($.preventDefault(),Ms(w,P))}})},us=(w,$)=>(w.on("NodeChange",$),()=>w.off("NodeChange",$)),Wo=w=>$=>{const P=()=>{$.setActive(!w.mode.isReadOnly()&&ft(w,w.selection.getNode())),$.setEnabled(w.selection.isEditable())};return P(),us(w,P)},Is=w=>$=>{const P=()=>{$.setEnabled(w.selection.isEditable())};return P(),us(w,P)},ni=w=>(w.selection.isCollapsed()?Ln(w.dom.getParents(w.selection.getStart())):co(w.selection.getRng())).length===1,Fa=w=>$=>{const P=()=>$.setEnabled(ni(w));return P(),us(w,P)},ma=w=>$=>{const P=Ie=>pn(Ie)||_s(w.selection.getRng()),j=w.dom.getParents(w.selection.getStart()),ue=Ie=>{$.setEnabled(P(Ie)&&w.selection.isEditable())};return ue(j),us(w,Ie=>ue(Ie.parents))},jo=w=>{w.addShortcut("Meta+K","",()=>{w.execCommand("mceLink")})},Bs=w=>{w.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:ns(w),onSetup:Wo(w)}),w.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:$s(w),onSetup:Fa(w)}),w.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:()=>ks(w),onSetup:ma(w)})},tc=w=>{w.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:$s(w),onSetup:Fa(w)}),w.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onSetup:Is(w),onAction:ns(w)}),w.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:()=>ks(w),onSetup:ma(w)})},Fs=w=>{const $="link unlink openlink",P="link";w.ui.registry.addContextMenu("link",{update:j=>w.dom.isEditable(j)?pn(w.dom.getParents(j,"a"))?$:P:""})},Pa=w=>{const $=ue=>{ue.selection.collapse(!1)},P=ue=>{const Ie=w.selection.getNode();return ue.setEnabled(ft(w,Ie)),Ye},j=ue=>{const Ie=We(w),Jt=Se(w);if(Ie.isNone()&&Jt){const Zn=uo(w.selection,Ie);return ge(Zn.length===0,ue)}else return ie.none()};w.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Wo(w)},label:"Link",predicate:ue=>rn(w)&&ft(w,ue),initValue:()=>We(w).fold(qe(""),un),commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:ue=>{const Ie=w.selection.getNode();return ue.setActive(ft(w,Ie)),Wo(w)(ue)},onAction:ue=>{const Ie=ue.getValue(),Jt=j(Ie);ur(w,{href:Ie,attach:Ye},{href:Ie,text:Jt,title:ie.none(),rel:ie.none(),target:ie.none(),class:ie.none()}),$(w),ue.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:P,onAction:ue=>{ks(w),ue.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:P,onAction:ue=>{$s(w)(),ue.hide()}}]})};var Ra=()=>{$o.add("link",w=>{St(w),Bs(w),tc(w),Fs(w),Pa(w),da(w),kc(w),jo(w)})};Ra()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager"),eo=tinymce.util.Tools.resolve("tinymce.Env"),bo=tinymce.util.Tools.resolve("tinymce.util.Tools");const cn=pt=>Ge=>Ge.options.get(pt),_n=cn("content_style"),Hn=cn("content_css_cors"),Sn=cn("body_class"),Ee=cn("body_id"),rt=pt=>{var Ge;let Ye="";const qe=pt.dom.encode,ht=(Ge=_n(pt))!==null&&Ge!==void 0?Ge:"";Ye+='<base href="'+qe(pt.documentBaseURI.getURI())+'">';const ie=Hn(pt)?' crossorigin="anonymous"':"";bo.each(pt.contentCSS,Et=>{Ye+='<link type="text/css" rel="stylesheet" href="'+qe(pt.documentBaseURI.toAbsolute(Et))+'"'+ie+">"}),ht&&(Ye+='<style type="text/css">'+ht+"</style>");const Q=Ee(pt),kt=Sn(pt),Kn='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(eo.os.isMacOS()||eo.os.isiOS()?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);<\/script> ",O=pt.getBody().dir,Xe=O?' dir="'+qe(O)+'"':"";return"<!DOCTYPE html><html><head>"+Ye+'</head><body id="'+qe(Q)+'" class="mce-content-body '+qe(kt)+'"'+Xe+">"+pt.getContent()+Kn+"</body></html>"},Nt=pt=>{const Ge=rt(pt);pt.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0,transparent:!1}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:Ge}}).focus("close")},ut=pt=>{pt.addCommand("mcePreview",()=>{Nt(pt)})},ln=pt=>{const Ge=()=>pt.execCommand("mcePreview");pt.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:Ge}),pt.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:Ge})};var nn=()=>{$o.add("preview",pt=>{ut(pt),ln(pt)})};nn()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(X,K,we)=>{var He;return we(X,K.prototype)?!0:((He=X.constructor)===null||He===void 0?void 0:He.name)===K.name},bo=X=>{const K=typeof X;return X===null?"null":K==="object"&&Array.isArray(X)?"array":K==="object"&&eo(X,String,(we,He)=>He.isPrototypeOf(we))?"string":K},cn=X=>K=>bo(K)===X,_n=X=>K=>typeof K===X,Hn=cn("string"),Sn=cn("object"),Ee=cn("array"),rt=X=>X==null,Nt=X=>!rt(X),ut=_n("function"),ln=(X,K)=>{if(Ee(X)){for(let we=0,He=X.length;we<He;++we)if(!K(X[we]))return!1;return!0}return!1},nn=X=>()=>X;function pt(X,...K){return(...we)=>{const He=K.concat(we);return X.apply(null,He)}}const Ge=nn(!1),Ye=X=>X.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var qe=tinymce.util.Tools.resolve("tinymce.util.Tools");const ht=X=>K=>K.options.get(X),ie=X=>{const K=X.options.register;K("template_cdate_classes",{processor:"string",default:"cdate"}),K("template_mdate_classes",{processor:"string",default:"mdate"}),K("template_selected_content_classes",{processor:"string",default:"selcontent"}),K("template_preview_replace_values",{processor:"object"}),K("template_replace_values",{processor:"object"}),K("templates",{processor:we=>Hn(we)||ln(we,Sn)||ut(we),default:[]}),K("template_cdate_format",{processor:"string",default:X.translate("%Y-%m-%d")}),K("template_mdate_format",{processor:"string",default:X.translate("%Y-%m-%d")})},Q=ht("template_cdate_classes"),kt=ht("template_mdate_classes"),to=ht("template_selected_content_classes"),Kn=ht("template_preview_replace_values"),O=ht("template_replace_values"),Xe=ht("templates"),Gt=ht("template_cdate_format"),Et=ht("template_mdate_format"),Vn=ht("content_style"),Jo=ht("content_css_cors"),Yn=ht("body_class"),ne=(X,K)=>{if(X=""+X,X.length<K)for(let we=0;we<K-X.length;we++)X="0"+X;return X},ge=(X,K,we=new Date)=>{const He="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),Pt="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),Rt="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),on="January February March April May June July August September October November December".split(" ");return K=K.replace("%D","%m/%d/%Y"),K=K.replace("%r","%I:%M:%S %p"),K=K.replace("%Y",""+we.getFullYear()),K=K.replace("%y",""+we.getYear()),K=K.replace("%m",ne(we.getMonth()+1,2)),K=K.replace("%d",ne(we.getDate(),2)),K=K.replace("%H",""+ne(we.getHours(),2)),K=K.replace("%M",""+ne(we.getMinutes(),2)),K=K.replace("%S",""+ne(we.getSeconds(),2)),K=K.replace("%I",""+((we.getHours()+11)%12+1)),K=K.replace("%p",we.getHours()<12?"AM":"PM"),K=K.replace("%B",""+X.translate(on[we.getMonth()])),K=K.replace("%b",""+X.translate(Rt[we.getMonth()])),K=K.replace("%A",""+X.translate(Pt[we.getDay()])),K=K.replace("%a",""+X.translate(He[we.getDay()])),K=K.replace("%%","%"),K};class g{constructor(K,we){this.tag=K,this.value=we}static some(K){return new g(!0,K)}static none(){return g.singletonNone}fold(K,we){return this.tag?we(this.value):K()}isSome(){return this.tag}isNone(){return!this.tag}map(K){return this.tag?g.some(K(this.value)):g.none()}bind(K){return this.tag?K(this.value):g.none()}exists(K){return this.tag&&K(this.value)}forall(K){return!this.tag||K(this.value)}filter(K){return!this.tag||K(this.value)?this:g.none()}getOr(K){return this.tag?this.value:K}or(K){return this.tag?this:K}getOrThunk(K){return this.tag?this.value:K()}orThunk(K){return this.tag?this:K()}getOrDie(K){if(this.tag)return this.value;throw new Error(K??"Called getOrDie on None")}static from(K){return Nt(K)?g.some(K):g.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(K){this.tag&&K(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}g.singletonNone=new g(!1);const St=(X,K)=>{for(let we=0,He=X.length;we<He;we++){const Pt=X[we];if(K(Pt,we))return!0}return!1},qt=(X,K)=>{const we=X.length,He=new Array(we);for(let Pt=0;Pt<we;Pt++){const Rt=X[Pt];He[Pt]=K(Rt,Pt)}return He},rn=(X,K,we)=>{for(let He=0,Pt=X.length;He<Pt;He++){const Rt=X[He];if(K(Rt,He))return g.some(Rt);if(we(Rt,He))break}return g.none()},Xn=(X,K)=>rn(X,K,Ge),Jn=Object.hasOwnProperty,Tt=(X,K)=>Rn(X,K)?g.from(X[K]):g.none(),Rn=(X,K)=>Jn.call(X,K);var gn=tinymce.util.Tools.resolve("tinymce.html.Serializer");const Lo={'"':"&quot;","<":"&lt;",">":"&gt;","&":"&amp;","'":"&#039;"},ae=X=>X.replace(/["'<>&]/g,K=>Tt(Lo,K).getOr(K)),be=(X,K,we)=>St(we.split(/\s+/),He=>X.hasClass(K,He)),kn=(X,K)=>gn({validate:!0},X.schema).serialize(X.parser.parse(K,{insert:!0})),he=(X,K)=>()=>{const we=Xe(X);ut(we)?we(K):Hn(we)?fetch(we).then(He=>{He.ok&&He.json().then(K)}):K(we)},Y=(X,K)=>(qe.each(K,(we,He)=>{ut(we)&&(we=we(He)),X=X.replace(new RegExp("\\{\\$"+Ye(He)+"\\}","g"),we)}),X),Ae=(X,K)=>{const we=X.dom,He=O(X);qe.each(we.select("*",K),Pt=>{qe.each(He,(Rt,on)=>{we.hasClass(Pt,on)&&ut(Rt)&&Rt(Pt)})})},me=(X,K,we)=>{const He=X.dom,Pt=X.selection.getContent();we=Y(we,O(X));let Rt=He.create("div",{},kn(X,we));const on=He.select(".mceTmpl",Rt);on&&on.length>0&&(Rt=He.create("div"),Rt.appendChild(on[0].cloneNode(!0))),qe.each(He.select("*",Rt),Lt=>{be(He,Lt,Q(X))&&(Lt.innerHTML=ge(X,Gt(X))),be(He,Lt,kt(X))&&(Lt.innerHTML=ge(X,Et(X))),be(He,Lt,to(X))&&(Lt.innerHTML=Pt)}),Ae(X,Rt),X.execCommand("mceInsertContent",!1,Rt.innerHTML),X.addVisual()};var zt=tinymce.util.Tools.resolve("tinymce.Env");const lt=(X,K)=>{var we;let He=kn(X,K);if(K.indexOf("<html>")===-1){let Pt="";const Rt=(we=Vn(X))!==null&&we!==void 0?we:"",on=Jo(X)?' crossorigin="anonymous"':"";qe.each(X.contentCSS,ft=>{Pt+='<link type="text/css" rel="stylesheet" href="'+X.documentBaseURI.toAbsolute(ft)+'"'+on+">"}),Rt&&(Pt+='<style type="text/css">'+Rt+"</style>");const Lt=Yn(X),bs=X.dom.encode,Ut='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(zt.os.isMacOS()||zt.os.isiOS()?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);<\/script> ",Ht=X.getBody().dir,We=Ht?' dir="'+bs(Ht)+'"':"";He='<!DOCTYPE html><html><head><base href="'+bs(X.documentBaseURI.getURI())+'">'+Pt+Ut+'</head><body class="'+bs(Lt)+'"'+We+">"+He+"</body></html>"}return Y(He,Kn(X))},en=(X,K)=>{const we=()=>{if(!K||K.length===0){const Ht=X.translate("No templates defined.");return X.notificationManager.open({text:Ht,type:"info"}),g.none()}return g.from(qe.map(K,(Ht,We)=>{const ft=uo=>uo.url!==void 0;return{selected:We===0,text:Ht.title,value:{url:ft(Ht)?g.from(Ht.url):g.none(),content:ft(Ht)?g.none():g.from(Ht.content),description:Ht.description}}}))},He=Ht=>qt(Ht,We=>({text:We.text,value:We.text})),Pt=(Ht,We)=>Xn(Ht,ft=>ft.text===We),Rt=Ht=>{X.windowManager.alert("Could not load the specified template.",()=>Ht.focus("template"))},on=Ht=>Ht.value.url.fold(()=>Promise.resolve(Ht.value.content.getOr("")),We=>fetch(We).then(ft=>ft.ok?ft.text():Promise.reject())),Lt=(Ht,We)=>(ft,uo)=>{if(uo.name==="template"){const co=ft.getData().template;Pt(Ht,co).each(Ln=>{ft.block("Loading..."),on(Ln).then(pn=>{We(ft,Ln,pn)}).catch(()=>{We(ft,Ln,""),ft.setEnabled("save",!1),Rt(ft)})})}},bs=Ht=>We=>{const ft=We.getData();Pt(Ht,ft.template).each(uo=>{on(uo).then(co=>{X.execCommand("mceInsertTemplate",!1,co),We.close()}).catch(()=>{We.setEnabled("save",!1),Rt(We)})})},un=Ht=>{const We=He(Ht),ft=(Ln,pn)=>({title:"Insert Template",size:"large",body:{type:"panel",items:Ln},initialData:pn,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:bs(Ht),onChange:Lt(Ht,uo)}),uo=(Ln,pn,_s)=>{const Se=lt(X,_s),wt=[{type:"listbox",name:"template",label:"Templates",items:We},{type:"htmlpanel",html:`<p aria-live="polite">${ae(pn.value.description)}</p>`},{label:"Preview",type:"iframe",name:"preview",sandboxed:!1,transparent:!1}],io={template:pn.text,preview:Se};Ln.unblock(),Ln.redial(ft(wt,io)),Ln.focus("template")},co=X.windowManager.open(ft([],{template:"",preview:""}));co.block("Loading..."),on(Ht[0]).then(Ln=>{uo(co,Ht[0],Ln)}).catch(()=>{uo(co,Ht[0],""),co.setEnabled("save",!1),Rt(co)})};we().each(un)},xt=X=>K=>{en(X,K)},At=X=>{X.addCommand("mceInsertTemplate",pt(me,X)),X.addCommand("mceTemplate",he(X,xt(X)))},yo=X=>{X.on("PreProcess",K=>{const we=X.dom,He=Et(X);qe.each(we.select("div",K.node),Pt=>{we.hasClass(Pt,"mceTmpl")&&(qe.each(we.select("*",Pt),Rt=>{be(we,Rt,kt(X))&&(Rt.innerHTML=ge(X,He))}),Ae(X,Pt))})})},Zo=X=>K=>{const we=()=>{K.setEnabled(X.selection.isEditable())};return X.on("NodeChange",we),we(),()=>{X.off("NodeChange",we)}},Qo=X=>{const K=()=>X.execCommand("mceTemplate");X.ui.registry.addButton("template",{icon:"template",tooltip:"Insert template",onSetup:Zo(X),onAction:K}),X.ui.registry.addMenuItem("template",{icon:"template",text:"Insert template...",onSetup:Zo(X),onAction:K})};var cr=()=>{$o.add("template",X=>{ie(X),Qo(X),At(X),yo(X)})};cr()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(i,u,y)=>{var T;return y(i,u.prototype)?!0:((T=i.constructor)===null||T===void 0?void 0:T.name)===u.name},bo=i=>{const u=typeof i;return i===null?"null":u==="object"&&Array.isArray(i)?"array":u==="object"&&eo(i,String,(y,T)=>T.isPrototypeOf(y))?"string":u},cn=i=>u=>bo(u)===i,_n=i=>u=>typeof u===i,Hn=i=>u=>i===u,Sn=cn("string"),Ee=cn("array"),rt=_n("boolean"),Nt=Hn(void 0),ut=i=>i==null,ln=i=>!ut(i),nn=_n("function"),pt=_n("number"),Ge=()=>{},Ye=(i,u)=>y=>i(u(y)),qe=i=>()=>i,ht=i=>i,ie=(i,u)=>i===u;function Q(i,...u){return(...y)=>{const T=u.concat(y);return i.apply(null,T)}}const kt=i=>{i()},to=qe(!1),Kn=qe(!0);class O{constructor(u,y){this.tag=u,this.value=y}static some(u){return new O(!0,u)}static none(){return O.singletonNone}fold(u,y){return this.tag?y(this.value):u()}isSome(){return this.tag}isNone(){return!this.tag}map(u){return this.tag?O.some(u(this.value)):O.none()}bind(u){return this.tag?u(this.value):O.none()}exists(u){return this.tag&&u(this.value)}forall(u){return!this.tag||u(this.value)}filter(u){return!this.tag||u(this.value)?this:O.none()}getOr(u){return this.tag?this.value:u}or(u){return this.tag?this:u}getOrThunk(u){return this.tag?this.value:u()}orThunk(u){return this.tag?this:u()}getOrDie(u){if(this.tag)return this.value;throw new Error(u??"Called getOrDie on None")}static from(u){return ln(u)?O.some(u):O.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(u){this.tag&&u(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}O.singletonNone=new O(!1);const Xe=Object.keys,Gt=Object.hasOwnProperty,Et=(i,u)=>{const y=Xe(i);for(let T=0,I=y.length;T<I;T++){const G=y[T],se=i[G];u(se,G)}},Vn=i=>(u,y)=>{i[y]=u},Jo=(i,u,y,T)=>{Et(i,(I,G)=>{(u(I,G)?y:T)(I,G)})},Yn=(i,u)=>{const y={};return Jo(i,u,Vn(y),Ge),y},ne=(i,u)=>{const y=[];return Et(i,(T,I)=>{y.push(u(T,I))}),y},ge=i=>ne(i,ht),g=i=>Xe(i).length,St=(i,u)=>qt(i,u)?O.from(i[u]):O.none(),qt=(i,u)=>Gt.call(i,u),rn=(i,u)=>qt(i,u)&&i[u]!==void 0&&i[u]!==null,Xn=i=>{for(const u in i)if(Gt.call(i,u))return!1;return!0},Jn=Array.prototype.indexOf,Tt=Array.prototype.push,Rn=(i,u)=>Jn.call(i,u),gn=(i,u)=>Rn(i,u)>-1,Lo=(i,u)=>{for(let y=0,T=i.length;y<T;y++){const I=i[y];if(u(I,y))return!0}return!1},ae=(i,u)=>{const y=[];for(let T=0;T<i;T++)y.push(u(T));return y},be=(i,u)=>{const y=i.length,T=new Array(y);for(let I=0;I<y;I++){const G=i[I];T[I]=u(G,I)}return T},kn=(i,u)=>{for(let y=0,T=i.length;y<T;y++){const I=i[y];u(I,y)}},he=(i,u)=>{for(let y=i.length-1;y>=0;y--){const T=i[y];u(T,y)}},Y=(i,u)=>{const y=[],T=[];for(let I=0,G=i.length;I<G;I++){const se=i[I];(u(se,I)?y:T).push(se)}return{pass:y,fail:T}},Ae=(i,u)=>{const y=[];for(let T=0,I=i.length;T<I;T++){const G=i[T];u(G,T)&&y.push(G)}return y},me=(i,u,y)=>(he(i,(T,I)=>{y=u(y,T,I)}),y),zt=(i,u,y)=>(kn(i,(T,I)=>{y=u(y,T,I)}),y),lt=(i,u,y)=>{for(let T=0,I=i.length;T<I;T++){const G=i[T];if(u(G,T))return O.some(G);if(y(G,T))break}return O.none()},en=(i,u)=>lt(i,u,to),xt=i=>{const u=[];for(let y=0,T=i.length;y<T;++y){if(!Ee(i[y]))throw new Error("Arr.flatten item "+y+" was not an array, input: "+i);Tt.apply(u,i[y])}return u},At=(i,u)=>xt(be(i,u)),yo=(i,u)=>{for(let y=0,T=i.length;y<T;++y){const I=i[y];if(u(I,y)!==!0)return!1}return!0},Zo=(i,u)=>{const y={};for(let T=0,I=i.length;T<I;T++){const G=i[T];y[String(G)]=u(G,T)}return y},Qo=(i,u)=>u>=0&&u<i.length?O.some(i[u]):O.none(),cr=i=>Qo(i,0),X=i=>Qo(i,i.length-1),K=(i,u)=>{for(let y=0;y<i.length;y++){const T=u(i[y],y);if(T.isSome())return T}return O.none()},we=8,He=9,Pt=11,Rt=1,on=3,Lt=(i,u)=>{const T=(u||document).createElement("div");if(T.innerHTML=i,!T.hasChildNodes()||T.childNodes.length>1){const I="HTML does not have a single root node";throw console.error(I,i),new Error(I)}return Ut(T.childNodes[0])},bs=(i,u)=>{const T=(u||document).createElement(i);return Ut(T)},un=(i,u)=>{const T=(u||document).createTextNode(i);return Ut(T)},Ut=i=>{if(i==null)throw new Error("Node cannot be null or undefined");return{dom:i}},We={fromHtml:Lt,fromTag:bs,fromText:un,fromDom:Ut,fromPoint:(i,u,y)=>O.from(i.dom.elementFromPoint(u,y)).map(Ut)},ft=(i,u)=>{const y=i.dom;if(y.nodeType!==Rt)return!1;{const T=y;if(T.matches!==void 0)return T.matches(u);if(T.msMatchesSelector!==void 0)return T.msMatchesSelector(u);if(T.webkitMatchesSelector!==void 0)return T.webkitMatchesSelector(u);if(T.mozMatchesSelector!==void 0)return T.mozMatchesSelector(u);throw new Error("Browser lacks native selectors")}},uo=i=>i.nodeType!==Rt&&i.nodeType!==He&&i.nodeType!==Pt||i.childElementCount===0,co=(i,u)=>{const y=u===void 0?document:u.dom;return uo(y)?[]:be(y.querySelectorAll(i),We.fromDom)},Ln=(i,u)=>{const y=u===void 0?document:u.dom;return uo(y)?O.none():O.from(y.querySelector(i)).map(We.fromDom)},pn=(i,u)=>i.dom===u.dom,_s=ft;typeof window<"u"||Function("return this;")();const Se=i=>i.dom.nodeName.toLowerCase(),wt=i=>i.dom.nodeType,io=i=>u=>wt(u)===i,Io=i=>wt(i)===we||Se(i)==="#comment",Os=io(Rt),es=io(on),ca=io(He),qs=io(Pt),ls=i=>u=>Os(u)&&Se(u)===i,ir=i=>We.fromDom(i.dom.ownerDocument),ts=i=>ca(i)?i:ir(i),lr=i=>O.from(i.dom.parentNode).map(We.fromDom),ur=(i,u)=>{const y=nn(u)?u:to;let T=i.dom;const I=[];for(;T.parentNode!==null&&T.parentNode!==void 0;){const G=T.parentNode,se=We.fromDom(G);if(I.push(se),y(se)===!0)break;T=G}return I},ks=i=>O.from(i.dom.previousSibling).map(We.fromDom),Es=i=>O.from(i.dom.nextSibling).map(We.fromDom),So=i=>be(i.dom.childNodes,We.fromDom),no=(i,u)=>{const y=i.dom.childNodes;return O.from(y[u]).map(We.fromDom)},Ks=i=>no(i,0),xo=i=>qs(i)&&ln(i.dom.host),$n=nn(Element.prototype.attachShadow)&&nn(Node.prototype.getRootNode)?i=>We.fromDom(i.dom.getRootNode()):ts,_r=i=>{const u=$n(i);return xo(u)?O.some(u):O.none()},M=i=>We.fromDom(i.dom.host),E=i=>{const u=es(i)?i.dom.parentNode:i.dom;if(u==null||u.ownerDocument===null)return!1;const y=u.ownerDocument;return _r(We.fromDom(u)).fold(()=>y.body.contains(u),Ye(E,M))};var U=(i,u,y,T,I)=>i(y,T)?O.some(y):nn(I)&&I(y)?O.none():u(y,T,I);const W=(i,u,y)=>{let T=i.dom;const I=nn(y)?y:to;for(;T.parentNode;){T=T.parentNode;const G=We.fromDom(T);if(u(G))return O.some(G);if(I(G))break}return O.none()},ke=(i,u,y)=>U((I,G)=>G(I),W,i,u,y),Pe=(i,u)=>{const y=I=>u(We.fromDom(I));return en(i.dom.childNodes,y).map(We.fromDom)},at=(i,u,y)=>W(i,T=>ft(T,u),y),te=(i,u)=>Pe(i,y=>ft(y,u)),It=(i,u)=>Ln(u,i),bt=(i,u,y)=>U((I,G)=>ft(I,G),at,i,u,y),Cn=i=>bt(i,"[contenteditable]"),zn=(i,u=!1)=>E(i)?i.dom.isContentEditable:Cn(i).fold(qe(u),y=>wo(y)==="true"),wo=i=>i.dom.contentEditable,Kr=i=>i.nodeName.toLowerCase(),Or=i=>We.fromDom(i.getBody()),mo=i=>u=>pn(u,Or(i)),kr=i=>i?i.replace(/px$/,""):"",hn=i=>/^\d+(\.\d+)?$/.test(i)?i+"px":i,fn=i=>We.fromDom(i.selection.getStart()),As=i=>We.fromDom(i.selection.getEnd()),Bo=i=>ke(i,ls("table")).forall(zn),Er=(i,u)=>Ae(So(i),u),dr=(i,u)=>{let y=[];return kn(So(i),T=>{u(T)&&(y=y.concat([T])),y=y.concat(dr(T,u))}),y},ia=(i,u)=>Er(i,y=>ft(y,u)),Co=(i,u)=>co(u,i),Xs=(i,u,y)=>{if(Sn(y)||rt(y)||pt(y))i.setAttribute(u,y+"");else throw console.error("Invalid call to Attribute.set. Key ",u,":: Value ",y,":: Element ",i),new Error("Attribute value was not simple")},Ds=(i,u,y)=>{Xs(i.dom,u,y)},kc=(i,u)=>{const y=i.dom;Et(u,(T,I)=>{Xs(y,I,T)})},Ar=(i,u)=>{const y=i.dom.getAttribute(u);return y===null?void 0:y},Uo=(i,u)=>O.from(Ar(i,u)),la=(i,u)=>{i.dom.removeAttribute(u)},Ec=i=>zt(i.dom.attributes,(u,y)=>(u[y.name]=y.value,u),{}),ua=(i,u,y=ie)=>i.exists(T=>y(T,u)),an=i=>{const u=[],y=T=>{u.push(T)};for(let T=0;T<i.length;T++)i[T].each(y);return u},Ms=(i,u,y)=>i.isSome()&&u.isSome()?O.some(y(i.getOrDie(),u.getOrDie())):O.none(),ns=i=>i.bind(ht),$s=(i,u)=>i?O.some(u):O.none(),da=(i,u)=>i.substring(u),us=(i,u,y)=>u===""||i.length>=u.length&&i.substr(y,y+u.length)===u,Wo=(i,u)=>Is(i,u)?da(i,u.length):i,Is=(i,u)=>us(i,u,0),Fa=(i=>u=>u.replace(i,""))(/^\s+|\s+$/g),ma=i=>i.length>0,jo=i=>!ma(i),Bs=(i,u=10)=>{const y=parseInt(i,u);return isNaN(y)?O.none():O.some(y)},tc=i=>{const u=parseFloat(i);return isNaN(u)?O.none():O.some(u)},Fs=i=>i.style!==void 0&&nn(i.style.getPropertyValue),Pa=(i,u,y)=>{if(!Sn(y))throw console.error("Invalid call to CSS.set. Property ",u,":: Value ",y,":: Element ",i),new Error("CSS value must be a string: "+y);Fs(i)&&i.style.setProperty(u,y)},Ra=(i,u)=>{Fs(i)&&i.style.removeProperty(u)},w=(i,u,y)=>{const T=i.dom;Pa(T,u,y)},$=(i,u)=>{const y=i.dom,I=window.getComputedStyle(y).getPropertyValue(u);return I===""&&!E(i)?P(y,u):I},P=(i,u)=>Fs(i)?i.style.getPropertyValue(u):"",j=(i,u)=>{const y=i.dom,T=P(y,u);return O.from(T).filter(I=>I.length>0)},ue=(i,u)=>{const y=i.dom;Ra(y,u),ua(Uo(i,"style").map(Fa),"")&&la(i,"style")},Ie=(i,u,y=0)=>Uo(i,u).map(T=>parseInt(T,10)).getOr(y),Jt=(i,u)=>Zn(i,u,Kn),Zn=(i,u,y)=>At(So(i),T=>ft(T,u)?y(T)?[T]:[]:Zn(T,u,y)),Kt=["tfoot","thead","tbody","colgroup"],Zt=i=>gn(Kt,i),sn=(i,u)=>({rows:i,columns:u}),mr=(i,u,y)=>({element:i,rowspan:u,colspan:y}),La=(i,u,y,T,I,G)=>({element:i,rowspan:u,colspan:y,row:T,column:I,isLocked:G}),Qe=(i,u,y)=>({element:i,cells:u,section:y}),Ac=(i,u,y,T)=>({startRow:i,startCol:u,finishRow:y,finishCol:T}),To=(i,u,y)=>({element:i,colspan:u,column:y}),Go=(i,u)=>({element:i,columns:u}),v=(i,u,y=to)=>{if(y(u))return O.none();if(gn(i,Se(u)))return O.some(u);const T=I=>ft(I,"table")||y(I);return at(u,i.join(","),T)},C=(i,u)=>v(["td","th"],i,u),A=i=>Jt(i,"th,td"),H=i=>ft(i,"colgroup")?ia(i,"col"):At(dn(i),u=>ia(u,"col")),ve=(i,u)=>bt(i,"table",u),pe=i=>Jt(i,"tr"),dn=i=>ve(i).fold(qe([]),u=>ia(u,"colgroup")),_o=(i,u)=>be(i,y=>{if(Se(y)==="colgroup"){const T=be(H(y),I=>{const G=Ie(I,"span",1);return mr(I,1,G)});return Qe(y,T,"colgroup")}else{const T=be(A(y),I=>{const G=Ie(I,"rowspan",1),se=Ie(I,"colspan",1);return mr(I,G,se)});return Qe(y,T,u(y))}}),Un=i=>lr(i).map(u=>{const y=Se(u);return Zt(y)?y:"tbody"}).getOr("tbody"),Dr=i=>{const u=pe(i),T=[...dn(i),...u];return _o(T,Un)},xn="data-snooker-locked-cols",ga=i=>Uo(i,xn).bind(u=>O.from(u.match(/\d+/g))).map(u=>Zo(u,Kn)),nc=(i,u)=>i+","+u,Qt=(i,u,y)=>O.from(i.access[nc(u,y)]),pa=(i,u,y)=>{const T=Dc(i,I=>y(u,I.element));return T.length>0?O.some(T[0]):O.none()},Dc=(i,u)=>{const y=At(i.all,T=>T.cells);return Ae(y,u)},Ps=i=>{const u={};let y=0;return kn(i.cells,T=>{const I=T.colspan;ae(I,G=>{const se=y+G;u[se]=To(T.element,I,se)}),y+=I}),u},In=i=>{const u={},y=[],I=cr(i).map(gs=>gs.element).bind(ve).bind(ga).getOr({});let G=0,se=0,xe=0;const{pass:tt,fail:ot}=Y(i,gs=>gs.section==="colgroup");kn(ot,gs=>{const Zr=[];kn(gs.cells,ic=>{let Pr=0;for(;u[nc(xe,Pr)]!==void 0;)Pr++;const Od=rn(I,Pr.toString()),gu=La(ic.element,ic.rowspan,ic.colspan,xe,Pr,Od);for(let pl=0;pl<ic.colspan;pl++)for(let hl=0;hl<ic.rowspan;hl++){const Eo=xe+hl,Rr=Pr+pl,lc=nc(Eo,Rr);u[lc]=gu,se=Math.max(se,Rr+1)}Zr.push(gu)}),G++,y.push(Qe(gs.element,Zr,gs.section)),xe++});const{columns:Gn,colgroups:bn}=X(tt).map(gs=>{const Zr=Ps(gs);return{colgroups:[Go(gs.element,ge(Zr))],columns:Zr}}).getOrThunk(()=>({colgroups:[],columns:{}}));return{grid:sn(G,se),access:u,all:y,columns:Gn,colgroups:bn}},Js={fromTable:i=>{const u=Dr(i);return In(u)},generate:In,getAt:Qt,findItem:pa,filterItems:Dc,justCells:i=>At(i.all,u=>u.cells),justColumns:i=>ge(i.columns),hasColumns:i=>Xe(i.columns).length>0,getColumnAt:(i,u)=>O.from(i.columns[u])};var Rs=tinymce.util.Tools.resolve("tinymce.util.Tools");const oc=(i,u,y)=>{const T=i.select("td,th",u);let I;for(let G=0;G<T.length;G++){const se=i.getStyle(T[G],y);if(Nt(I)&&(I=se),I!==se)return""}return I},ha=(i,u,y)=>{Rs.each("left center right".split(" "),T=>{T!==y&&i.formatter.remove("align"+T,{},u)}),y&&i.formatter.apply("align"+y,{},u)},Jl=(i,u,y)=>{Rs.each("top middle bottom".split(" "),T=>{T!==y&&i.formatter.remove("valign"+T,{},u)}),y&&i.formatter.apply("valign"+y,{},u)},Oo=(i,u,y)=>{i.dispatch("TableModified",{...y,table:u})},Mr=(i,u)=>tc(i).getOr(u),oi=(i,u,y)=>Mr($(i,u),y),$r=(i,u,y,T)=>{const I=oi(i,`padding-${y}`,0),G=oi(i,`padding-${T}`,0),se=oi(i,`border-${y}-width`,0),xe=oi(i,`border-${T}-width`,0);return u-I-G-se-xe},td=(i,u)=>{const y=i.dom,T=y.getBoundingClientRect().width||y.offsetWidth;return u==="border-box"?T:$r(i,T,"left","right")},$c=i=>td(i,"content-box");var Ic=tinymce.util.Tools.resolve("tinymce.Env");const Bc="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",qi=ae(5,i=>{const u=`${i+1}px`;return{title:u,value:u}}),sc=be(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],i=>({title:i,value:i.toLowerCase()})),Zl="100%",rc=i=>{var u;const y=i.dom,T=(u=y.getParent(i.selection.getStart(),y.isBlock))!==null&&u!==void 0?u:i.getBody();return $c(We.fromDom(T))+"px"},nd=(i,u)=>gi(i)||!ba(i)?u:mi(i)?{...u,width:rc(i)}:{...u,width:Zl},si=(i,u)=>gi(i)||ba(i)?u:mi(i)?{...u,width:rc(i)}:{...u,width:Zl},No=i=>u=>u.options.get(i),Xr=i=>{const u=i.options.register;u("table_border_widths",{processor:"object[]",default:qi}),u("table_border_styles",{processor:"object[]",default:sc}),u("table_cell_advtab",{processor:"boolean",default:!0}),u("table_row_advtab",{processor:"boolean",default:!0}),u("table_advtab",{processor:"boolean",default:!0}),u("table_appearance_options",{processor:"boolean",default:!0}),u("table_grid",{processor:"boolean",default:!Ic.deviceType.isTouch()}),u("table_cell_class_list",{processor:"object[]",default:[]}),u("table_row_class_list",{processor:"object[]",default:[]}),u("table_class_list",{processor:"object[]",default:[]}),u("table_toolbar",{processor:"string",default:Bc}),u("table_background_color_map",{processor:"object[]",default:[]}),u("table_border_color_map",{processor:"object[]",default:[]})},Ql=No("table_sizing_mode"),ri=No("table_border_widths"),ai=No("table_border_styles"),ci=No("table_cell_advtab"),ii=No("table_row_advtab"),fa=No("table_advtab"),li=No("table_appearance_options"),eu=No("table_grid"),ba=No("table_style_by_css"),ui=No("table_cell_class_list"),tu=No("table_row_class_list"),ac=No("table_class_list"),Ki=No("table_toolbar"),Yi=No("table_background_color_map"),di=No("table_border_color_map"),mi=i=>Ql(i)==="fixed",gi=i=>Ql(i)==="responsive",Xi=i=>{const u=i.options,y=u.get("table_default_styles");return u.isSet("table_default_styles")?y:nd(i,y)},Ji=i=>{const u=i.options,y=u.get("table_default_attributes");return u.isSet("table_default_attributes")?y:si(i,y)},pi=(i,u)=>u.column>=i.startCol&&u.column+u.colspan-1<=i.finishCol&&u.row>=i.startRow&&u.row+u.rowspan-1<=i.finishRow,od=(i,u)=>{let y=!0;const T=Q(pi,u);for(let I=u.startRow;I<=u.finishRow;I++)for(let G=u.startCol;G<=u.finishCol;G++)y=y&&Js.getAt(i,I,G).exists(T);return y?O.some(u):O.none()},nu=(i,u)=>Ac(Math.min(i.row,u.row),Math.min(i.column,u.column),Math.max(i.row+i.rowspan-1,u.row+u.rowspan-1),Math.max(i.column+i.colspan-1,u.column+u.colspan-1)),ou=(i,u,y)=>{const T=Js.findItem(i,u,pn),I=Js.findItem(i,y,pn);return T.bind(G=>I.map(se=>nu(G,se)))},Am=(i,u,y)=>ou(i,u,y).bind(T=>od(i,T)),sd=(i,u,y)=>{const T=rd(i);return Am(T,u,y)},rd=Js.fromTable,Zi=(i,u)=>{lr(i).each(T=>{T.dom.insertBefore(u.dom,i.dom)})},Ir=(i,u)=>{Es(i).fold(()=>{lr(i).each(I=>{va(I,u)})},T=>{Zi(T,u)})},ad=(i,u)=>{Ks(i).fold(()=>{va(i,u)},T=>{i.dom.insertBefore(u.dom,T.dom)})},va=(i,u)=>{i.dom.appendChild(u.dom)},cd=(i,u)=>{Zi(i,u),va(u,i)},Qi=(i,u)=>{kn(u,(y,T)=>{const I=T===0?i:u[T-1];Ir(I,y)})},id=(i,u)=>{kn(u,y=>{va(i,y)})},el=i=>{const u=i.dom;u.parentNode!==null&&u.parentNode.removeChild(u)},tl=i=>{const u=So(i);u.length>0&&Qi(i,u),el(i)},su=((i,u)=>{const y=G=>{if(!i(G))throw new Error("Can only get "+u+" value of a "+u+" node");return T(G).getOr("")},T=G=>i(G)?O.from(G.dom.nodeValue):O.none();return{get:y,getOption:T,set:(G,se)=>{if(!i(G))throw new Error("Can only set raw "+u+" value of a "+u+" node");G.dom.nodeValue=se}}})(es,"text"),ld=i=>su.get(i),Zs=(i,u)=>su.set(i,u);var ud=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ru=()=>{const i=ot=>We.fromDom(ot.dom.cloneNode(!1)),u=ot=>ts(ot).dom,y=ot=>Os(ot)?Se(ot)==="body"?!0:gn(ud,Se(ot)):!1,T=ot=>Os(ot)?gn(["br","img","hr","input"],Se(ot)):!1,I=ot=>Os(ot)&&Ar(ot,"contenteditable")==="false",G=(ot,Gn)=>ot.dom.compareDocumentPosition(Gn.dom),se=(ot,Gn)=>{const bn=Ec(ot);kc(Gn,bn)},xe=ot=>{const Gn=Se(ot);return gn(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],Gn)},tt=ot=>Os(ot)?Uo(ot,"lang"):O.none();return{up:qe({selector:at,closest:bt,predicate:W,all:ur}),down:qe({selector:Co,predicate:dr}),styles:qe({get:$,getRaw:j,set:w,remove:ue}),attrs:qe({get:Ar,set:Ds,remove:la,copyTo:se}),insert:qe({before:Zi,after:Ir,afterAll:Qi,append:va,appendAll:id,prepend:ad,wrap:cd}),remove:qe({unwrap:tl,remove:el}),create:qe({nu:We.fromTag,clone:i,text:We.fromText}),query:qe({comparePosition:G,prevSibling:ks,nextSibling:Es}),property:qe({children:So,name:Se,parent:lr,document:u,isText:es,isComment:Io,isElement:Os,isSpecial:xe,getLanguage:tt,getText:ld,setText:Zs,isBoundary:y,isEmptyTag:T,isNonEditable:I}),eq:pn,is:_s}};const nl=(i,u,y,T)=>{const I=y[0],G=y.slice(1);return T(i,u,I,G)},gr=(i,u,y)=>y.length>0?nl(i,u,y,Ls):O.none(),Ls=(i,u,y,T)=>{const I=u(i,y);return me(T,(G,se)=>{const xe=u(i,se);return au(i,G,xe)},I)},au=(i,u,y)=>u.bind(T=>y.filter(Q(i.eq,T))),dd=gr,ol=ru(),sl=(i,u)=>dd(ol,(y,T)=>i(T),u),rl=i=>at(i,"table"),cu=(i,u)=>{const y=Co(i,u);return y.length>0?O.some(y):O.none()},md=(i,u,y)=>It(i,u).bind(T=>It(i,y).bind(I=>sl(rl,[T,I]).map(G=>({first:T,last:I,table:G})))),Dm=(i,u)=>cu(i,u),gd=(i,u,y)=>md(i,u,y).bind(T=>{const I=tt=>pn(i,tt),G="thead,tfoot,tbody,table",se=at(T.first,G,I),xe=at(T.last,G,I);return se.bind(tt=>xe.bind(ot=>pn(tt,ot)?sd(T.table,T.first,T.last):O.none()))}),al=i=>be(i,We.fromDom),Fc="data-mce-selected",pd="td["+Fc+"],th["+Fc+"]",cl="data-mce-first-selected",m="td["+cl+"],th["+cl+"]",f="data-mce-last-selected",x="td["+f+"],th["+f+"]",D={selected:Fc,selectedSelector:pd,firstSelected:cl,firstSelectedSelector:m,lastSelected:f,lastSelectedSelector:x},F=i=>ve(i).bind(u=>Dm(u,D.firstSelectedSelector)).fold(qe(i),u=>u[0]),oe=i=>(u,y)=>{const T=Se(u),I=T==="col"||T==="colgroup"?F(u):u;return bt(I,i,y)},Je=oe("th,td,caption"),ct=oe("th,td"),_t=i=>al(i.model.table.getSelectedCells()),et=(i,u)=>{const y=ct(i),T=y.bind(I=>ve(I)).map(I=>pe(I));return Ms(y,T,(I,G)=>Ae(G,se=>Lo(al(se.dom.cells),xe=>Ar(xe,u)==="1"||pn(xe,I)))).getOr([])},Me=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],Fn=i=>({value:Mm(i)}),vs=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Xp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Jp=i=>vs.test(i)||Xp.test(i),Mm=i=>Wo(i,"#").toUpperCase(),Zp=i=>Jp(i)?O.some({value:Mm(i)}):O.none(),hd=i=>{const u=i.toString(16);return(u.length===1?"0"+u:u).toUpperCase()},iu=i=>{const u=hd(i.red)+hd(i.green)+hd(i.blue);return Fn(u)},$m=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,Ny=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Im=(i,u,y,T)=>({red:i,green:u,blue:y,alpha:T}),oo=(i,u,y,T)=>{const I=parseInt(i,10),G=parseInt(u,10),se=parseInt(y,10),xe=parseFloat(T);return Im(I,G,se,xe)},fd=i=>{if(i==="transparent")return O.some(Im(0,0,0,0));const u=$m.exec(i);if(u!==null)return O.some(oo(u[1],u[2],u[3],"1"));const y=Ny.exec(i);return y!==null?O.some(oo(y[1],y[2],y[3],y[4])):O.none()},Qp=i=>Zp(i).orThunk(()=>fd(i).map(iu)).getOrThunk(()=>{const u=document.createElement("canvas");u.height=1,u.width=1;const y=u.getContext("2d");y.clearRect(0,0,u.width,u.height),y.fillStyle="#FFFFFF",y.fillStyle=i,y.fillRect(0,0,1,1);const T=y.getImageData(0,0,1,1).data,I=T[0],G=T[1],se=T[2],xe=T[3];return iu(Im(I,G,se,xe))}),bd=i=>fd(i).map(iu).map(u=>"#"+u.value).getOr(i),vd=i=>{let u=i;return{get:()=>u,set:I=>{u=I}}},eh=i=>{const u=vd(O.none()),y=()=>u.get().each(i);return{clear:()=>{y(),u.set(O.none())},isSet:()=>u.get().isSome(),get:()=>u.get(),set:xe=>{y(),u.set(O.some(xe))}}},Bm=()=>eh(i=>i.unbind()),Wn=(i,u,y)=>T=>{const I=Bm(),G=jo(y),se=()=>{const xe=_t(i),tt=ot=>i.formatter.match(u,{value:y},ot.dom,G);G?(T.setActive(!Lo(xe,tt)),I.set(i.formatter.formatChanged(u,ot=>T.setActive(!ot),!0))):(T.setActive(yo(xe,tt)),I.set(i.formatter.formatChanged(u,T.setActive,!1,{value:y})))};return i.initialized?se():i.on("init",se),I.clear},lu=i=>rn(i,"menu"),Ns=i=>be(i,u=>{const y=u.text||u.title||"";return lu(u)?{text:y,items:Ns(u.menu)}:{text:y,value:u.value}}),ya=(i,u,y,T)=>be(u,I=>{const G=I.text||I.title;return lu(I)?{type:"nestedmenuitem",text:G,getSubmenuItems:()=>ya(i,I.menu,y,T)}:{text:G,type:"togglemenuitem",onAction:()=>T(I.value),onSetup:Wn(i,y,I.value)}}),Na=(i,u)=>y=>{i.execCommand("mceTableApplyCellStyle",!1,{[u]:y})},Pc=i=>At(i,u=>lu(u)?[{...u,menu:Pc(u.menu)}]:ma(u.value)?[u]:[]),Rc=(i,u,y,T)=>I=>I(ya(i,u,y,T)),uu=(i,u,y)=>{const T=be(u,I=>({text:I.title,value:"#"+Qp(I.value).value,type:"choiceitem"}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:T.length>0?T:void 0,allowCustomColors:!1},onAction:I=>{const G=I.value==="remove"?"":I.value;i.execCommand("mceTableApplyCellStyle",!1,{[y]:G})}}]},Fm=i=>()=>{const y=i.queryCommandValue("mceTableRowType")==="header"?"body":"header";i.execCommand("mceTableRowType",!1,{type:y})},yd=i=>()=>{const y=i.queryCommandValue("mceTableColType")==="th"?"td":"th";i.execCommand("mceTableColType",!1,{type:y})},Hy=i=>{const u=Ns(ui(i));return u.length>0?O.some({name:"class",type:"listbox",label:"Class",items:u}):O.none()},Vy=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Me}],Sd=i=>Vy.concat(Hy(i).toArray()),il=(i,u)=>{const T=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(Ns(ai(i)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:u==="cell"?[{name:"borderwidth",type:"input",label:"Border width"}].concat(T):T}},Lc={normal:(i,u)=>{const y=i.dom;return{setAttrib:(se,xe)=>{y.setAttrib(u,se,xe)},setStyle:(se,xe)=>{y.setStyle(u,se,xe)},setFormat:(se,xe)=>{xe===""?i.formatter.remove(se,{value:null},u,!0):i.formatter.apply(se,{value:xe},u)}}}},th=ls("th"),nh=(i,u)=>i&&u?"sectionCells":i?"section":"cells",oh=i=>{const u=i.section==="thead",y=ua(sh(i.cells),"th");return i.section==="tfoot"?{type:"footer"}:u||y?{type:"header",subType:nh(u,y)}:{type:"body"}},sh=i=>{const u=Ae(i,y=>th(y.element));return u.length===0?O.some("td"):u.length===i.length?O.some("th"):O.none()},rh=i=>{const u=be(i,I=>oh(I).type),y=gn(u,"header"),T=gn(u,"footer");if(!y&&!T)return O.some("body");{const I=gn(u,"body");return y&&!I&&!T?O.some("header"):!y&&!I&&T?O.some("footer"):O.none()}},fi=i=>{let u=!1,y;return(...T)=>(u||(u=!0,y=i.apply(null,T)),y)},xd=(i,u)=>K(i.all,y=>en(y.cells,T=>pn(u,T.element))),ah=(i,u,y)=>{const T=be(u.selection,G=>C(G).bind(se=>xd(i,se)).filter(y)),I=an(T);return $s(I.length>0,I)},Pm=(i,u)=>u.mergable,ch=(i,u)=>u.unmergable,Rm=(i,u)=>ah(i,u,Kn),ih=(i,u)=>xd(i,u).exists(y=>!y.isLocked),Lm=(i,u)=>yo(u,y=>ih(i,y)),Nm=(i,u)=>Pm(i,u).filter(y=>Lm(i,y.cells)),lh=(i,u)=>ch(i,u).filter(y=>Lm(i,y));({...{generate:i=>{if(!Ee(i))throw new Error("cases must be an array");if(i.length===0)throw new Error("there must be at least one case");const u=[],y={};return kn(i,(T,I)=>{const G=Xe(T);if(G.length!==1)throw new Error("one and only one name per case");const se=G[0],xe=T[se];if(y[se]!==void 0)throw new Error("duplicate key detected:"+se);if(se==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Ee(xe))throw new Error("case arguments must be an array");u.push(se),y[se]=(...tt)=>{const ot=tt.length;if(ot!==xe.length)throw new Error("Wrong number of arguments to case "+se+". Expected "+xe.length+" ("+xe+"), got "+ot);return{fold:(...bn)=>{if(bn.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+bn.length);return bn[I].apply(null,tt)},match:bn=>{const En=Xe(bn);if(u.length!==En.length)throw new Error("Wrong number of arguments to match. Expected: "+u.join(",")+`
Actual: `+En.join(","));if(!yo(u,Zr=>gn(En,Zr)))throw new Error("Not all branches were specified when using match. Specified: "+En.join(", ")+`
Required: `+u.join(", "));return bn[se].apply(null,tt)},log:bn=>{console.log(bn,{constructors:u,constructor:se,params:tt})}}}}),y}}.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])});const uh=(i,u)=>{const y=Js.fromTable(i);return Rm(y,u).bind(I=>{const G=I[I.length-1],se=I[0].row,xe=G.row+G.rowspan,tt=y.all.slice(se,xe);return rh(tt)}).getOr("")},du=i=>Is(i,"rgb")?bd(i):i,ll=i=>{const u=We.fromDom(i);return{borderwidth:j(u,"border-width").getOr(""),borderstyle:j(u,"border-style").getOr(""),bordercolor:j(u,"border-color").map(du).getOr(""),backgroundcolor:j(u,"background-color").map(du).getOr("")}},Br=i=>{const u=i[0],y=i.slice(1);return kn(y,T=>{kn(Xe(u),I=>{Et(T,(G,se)=>{const xe=u[I];xe!==""&&I===se&&xe!==G&&(u[I]="")})})}),u},ul=(i,u,y,T)=>en(i,I=>!Nt(y.formatter.matchNode(T,u+I))).getOr(""),bi=Q(ul,["left","center","right"],"align"),Fo=Q(ul,["top","middle","bottom"],"valign"),dl=(i,u)=>{const y=Xi(i),T=Ji(i),I=()=>({borderstyle:St(y,"border-style").getOr(""),bordercolor:du(St(y,"border-color").getOr("")),backgroundcolor:du(St(y,"background-color").getOr(""))}),G={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},se=()=>{const Gn=y["border-width"];return ba(i)&&Gn?{border:Gn}:St(T,"border").fold(()=>({}),bn=>({border:bn}))},xe=u?I():{},tt=()=>{const Gn=St(y,"border-spacing").or(St(T,"cellspacing")).fold(()=>({}),En=>({cellspacing:En})),bn=St(y,"border-padding").or(St(T,"cellpadding")).fold(()=>({}),En=>({cellpadding:En}));return{...Gn,...bn}};return{...G,...y,...T,...xe,...se(),...tt()}},wd=i=>ve(We.fromDom(i)).map(u=>{const y={selection:al(i.cells)};return uh(u,y)}).getOr(""),Vm=(i,u,y)=>{const T=(xe,tt)=>{const ot=j(We.fromDom(tt),"border-width");return ba(i)&&ot.isSome()?ot.getOr(""):xe.getAttrib(tt,"border")||oc(i.dom,tt,"border-width")||oc(i.dom,tt,"border")||""},I=i.dom,G=ba(i)?I.getStyle(u,"border-spacing")||I.getAttrib(u,"cellspacing"):I.getAttrib(u,"cellspacing")||I.getStyle(u,"border-spacing"),se=ba(i)?oc(I,u,"padding")||I.getAttrib(u,"cellpadding"):I.getAttrib(u,"cellpadding")||oc(I,u,"padding");return{width:I.getStyle(u,"width")||I.getAttrib(u,"width"),height:I.getStyle(u,"height")||I.getAttrib(u,"height"),cellspacing:G??"",cellpadding:se??"",border:T(I,u),caption:!!I.select("caption",u)[0],class:I.getAttrib(u,"class",""),align:bi(i,u),...y?ll(u):{}}},dh=(i,u,y)=>{const T=i.dom;return{height:T.getStyle(u,"height")||T.getAttrib(u,"height"),class:T.getAttrib(u,"class",""),type:wd(u),align:bi(i,u),...y?ll(u):{}}},mh=(i,u,y,T)=>{const I=i.dom,G=T.getOr(u),se=(xe,tt)=>I.getStyle(xe,tt)||I.getAttrib(xe,tt);return{width:se(G,"width"),height:se(u,"height"),scope:I.getAttrib(u,"scope"),celltype:Kr(u),class:I.getAttrib(u,"class",""),halign:bi(i,u),valign:Fo(i,u),...y?ll(u):{}}},Hc=(i,u)=>{const y=Js.fromTable(i),T=Js.justCells(y),I=Ae(T,G=>Lo(u,se=>pn(G.element,se)));return be(I,G=>({element:G.element.dom,column:Js.getColumnAt(y,G.column).map(se=>se.element.dom)}))},gh=(i,u,y,T)=>{T("scope")&&i.setAttrib("scope",y.scope),T("class")&&i.setAttrib("class",y.class),T("height")&&i.setStyle("height",hn(y.height)),T("width")&&u.setStyle("width",hn(y.width))},ml=(i,u,y)=>{y("backgroundcolor")&&i.setFormat("tablecellbackgroundcolor",u.backgroundcolor),y("bordercolor")&&i.setFormat("tablecellbordercolor",u.bordercolor),y("borderstyle")&&i.setFormat("tablecellborderstyle",u.borderstyle),y("borderwidth")&&i.setFormat("tablecellborderwidth",hn(u.borderwidth))},zm=(i,u,y,T)=>{const I=u.length===1;kn(u,G=>{const se=G.element,xe=I?Kn:T,tt=Lc.normal(i,se),ot=G.column.map(Gn=>Lc.normal(i,Gn)).getOr(tt);gh(tt,ot,y,xe),ci(i)&&ml(tt,y,xe),T("halign")&&ha(i,se,y.halign),T("valign")&&Jl(i,se,y.valign)})},ph=(i,u)=>{i.execCommand("mceTableCellType",!1,{type:u.celltype,no_events:!0})},jn=(i,u,y,T)=>{const I=Yn(T,(G,se)=>y[se]!==G);g(I)>0&&u.length>=1&&ve(u[0]).each(G=>{const se=Hc(G,u),xe=g(Yn(I,(ot,Gn)=>Gn!=="scope"&&Gn!=="celltype"))>0,tt=qt(I,"celltype");(xe||qt(I,"scope"))&&zm(i,se,T,Q(qt,I)),tt&&ph(i,T),Oo(i,G.dom,{structure:tt,style:xe})})},Jr=(i,u,y,T)=>{const I=T.getData();T.close(),i.undoManager.transact(()=>{jn(i,u,y,I),i.focus()})},ys=(i,u)=>{const y=ve(u[0]).map(T=>be(Hc(T,u),I=>mh(i,I.element,ci(i),I.column)));return Br(y.getOrDie())},vi=i=>{const u=_t(i);if(u.length===0)return;const y=ys(i,u),T={type:"tabpanel",tabs:[{title:"General",name:"general",items:Sd(i)},il(i,"cell")]},I={type:"panel",items:[{type:"grid",columns:2,items:Sd(i)}]};i.windowManager.open({title:"Cell Properties",size:"normal",body:ci(i)?T:I,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:y,onSubmit:Q(Jr,i,u,y)})},Hs=i=>{const u=Ns(tu(i));return u.length>0?O.some({name:"class",type:"listbox",label:"Class",items:u}):O.none()},Um=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Po=i=>Um.concat(Hs(i).toArray()),ds=(i,u,y)=>{y("class")&&i.setAttrib("class",u.class),y("height")&&i.setStyle("height",hn(u.height))},Cd=(i,u,y)=>{y("backgroundcolor")&&i.setStyle("background-color",u.backgroundcolor),y("bordercolor")&&i.setStyle("border-color",u.bordercolor),y("borderstyle")&&i.setStyle("border-style",u.borderstyle)},J=(i,u,y,T)=>{const G=u.length===1?Kn:T;kn(u,se=>{const xe=Lc.normal(i,se);ds(xe,y,G),ii(i)&&Cd(xe,y,G),T("align")&&ha(i,se,y.align)})},Qs=(i,u)=>{i.execCommand("mceTableRowType",!1,{type:u.type,no_events:!0})},hh=(i,u,y,T)=>{const I=Yn(T,(G,se)=>y[se]!==G);if(g(I)>0){const G=qt(I,"type"),se=G?g(I)>1:!0;se&&J(i,u,T,Q(qt,I)),G&&Qs(i,T),ve(We.fromDom(u[0])).each(xe=>Oo(i,xe.dom,{structure:G,style:se}))}},go=(i,u,y,T)=>{const I=T.getData();T.close(),i.undoManager.transact(()=>{hh(i,u,y,I),i.focus()})},Ha=i=>{const u=et(fn(i),D.selected);if(u.length===0)return;const y=be(u,se=>dh(i,se.dom,ii(i))),T=Br(y),I={type:"tabpanel",tabs:[{title:"General",name:"general",items:Po(i)},il(i,"row")]},G={type:"panel",items:[{type:"grid",columns:2,items:Po(i)}]};i.windowManager.open({title:"Row Properties",size:"normal",body:ii(i)?I:G,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:T,onSubmit:Q(go,i,be(u,se=>se.dom),T)})},fh=(i,u,y)=>{const T=y?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],I=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],G=li(i)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],se=[{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],xe=u.length>0?[{type:"listbox",name:"class",label:"Class",items:u}]:[];return T.concat(I).concat(G).concat(se).concat(xe)},hr=(i,u,y,T)=>{if(u.tagName==="TD"||u.tagName==="TH")Sn(y)&&ln(T)?i.setStyle(u,y,T):i.setStyles(u,y);else if(u.children)for(let I=0;I<u.children.length;I++)hr(i,u.children[I],y,T)},bh=(i,u,y,T)=>{const I=i.dom,G={},se={},xe=ba(i),tt=fa(i);if(Nt(y.class)||(G.class=y.class),se.height=hn(y.height),xe?se.width=hn(y.width):I.getAttrib(u,"width")&&(G.width=kr(y.width)),xe?(se["border-width"]=hn(y.border),se["border-spacing"]=hn(y.cellspacing)):(G.border=y.border,G.cellpadding=y.cellpadding,G.cellspacing=y.cellspacing),xe&&u.children){const ot={};if(T.border&&(ot["border-width"]=hn(y.border)),T.cellpadding&&(ot.padding=hn(y.cellpadding)),tt&&T.bordercolor&&(ot["border-color"]=y.bordercolor),!Xn(ot))for(let Gn=0;Gn<u.children.length;Gn++)hr(I,u.children[Gn],ot)}if(tt){const ot=y;se["background-color"]=ot.backgroundcolor,se["border-color"]=ot.bordercolor,se["border-style"]=ot.borderstyle}G.style=I.serializeStyle({...Xi(i),...se}),I.setAttribs(u,{...Ji(i),...G})},cc=(i,u,y,T)=>{const I=i.dom,G=T.getData(),se=Yn(G,(xe,tt)=>y[tt]!==xe);T.close(),G.class===""&&delete G.class,i.undoManager.transact(()=>{if(!u){const xe=Bs(G.cols).getOr(1),tt=Bs(G.rows).getOr(1);i.execCommand("mceInsertTable",!1,{rows:tt,columns:xe}),u=ct(fn(i),mo(i)).bind(ot=>ve(ot,mo(i))).map(ot=>ot.dom).getOrDie()}if(g(se)>0){const xe={border:qt(se,"border"),bordercolor:qt(se,"bordercolor"),cellpadding:qt(se,"cellpadding")};bh(i,u,G,xe);const tt=I.select("caption",u)[0];(tt&&!G.caption||!tt&&G.caption)&&i.execCommand("mceTableToggleCaption"),ha(i,u,G.align)}if(i.focus(),i.addVisual(),g(se)>0){const xe=qt(se,"caption"),tt=xe?g(se)>1:!0;Oo(i,u,{structure:xe,style:tt})}})},Td=(i,u)=>{const y=i.dom;let T,I=dl(i,fa(i));u?(I.cols="1",I.rows="1",fa(i)&&(I.borderstyle="",I.bordercolor="",I.backgroundcolor="")):(T=y.getParent(i.selection.getStart(),"table",i.getBody()),T?I=Vm(i,T,fa(i)):fa(i)&&(I.borderstyle="",I.bordercolor="",I.backgroundcolor=""));const G=Ns(ac(i));G.length>0&&I.class&&(I.class=I.class.replace(/\s*mce\-item\-table\s*/g,""));const se={type:"grid",columns:2,items:fh(i,G,u)},xe=()=>({type:"panel",items:[se]}),tt=()=>({type:"tabpanel",tabs:[{title:"General",name:"general",items:[se]},il(i,"table")]}),ot=fa(i)?tt():xe();i.windowManager.open({title:"Table Properties",size:"normal",body:ot,onSubmit:Q(cc,i,T,I),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:I})},er=i=>{const u=y=>{Bo(fn(i))&&y()};Et({mceTableProps:Q(Td,i,!1),mceTableRowProps:Q(Ha,i),mceTableCellProps:Q(vi,i),mceInsertTableDialog:Q(Td,i,!0)},(y,T)=>i.addCommand(T,()=>u(y)))},Wt=(i,u)=>te(i,u).isSome(),Sa=ht,gl=i=>{const u=(T,I)=>Uo(T,I).exists(G=>parseInt(G,10)>1),y=T=>u(T,"rowspan")||u(T,"colspan");return i.length>0&&yo(i,y)?O.some(i):O.none()},ms=(i,u,y)=>u.length<=1?O.none():gd(i,y.firstSelectedSelector,y.lastSelectedSelector).map(T=>({bounds:T,cells:u})),Wm=i=>({element:i,mergable:O.none(),unmergable:O.none(),selection:[i]}),Vc=(i,u,y)=>({element:y,mergable:ms(u,i,D),unmergable:gl(i),selection:Sa(i)}),jm=i=>{const u=vd(O.none()),y=vd([]);let T=O.none();const I=ls("caption"),G=mt=>T.forall(An=>!An[mt]),se=()=>Je(fn(i),mo(i)),xe=()=>Je(As(i),mo(i)),tt=()=>se().bind(mt=>ns(Ms(ve(mt),xe().bind(ve),(An,os)=>pn(An,os)?I(mt)?O.some(Wm(mt)):O.some(Vc(_t(i),An,mt)):O.none()))),ot=mt=>ve(mt.element).map(os=>{const Vs=Js.fromTable(os),za=Rm(Vs,mt).getOr([]),uc=zt(za,(fl,nr)=>(nr.isLocked&&(fl.onAny=!0,nr.column===0?fl.onFirst=!0:nr.column+nr.colspan>=Vs.grid.columns&&(fl.onLast=!0)),fl),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Nm(Vs,mt).isSome(),unmergeable:lh(Vs,mt).isSome(),locked:uc}}),Gn=()=>{u.set(fi(tt)()),T=u.get().bind(ot),kn(y.get(),kt)},bn=mt=>(mt(),y.set(y.get().concat([mt])),()=>{y.set(Ae(y.get(),An=>An!==mt))}),En=(mt,An)=>bn(()=>u.get().fold(()=>{mt.setEnabled(!1)},os=>{mt.setEnabled(!An(os)&&i.selection.isEditable())})),gs=(mt,An,os)=>bn(()=>u.get().fold(()=>{mt.setEnabled(!1),mt.setActive(!1)},Vs=>{mt.setEnabled(!An(Vs)&&i.selection.isEditable()),mt.setActive(os(Vs))})),Zr=mt=>T.exists(An=>An.locked[mt]),ic=mt=>En(mt,An=>!1),Pr=mt=>En(mt,An=>I(An.element)),Od=mt=>An=>En(An,os=>I(os.element)||Zr(mt)),gu=mt=>An=>En(An,os=>I(os.element)||mt().isNone()),pl=(mt,An)=>os=>En(os,Vs=>I(Vs.element)||mt().isNone()||Zr(An)),hl=mt=>En(mt,An=>G("mergeable")),Eo=mt=>En(mt,An=>G("unmergeable")),Rr=mt=>gs(mt,to,An=>ve(An.element,mo(i)).exists(Vs=>Wt(Vs,"caption"))),lc=(mt,An)=>os=>gs(os,Vs=>I(Vs.element),()=>i.queryCommandValue(mt)===An),zc=lc("mceTableRowType","header"),qm=lc("mceTableColType","th");return i.on("NodeChange ExecCommand TableSelectorChange",Gn),{onSetupTable:ic,onSetupCellOrRow:Pr,onSetupColumn:Od,onSetupPasteable:gu,onSetupPasteableColumn:pl,onSetupMergeable:hl,onSetupUnmergeable:Eo,resetTargets:Gn,onSetupTableWithCaption:Rr,onSetupTableRowHeaders:zc,onSetupTableColumnHeaders:qm,targets:u.get}};var tr=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const Gm="x-tinymce/dom-table-",N=Gm+"rows",fr=Gm+"columns",mu=i=>{var u;const y=(u=tr.read())!==null&&u!==void 0?u:[];return K(y,T=>O.from(T.getType(i)))},Fr=()=>mu(N),br=()=>mu(fr),Ho=i=>u=>{const y=()=>{u.setEnabled(i.selection.isEditable())};return i.on("NodeChange",y),y(),()=>{i.off("NodeChange",y)}},ko=(i,u)=>{i.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",onSetup:Ho(i),fetch:xe=>xe("inserttable | cell row column | advtablesort | tableprops deletetable")});const y=xe=>()=>i.execCommand(xe),T=(xe,tt)=>{i.queryCommandSupported(tt.command)&&i.ui.registry.addButton(xe,{...tt,onAction:nn(tt.onAction)?tt.onAction:y(tt.command)})},I=(xe,tt)=>{i.queryCommandSupported(tt.command)&&i.ui.registry.addToggleButton(xe,{...tt,onAction:nn(tt.onAction)?tt.onAction:y(tt.command)})};T("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:u.onSetupTable}),T("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:u.onSetupTable}),T("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:u.onSetupCellOrRow}),T("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:u.onSetupMergeable}),T("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:u.onSetupUnmergeable}),T("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:u.onSetupCellOrRow}),T("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:u.onSetupCellOrRow}),T("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:u.onSetupCellOrRow}),T("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:u.onSetupCellOrRow}),T("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:u.onSetupColumn("onFirst")}),T("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:u.onSetupColumn("onLast")}),T("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:u.onSetupColumn("onAny")}),T("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:u.onSetupCellOrRow}),T("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:u.onSetupCellOrRow}),T("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:u.onSetupPasteable(Fr)}),T("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:u.onSetupPasteable(Fr)}),T("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:u.onSetupColumn("onAny")}),T("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:u.onSetupColumn("onAny")}),T("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:u.onSetupPasteableColumn(br,"onFirst")}),T("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:u.onSetupPasteableColumn(br,"onLast")}),T("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table",onSetup:Ho(i)});const G=Pc(ac(i));G.length!==0&&i.queryCommandSupported("mceTableToggleClass")&&i.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Rc(i,G,"tableclass",xe=>i.execCommand("mceTableToggleClass",!1,xe)),onSetup:u.onSetupTable});const se=Pc(ui(i));se.length!==0&&i.queryCommandSupported("mceTableCellToggleClass")&&i.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Rc(i,se,"tablecellclass",xe=>i.execCommand("mceTableCellToggleClass",!1,xe)),onSetup:u.onSetupCellOrRow}),i.queryCommandSupported("mceTableApplyCellStyle")&&(i.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Rc(i,Me,"tablecellverticalalign",Na(i,"vertical-align")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Rc(i,ri(i),"tablecellborderwidth",Na(i,"border-width")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Rc(i,ai(i),"tablecellborderstyle",Na(i,"border-style")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:xe=>xe(uu(i,Yi(i),"background-color")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:xe=>xe(uu(i,di(i),"border-color")),onSetup:u.onSetupCellOrRow})),I("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:u.onSetupTableWithCaption}),I("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:Fm(i),onSetup:u.onSetupTableRowHeaders}),I("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:yd(i),onSetup:u.onSetupTableColumnHeaders})},vh=i=>{const u=T=>i.dom.is(T,"table")&&i.getBody().contains(T)&&i.dom.isEditable(T.parentNode),y=Ki(i);y.length>0&&i.ui.registry.addContextToolbar("table",{predicate:u,items:y,scope:"node",position:"node"})},Va=i=>u=>{const y=()=>{u.setEnabled(i.selection.isEditable())};return i.on("NodeChange",y),y(),()=>{i.off("NodeChange",y)}},_d=(i,u)=>{const y=bn=>()=>i.execCommand(bn),T=(bn,En)=>i.queryCommandSupported(En.command)?(i.ui.registry.addMenuItem(bn,{...En,onAction:nn(En.onAction)?En.onAction:y(En.command)}),!0):!1,I=(bn,En)=>{i.queryCommandSupported(En.command)&&i.ui.registry.addToggleMenuItem(bn,{...En,onAction:nn(En.onAction)?En.onAction:y(En.command)})},G=bn=>{i.execCommand("mceInsertTable",!1,{rows:bn.numRows,columns:bn.numColumns})},se=[T("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:u.onSetupCellOrRow}),T("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:u.onSetupCellOrRow}),T("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:u.onSetupCellOrRow}),T("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:u.onSetupCellOrRow}),T("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:u.onSetupCellOrRow}),T("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:u.onSetupCellOrRow}),T("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:u.onSetupPasteable(Fr)}),T("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:u.onSetupPasteable(Fr)})],xe=[T("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:u.onSetupColumn("onFirst")}),T("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:u.onSetupColumn("onLast")}),T("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:u.onSetupColumn("onAny")}),T("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:u.onSetupColumn("onAny")}),T("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:u.onSetupColumn("onAny")}),T("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:u.onSetupPasteableColumn(br,"onFirst")}),T("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:u.onSetupPasteableColumn(br,"onLast")})],tt=[T("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:u.onSetupCellOrRow}),T("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:u.onSetupMergeable}),T("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:u.onSetupUnmergeable})];eu(i)?i.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:G}],onSetup:Va(i)}):i.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:y("mceInsertTableDialog"),onSetup:Va(i)}),i.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:y("mceInsertTableDialog"),onSetup:Va(i)}),T("tableprops",{text:"Table properties",onSetup:u.onSetupTable,command:"mceTableProps"}),T("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:u.onSetupTable,command:"mceTableDelete"}),gn(se,!0)&&i.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:qe("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),gn(xe,!0)&&i.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:qe("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),gn(tt,!0)&&i.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:qe("tablecellprops tablemergecells tablesplitcells")}),i.ui.registry.addContextMenu("table",{update:()=>(u.resetTargets(),u.targets().fold(qe(""),bn=>Se(bn.element)==="caption"?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"))});const ot=Pc(ac(i));ot.length!==0&&i.queryCommandSupported("mceTableToggleClass")&&i.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>ya(i,ot,"tableclass",bn=>i.execCommand("mceTableToggleClass",!1,bn)),onSetup:u.onSetupTable});const Gn=Pc(ui(i));Gn.length!==0&&i.queryCommandSupported("mceTableCellToggleClass")&&i.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>ya(i,Gn,"tablecellclass",bn=>i.execCommand("mceTableCellToggleClass",!1,bn)),onSetup:u.onSetupCellOrRow}),i.queryCommandSupported("mceTableApplyCellStyle")&&(i.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>ya(i,Me,"tablecellverticalalign",Na(i,"vertical-align")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>ya(i,ri(i),"tablecellborderwidth",Na(i,"border-width")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>ya(i,ai(i),"tablecellborderstyle",Na(i,"border-style")),onSetup:u.onSetupCellOrRow}),i.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>uu(i,Yi(i),"background-color"),onSetup:u.onSetupCellOrRow}),i.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>uu(i,di(i),"border-color"),onSetup:u.onSetupCellOrRow})),I("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:u.onSetupTableWithCaption}),I("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:Fm(i),onSetup:u.onSetupTableRowHeaders}),I("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:yd(i),onSetup:u.onSetupTableRowHeaders})},Le=i=>{const u=jm(i);Xr(i),er(i),_d(i,u),ko(i,u),vh(i)};var Uy=()=>{$o.add("table",Le)};Uy()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager"),eo=tinymce.util.Tools.resolve("tinymce.Env");const bo=Ge=>Ye=>Ye.options.get(Ge),cn=Ge=>{const Ye=Ge.options.register;Ye("pagebreak_separator",{processor:"string",default:"<!-- pagebreak -->"}),Ye("pagebreak_split_block",{processor:"boolean",default:!1})},_n=bo("pagebreak_separator"),Hn=bo("pagebreak_split_block"),Sn="mce-pagebreak",Ee=Ge=>{const Ye=`<img src="${eo.transparentSrc}" class="${Sn}" data-mce-resize="false" data-mce-placeholder />`;return Ge?`<p>${Ye}</p>`:Ye},rt=Ge=>{const Ye=_n(Ge),qe=()=>Hn(Ge),ht=new RegExp(Ye.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,ie=>"\\"+ie),"gi");Ge.on("BeforeSetContent",ie=>{ie.content=ie.content.replace(ht,Ee(qe()))}),Ge.on("PreInit",()=>{Ge.serializer.addNodeFilter("img",ie=>{let Q=ie.length,kt,to;for(;Q--;)if(kt=ie[Q],to=kt.attr("class"),to&&to.indexOf(Sn)!==-1){const Kn=kt.parent;if(Kn&&Ge.schema.getBlockElements()[Kn.name]&&qe()){Kn.type=3,Kn.value=Ye,Kn.raw=!0,kt.remove();continue}kt.type=3,kt.value=Ye,kt.raw=!0}})})},Nt=Ge=>{Ge.addCommand("mcePageBreak",()=>{Ge.insertContent(Ee(Hn(Ge)))})},ut=Ge=>{Ge.on("ResolveName",Ye=>{Ye.target.nodeName==="IMG"&&Ge.dom.hasClass(Ye.target,Sn)&&(Ye.name="pagebreak")})},ln=Ge=>Ye=>{const qe=()=>{Ye.setEnabled(Ge.selection.isEditable())};return Ge.on("NodeChange",qe),qe(),()=>{Ge.off("NodeChange",qe)}},nn=Ge=>{const Ye=()=>Ge.execCommand("mcePageBreak");Ge.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:Ye,onSetup:ln(Ge)}),Ge.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:Ye,onSetup:ln(Ge)})};var pt=()=>{$o.add("pagebreak",Ge=>{cn(Ge),Nt(Ge),nn(Ge),rt(Ge),ut(Ge)})};pt()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(m,f,x)=>{var D;return x(m,f.prototype)?!0:((D=m.constructor)===null||D===void 0?void 0:D.name)===f.name},bo=m=>{const f=typeof m;return m===null?"null":f==="object"&&Array.isArray(m)?"array":f==="object"&&eo(m,String,(x,D)=>D.isPrototypeOf(x))?"string":f},cn=m=>f=>bo(f)===m,_n=m=>f=>typeof f===m,Hn=cn("string"),Sn=cn("object"),Ee=cn("array"),rt=_n("boolean"),Nt=m=>m==null,ut=m=>!Nt(m),ln=_n("function"),nn=_n("number"),pt=()=>{},Ge=m=>()=>m,Ye=(m,f)=>m===f,qe=m=>f=>!m(f),ht=Ge(!1);class ie{constructor(f,x){this.tag=f,this.value=x}static some(f){return new ie(!0,f)}static none(){return ie.singletonNone}fold(f,x){return this.tag?x(this.value):f()}isSome(){return this.tag}isNone(){return!this.tag}map(f){return this.tag?ie.some(f(this.value)):ie.none()}bind(f){return this.tag?f(this.value):ie.none()}exists(f){return this.tag&&f(this.value)}forall(f){return!this.tag||f(this.value)}filter(f){return!this.tag||f(this.value)?this:ie.none()}getOr(f){return this.tag?this.value:f}or(f){return this.tag?this:f}getOrThunk(f){return this.tag?this.value:f()}orThunk(f){return this.tag?this:f()}getOrDie(f){if(this.tag)return this.value;throw new Error(f??"Called getOrDie on None")}static from(f){return ut(f)?ie.some(f):ie.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(f){this.tag&&f(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}ie.singletonNone=new ie(!1);const Q=Array.prototype.slice,kt=Array.prototype.indexOf,to=Array.prototype.push,Kn=(m,f)=>kt.call(m,f),O=(m,f)=>Kn(m,f)>-1,Xe=(m,f)=>{for(let x=0,D=m.length;x<D;x++){const F=m[x];if(f(F,x))return!0}return!1},Gt=(m,f)=>{const x=m.length,D=new Array(x);for(let F=0;F<x;F++){const oe=m[F];D[F]=f(oe,F)}return D},Et=(m,f)=>{for(let x=0,D=m.length;x<D;x++){const F=m[x];f(F,x)}},Vn=(m,f)=>{const x=[];for(let D=0,F=m.length;D<F;D++){const oe=m[D];f(oe,D)&&x.push(oe)}return x},Jo=(m,f)=>{if(m.length===0)return[];{let x=f(m[0]);const D=[];let F=[];for(let oe=0,Je=m.length;oe<Je;oe++){const ct=m[oe],_t=f(ct);_t!==x&&(D.push(F),F=[]),x=_t,F.push(ct)}return F.length!==0&&D.push(F),D}},Yn=(m,f,x)=>(Et(m,(D,F)=>{x=f(x,D,F)}),x),ne=(m,f,x)=>{for(let D=0,F=m.length;D<F;D++){const oe=m[D];if(f(oe,D))return ie.some(oe);if(x(oe,D))break}return ie.none()},ge=(m,f)=>ne(m,f,ht),g=m=>{const f=[];for(let x=0,D=m.length;x<D;++x){if(!Ee(m[x]))throw new Error("Arr.flatten item "+x+" was not an array, input: "+m);to.apply(f,m[x])}return f},St=(m,f)=>g(Gt(m,f)),qt=m=>{const f=Q.call(m,0);return f.reverse(),f},rn=(m,f)=>f>=0&&f<m.length?ie.some(m[f]):ie.none(),Xn=m=>rn(m,0),Jn=m=>rn(m,m.length-1),Tt=(m,f)=>{const x=[],D=ln(f)?F=>Xe(x,oe=>f(oe,F)):F=>O(x,F);for(let F=0,oe=m.length;F<oe;F++){const Je=m[F];D(Je)||x.push(Je)}return x},Rn=(m,f,x=Ye)=>m.exists(D=>x(D,f)),gn=(m,f,x=Ye)=>Lo(m,f,x).getOr(m.isNone()&&f.isNone()),Lo=(m,f,x)=>m.isSome()&&f.isSome()?ie.some(x(m.getOrDie(),f.getOrDie())):ie.none(),ae=1,be=(m,f)=>{const D=(f||document).createElement("div");if(D.innerHTML=m,!D.hasChildNodes()||D.childNodes.length>1){const F="HTML does not have a single root node";throw console.error(F,m),new Error(F)}return Y(D.childNodes[0])},kn=(m,f)=>{const D=(f||document).createElement(m);return Y(D)},he=(m,f)=>{const D=(f||document).createTextNode(m);return Y(D)},Y=m=>{if(m==null)throw new Error("Node cannot be null or undefined");return{dom:m}},me={fromHtml:be,fromTag:kn,fromText:he,fromDom:Y,fromPoint:(m,f,x)=>ie.from(m.dom.elementFromPoint(f,x)).map(Y)},zt=(m,f)=>{const x=m.dom;if(x.nodeType!==ae)return!1;{const D=x;if(D.matches!==void 0)return D.matches(f);if(D.msMatchesSelector!==void 0)return D.msMatchesSelector(f);if(D.webkitMatchesSelector!==void 0)return D.webkitMatchesSelector(f);if(D.mozMatchesSelector!==void 0)return D.mozMatchesSelector(f);throw new Error("Browser lacks native selectors")}},lt=(m,f)=>m.dom===f.dom,en=(m,f)=>{const x=m.dom,D=f.dom;return x===D?!1:x.contains(D)},xt=zt;var At=(m,f,x,D,F)=>m(x,D)?ie.some(x):ln(F)&&F(x)?ie.none():f(x,D,F);typeof window<"u"||Function("return this;")();const yo=m=>m.dom.nodeName.toLowerCase(),Zo=m=>m.dom.nodeType,cr=(m=>f=>Zo(f)===m)(ae),X=m=>f=>cr(f)&&yo(f)===m,K=m=>ie.from(m.dom.parentNode).map(me.fromDom),we=m=>ie.from(m.dom.parentElement).map(me.fromDom),He=m=>ie.from(m.dom.nextSibling).map(me.fromDom),Pt=m=>Gt(m.dom.childNodes,me.fromDom),Rt=(m,f)=>{const x=m.dom.childNodes;return ie.from(x[f]).map(me.fromDom)},on=m=>Rt(m,0),Lt=m=>Rt(m,m.dom.childNodes.length-1),bs=(m,f,x)=>{let D=m.dom;const F=ln(x)?x:ht;for(;D.parentNode;){D=D.parentNode;const oe=me.fromDom(D);if(f(oe))return ie.some(oe);if(F(oe))break}return ie.none()},un=(m,f,x)=>At((F,oe)=>oe(F),bs,m,f,x),Ut=(m,f)=>{K(m).each(D=>{D.dom.insertBefore(f.dom,m.dom)})},Ht=(m,f)=>{He(m).fold(()=>{K(m).each(F=>{We(F,f)})},D=>{Ut(D,f)})},We=(m,f)=>{m.dom.appendChild(f.dom)},ft=(m,f)=>{Et(f,x=>{Ut(m,x)})},uo=(m,f)=>{Et(f,x=>{We(m,x)})},co=m=>{m.dom.textContent="",Et(Pt(m),f=>{Ln(f)})},Ln=m=>{const f=m.dom;f.parentNode!==null&&f.parentNode.removeChild(f)};var pn=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),_s=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Se=tinymce.util.Tools.resolve("tinymce.util.VK");const wt=m=>Gt(m,me.fromDom),io=Object.keys,Io=(m,f)=>{const x=io(m);for(let D=0,F=x.length;D<F;D++){const oe=x[D],Je=m[oe];f(Je,oe)}},Os=m=>(f,x)=>{m[x]=f},es=(m,f,x,D)=>{Io(m,(F,oe)=>{(f(F,oe)?x:D)(F,oe)})},ca=(m,f)=>{const x={};return es(m,f,Os(x),pt),x},qs=(m,f,x)=>{if(Hn(x)||rt(x)||nn(x))m.setAttribute(f,x+"");else throw console.error("Invalid call to Attribute.set. Key ",f,":: Value ",x,":: Element ",m),new Error("Attribute value was not simple")},ls=(m,f)=>{const x=m.dom;Io(f,(D,F)=>{qs(x,F,D)})},ir=m=>Yn(m.dom.attributes,(f,x)=>(f[x.name]=x.value,f),{}),ts=(m,f)=>me.fromDom(m.dom.cloneNode(f)),lr=m=>ts(m,!0),ur=(m,f)=>{const x=me.fromTag(f),D=ir(m);return ls(x,D),x},ks=(m,f)=>{const x=ur(m,f);Ht(m,x);const D=Pt(m);return uo(x,D),Ln(m),x};var Es=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),So=tinymce.util.Tools.resolve("tinymce.util.Tools");const no=m=>f=>ut(f)&&f.nodeName.toLowerCase()===m,Ks=m=>f=>ut(f)&&m.test(f.nodeName),xo=m=>ut(m)&&m.nodeType===3,Ys=m=>ut(m)&&m.nodeType===1,$n=Ks(/^(OL|UL|DL)$/),_r=Ks(/^(OL|UL)$/),M=no("ol"),E=Ks(/^(LI|DT|DD)$/),U=Ks(/^(DT|DD)$/),W=Ks(/^(TH|TD)$/),ke=no("br"),Pe=m=>{var f;return((f=m.parentNode)===null||f===void 0?void 0:f.firstChild)===m},at=(m,f)=>ut(f)&&f.nodeName in m.schema.getTextBlockElements(),te=(m,f)=>ut(m)&&m.nodeName in f,It=(m,f)=>ut(f)&&f.nodeName in m.schema.getVoidElements(),bt=(m,f)=>ke(f)?m.isBlock(f.nextSibling)&&!ke(f.previousSibling):!1,Cn=(m,f,x)=>{const D=m.isEmpty(f);return x&&m.select("span[data-mce-type=bookmark]",f).length>0?!1:D},zn=(m,f)=>m.isChildOf(f,m.getRoot()),wo=m=>f=>f.options.get(m),Kr=m=>{const f=m.options.register;f("lists_indent_on_tab",{processor:"boolean",default:!0})},Or=wo("lists_indent_on_tab"),mo=wo("forced_root_block"),kr=wo("forced_root_block_attrs"),hn=(m,f)=>{const x=m.dom,D=m.schema.getBlockElements(),F=x.createFragment(),oe=mo(m),Je=kr(m);let ct,_t,et=!1;for(_t=x.create(oe,Je),te(f.firstChild,D)||F.appendChild(_t);ct=f.firstChild;){const Me=ct.nodeName;!et&&(Me!=="SPAN"||ct.getAttribute("data-mce-type")!=="bookmark")&&(et=!0),te(ct,D)?(F.appendChild(ct),_t=null):(_t||(_t=x.create(oe,Je),F.appendChild(_t)),_t.appendChild(ct))}return!et&&_t&&_t.appendChild(x.create("br",{"data-mce-bogus":"1"})),F},fn=Es.DOM,As=(m,f,x)=>{const D=et=>{const Me=et.parentNode;Me&&So.each(F,Fn=>{Me.insertBefore(Fn,x.parentNode)}),fn.remove(et)},F=fn.select('span[data-mce-type="bookmark"]',f),oe=hn(m,x),Je=fn.createRng();Je.setStartAfter(x),Je.setEndAfter(f);const ct=Je.extractContents();for(let et=ct.firstChild;et;et=et.firstChild)if(et.nodeName==="LI"&&m.dom.isEmpty(et)){fn.remove(et);break}m.dom.isEmpty(ct)||fn.insertAfter(ct,f),fn.insertAfter(oe,f);const _t=x.parentElement;_t&&Cn(m.dom,_t)&&D(_t),fn.remove(x),Cn(m.dom,f)&&fn.remove(f)},Bo=X("dd"),Er=X("dt"),dr=(m,f)=>{Bo(f)?ks(f,"dt"):Er(f)&&we(f).each(x=>As(m,x.dom,f.dom))},ia=m=>{Er(m)&&ks(m,"dd")},Co=(m,f,x)=>{f==="Indent"?Et(x,ia):Et(x,D=>dr(m,D))},Xs=(m,f)=>{if(xo(m))return{container:m,offset:f};const x=pn.getNode(m,f);return xo(x)?{container:x,offset:f>=m.childNodes.length?x.data.length:0}:x.previousSibling&&xo(x.previousSibling)?{container:x.previousSibling,offset:x.previousSibling.data.length}:x.nextSibling&&xo(x.nextSibling)?{container:x.nextSibling,offset:0}:{container:m,offset:f}},Ds=m=>{const f=m.cloneRange(),x=Xs(m.startContainer,m.startOffset);f.setStart(x.container,x.offset);const D=Xs(m.endContainer,m.endOffset);return f.setEnd(D.container,D.offset),f},kc=["OL","UL","DL"],Ar=kc.join(","),Uo=(m,f)=>{const x=f||m.selection.getStart(!0);return m.dom.getParent(x,Ar,us(m,x))},la=(m,f)=>ut(m)&&f.length===1&&f[0]===m,Ec=m=>Vn(m.querySelectorAll(Ar),$n),ua=m=>{const f=Uo(m),x=m.selection.getSelectedBlocks();return la(f,x)?Ec(f):Vn(x,D=>$n(D)&&f!==D)},an=(m,f)=>{const x=So.map(f,D=>{const F=m.dom.getParent(D,"li,dd,dt",us(m,D));return F||D});return Tt(x)},Ms=m=>{const f=m.selection.getSelectedBlocks();return Vn(an(m,f),E)},ns=m=>Vn(Ms(m),U),$s=(m,f)=>{const x=m.dom.getParents(f,"TD,TH");return x.length>0?x[0]:m.getBody()},da=(m,f)=>!$n(f)&&!E(f)&&Xe(kc,x=>m.isValidChild(f.nodeName,x)),us=(m,f)=>{const x=m.dom.getParents(f,m.dom.isBlock);return ge(x,F=>da(m.schema,F)).getOr(m.getBody())},Wo=(m,f)=>{const x=m.dom.getParents(f,"ol,ul",us(m,f));return Jn(x)},Is=m=>{const f=Wo(m,m.selection.getStart()),x=Vn(m.selection.getSelectedBlocks(),_r);return f.toArray().concat(x)},ni=m=>{const f=Is(m);return Fa(m,f)},Fa=(m,f)=>{const x=Gt(f,D=>Wo(m,D).getOr(D));return Tt(x)},ma=m=>/\btox\-/.test(m.className),jo=(m,f)=>ne(m,$n,W).exists(x=>x.nodeName===f&&!ma(x)),Bs=(m,f)=>f!==null&&!m.dom.isEditable(f),tc=m=>{const f=Uo(m);return Bs(m,f)},Fs=(m,f)=>{const x=m.dom.getParent(f,"ol,ul,dl");return Bs(m,x)},Pa=(m,f)=>{const x=m.selection.getNode();return f({parents:m.dom.getParents(x),element:x}),m.on("NodeChange",f),()=>m.off("NodeChange",f)},Ra=(m,f)=>{const D=(f||document).createDocumentFragment();return Et(m,F=>{D.appendChild(F.dom)}),me.fromDom(D)},w=(m,f,x)=>m.dispatch("ListMutation",{action:f,element:x}),P=(m=>f=>f.replace(m,""))(/^\s+|\s+$/g),j=m=>m.length>0,ue=m=>!j(m),Ie=m=>m.style!==void 0&&ln(m.style.getPropertyValue),Jt=(m,f,x)=>{if(!Hn(x))throw console.error("Invalid call to CSS.set. Property ",f,":: Value ",x,":: Element ",m),new Error("CSS value must be a string: "+x);Ie(m)&&m.style.setProperty(f,x)},Zn=(m,f,x)=>{const D=m.dom;Jt(D,f,x)},Kt=(m,f)=>{We(m.item,f.list)},Zt=m=>{for(let f=1;f<m.length;f++)Kt(m[f-1],m[f])},sn=(m,f)=>{Lo(Jn(m),Xn(f),Kt)},mr=(m,f)=>{const x={list:me.fromTag(f,m),item:me.fromTag("li",m)};return We(x.list,x.item),x},La=(m,f,x)=>{const D=[];for(let F=0;F<x;F++)D.push(mr(m,f.listType));return D},Qe=(m,f)=>{for(let x=0;x<m.length-1;x++)Zn(m[x].item,"list-style-type","none");Jn(m).each(x=>{ls(x.list,f.listAttributes),ls(x.item,f.itemAttributes),uo(x.item,f.content)})},Ac=(m,f)=>{yo(m.list)!==f.listType&&(m.list=ks(m.list,f.listType)),ls(m.list,f.listAttributes)},To=(m,f,x)=>{const D=me.fromTag("li",m);return ls(D,f),uo(D,x),D},Go=(m,f)=>{We(m.list,f),m.item=f},v=(m,f,x)=>{const D=f.slice(0,x.depth);return Jn(D).each(F=>{const oe=To(m,x.itemAttributes,x.content);Go(F,oe),Ac(F,x)}),D},C=(m,f,x)=>{const D=La(m,x,x.depth-f.length);return Zt(D),Qe(D,x),sn(f,D),f.concat(D)},A=(m,f)=>{const x=Yn(f,(D,F)=>F.depth>D.length?C(m,D,F):v(m,D,F),[]);return Xn(x).map(D=>D.list)},H=m=>xt(m,"OL,UL"),ve=m=>on(m).exists(H),pe=m=>Lt(m).exists(H),dn=m=>m.depth>0,_o=m=>m.isSelected,Un=m=>{const f=Pt(m),x=pe(m)?f.slice(0,-1):f;return Gt(x,lr)},Dr=(m,f,x)=>K(m).filter(cr).map(D=>({depth:f,dirty:!1,isSelected:x,content:Un(m),itemAttributes:ir(m),listAttributes:ir(D),listType:yo(D)})),xn=(m,f)=>{switch(m){case"Indent":f.depth++;break;case"Outdent":f.depth--;break;case"Flatten":f.depth=0}f.dirty=!0},ga=(m,f)=>{m.listType=f.listType,m.listAttributes={...f.listAttributes}},nc=m=>{m.listAttributes=ca(m.listAttributes,(f,x)=>x!=="start")},Qt=(m,f)=>{const x=m[f].depth,D=oe=>oe.depth===x&&!oe.dirty,F=oe=>oe.depth<x;return ne(qt(m.slice(0,f)),D,F).orThunk(()=>ne(m.slice(f+1),D,F))},pa=m=>(Et(m,(f,x)=>{Qt(m,x).fold(()=>{f.dirty&&nc(f)},D=>ga(f,D))}),m),Dc=m=>{let f=m;return{get:()=>f,set:F=>{f=F}}},Ps=(m,f,x,D)=>on(D).filter(H).fold(()=>{f.each(Je=>{lt(Je.start,D)&&x.set(!0)});const F=Dr(D,m,x.get());f.each(Je=>{lt(Je.end,D)&&x.set(!1)});const oe=Lt(D).filter(H).map(Je=>In(m,f,x,Je)).getOr([]);return F.toArray().concat(oe)},F=>In(m,f,x,F)),In=(m,f,x,D)=>St(Pt(D),F=>{const oe=H(F)?In:Ps,Je=m+1;return oe(Je,f,x,F)}),Yr=(m,f)=>{const x=Dc(!1),D=0;return Gt(m,F=>({sourceList:F,entries:In(D,f,x,F)}))},km=(m,f)=>{const x=pa(f);return Gt(x,D=>{const F=Ra(D.content);return me.fromDom(hn(m,F.dom))})},ed=(m,f)=>{const x=pa(f);return A(m.contentDocument,x).toArray()},Bn=(m,f)=>St(Jo(f,dn),x=>Xn(x).exists(dn)?ed(m,x):km(m,x)),Em=(m,f)=>{Et(Vn(m,_o),x=>xn(f,x))},Js=m=>{const f=Gt(Ms(m),me.fromDom);return Lo(ge(f,qe(ve)),ge(qt(f),qe(ve)),(x,D)=>({start:x,end:D}))},Rs=(m,f,x)=>{const D=Yr(f,Js(m));Et(D,F=>{Em(F.entries,x);const oe=Bn(m,F.entries);Et(oe,Je=>{w(m,x==="Indent"?"IndentList":"OutdentList",Je.dom)}),ft(F.sourceList,oe),Ln(F.sourceList)})},oc=(m,f)=>{const x=wt(ni(m)),D=wt(ns(m));let F=!1;if(x.length||D.length){const oe=m.selection.getBookmark();Rs(m,x,f),Co(m,f,D),m.selection.moveToBookmark(oe),m.selection.setRng(Ds(m.selection.getRng())),m.nodeChanged(),F=!0}return F},ha=(m,f)=>!tc(m)&&oc(m,f),Jl=m=>ha(m,"Indent"),Oo=m=>ha(m,"Outdent"),Mr=m=>ha(m,"Flatten"),oi="\uFEFF",$r=m=>m===oi;var td=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");const Mc=Es.DOM,$c=m=>{const f={},x=D=>{let F=m[D?"startContainer":"endContainer"],oe=m[D?"startOffset":"endOffset"];if(Ys(F)){const Je=Mc.create("span",{"data-mce-type":"bookmark"});F.hasChildNodes()?(oe=Math.min(oe,F.childNodes.length-1),D?F.insertBefore(Je,F.childNodes[oe]):Mc.insertAfter(Je,F.childNodes[oe])):F.appendChild(Je),F=Je,oe=0}f[D?"startContainer":"endContainer"]=F,f[D?"startOffset":"endOffset"]=oe};return x(!0),m.collapsed||x(),f},Ic=m=>{const f=D=>{const F=ct=>{var _t;let et=(_t=ct.parentNode)===null||_t===void 0?void 0:_t.firstChild,Me=0;for(;et;){if(et===ct)return Me;(!Ys(et)||et.getAttribute("data-mce-type")!=="bookmark")&&Me++,et=et.nextSibling}return-1};let oe=m[D?"startContainer":"endContainer"],Je=m[D?"startOffset":"endOffset"];if(oe){if(Ys(oe)&&oe.parentNode){const ct=oe;Je=F(oe),oe=oe.parentNode,Mc.remove(ct),!oe.hasChildNodes()&&Mc.isBlock(oe)&&oe.appendChild(Mc.create("br"))}m[D?"startContainer":"endContainer"]=oe,m[D?"startOffset":"endOffset"]=Je}};f(!0),f();const x=Mc.createRng();return x.setStart(m.startContainer,m.startOffset),m.endContainer&&x.setEnd(m.endContainer,m.endOffset),Ds(x)},Bc=m=>{switch(m){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},qi=(m,f,x)=>{const D=x["list-style-type"]?x["list-style-type"]:null;m.setStyle(f,"list-style-type",D)},sc=(m,f)=>{So.each(f,(x,D)=>{m.setAttribute(D,x)})},Zl=(m,f,x)=>{sc(f,x["list-attributes"]),So.each(m.select("li",f),D=>{sc(D,x["list-item-attributes"])})},rc=(m,f,x)=>{qi(m,f,x),Zl(m,f,x)},nd=(m,f,x)=>{So.each(x,D=>m.setStyle(f,D,""))},si=(m,f)=>ut(f)&&!te(f,m.schema.getBlockElements()),No=(m,f,x,D)=>{let F=f[x?"startContainer":"endContainer"];const oe=f[x?"startOffset":"endOffset"];Ys(F)&&(F=F.childNodes[Math.min(oe,F.childNodes.length-1)]||F),!x&&ke(F.nextSibling)&&(F=F.nextSibling);const Je=(ct,_t)=>{var et;const Me=new _s(ct,D),Fn=_t?"next":"prev";let vs;for(;vs=Me[Fn]();)if(!(It(m,vs)||$r(vs.textContent)||((et=vs.textContent)===null||et===void 0?void 0:et.length)===0))return ie.some(vs);return ie.none()};if(x&&xo(F))if($r(F.textContent))F=Je(F,!1).getOr(F);else for(F.parentNode!==null&&si(m,F.parentNode)&&(F=F.parentNode);F.previousSibling!==null&&(si(m,F.previousSibling)||xo(F.previousSibling));)F=F.previousSibling;if(!x&&xo(F))if($r(F.textContent))F=Je(F,!0).getOr(F);else for(F.parentNode!==null&&si(m,F.parentNode)&&(F=F.parentNode);F.nextSibling!==null&&(si(m,F.nextSibling)||xo(F.nextSibling));)F=F.nextSibling;for(;F.parentNode!==D;){const ct=F.parentNode;if(at(m,F)||/^(TD|TH)$/.test(ct.nodeName))return F;F=ct}return F},Xr=(m,f,x)=>{const D=[],F=m.dom,oe=No(m,f,!0,x),Je=No(m,f,!1,x);let ct;const _t=[];for(let et=oe;et&&(_t.push(et),et!==Je);et=et.nextSibling);return So.each(_t,et=>{var Me;if(at(m,et)){D.push(et),ct=null;return}if(F.isBlock(et)||ke(et)){ke(et)&&F.remove(et),ct=null;return}const Fn=et.nextSibling;if(td.isBookmarkNode(et)&&($n(Fn)||at(m,Fn)||!Fn&&et.parentNode===x)){ct=null;return}ct||(ct=F.create("p"),(Me=et.parentNode)===null||Me===void 0||Me.insertBefore(ct,et),D.push(ct)),ct.appendChild(et)}),D},Ql=(m,f,x)=>{const D=m.getStyle(f,"list-style-type");let F=x?x["list-style-type"]:"";return F=F===null?"":F,D===F},ri=(m,f,x)=>{const D=m.selection.getRng();let F="LI";const oe=us(m,m.selection.getStart(!0)),Je=m.dom;if(Je.getContentEditable(m.selection.getNode())==="false")return;f=f.toUpperCase(),f==="DL"&&(F="DT");const ct=$c(D),_t=Vn(Xr(m,D,oe),m.dom.isEditable);So.each(_t,et=>{let Me;const Fn=et.previousSibling,vs=et.parentNode;E(vs)||(Fn&&$n(Fn)&&Fn.nodeName===f&&Ql(Je,Fn,x)?(Me=Fn,et=Je.rename(et,F),Fn.appendChild(et)):(Me=Je.create(f),vs.insertBefore(Me,et),Me.appendChild(et),et=Je.rename(et,F)),nd(Je,et,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),rc(Je,Me,x),li(m.dom,Me))}),m.selection.setRng(Ic(ct))},ai=(m,f)=>$n(m)&&m.nodeName===(f==null?void 0:f.nodeName),ci=(m,f,x)=>{const D=m.getStyle(f,"list-style-type",!0),F=m.getStyle(x,"list-style-type",!0);return D===F},ii=(m,f)=>m.className===f.className,fa=(m,f,x)=>ai(f,x)&&ci(m,f,x)&&ii(f,x),li=(m,f)=>{let x,D=f.nextSibling;if(fa(m,f,D)){const F=D;for(;x=F.firstChild;)f.appendChild(x);m.remove(F)}if(D=f.previousSibling,fa(m,f,D)){const F=D;for(;x=F.lastChild;)f.insertBefore(x,f.firstChild);m.remove(F)}},eu=(m,f,x,D)=>{if(f.nodeName!==x){const F=m.dom.rename(f,x);rc(m.dom,F,D),w(m,Bc(x),F)}else rc(m.dom,f,D),w(m,Bc(x),f)},ba=(m,f,x,D,F)=>{const oe=$n(f);if(oe&&f.nodeName===D&&!ui(F))Mr(m);else{ri(m,D,F);const Je=$c(m.selection.getRng()),ct=oe?[f,...x]:x;So.each(ct,_t=>{eu(m,_t,D,F)}),m.selection.setRng(Ic(Je))}},ui=m=>"list-style-type"in m,tu=(m,f,x,D)=>{if(f!==m.getBody())if(f)if(f.nodeName===x&&!ui(D)&&!ma(f))Mr(m);else{const F=$c(m.selection.getRng());rc(m.dom,f,D);const oe=m.dom.rename(f,x);li(m.dom,oe),m.selection.setRng(Ic(F)),ri(m,x,D),w(m,Bc(x),oe)}else ri(m,x,D),w(m,Bc(x),f)},ac=(m,f,x)=>{const D=Uo(m);if(Fs(m,D)||!m.hasEditableRoot())return;const F=ua(m),oe=Sn(x)?x:{};F.length>0?ba(m,D,F,f,oe):tu(m,D,f,oe)},Ki=Es.DOM,Yi=(m,f)=>{const x=f.parentElement;if(x&&x.nodeName==="LI"&&x.firstChild===f){const D=x.previousSibling;D&&D.nodeName==="LI"?(D.appendChild(f),Cn(m,x)&&Ki.remove(x)):Ki.setStyle(x,"listStyleType","none")}if($n(x)){const D=x.previousSibling;D&&D.nodeName==="LI"&&D.appendChild(f)}},di=(m,f)=>{const x=So.grep(m.select("ol,ul",f));So.each(x,D=>{Yi(m,D)})},mi=(m,f,x,D)=>{let F=f.startContainer;const oe=f.startOffset;if(xo(F)&&(x?oe<F.data.length:oe>0))return F;const Je=m.schema.getNonEmptyElements();Ys(F)&&(F=pn.getNode(F,oe));const ct=new _s(F,D);x&&bt(m.dom,F)&&ct.next();const _t=x?ct.next.bind(ct):ct.prev2.bind(ct);for(;F=_t();)if(F.nodeName==="LI"&&!F.hasChildNodes()||Je[F.nodeName]||xo(F)&&F.data.length>0)return F;return null},gi=(m,f)=>{const x=f.childNodes;return x.length===1&&!$n(x[0])&&m.isBlock(x[0])},Xi=(m,f)=>{gi(m,f)&&m.remove(f.firstChild,!0)},Ji=(m,f,x)=>{let D;const F=gi(m,x)?x.firstChild:x;if(Xi(m,f),!Cn(m,f,!0))for(;D=f.firstChild;)F.appendChild(D)},pi=(m,f,x)=>{let D;const F=f.parentNode;if(!zn(m,f)||!zn(m,x))return;$n(x.lastChild)&&(D=x.lastChild),F===x.lastChild&&ke(F.previousSibling)&&m.remove(F.previousSibling);const oe=x.lastChild;oe&&ke(oe)&&f.hasChildNodes()&&m.remove(oe),Cn(m,x,!0)&&co(me.fromDom(x)),Ji(m,f,x),D&&x.appendChild(D);const ct=en(me.fromDom(x),me.fromDom(f))?m.getParents(f,$n,x):[];m.remove(f),Et(ct,_t=>{Cn(m,_t)&&_t!==m.getRoot()&&m.remove(_t)})},od=(m,f,x)=>{co(me.fromDom(x)),pi(m.dom,f,x),m.selection.setCursorLocation(x,0)},nu=(m,f,x,D)=>{const F=m.dom;if(F.isEmpty(D))od(m,x,D);else{const oe=$c(f);pi(F,x,D),m.selection.setRng(Ic(oe))}},ou=(m,f,x,D)=>{const F=$c(f);pi(m.dom,x,D);const oe=Ic(F);m.selection.setRng(oe)},Am=(m,f)=>{const x=m.dom,D=m.selection,F=D.getStart(),oe=$s(m,F),Je=x.getParent(D.getStart(),"LI",oe);if(Je){const ct=Je.parentElement;if(ct===m.getBody()&&Cn(x,ct))return!0;const _t=Ds(D.getRng()),et=x.getParent(mi(m,_t,f,oe),"LI",oe);if(et&&et!==Je)return m.undoManager.transact(()=>{f?nu(m,_t,et,Je):Pe(Je)?Oo(m):ou(m,_t,Je,et)}),!0;if(!et&&!f&&_t.startOffset===0&&_t.endOffset===0)return m.undoManager.transact(()=>{Mr(m)}),!0}return!1},sd=(m,f,x)=>{const D=m.getParent(f.parentNode,m.isBlock,x);m.remove(f),D&&m.isEmpty(D)&&m.remove(D)},rd=(m,f)=>{const x=m.dom,D=m.selection.getStart(),F=$s(m,D),oe=x.getParent(D,x.isBlock,F);if(oe&&x.isEmpty(oe)){const Je=Ds(m.selection.getRng()),ct=x.getParent(mi(m,Je,f,F),"LI",F);if(ct){const _t=vs=>O(["td","th","caption"],yo(vs)),et=vs=>vs.dom===F,Me=un(me.fromDom(ct),_t,et),Fn=un(me.fromDom(Je.startContainer),_t,et);return gn(Me,Fn,lt)?(m.undoManager.transact(()=>{sd(x,oe,F),li(x,ct.parentNode),m.selection.select(ct,!0),m.selection.collapse(f)}),!0):!1}}return!1},Zi=(m,f)=>Am(m,f)||rd(m,f),Ir=m=>{const f=m.selection.getStart(),x=$s(m,f);return m.dom.getParent(f,"LI,DT,DD",x)||Ms(m).length>0},ad=m=>Ir(m)?(m.undoManager.transact(()=>{m.execCommand("Delete"),di(m.dom,m.getBody())}),!0):!1,va=(m,f)=>{const x=m.selection;return!Fs(m,x.getNode())&&(x.isCollapsed()?Zi(m,f):ad(m))},cd=m=>{m.on("ExecCommand",f=>{const x=f.command.toLowerCase();(x==="delete"||x==="forwarddelete")&&Ir(m)&&di(m.dom,m.getBody())}),m.on("keydown",f=>{f.keyCode===Se.BACKSPACE?va(m,!1)&&f.preventDefault():f.keyCode===Se.DELETE&&va(m,!0)&&f.preventDefault()})},Qi=m=>({backspaceDelete:f=>{va(m,f)}}),id=(m,f)=>{const x=Uo(m);x===null||Fs(m,x)||m.undoManager.transact(()=>{Sn(f.styles)&&m.dom.setStyles(x,f.styles),Sn(f.attrs)&&Io(f.attrs,(D,F)=>m.dom.setAttrib(x,F,D))})},el=m=>{const f=qt(P(m).split("")),x=Gt(f,(D,F)=>{const oe=D.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,F)*oe});return Yn(x,(D,F)=>D+F,0)},tl=m=>{if(m--,m<0)return"";{const f=m%26,x=Math.floor(m/26),D=tl(x),F=String.fromCharCode("A".charCodeAt(0)+f);return D+F}},hi=m=>/^[A-Z]+$/.test(m),su=m=>/^[a-z]+$/.test(m),ld=m=>/^[0-9]+$/.test(m),Zs=m=>ld(m)?2:hi(m)?0:su(m)?1:ue(m)?3:4,ud=m=>{switch(Zs(m)){case 2:return ie.some({listStyleType:ie.none(),start:m});case 0:return ie.some({listStyleType:ie.some("upper-alpha"),start:el(m).toString()});case 1:return ie.some({listStyleType:ie.some("lower-alpha"),start:el(m).toString()});case 3:return ie.some({listStyleType:ie.none(),start:""});case 4:return ie.none()}},ru=m=>{const f=parseInt(m.start,10);return Rn(m.listStyleType,"upper-alpha")?tl(f):Rn(m.listStyleType,"lower-alpha")?tl(f).toLowerCase():m.start},nl=m=>{const f=Uo(m);!M(f)||Fs(m,f)||m.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:ru({start:m.dom.getAttrib(f,"start","1"),listStyleType:ie.from(m.dom.getStyle(f,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:x=>{const D=x.getData();ud(D.start).each(F=>{m.execCommand("mceListUpdate",!1,{attrs:{start:F.start==="1"?"":F.start},styles:{"list-style-type":F.listStyleType.getOr("")}})}),x.close()}})},gr=(m,f)=>()=>{const x=Uo(m);return ut(x)&&x.nodeName===f},Ls=m=>{m.addCommand("mceListProps",()=>{nl(m)})},au=m=>{m.on("BeforeExecCommand",f=>{const x=f.command.toLowerCase();x==="indent"?Jl(m):x==="outdent"&&Oo(m)}),m.addCommand("InsertUnorderedList",(f,x)=>{ac(m,"UL",x)}),m.addCommand("InsertOrderedList",(f,x)=>{ac(m,"OL",x)}),m.addCommand("InsertDefinitionList",(f,x)=>{ac(m,"DL",x)}),m.addCommand("RemoveList",()=>{Mr(m)}),Ls(m),m.addCommand("mceListUpdate",(f,x)=>{Sn(x)&&id(m,x)}),m.addQueryStateHandler("InsertUnorderedList",gr(m,"UL")),m.addQueryStateHandler("InsertOrderedList",gr(m,"OL")),m.addQueryStateHandler("InsertDefinitionList",gr(m,"DL"))};var dd=tinymce.util.Tools.resolve("tinymce.html.Node");const ol=m=>m.type===3,sl=m=>m.length===0,rl=m=>{const f=(F,oe)=>{const Je=dd.create("li");Et(F,ct=>Je.append(ct)),oe?m.insert(Je,oe,!0):m.append(Je)},x=(F,oe)=>ol(oe)?[...F,oe]:!sl(F)&&!ol(oe)?(f(F,oe),[]):F,D=Yn(m.children(),x,[]);sl(D)||f(D)},cu=m=>{m.on("PreInit",()=>{const{parser:f}=m;f.addNodeFilter("ul,ol",x=>Et(x,rl))})},md=m=>{m.on("keydown",f=>{f.keyCode!==Se.TAB||Se.metaKeyPressed(f)||m.undoManager.transact(()=>{(f.shiftKey?Oo(m):Jl(m))&&f.preventDefault()})})},Dm=m=>{Or(m)&&md(m),cd(m)},gd=(m,f)=>x=>{const D=F=>{x.setActive(jo(F.parents,f)),x.setEnabled(!Fs(m,F.element)&&m.selection.isEditable())};return x.setEnabled(m.selection.isEditable()),Pa(m,D)},al=m=>{const f=x=>()=>m.execCommand(x);m.hasPlugin("advlist")||(m.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:f("InsertOrderedList"),onSetup:gd(m,"OL")}),m.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:f("InsertUnorderedList"),onSetup:gd(m,"UL")}))},Fc=(m,f)=>x=>Pa(m,F=>x.setEnabled(jo(F.parents,f)&&!Fs(m,F.element))),pd=m=>{const f={text:"List properties...",icon:"ordered-list",onAction:()=>m.execCommand("mceListProps"),onSetup:Fc(m,"OL")};m.ui.registry.addMenuItem("listprops",f),m.ui.registry.addContextMenu("lists",{update:x=>{const D=Uo(m,x);return M(D)?["listprops"]:[]}})};var cl=()=>{$o.add("lists",m=>(Kr(m),cu(m),m.hasPlugin("rtc",!0)?Ls(m):(Dm(m),au(m)),al(m),pd(m),Qi(m)))};cl()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(ne,ge,g)=>{const St=ge==="UL"?"InsertUnorderedList":"InsertOrderedList";ne.execCommand(St,!1,g===!1?null:{"list-style-type":g})},bo=ne=>{ne.addCommand("ApplyUnorderedListStyle",(ge,g)=>{eo(ne,"UL",g["list-style-type"])}),ne.addCommand("ApplyOrderedListStyle",(ge,g)=>{eo(ne,"OL",g["list-style-type"])})},cn=ne=>ge=>ge.options.get(ne),_n=ne=>{const ge=ne.options.register;ge("advlist_number_styles",{processor:"string[]",default:"default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman".split(",")}),ge("advlist_bullet_styles",{processor:"string[]",default:"default,circle,square".split(",")})},Hn=cn("advlist_number_styles"),Sn=cn("advlist_bullet_styles"),Ee=ne=>ne==null,rt=ne=>!Ee(ne);var Nt=tinymce.util.Tools.resolve("tinymce.util.Tools");class ut{constructor(ge,g){this.tag=ge,this.value=g}static some(ge){return new ut(!0,ge)}static none(){return ut.singletonNone}fold(ge,g){return this.tag?g(this.value):ge()}isSome(){return this.tag}isNone(){return!this.tag}map(ge){return this.tag?ut.some(ge(this.value)):ut.none()}bind(ge){return this.tag?ge(this.value):ut.none()}exists(ge){return this.tag&&ge(this.value)}forall(ge){return!this.tag||ge(this.value)}filter(ge){return!this.tag||ge(this.value)?this:ut.none()}getOr(ge){return this.tag?this.value:ge}or(ge){return this.tag?this:ge}getOrThunk(ge){return this.tag?this.value:ge()}orThunk(ge){return this.tag?this:ge()}getOrDie(ge){if(this.tag)return this.value;throw new Error(ge??"Called getOrDie on None")}static from(ge){return rt(ge)?ut.some(ge):ut.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(ge){this.tag&&ge(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}ut.singletonNone=new ut(!1);const ln=(ne,ge,g)=>{for(let St=0,qt=ne.length;St<qt;St++){const rn=ne[St];if(ge(rn,St))return ut.some(rn);if(g(rn,St))break}return ut.none()},nn=ne=>/\btox\-/.test(ne.className),pt=(ne,ge)=>ne.dom.isChildOf(ge,ne.getBody()),Ge=ne=>ge=>rt(ge)&&ne.test(ge.nodeName),Ye=Ge(/^(OL|UL|DL)$/),qe=Ge(/^(TH|TD)$/),ht=(ne,ge,g)=>ln(ge,St=>Ye(St)&&!nn(St),qe).exists(St=>St.nodeName===g&&pt(ne,St)),ie=ne=>{const ge=ne.dom.getParent(ne.selection.getNode(),"ol,ul"),g=ne.dom.getStyle(ge,"listStyleType");return ut.from(g)},Q=(ne,ge)=>ge!==null&&!ne.dom.isEditable(ge),kt=(ne,ge)=>{const g=ne.dom.getParent(ge,"ol,ul,dl");return Q(ne,g)&&ne.selection.isEditable()},to=(ne,ge)=>{const g=ne.selection.getNode();return ge({parents:ne.dom.getParents(g),element:g}),ne.on("NodeChange",ge),()=>ne.off("NodeChange",ge)},Kn=ne=>ne.replace(/\-/g," ").replace(/\b\w/g,ge=>ge.toUpperCase()),O=ne=>Ee(ne)||ne==="default"?"":ne,Xe=(ne,ge)=>g=>{const St=(rn,Xn)=>{const Jn=rn.selection.getStart(!0);g.setActive(ht(rn,Xn,ge)),g.setEnabled(!kt(rn,Jn)&&rn.selection.isEditable())};return to(ne,rn=>St(ne,rn.parents))},Gt=(ne,ge,g,St,qt,rn)=>{ne.ui.registry.addSplitButton(ge,{tooltip:g,icon:qt==="OL"?"ordered-list":"unordered-list",presets:"listpreview",columns:3,fetch:Xn=>{const Jn=Nt.map(rn,Tt=>{const Rn=qt==="OL"?"num":"bull",gn=Tt==="disc"||Tt==="decimal"?"default":Tt,Lo=O(Tt),ae=Kn(Tt);return{type:"choiceitem",value:Lo,icon:"list-"+Rn+"-"+gn,text:ae}});Xn(Jn)},onAction:()=>ne.execCommand(St),onItemAction:(Xn,Jn)=>{eo(ne,qt,Jn)},select:Xn=>ie(ne).map(Tt=>Xn===Tt).getOr(!1),onSetup:Xe(ne,qt)})},Et=(ne,ge,g,St,qt,rn)=>{ne.ui.registry.addToggleButton(ge,{active:!1,tooltip:g,icon:qt==="OL"?"ordered-list":"unordered-list",onSetup:Xe(ne,qt),onAction:()=>ne.queryCommandState(St)||rn===""?ne.execCommand(St):eo(ne,qt,rn)})},Vn=(ne,ge,g,St,qt,rn)=>{rn.length>1?Gt(ne,ge,g,St,qt,rn):Et(ne,ge,g,St,qt,O(rn[0]))},Jo=ne=>{Vn(ne,"numlist","Numbered list","InsertOrderedList","OL",Hn(ne)),Vn(ne,"bullist","Bullet list","InsertUnorderedList","UL",Sn(ne))};var Yn=()=>{$o.add("advlist",ne=>{ne.hasPlugin("lists")?(_n(ne),Jo(ne),bo(ne)):console.error("Please use the Lists plugin together with the Advanced List plugin.")})};Yn()})();(function(){var $o=tinymce.util.Tools.resolve("tinymce.PluginManager");const eo=(he,Y,Ae)=>{var me;return Ae(he,Y.prototype)?!0:((me=he.constructor)===null||me===void 0?void 0:me.name)===Y.name},bo=he=>{const Y=typeof he;return he===null?"null":Y==="object"&&Array.isArray(he)?"array":Y==="object"&&eo(he,String,(Ae,me)=>me.isPrototypeOf(Ae))?"string":Y},cn=he=>Y=>bo(Y)===he,_n=he=>Y=>typeof Y===he,Hn=cn("string"),Sn=_n("boolean"),Ee=he=>he==null,rt=he=>!Ee(he),Nt=_n("function"),ut=he=>Y=>Y.options.get(he),ln=he=>{const Y=he.options.register,Ae=en=>xt=>{const At=Sn(xt)||Hn(xt);return At?Sn(xt)?{value:xt?en:"",valid:At}:{value:xt.trim(),valid:At}:{valid:!1,message:"Must be a boolean or string."}},me="bold italic | quicklink h2 h3 blockquote";Y("quickbars_selection_toolbar",{processor:Ae(me),default:me});const zt="quickimage quicktable";Y("quickbars_insert_toolbar",{processor:Ae(zt),default:zt});const lt="alignleft aligncenter alignright";Y("quickbars_image_toolbar",{processor:Ae(lt),default:lt})},nn=ut("quickbars_selection_toolbar"),pt=ut("quickbars_insert_toolbar"),Ge=ut("quickbars_image_toolbar");let Ye=0;const qe=he=>{const Ae=new Date().getTime(),me=Math.floor(Math.random()*1e9);return Ye++,he+"_"+me+Ye+String(Ae)},ht=(he,Y,Ae)=>{he.execCommand("mceInsertTable",!1,{rows:Ae,columns:Y})},ie=(he,Y,Ae)=>{const me=he.editorUpload.blobCache,zt=me.create(qe("mceu"),Ae,Y);me.add(zt),he.insertContent(he.dom.createHTML("img",{src:zt.blobUri()}))},Q=he=>new Promise(Y=>{const Ae=new FileReader;Ae.onloadend=()=>{Y(Ae.result.split(",")[1])},Ae.readAsDataURL(he)});var kt=tinymce.util.Tools.resolve("tinymce.util.Delay");const to=he=>new Promise(Y=>{let Ae=!1;const me=document.createElement("input");me.type="file",me.accept="image/*",me.style.position="fixed",me.style.left="0",me.style.top="0",me.style.opacity="0.001",document.body.appendChild(me);const zt=xt=>{var At;Ae||((At=me.parentNode)===null||At===void 0||At.removeChild(me),Ae=!0,Y(xt))},lt=xt=>{zt(Array.prototype.slice.call(xt.target.files))};me.addEventListener("input",lt),me.addEventListener("change",lt);const en=xt=>{const At=()=>{zt([])};Ae||(xt.type==="focusin"?kt.setEditorTimeout(he,At,1e3):At()),he.off("focusin remove",en)};he.on("focusin remove",en),me.click()}),Kn=he=>{he.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{to(he).then(Y=>{if(Y.length>0){const Ae=Y[0];Q(Ae).then(me=>{ie(he,me,Ae)})}})}}),he.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{ht(he,2,2)}})},Xe=(he=>()=>he)(!1);class Gt{constructor(Y,Ae){this.tag=Y,this.value=Ae}static some(Y){return new Gt(!0,Y)}static none(){return Gt.singletonNone}fold(Y,Ae){return this.tag?Ae(this.value):Y()}isSome(){return this.tag}isNone(){return!this.tag}map(Y){return this.tag?Gt.some(Y(this.value)):Gt.none()}bind(Y){return this.tag?Y(this.value):Gt.none()}exists(Y){return this.tag&&Y(this.value)}forall(Y){return!this.tag||Y(this.value)}filter(Y){return!this.tag||Y(this.value)?this:Gt.none()}getOr(Y){return this.tag?this.value:Y}or(Y){return this.tag?this:Y}getOrThunk(Y){return this.tag?this.value:Y()}orThunk(Y){return this.tag?this:Y()}getOrDie(Y){if(this.tag)return this.value;throw new Error(Y??"Called getOrDie on None")}static from(Y){return rt(Y)?Gt.some(Y):Gt.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(Y){this.tag&&Y(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}Gt.singletonNone=new Gt(!1),typeof window<"u"||Function("return this;")();const Et=1,Vn=he=>he.dom.nodeName.toLowerCase(),Jo=(he,Y)=>{const Ae=he.dom;return Ae&&Ae.hasAttribute?Ae.hasAttribute(Y):!1};var Yn=(he,Y,Ae,me,zt)=>he(Ae,me)?Gt.some(Ae):Nt(zt)&&zt(Ae)?Gt.none():Y(Ae,me,zt);const ne=(he,Y)=>{const me=(Y||document).createElement("div");if(me.innerHTML=he,!me.hasChildNodes()||me.childNodes.length>1){const zt="HTML does not have a single root node";throw console.error(zt,he),new Error(zt)}return St(me.childNodes[0])},ge=(he,Y)=>{const me=(Y||document).createElement(he);return St(me)},g=(he,Y)=>{const me=(Y||document).createTextNode(he);return St(me)},St=he=>{if(he==null)throw new Error("Node cannot be null or undefined");return{dom:he}},rn={fromHtml:ne,fromTag:ge,fromText:g,fromDom:St,fromPoint:(he,Y,Ae)=>Gt.from(he.dom.elementFromPoint(Y,Ae)).map(St)},Xn=(he,Y)=>{const Ae=he.dom;if(Ae.nodeType!==Et)return!1;{const me=Ae;if(me.matches!==void 0)return me.matches(Y);if(me.msMatchesSelector!==void 0)return me.msMatchesSelector(Y);if(me.webkitMatchesSelector!==void 0)return me.webkitMatchesSelector(Y);if(me.mozMatchesSelector!==void 0)return me.mozMatchesSelector(Y);throw new Error("Browser lacks native selectors")}},Jn=(he,Y,Ae)=>{let me=he.dom;const zt=Nt(Ae)?Ae:Xe;for(;me.parentNode;){me=me.parentNode;const lt=rn.fromDom(me);if(Y(lt))return Gt.some(lt);if(zt(lt))break}return Gt.none()},Tt=(he,Y,Ae)=>Yn((zt,lt)=>lt(zt),Jn,he,Y,Ae),Rn=(he,Y,Ae)=>Tt(he,Y,Ae).isSome(),gn=(he,Y,Ae)=>Jn(he,me=>Xn(me,Y),Ae),Lo=(he,Y,Ae)=>Yn((zt,lt)=>Xn(zt,lt),gn,he,Y,Ae),ae=he=>{const Y=pt(he);Y.length>0&&he.ui.registry.addContextToolbar("quickblock",{predicate:Ae=>{const me=rn.fromDom(Ae),zt=he.schema.getTextBlockElements(),lt=en=>en.dom===he.getBody();return!Jo(me,"data-mce-bogus")&&Lo(me,'table,[data-mce-bogus="all"]',lt).fold(()=>Rn(me,en=>Vn(en)in zt&&he.dom.isEmpty(en.dom),lt),Xe)},items:Y,position:"line",scope:"editor"})},be=he=>{const Y=en=>he.dom.isEditable(en),Ae=en=>Y(en.parentElement),me=en=>en.nodeName==="IMG"||en.nodeName==="FIGURE"&&/image/i.test(en.className)&&Ae(en),zt=Ge(he);zt.length>0&&he.ui.registry.addContextToolbar("imageselection",{predicate:me,items:zt,position:"node"});const lt=nn(he);lt.length>0&&he.ui.registry.addContextToolbar("textselection",{predicate:en=>!me(en)&&!he.selection.isCollapsed()&&Y(en),items:lt,position:"selection",scope:"editor"})};var kn=()=>{$o.add("quickbars",he=>{ln(he),Kn(he),ae(he),be(he)})};kn()})();
